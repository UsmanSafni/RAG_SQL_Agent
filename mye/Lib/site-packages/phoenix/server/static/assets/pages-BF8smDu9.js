import{A as E,a$ as ue,b0 as Ne,b1 as ze,b2 as ut,B as yt,r as u,j as e,R as Ke,u as Ya,E as K,l as s,b3 as xe,at as le,O as U,v as I,b4 as Ju,ac as Ae,a8 as fl,ah as Ye,ag as H,Q as G,az as pa,a9 as hl,b5 as on,b6 as Zu,au as Xu,b7 as Yu,H as yi,S as ne,T as ve,b8 as kl,aE as Te,aH as Pe,aI as W,b9 as _e,ba as Tn,bb as Pn,bc as fn,o as ar,I as em,bd as nm,be as Xt,bf as Yt,bg as Aa,bh as qe,n as et,bi as am,av as re,aN as tr,bj as tm,bk as fi,bl as lm,bm as im,bn as rm,bo as sm,bp as om,bq as dm,br as cm,bs as um,bt as mm,bu as Be,bv as Ga,D as pm,bw as gm,bx as st,aF as hn,g as lr,by as ym,ay as bl,bz as fm,bA as ir,bB as rr,bC as hm,ai as km,ad as Sl,bD as bm,ae as Sm,af as vm,bE as Cm,p as Fm,bF as hi}from"./vendor-Byx9ZW8r.js";import{y as ft,z as ht,C as Q,d as Z,v as He,w as ae,B as dn,D as X,A as pe,G as vl,p as kt,P as ga,e as $e,f as Zn,T as me,E as bt,a as Ee,r as Xn,s as Da,x as Cl,c as Yn,H as ya,g as Fl,t as St,J as Km,n as vt,h as wn,K as Tm,M as Pm,N as Im,O as Kl,Q as Tl,u as xm,R as Dm}from"./vendor-arizeai-0BoxbU9V.js";import{s as _m,l as Lm,j as Pl,a as Le,i as Il,b as sr,c as wm,d as Hn,e as In,f as or,D as dr,g as Bn,h as Ua,k as Em,m as fe,T as Je,n as Mm,o as xl,p as ki,q as Vm,r as bi,t as Rm,u as Am,v as Nm,N as zm,w as $m,L as ge,x as Fe,y as mn,B as Om,_ as h,z as vn,I as L,C as Qm,G as cr,A as Ct,P as fa,M as Dl,E as Ft,S as ur,F as jm,H as qm,J as Bm,K as Um,O as Hm,Q as Gm,R as Wm,U as he,V as v,W as C,X as oe,Y as ul,Z as de,$ as ce,a0 as Ze,a1 as Jm,a2 as Zm,a3 as Xm,a4 as en,a5 as ke,a6 as Ce,a7 as A,a8 as te,a9 as J,aa as Ym,ab as ep,ac as np,ad as ap,ae as Kt,af as Tt,ag as mr,ah as tp,ai as lp,aj as ip,ak as ie,al as Pt,am as rp,an as pr,ao as Ka,ap as Wa,aq as _l,ar as Oe,as as sp,at as Ll,au as op,av as dp,aw as cp,ax as Fn,ay as Qe,az as je,aA as gr,aB as It,aC as Me,aD as ea,aE as De,aF as Ve,aG as _a,aH as En,aI as xn,aJ as xt,aK as La,aL as Dt,aM as yr,aN as nn,aO as fr,aP as up,aQ as wl,aR as oa,aS as Qn,aT as mp,aU as pp,aV as hr,aW as kr,aX as _t,aY as pn,aZ as na,a_ as tn,a$ as ln,b0 as gp,b1 as yp,b2 as Ja,b3 as fp,b4 as Ha,b5 as Ge,b6 as El,b7 as hp,b8 as kp,b9 as Lt,ba as Mn,bb as bp,bc as Sp,bd as Ml,be as an,bf as gn,bg as wa,bh as Vl,bi as br,bj as vp,bk as Rl,bl as Sr,bm as Cp,bn as Al,bo as nt,bp as vr,bq as Cr,br as Fr,bs as Ue,bt as Kr,bu as kn,bv as ml,bw as Fp,bx as Nl,by as zl,bz as Tr,bA as Kp,bB as Tp,bC as $l,bD as Pp,bE as Ip,bF as xp,bG as Dp,bH as da,bI as Ol,bJ as _p,bK as Pr,bL as We,bM as Lp,bN as wp,bO as Ep,bP as Mp,bQ as Vp,bR as Rp,bS as Ap,bT as wt,bU as Np,bV as zp,bW as Ir,bX as xr,bY as Si,bZ as bn,b_ as Vn,b$ as Ql,c0 as Dr,c1 as _r,c2 as vi,c3 as Ci,c4 as $p,c5 as Op,c6 as B,c7 as Lr,c8 as Et,c9 as Mt,ca as Ea,cb as wr,cc as Ma,cd as Va,ce as Er,cf as Rn,cg as Re,ch as Vt,ci as An,cj as Qp,ck as jp,cl as qp,cm as Bp,cn as Up,co as rn,cp as sn,cq as Hp,cr as Gp,cs as Mr,ct as Wp,cu as Jp,cv as Fi,cw as Zp,cx as Xp,cy as Yp,cz as eg,cA as ng,cB as ag,cC as Vr,cD as tg,cE as lg,cF as ig,cG as rg,cH as ua,cI as jl,cJ as Rr,cK as Fa,cL as pt,cM as Rt,cN as Ar,cO as Nr,cP as el,cQ as sg,cR as zr,cS as og,cT as ql,cU as At,cV as cn,cW as dg,cX as $r,cY as cg,cZ as Or,c_ as Qr,c$ as ug,d0 as mg,d1 as jr,d2 as Gn,d3 as pg,d4 as gg,d5 as Ki,d6 as yg,d7 as fg,d8 as hg,d9 as kg,da as bg,db as qr,dc as Sg,dd as Ta,de as pl,df as vg,dg as Br,dh as Cg,di as Fg,dj as Kg,dk as Nt,dl as Ur,dm as Ti,dn as Tg,dp as Pg,dq as Bl,dr as Hr,ds as Gr,dt as Ig,du as gl,dv as xg,dw as Dg,dx as ot,dy as _g,dz as Lg,dA as Wr,dB as Jr,dC as wg,dD as Eg,dE as Mg,dF as Pi,dG as Ii}from"./components-DtYT5gwD.js";import{m as aa,n as ta,j as Vg,E as Zr,R as la,k as Ul,d as Rg,p as at,q as Xr}from"./vendor-codemirror-BX78TDyo.js";import{R as Nn,C as tt,X as ia,Y as yn,a as ra,T as zn,B as Ia,A as Za,b as Yr,c as Hl,L as es,d as Ag,P as ns,e as as,f as ts}from"./vendor-recharts-BLborQJX.js";const Ng=4,zg={user:["user","human"],ai:["assistant","bot","ai"],system:["system"],tool:["tool"]},$g="Unable to parse span input messages, expected messages which include a role and content.",Og="Unable to parse span output messages, expected messages which include a role and content.",Qg="Unable to parse span output expected output.value to be present.",jg="Unable to parse span attributes, attributes must be valid JSON.",qg="Unable to parse model config, expected llm.model_name to be present.",Bg="Unable to parse model config, expected llm.invocation_parameters JSON string to be present.",Ug="Unable to parse invocation parameters response_format, expected llm.invocation_parameters.response_format to be a well formed json object or undefined.",Hg="Unable to parse tools, expected tools to be an array of valid tools.",Gg="Unable to parse prompt template variables, expected prompt template variables to be a valid JSON object string.",xi={AZURE_OPENAI:[],ANTHROPIC:["claude"],OPENAI:["gpt","o1"],GOOGLE:["gemini"]},Un="TOOL_CHOICE",Pa="tool_choice",Dn="RESPONSE_FORMAT",Kn="response_format",Wg=[Un,Dn],Jg=E.object({tool_call:E.object({id:E.string().optional(),function:E.object({name:E.string(),arguments:E.string()}).partial()}).partial()}).partial(),ls=E.object({[ue.message]:E.object({[Ne.role]:E.string(),[Ne.content]:E.union([E.string(),E.array(E.record(E.string(),E.unknown()))]).default(""),[Ne.tool_calls]:E.array(Jg).optional(),[Ne.tool_call_id]:E.string().optional()})}),Zg=E.object({[ue.llm]:E.object({[ze.input_messages]:E.array(ls)})}),Xg=E.object({[ue.llm]:E.object({[ze.output_messages]:E.array(ls)})}),Yg=E.object({[ue.output]:E.object({value:E.string()})}),is=_m()(E.enum(["user","ai","system","tool"])),ey=E.object({id:E.number(),role:is,content:E.string().optional(),toolCallId:E.string().optional(),toolCalls:E.array(Lm).optional()}),ny=E.array(ey),Gl=E.lazy(()=>E.record(Pl)),ay=Gl,rs=E.string().transform((n,a)=>{const{json:t}=Le(n);if(!Il(t))return a.addIssue({code:E.ZodIssueCode.custom,message:"The invocation parameters must be a valid JSON object"}),E.NEVER;const{success:l,data:i}=ay.safeParse(t);return l?i:(a.addIssue({code:E.ZodIssueCode.custom,message:"The invocation parameters must be a valid JSON object"}),E.NEVER)}).default("{}"),ty=E.object({[ue.llm]:E.object({[ze.provider]:E.string().optional(),[ze.model_name]:E.string()})}),ss=E.object({[ue.llm]:E.object({[ze.invocation_parameters]:rs})}),ly=E.object({[ue.llm]:E.object({[ze.invocation_parameters]:rs.pipe(E.object({response_format:Gl.optional()}))})}),iy=E.object({url:E.object({full:E.string(),path:E.string().optional()})}),ry=E.string().transform((n,a)=>{const{json:t}=Le(n);return t==null||!Il(t)?(a.addIssue({code:E.ZodIssueCode.custom,message:"The tool JSON schema must be a valid JSON object"}),E.NEVER):t}).transform((n,a)=>{const{data:t,success:l}=sr.safeParse(n);return l?t:(a.addIssue({code:E.ZodIssueCode.custom,message:"The tool JSON schema must be a valid tool schema"}),E.NEVER)}),sy=E.object({[ue.llm]:E.object({[ze.tools]:E.array(E.object({[ue.tool]:E.object({[ut.json_schema]:ry})}).optional()).optional()}).optional()}).optional(),oy=E.lazy(()=>E.object({type:E.literal("json_schema"),json_schema:E.object({name:E.string().describe("The name of the schema"),schema:wm.describe("The schema itself in JSON schema format"),strict:E.literal(!0).describe("The schema must be strict")})})),dy=yt(oy,{removeAdditionalStrategy:"passthrough"}),cy=E.string().transform((n,a)=>{const{json:t}=Le(n);return Hn(t)?Object.entries(t).reduce((i,[r,o])=>{if(typeof o=="string")i[r]=o;else{const{json:d}=In(o);d!=null&&(i[r]=d)}return i},{}):(a.addIssue({code:E.ZodIssueCode.custom,message:"The prompt template variables must be a valid JSON object"}),E.NEVER)}),uy=E.object({[ue.llm]:E.object({[ze.prompt_template]:E.object({variables:cy}).optional()}).optional()}).optional();function os(n){return is.safeParse(n).success}function jn(n){const a=n.toLowerCase();if(os(a))return a;for(const[t,l]of Object.entries(zg))if(l.includes(a))return t;return Em}function my({toolCalls:n,provider:a}){if(n!=null)return n.map(({tool_call:t})=>{var i,r,o,d;if(t==null)return null;let l={};if(((i=t.function)==null?void 0:i.arguments)!=null){const{json:c}=Le(t.function.arguments);Hn(c)&&(l=c)}switch(a){case"OPENAI":case"AZURE_OPENAI":return{id:t.id??"",type:"function",function:{name:((r=t.function)==null?void 0:r.name)??"",arguments:l}};case"ANTHROPIC":return{id:t.id??"",type:"tool_use",name:((o=t.function)==null?void 0:o.name)??"",input:l};case"GOOGLE":return{id:t.id??"",function:{name:((d=t.function)==null?void 0:d.name)??"",arguments:l}};default:fe()}}).filter(t=>t!=null)}function ds({messages:n,provider:a}){return n.map(({message:t})=>({id:Bn(),role:t.tool_call_id!=null?jn("tool"):jn(t.role),content:typeof t.content=="string"?t.content:void 0,toolCalls:my({provider:a,toolCalls:t.tool_calls}),toolCallId:t.tool_call_id}))}function py({provider:n,parsedAttributes:a}){var l;const t=Zg.safeParse(a);if(!t.success)return{messageParsingErrors:[$g],messages:null};if(n==="ANTHROPIC"){const{success:i,data:r}=ss.safeParse(a);if(i){const o=t.data.llm.input_messages,d=(l=r.llm.invocation_parameters)==null?void 0:l.system;typeof d=="string"&&d&&(!o||o[0].message.role!=="system")&&t.data.llm.input_messages.unshift({message:{role:"system",content:d}})}}return{messageParsingErrors:[],messages:ds({provider:n,messages:t.data.llm.input_messages})}}function gy({provider:n,parsedAttributes:a}){const t=[],l=Xg.safeParse(a);if(l.success)return{output:ds({provider:n,messages:l.data.llm.output_messages}),outputParsingErrors:t};t.push(Og);const i=Yg.safeParse(a);return i.success?{output:i.data.output.value,outputParsingErrors:t}:(t.push(Qg),{output:void 0,outputParsingErrors:t})}function cs(n){if(n==null)return null;switch(n.toLowerCase()){case"openai":return"OPENAI";case"anthropic":return"ANTHROPIC";case"google":return"GOOGLE";case"azure":return"AZURE_OPENAI";default:return null}}function yy(n){for(const a of Object.keys(xi))if(xi[a].some(l=>n.includes(l)))return a;return dr}function fy(n){const{success:a,data:t}=ty.safeParse(n);if(a){const l=cs(t.llm.provider)||yy(t.llm.model_name),i=hy(n);return{modelConfig:{...Object.fromEntries(Object.entries(i).filter(([r,o])=>o!==null)),modelName:t.llm.model_name,provider:l,invocationParameters:[],supportedInvocationParameters:[]},parsingErrors:[]}}return{modelConfig:null,parsingErrors:[qg]}}function hy(n){const{success:a,data:t}=iy.safeParse(n);if(a)try{const l=new URL(t.url.full);let i=l;if(t.url.path)try{i=new URL(t.url.full.split(t.url.path)[0])}catch{}return{baseUrl:`${i.origin}${i.pathname}`,endpoint:l.origin,apiVersion:l.searchParams.get("api-version")||null}}catch{}return{baseUrl:null,apiVersion:null,endpoint:null}}function ky(n,a=[]){const{success:t,data:l}=ss.safeParse(n),i=[];return t||i.push(Bg),{invocationParameters:Iy((l==null?void 0:l.llm.invocation_parameters)??{},a),parsingErrors:i}}function by(n){const{success:a,data:t}=ly.safeParse(n);return a?{responseFormat:t.llm.invocation_parameters.response_format,parsingErrors:[]}:{responseFormat:void 0,parsingErrors:[Ug]}}function Sy(n){var a;return(((a=n==null?void 0:n.llm)==null?void 0:a.tools)??[]).map(t=>(t==null?void 0:t.tool)==null?null:{id:Ua(),definition:t.tool.json_schema}).filter(t=>t!=null)}function vy(n){var l;const{data:a,success:t}=sy.safeParse(n);return t?((l=a==null?void 0:a.llm)==null?void 0:l.tools)==null?{tools:null,parsingErrors:[]}:{tools:Sy(a),parsingErrors:[]}:{tools:null,parsingErrors:[Hg]}}function Cy(n){var l;const{success:a,data:t}=uy.safeParse(n);return a?((l=t==null?void 0:t.llm)==null?void 0:l.prompt_template)==null?{variables:null,parsingErrors:[]}:{variables:t.llm.prompt_template.variables,parsingErrors:[]}:{variables:null,parsingErrors:[Gg]}}function Fy(n){const{instance:a,instanceMessages:t}=or(),l={...a,template:{__type:"chat",messages:Object.values(t)}},{json:i,parseError:r}=Le(n.attributes);if(r)return{playgroundInstance:{...l,spanId:(n==null?void 0:n.id)??null},parsingErrors:[jg]};const o=n.invocationParameters,d=fy(i);let{modelConfig:c}=d;const{parsingErrors:p}=d,{messages:y,messageParsingErrors:m}=py({provider:(c==null?void 0:c.provider)??l.model.provider,parsedAttributes:i}),{output:g,outputParsingErrors:f}=gy({provider:(c==null?void 0:c.provider)??l.model.provider,parsedAttributes:i}),{invocationParameters:k,parsingErrors:b}=ky(i,o),{variables:S,parsingErrors:F}=Cy(i),{parsingErrors:P}=by(i);c=c!=null?{...c,invocationParameters:P.length>0?k.filter(T=>T.invocationName!==Kn&&T.canonicalName!==Dn):k}:null;const{tools:D,parsingErrors:w}=vy(i);return{playgroundInstance:{...l,model:c??l.model,template:y!=null?{__type:"chat",messages:y}:l.template,output:g,spanId:n.id,tools:D??l.tools},playgroundInput:S!=null?{variablesValueCache:S}:void 0,parsingErrors:[...m,...f,...p,...w,...b,...P,...F]}}const Ky=n=>ny.safeParse(n).success,us=({instance:n,templateFormat:a})=>{if(a==Je.NONE)return[];const t=new Set,l=n.template.__type,i=Mm(a);switch(l){case"chat":{n.template.messages.forEach(r=>{(r.content==null?[]:i.extractVariables(r.content)).forEach(d=>{t.add(d)})});break}case"text_completion":{i.extractVariables(n.template.prompt).forEach(o=>{t.add(o)});break}default:fe()}return Array.from(t)},Ty=({instances:n,templateFormat:a})=>a==Je.NONE?[]:Array.from(new Set(n.flatMap(t=>us({instance:t,templateFormat:a})))),ms=({instances:n,templateFormat:a,input:t})=>{if(a==Je.NONE)return{variablesMap:{},variableKeys:[]};const l=Ty({instances:n,templateFormat:a}),i=t.variablesValueCache??{};return{variablesMap:l.reduce((o,d)=>(o[d]=i[d]||"",o),{}),variableKeys:l}};function Wn(n,a){return n.invocationName===a.invocationName||n.canonicalName!=null&&a.canonicalName!=null&&n.canonicalName===a.canonicalName}const Py=(n,a)=>n.filter(t=>a.some(l=>Wn(l,t))).map(t=>{var l;return{...t,invocationName:((l=a.find(i=>Wn(i,t)))==null?void 0:l.invocationName)??t.invocationName}}),Ra=n=>n.replace(/_([a-z])/g,(a,t)=>t.toUpperCase()),Iy=(n,a)=>Object.entries(n).map(([t,l])=>{const i=a.find(r=>r.canonicalName&&r.canonicalName.toLowerCase()===t.toLowerCase()||r.invocationName&&r.invocationName.toLowerCase()===t.toLowerCase());return i==null||i.invocationInputField==null||i.invocationName==null?null:{canonicalName:i.canonicalName,invocationName:i.invocationName,[Ra(i.invocationInputField)]:l}}).filter(t=>t!=null),ps=n=>{const{provider:a,validatedToolDefinition:t}=Am(n.definition);switch(a){case"OPENAI":case"AZURE_OPENAI":return t.function.name;case"ANTHROPIC":return t.name;case"UNKNOWN":return null;default:fe()}},xy=({provider:n,toolNumber:a})=>{switch(n){case"OPENAI":case"AZURE_OPENAI":return{id:Ua(),definition:bi(a)};case"ANTHROPIC":return{id:Ua(),definition:Rm(a)};case"GOOGLE":return{id:Ua(),definition:bi(a)};default:fe()}},Dy=n=>{switch(n){case"OPENAI":case"AZURE_OPENAI":return ki();case"ANTHROPIC":return Vm();case"GOOGLE":return ki();default:fe()}};function _y(n){return{content:n.content,role:Ly(n.role),toolCalls:n.toolCalls,toolCallId:n.toolCallId}}function Ly(n){switch(n){case"system":return"SYSTEM";case"user":return"USER";case"tool":return"TOOL";case"ai":return"AI";default:fe()}}const gs=({playgroundStore:n,instanceId:a,credentials:t})=>{var m;const{instances:l,allInstanceMessages:i}=n.getState(),r=l.find(g=>g.id===a);if(!r)throw new Error(`No instance found for id ${a}`);if(r.template.__type!=="chat")throw new Error("We only support chat templates for now");const o=r.template.messageIds.map(g=>i[g]).filter(g=>g!=null),d=r.model.supportedInvocationParameters;let c=[...r.model.invocationParameters];const p=xl({toolChoice:r.toolChoice,targetProvider:r.model.provider});r.tools.length>0?(c=c.filter(g=>g.invocationName!==Pa&&g.canonicalName!==Un),c.push({canonicalName:Un,invocationName:Pa,valueJson:p})):c=c.filter(g=>g.invocationName!==Pa&&g.canonicalName!==Un),c=d.length?Py(c,d):c;const y=r.model.provider==="AZURE_OPENAI"?{endpoint:r.model.endpoint,apiVersion:r.model.apiVersion}:{};return{messages:o.map(_y),model:{providerKey:r.model.provider,name:r.model.modelName||"",baseUrl:r.model.baseUrl,...y},invocationParameters:fs(c,r.model.provider,r.model.modelName),tools:r.tools.length?r.tools.map(g=>g.definition):void 0,apiKey:t[r.model.provider]||null,promptName:(m=r.prompt)==null?void 0:m.name}},zt=(n,a)=>{if(n.template.__type==="chat"){const{messageIds:t,...l}=n.template;return{...n,template:{...l,messages:n.template.messageIds.map(i=>a[i])}}}return n},wy=({playgroundStore:n,instanceId:a,credentials:t})=>{const l=gs({playgroundStore:n,instanceId:a,credentials:t}),{instances:i,templateFormat:r,input:o,allInstanceMessages:d}=n.getState(),c=i.map(y=>zt(y,d)),{variablesMap:p}=ms({instances:c,input:o,templateFormat:r});return{...l,template:{variables:p,format:r}}},Di=({playgroundStore:n,instanceId:a,credentials:t,datasetId:l})=>({...gs({playgroundStore:n,instanceId:a,credentials:t}),templateFormat:n.getState().templateFormat,datasetId:l});function $t(n){if(n===""||typeof n>"u")return"{}";if(typeof n=="string"){const a=n.startsWith('"{')||n.startsWith('"[')||n.startsWith('"\\"');try{if(a){const l=JSON.parse(n),i=typeof l=="string"?JSON.parse(l):l;return JSON.stringify(i,null,2)}}catch{}if(/^\s*[0-9{[]|true|false|null/.test(n))return n}return JSON.stringify(n,null,2)}function ys(n,a){return a.filter(t=>t.required).every(t=>n.some(l=>Wn(l,t)))}const Ey=n=>{for(const[a,t]of Object.entries(n))if(a.endsWith("DefaultValue")&&t!=null)return n[a]};function s2(n,a){const t=new Map(n.map(l=>[l.invocationName,l]));return a.forEach(l=>{var c;const i=l.invocationName,r=Ey(l),o=Ra(l.invocationInputField||"");if(!l.invocationName||!l.invocationInputField||!i||r==null||((c=t.get(i))==null?void 0:c[o])!=null)return;const d={canonicalName:l.canonicalName,invocationName:l.invocationName,[o]:r};t.set(i,d)}),Array.from(t.values())}const My=E.object({type:E.literal("enabled")}).passthrough(),Vy=E.object({type:E.enum(["any","tool"])}).passthrough(),Ry=(n,a)=>{if(!a)return n;const t=n.some(l=>l.canonicalName==="ANTHROPIC_EXTENDED_THINKING"&&l.valueJson&&My.safeParse(l.valueJson).success);return n.filter(l=>{if(l.canonicalName==="ANTHROPIC_EXTENDED_THINKING"&&!l.valueJson)return!1;if(t){if(l.canonicalName==="TEMPERATURE"||l.canonicalName==="TOP_P")return!1;if(l.canonicalName===Un)return!Vy.safeParse(l.valueJson).success}return!0})},fs=(n,a,t)=>a==="ANTHROPIC"?Ry(n,t):n,hs=u.createContext(null);function o2({children:n,...a}){const[t]=u.useState(()=>Nm(a));return e(hs.Provider,{value:t,children:n})}function xa(n,a){const t=Ke.useContext(hs);if(!t)throw new Error("Missing CredentialsContext.Provider in the tree");return Ya(t,n,a)}const ks=u.createContext(null);function Ay(){const n=u.useContext(ks);if(n===null)throw new Error("useFunctionality must be used within a FunctionalityProvider");return n}function d2(n){return e(ks.Provider,{value:{authenticationEnabled:window.Config.authenticationEnabled},children:n.children})}const Ny=K`
  display: flex;
  direction: row;
  height: 100vh;
  overflow: hidden;
`,zy=K`
  display: flex;
  flex-direction: column;
  flex: 1 1 auto;
  height: 100%;
  overflow: hidden;
  padding-left: var(--px-nav-collapsed-width);
`,$y=K`
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  height: 100%;
  overflow: hidden;
`,Oy=K`
  display: flex;
  flex-direction: column;
  margin: 0;
  list-style: none;
  gap: var(--ac-global-dimension-size-50);
  padding-inline-start: 0;
`,Qy=K`
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-size-50);
`;function c2(){return s("div",{css:Ny,"data-testid":"layout",children:[e(jy,{}),s("div",{css:zy,children:[e($m,{children:e(zm,{})}),e("div",{"data-testid":"content",css:$y,children:e(u.Suspense,{fallback:e(ge,{}),children:e(xe,{})})})]})]})}function jy(){const n=u.useMemo(()=>window.Config.hasInferences,[]),a=Fe(),{authenticationEnabled:t}=Ay(),l=le(),i=u.useCallback(async()=>{const r=await fetch(mn("/auth/logout"),{method:"POST"});if(r.ok){l("/login");return}a({title:"Logout Failed",message:"Failed to log out: "+r.statusText})},[l,a]);return s(Wm,{children:[e(Om,{}),s(h,{direction:"column",justifyContent:"space-between",flex:"1 1 auto",children:[s("ul",{css:Qy,children:[n&&e("li",{children:e(vn,{to:"/model",text:"Model",leadingVisual:e(L,{svg:e(Qm,{})})})}),e("li",{children:e(vn,{to:"/projects",text:"Projects",leadingVisual:e(L,{svg:e(cr,{})})})}),e("li",{children:e(vn,{to:"/datasets",text:"Datasets",leadingVisual:e(L,{svg:e(Ct,{})})})}),e("li",{children:e(vn,{to:"/playground",text:"Playground",leadingVisual:e(L,{svg:e(fa,{})})})}),e("li",{children:e(vn,{to:"/prompts",text:"Prompts",leadingVisual:e(L,{svg:e(Dl,{})})})}),e("li",{children:e(vn,{to:"/apis",text:"APIs",leadingVisual:e(L,{svg:e(Ft,{})})})})]}),s("ul",{css:Oy,children:[e("li",{children:e(vn,{to:"/settings",text:"Settings",leadingVisual:e(L,{svg:e(ur,{})})})}),e("li",{children:e(jm,{})}),e("li",{children:e(vn,{to:"/support",text:"Support",leadingVisual:e(L,{svg:e(qm,{})})})}),e("li",{children:e(Bm,{})}),t&&s(U,{children:[e("li",{children:e(vn,{to:"/profile",text:"Profile",leadingVisual:e(L,{svg:e(Um,{})})})}),e("li",{children:e(Hm,{text:"Log Out",leadingVisual:e(L,{svg:e(Gm,{})}),onClick:i})})]})]})]})]})}const bs=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"promptConfigLoaderQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"PromptVersionTagsConfigCard_data"}],type:"Prompt",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"promptConfigLoaderQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"versionTags",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"promptVersionId",storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null}],storageKey:null}]},params:{cacheID:"3b99248824fdc64b0a16632d83801a44",id:null,metadata:{},name:"promptConfigLoaderQuery",operationKind:"query",text:`query promptConfigLoaderQuery(
  $id: GlobalID!
) {
  prompt: node(id: $id) {
    __typename
    ... on Prompt {
      ...PromptVersionTagsConfigCard_data
    }
    __isNode: __typename
    id
  }
}

fragment PromptVersionTagsConfigCard_data on Prompt {
  id
  versionTags {
    id
    name
    description
    promptVersionId
  }
}
`}}}();bs.hash="2dcab1077c1d7e48736d23d95ce22331";const u2=async({params:n})=>{const a=n.promptId;if(!a)throw new Error("Prompt ID is required");return await I.fetchQuery(he,bs,{id:a}).toPromise()},Ss={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptIndexPage__aside",selections:[{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{args:null,kind:"FragmentSpread",name:"PromptLatestVersionsListFragment"},{args:null,kind:"FragmentSpread",name:"EditPromptButton_data"}],type:"Prompt",abstractKey:null};Ss.hash="a77263d84d9add47173ed2e3d0243952";const vs={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptIndexPage__main",selections:[{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"PromptInvocationParameters__main"},{args:null,kind:"FragmentSpread",name:"PromptChatMessagesCard__main"},{args:null,kind:"FragmentSpread",name:"PromptCodeExportCard__main"},{args:null,kind:"FragmentSpread",name:"PromptModelConfigurationCard__main"}],storageKey:null}],storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"PromptIndexPage__aside"}],type:"Prompt",abstractKey:null};vs.hash="a883b83f574448623a2b02a60d899d41";const Cs={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptModelConfigurationCard__main",selections:[{alias:"model",args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:"provider",args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{args:null,kind:"FragmentSpread",name:"PromptLLM__main"},{args:null,kind:"FragmentSpread",name:"PromptInvocationParameters__main"},{args:null,kind:"FragmentSpread",name:"PromptTools__main"},{args:null,kind:"FragmentSpread",name:"PromptResponseFormatFragment"}],type:"PromptVersion",abstractKey:null};Cs.hash="1c4202299f1f881250b17b75244fac54";const Fs={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptInvocationParameters__main",selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationParameters",storageKey:null}],type:"PromptVersion",abstractKey:null};Fs.hash="4f00ab4f0396fffb81a1b068e544cfcf";function qy({keyName:n,value:a}){const{json:t,stringifyError:l}=In(a);return l?null:e(C,{paddingStart:"size-100",paddingEnd:"size-100",children:s(h,{direction:"row",justifyContent:"space-between",children:[e(v,{size:"XS",color:"text-700",children:n}),e(v,{size:"XS",children:t})]})})}function By({promptVersion:n}){const{invocationParameters:a}=I.useFragment(Fs,n),t=u.useMemo(()=>Ju(a)?Object.entries(a).map(([l,i])=>({key:l,value:i})):[],[a]);return t.length===0?e(C,{padding:"size-200",children:e(h,{justifyContent:"center",alignItems:"center",children:e(v,{color:"text-300",children:"No parameters saved for this prompt"})})}):e(ht,{listSize:"small",children:t.map(({key:l,value:i},r)=>e(ft,{children:e(qy,{keyName:l,value:i})},`${l}-${r}`))})}const Ks={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptLLM__main",selections:[{alias:"model",args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:"provider",args:null,kind:"ScalarField",name:"modelProvider",storageKey:null}],type:"PromptVersion",abstractKey:null};Ks.hash="acc90da43126218472d2fc19cd8d0512";const _i=({keyName:n,children:a})=>e(ft,{listSize:"small",children:e(C,{paddingStart:"size-100",paddingEnd:"size-100",children:s(h,{direction:"row",justifyContent:"space-between",children:[e(v,{size:"XS",color:"text-700",children:n}),e(v,{size:"XS",children:a})]})})});function Uy({promptVersion:n}){const a=I.useFragment(Ks,n);return s(ce,{id:"llm",children:[e(oe,{children:"LLM"}),e(de,{children:s(ht,{listSize:"small",children:[e(_i,{keyName:"Model",children:a.model}),e(_i,{keyName:"Provider",children:ul[a.provider]??a.provider})]})})]})}const Ts={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptResponseFormatFragment",selections:[{alias:null,args:null,concreteType:"ResponseFormat",kind:"LinkedField",name:"responseFormat",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],storageKey:null}],type:"PromptVersion",abstractKey:null};Ts.hash="154d745ec5e978e0dfc811ebfb9faa8c";function Hy({promptVersion:n}){const{responseFormat:a}=I.useFragment(Ts,n),t=u.useMemo(()=>typeof(a==null?void 0:a.definition)=="string"?In(Le(a==null?void 0:a.definition).json||"",null,2).json||"":In(a==null?void 0:a.definition,null,2).json||"",[a==null?void 0:a.definition]);return t?s(ce,{id:"response-format",children:[e(oe,{children:"Response Format"}),e(de,{children:e(Ze,{value:t})})]}):s(ce,{id:"response-format",children:[e(oe,{children:"Response Format"}),e(de,{children:e(C,{padding:"size-200",children:e(h,{justifyContent:"center",alignItems:"center",children:e(v,{color:"text-300",children:"No response format specified for this prompt"})})})})]})}const Ps={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptTools__main",selections:[{alias:null,args:null,concreteType:"ToolDefinition",kind:"LinkedField",name:"tools",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],storageKey:null}],type:"PromptVersion",abstractKey:null};Ps.hash="aa512d962d83a58b70ae0e17f01242b3";function Gy({promptVersion:n}){const{tools:a}=I.useFragment(Ps,n),t=u.useMemo(()=>a.map((l,i)=>{const r=l.definition;return{name:Zm(r)||`Tool ${i+1}`,description:Jm(r)||void 0,definition:In(r,null,2).json||"{}"}}),[a]);return t.length===0?s(ce,{id:"tools",children:[e(oe,{children:"Tools"}),e(de,{children:e(C,{padding:"size-200",children:e(h,{justifyContent:"center",alignItems:"center",children:e(v,{color:"text-300",children:"No tools specified for this prompt"})})})})]}):s(h,{direction:"column",children:[e(Xm,{bordered:!1,children:"Tools"}),e(en,{css:K`
          & {
            > .ac-disclosure:last-child {
              &[data-expanded="true"] {
                border-bottom: 1px solid var(--ac-global-border-color-default);
              }
            }
          }
        `,children:t.map((l,i)=>s(ce,{id:`tool-${i}`,children:[s(oe,{arrowPosition:"start",justifyContent:"space-between",children:[e(v,{children:l.name}),e(v,{children:l.description})]}),e(de,{children:e(Ze,{value:l.definition})})]},`${l.name}-${i}`))})]})}function Is({promptVersion:n}){const a=I.useFragment(Cs,n);return e(Q,{title:"Model Configuration",variant:"compact",bodyStyle:{padding:0},collapsible:!0,children:s(en,{defaultExpandedKeys:["llm","invocation-parameters","tools","response-format"],children:[e(Uy,{promptVersion:a}),s(ce,{id:"invocation-parameters",children:[e(oe,{children:"Invocation Parameters"}),e(de,{children:e(By,{promptVersion:a})})]}),e(Gy,{promptVersion:a}),e(Hy,{promptVersion:a})]})})}const xs=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{kind:"Variable",name:"input",variableName:"input"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"toolCallId",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},o=[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],d={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"EditPromptButtonPatchPromptMutation",selections:[{alias:null,args:a,concreteType:"Prompt",kind:"LinkedField",name:"patchPrompt",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"PromptIndexPage__main"}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"EditPromptButtonPatchPromptMutation",selections:[{alias:null,args:a,concreteType:"Prompt",kind:"LinkedField",name:"patchPrompt",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationParameters",storageKey:null},{alias:"provider",args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"template",plural:!1,selections:[t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptMessage",kind:"LinkedField",name:"messages",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"content",plural:!0,selections:[t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TextContentValue",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}],type:"TextContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolCallContentValue",kind:"LinkedField",name:"toolCall",plural:!1,selections:[l,{alias:null,args:null,concreteType:"ToolCallFunction",kind:"LinkedField",name:"toolCall",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null},i],storageKey:null}],storageKey:null}],type:"ToolCallContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolResultContentValue",kind:"LinkedField",name:"toolResult",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}],type:"ToolResultContentPart",abstractKey:null}],storageKey:null}],storageKey:null}],type:"PromptChatTemplate",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"template",storageKey:null}],type:"PromptStringTemplate",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateFormat",storageKey:null},r,{alias:null,args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:"ResponseFormat",kind:"LinkedField",name:"responseFormat",plural:!1,selections:o,storageKey:null},{alias:null,args:null,concreteType:"ToolDefinition",kind:"LinkedField",name:"tools",plural:!0,selections:o,storageKey:null},{alias:"model",args:null,kind:"ScalarField",name:"modelName",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},d,{alias:"latestVersions",args:[{kind:"Literal",name:"first",value:5}],concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[r,d,{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[r,i],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:"promptVersions(first:5)"},r],storageKey:null}]},params:{cacheID:"a0e00e13cb2441248615b9d8966a918f",id:null,metadata:{},name:"EditPromptButtonPatchPromptMutation",operationKind:"mutation",text:`mutation EditPromptButtonPatchPromptMutation(
  $input: PatchPromptInput!
) {
  patchPrompt(input: $input) {
    ...PromptIndexPage__main
  }
}

fragment EditPromptButton_data on Prompt {
  id
  description
}

fragment PromptChatMessagesCard__main on PromptVersion {
  provider: modelProvider
  template {
    __typename
    ... on PromptChatTemplate {
      messages {
        role
        content {
          __typename
          ... on TextContentPart {
            text {
              text
            }
          }
          ... on ToolCallContentPart {
            toolCall {
              toolCallId
              toolCall {
                arguments
                name
              }
            }
          }
          ... on ToolResultContentPart {
            toolResult {
              toolCallId
              result
            }
          }
        }
      }
    }
    ... on PromptStringTemplate {
      template
    }
  }
  templateType
  templateFormat
}

fragment PromptCodeExportCard__main on PromptVersion {
  id
  invocationParameters
  modelName
  modelProvider
  responseFormat {
    definition
  }
  tools {
    definition
  }
  template {
    __typename
    ... on PromptChatTemplate {
      messages {
        role
        content {
          __typename
          ... on TextContentPart {
            __typename
            text {
              text
            }
          }
          ... on ToolCallContentPart {
            __typename
            toolCall {
              toolCallId
              toolCall {
                name
                arguments
              }
            }
          }
          ... on ToolResultContentPart {
            __typename
            toolResult {
              toolCallId
              result
            }
          }
        }
      }
    }
    ... on PromptStringTemplate {
      template
    }
  }
  templateFormat
  templateType
}

fragment PromptIndexPage__aside on Prompt {
  description
  ...PromptLatestVersionsListFragment
  ...EditPromptButton_data
}

fragment PromptIndexPage__main on Prompt {
  promptVersions {
    edges {
      node {
        ...PromptInvocationParameters__main
        ...PromptChatMessagesCard__main
        ...PromptCodeExportCard__main
        ...PromptModelConfigurationCard__main
      }
    }
  }
  ...PromptIndexPage__aside
}

fragment PromptInvocationParameters__main on PromptVersion {
  invocationParameters
}

fragment PromptLLM__main on PromptVersion {
  model: modelName
  provider: modelProvider
}

fragment PromptLatestVersionsListFragment on Prompt {
  latestVersions: promptVersions(first: 5) {
    edges {
      version: node {
        id
        description
        createdAt
        sequenceNumber
        ...PromptVersionSummaryFragment
      }
    }
  }
}

fragment PromptModelConfigurationCard__main on PromptVersion {
  model: modelName
  provider: modelProvider
  ...PromptLLM__main
  ...PromptInvocationParameters__main
  ...PromptTools__main
  ...PromptResponseFormatFragment
}

fragment PromptResponseFormatFragment on PromptVersion {
  responseFormat {
    definition
  }
}

fragment PromptTools__main on PromptVersion {
  tools {
    definition
  }
}

fragment PromptVersionSummaryFragment on PromptVersion {
  id
  description
  sequenceNumber
  createdAt
  user {
    id
    username
    profilePictureUrl
  }
  ...PromptVersionTagsList_data
}

fragment PromptVersionTagsList_data on PromptVersion {
  tags {
    id
    name
  }
}
`}}}();xs.hash="3ce25c8fbe5598ec1ee037a9778a6957";const Ds={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"EditPromptButton_data",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null}],type:"Prompt",abstractKey:null};Ds.hash="24788aacf7830c0e5037befe576f4968";function Wy(n){const[a,t]=u.useState(!1),l=ke(),i=Fe(),r=I.useFragment(Ds,n.prompt),[o,d]=I.useMutation(xs),{control:c,handleSubmit:p}=Ae({defaultValues:{description:r.description??""}}),y=u.useCallback(m=>{o({variables:{input:{promptId:r.id,description:m.description}},onCompleted:()=>{t(!1),l({title:"Prompt updated",message:"The prompt has been updated successfully"})},onError:g=>{var f;i({title:"Error updating prompt",message:(f=Ce(g))==null?void 0:f[0]})}})},[r.id,o,i,l]);return s(hl,{isOpen:a,onOpenChange:t,children:[e(A,{size:"S",leadingVisual:e(L,{svg:e(ur,{})}),variant:"quiet","aria-label":"configure prompt",onPress:()=>t(!0)}),e(Ym,{size:"S",isDismissable:!0,children:s(fl,{children:[e(te,{slot:"title",children:"Edit Prompt Details"}),s(Ye,{children:[e(C,{padding:"size-200",children:e(H,{name:"description",control:c,render:({field:m})=>s(J,{value:m.value,onChange:m.onChange,children:[e(G,{children:"Prompt Description"}),e(pa,{placeholder:"Enter a description for the prompt"}),e(v,{slot:"description",children:"A description of the prompt"})]})})}),e(C,{paddingX:"size-200",paddingY:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:s(h,{direction:"row",gap:"size-100",justifyContent:"end",children:[e(A,{slot:"close",size:"S",children:"Cancel"}),e(A,{variant:"primary",size:"S",isDisabled:d,onPress:()=>p(y)(),children:d?"Saving...":"Save"})]})})]})]})})]})}const _s=function(){var n={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"toolCallId",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptChatMessagesCard__main",selections:[{alias:"provider",args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"template",plural:!1,selections:[n,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptMessage",kind:"LinkedField",name:"messages",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"content",plural:!0,selections:[n,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TextContentValue",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}],type:"TextContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolCallContentValue",kind:"LinkedField",name:"toolCall",plural:!1,selections:[a,{alias:null,args:null,concreteType:"ToolCallFunction",kind:"LinkedField",name:"toolCall",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],type:"ToolCallContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolResultContentValue",kind:"LinkedField",name:"toolResult",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}],type:"ToolResultContentPart",abstractKey:null}],storageKey:null}],storageKey:null}],type:"PromptChatTemplate",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"template",storageKey:null}],type:"PromptStringTemplate",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateFormat",storageKey:null}],type:"PromptVersion",abstractKey:null}}();_s.hash="e0d9c12926330e5e774cbc64de158a82";const Wl=E.object({text:E.object({text:E.string()})}),Jl=E.object({toolCall:E.object({toolCallId:E.string(),toolCall:E.object({name:E.string(),arguments:E.string()})})}),Zl=E.object({toolResult:E.object({toolCallId:E.string(),result:Pl})}),Ot=n=>{const a=Wl.safeParse(n);return a.success?a.data:null},Ls=n=>{const a={text:{text:n}},t=Wl.safeParse(a);return t.success?t.data:null},Xl=n=>{const a=Jl.safeParse(n);return a.success?a.data:null},ws=n=>{const a=ep(n),t=np(n),l=ap(n);if(!a)return null;const i=In(l).json||"",r={toolCall:{toolCallId:a,toolCall:{name:t||a,arguments:i}}},o=Jl.safeParse(r);return o.success?o.data:null},Yl=n=>{const a=Zl.safeParse(n);return a.success?a.data:null},Es=(n,a)=>{const t={toolResult:{toolCallId:n,result:a}},l=Zl.safeParse(t);return l.success?l.data:null};function lt(n){return u.useMemo(()=>{const a=n.toLowerCase();return a==="user"||a==="human"?{backgroundColor:"grey-200",borderColor:"grey-500"}:a==="assistant"||a==="ai"?{backgroundColor:"blue-100",borderColor:"blue-700"}:a==="system"||a==="developer"?{backgroundColor:"indigo-100",borderColor:"indigo-700"}:["function","tool"].includes(a)?{backgroundColor:"yellow-100",borderColor:"yellow-700"}:{backgroundColor:"grey-100",borderColor:"grey-700"}},[n])}const Qt={text:"Text",toolCall:"Tool Call",toolResult:"Tool Result"},Jy=Object.values(Qt);function Zy({toolResult:n,isOnlyChild:a}){const t=u.useMemo(()=>{const l=n.toolResult.result;return $t(l)},[n]);return e(ei,{title:Qt.toolResult,isOnlyChild:a,children:s(h,{direction:"column",children:[e(C,{paddingX:"size-200",paddingTop:"size-100",children:s(h,{direction:"column",justifyContent:"start",gap:"size-100",children:[e(v,{weight:"heavy",size:"XS",children:"Tool ID"}),e(C,{paddingX:"size-300",children:e(v,{size:"XS",children:n.toolResult.toolCallId})})]})}),s(h,{direction:"column",children:[e(C,{paddingX:"size-200",paddingTop:"size-100",children:e(v,{weight:"heavy",size:"XS",children:"Tool Result"})}),e(Kt,{readOnly:!0,children:e(Tt,{readOnly:!0,height:"100%",defaultValue:t,templateFormat:Je.NONE})})]})]})})}function Xy({provider:n,toolCall:a,isOnlyChild:t}){const l=u.useMemo(()=>{const i=mr(a,n);return In(i,null,2).json||""},[n,a]);return e(ei,{title:Qt.toolCall,isOnlyChild:t,children:e(Kt,{readOnly:!0,children:e(Tt,{readOnly:!0,height:"100%",defaultValue:l,templateFormat:Je.NONE})})})}function Yy(n){const{text:a,templateFormat:t,isOnlyChild:l}=n;return e(ei,{title:Qt.text,isOnlyChild:l,children:e(Kt,{readOnly:!0,children:e(Tt,{readOnly:!0,height:"100%",defaultValue:a,templateFormat:t})})})}function ei({title:n,children:a,isOnlyChild:t}){return t?e(U,{children:a}):s(ce,{id:n,children:[e(oe,{children:e(v,{weight:"heavy",size:"S",children:n})}),e(de,{children:a})]})}function ef(n){const{role:a,children:t}=n,l=lt(a);return e(Q,{title:a,variant:"compact",...l,bodyStyle:{padding:0},collapsible:!0,children:e(en,{defaultExpandedKeys:Jy,children:t})})}function nf({promptVersion:n}){const{template:a,templateFormat:t,provider:l}=I.useFragment(_s,n);if(a.__typename==="PromptStringTemplate")return e(v,{children:a.template});if(a.__typename==="PromptChatTemplate")return e(tf,{template:a,templateFormat:t,provider:cs(l)||dr});if(a.__typename==="%other")throw new Error("Unknown template type"+a.__typename)}function af({part:n,templateFormat:a,provider:t,isOnlyChild:l}){let i=Ot(n);return i?e(Yy,{text:i.text.text,templateFormat:a,isOnlyChild:l}):(i=Xl(n),i?e(Xy,{toolCall:i,provider:t,isOnlyChild:l}):(i=Yl(n),i?e(Zy,{toolResult:i,isOnlyChild:l}):null))}function tf({template:n,templateFormat:a,provider:t}){const{messages:l}=n;return e(h,{direction:"column",gap:"size-100","data-testid":"chat-messages",children:l.map((i,r)=>{const o=i.content.length===1&&i.content.find(Ot)!=null;return e(ef,{role:i.role,children:i.content.map((d,c)=>e(af,{part:d,templateFormat:a,provider:t,isOnlyChild:o},`${c}-${d.__typename}`))},r)})})}function Ms({title:n="Prompt",promptVersion:a}){return e(Q,{title:n,variant:"compact",collapsible:!0,"data-testid":"prompt-chat-messages-card",children:e(nf,{promptVersion:a})})}const Vs=function(){var n=[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],a={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"toolCallId",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptCodeExportCard__main",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"invocationParameters",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:"ResponseFormat",kind:"LinkedField",name:"responseFormat",plural:!1,selections:n,storageKey:null},{alias:null,args:null,concreteType:"ToolDefinition",kind:"LinkedField",name:"tools",plural:!0,selections:n,storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"template",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptMessage",kind:"LinkedField",name:"messages",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"content",plural:!0,selections:[{kind:"InlineFragment",selections:[a,{alias:null,args:null,concreteType:"TextContentValue",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}],type:"TextContentPart",abstractKey:null},{kind:"InlineFragment",selections:[a,{alias:null,args:null,concreteType:"ToolCallContentValue",kind:"LinkedField",name:"toolCall",plural:!1,selections:[t,{alias:null,args:null,concreteType:"ToolCallFunction",kind:"LinkedField",name:"toolCall",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],storageKey:null}],type:"ToolCallContentPart",abstractKey:null},{kind:"InlineFragment",selections:[a,{alias:null,args:null,concreteType:"ToolResultContentValue",kind:"LinkedField",name:"toolResult",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}],type:"ToolResultContentPart",abstractKey:null}],storageKey:null}],storageKey:null}],type:"PromptChatTemplate",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"template",storageKey:null}],type:"PromptStringTemplate",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateFormat",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateType",storageKey:null}],type:"PromptVersion",abstractKey:null}}();Vs.hash="3fa95713c234bb0cfa4c36e8e4f9cea0";const lf=E.enum(["system","user","assistant","developer","tool","function"]),jt=E.object({role:lf,content:E.string().nullable(),name:E.string().optional(),tool_call_id:E.string().optional(),tool_calls:E.array(tp).optional()}).passthrough(),rf=E.array(jt);yt(rf,{removeAdditionalStrategy:"passthrough"});const sf=E.enum(["user","assistant","tool"]),of=lp.extend({type:E.string(),text:E.string().optional(),id:E.string().optional(),tool_use_id:E.string().optional(),name:E.string().optional(),input:E.record(E.unknown()).optional(),source:E.object({type:E.string(),media_type:E.string().optional(),data:E.string().optional()}).optional()}),Rs=E.object({role:sf,content:E.union([E.string(),E.array(of)])}),df=E.array(Rs);yt(df,{removeAdditionalStrategy:"passthrough"});const cf=E.enum(["SYSTEM","USER","AI","TOOL"]),uf=E.object({image:E.object({url:E.string()})}),mf=E.discriminatedUnion("__typename",[Wl.extend({__typename:E.literal("TextContentPart")}),uf.extend({__typename:E.literal("ImageContentPart")}),Jl.extend({__typename:E.literal("ToolCallContentPart")}),Zl.extend({__typename:E.literal("ToolResultContentPart")})]),qt=E.object({role:cf,content:E.array(mf)}).passthrough(),pf=E.array(qt);yt(pf,{removeAdditionalStrategy:"passthrough"});const As=jt.transform(n=>{const a={role:n.role==="assistant"?"assistant":"user",content:n.content?[{type:"text",text:n.content}]:[]};return n.tool_calls?{...a,content:[...a.content,...n.tool_calls.map(t=>ip.parse(t))]}:n.tool_call_id?{...a,content:[{type:"tool_result",tool_use_id:n.tool_call_id,content:n.content}]}:a}),Ns=qt.transform(n=>{if(n.role==="TOOL"){const l=n.content.map(i=>Yl(i)).find(i=>!!i);if(!l)throw new Error("TOOL role message must have a ToolResultContentPart");return{role:"tool",content:$t(l.toolResult.result),tool_call_id:l.toolResult.toolCallId}}const a={role:{SYSTEM:"system",USER:"user",AI:"assistant",TOOL:"tool"}[n.role],content:n.content.map(l=>Ot(l)).filter(l=>!!l).map(l=>l.text.text).join(`
`)},t=n.content.map(l=>Xl(l)).filter(l=>!!l).map(l=>({id:l.toolCall.toolCallId,type:"function",function:{name:l.toolCall.toolCall.name,arguments:typeof l.toolCall.toolCall.arguments=="string"?JSON.parse(l.toolCall.toolCall.arguments):l.toolCall.toolCall.arguments}}));return t.length>0?{...a,tool_calls:t}:a});jt.transform(n=>{const a=[];if(n.role==="tool"&&n.tool_call_id){const l=Es(n.tool_call_id,n.content);return l&&a.push({__typename:"ToolResultContentPart",...l}),{role:"TOOL",content:a}}if(n.content){const l=Ls(n.content);l&&a.push({__typename:"TextContentPart",...l})}return n.tool_calls&&n.tool_calls.forEach(l=>{const i=ws({id:l.id,name:l.function.name,arguments:l.function.arguments});i&&a.push({__typename:"ToolCallContentPart",...i})}),{role:{system:"SYSTEM",user:"USER",assistant:"AI",tool:"TOOL",developer:"SYSTEM",function:"TOOL"}[n.role],content:a}});const gf=({message:n,targetProvider:a})=>{switch(a){case"AZURE_OPENAI":case"OPENAI":return n;case"ANTHROPIC":return As.parse(n);case"GOOGLE":return n;default:return fe()}};E.union([jt,Rs,qt,Pl]);qt.transform(n=>As.parse(Ns.parse(n)));const un="  ",dt=({json:n,level:a,removeKeyQuotes:t=!1})=>{const l=un.repeat(a);let i=JSON.stringify(n,null,un);return i=i.split(`
`).map((r,o)=>o>0?l+r:r).join(`
`),t&&(i=i.replace(/"([a-zA-Z_$][a-zA-Z0-9_$]*)"\s*:/g,"$1:")),i},yf=on.template(`
from openai import OpenAI

client = OpenAI()

messages=<%= messages %>
# ^ apply additional templating to messages if needed

completion = client.chat.completions.create(
<% _.forEach(args, function(arg) { %><%= tab %><%= arg %>,
<% }); %>)

print(completion.choices[0].message)
`.trim()),ff=on.template(`
import OpenAI from "openai";

const openai = new OpenAI();

const messages = <%= messages %>;
// ^ apply additional templating to messages if needed

const response = openai.chat.completions.create({
<% _.forEach(args, function(arg) { %><%= tab %><%= arg %>,
<% }); %>});

response.then((completion) => console.log(completion.choices[0].message));
`.trim()),hf=on.template(`
from openai import OpenAI
from phoenix.client import Client

prompt = Client().prompts.get(prompt_version_id="<%= versionId %>")

# Format the prompt template with the appropriate variables
response = OpenAI().chat.completions.create(**prompt.format(variables={ "variable": "value" }))
print(response.choices[0].message.content)
  `.trim()),kf=on.template(`
from openai import OpenAI;
import { Client } from "@arizeai/phoenix-client";
import { toSDK, getPrompt } from "@arizeai/phoenix-client/prompts";

const client = new Client();
const openai = new OpenAI();

const prompt = await getPrompt({
  client,
  prompt: {
    versionId: "<%= versionId %>",
  },
});

const openAIParams = toSDK({
  prompt,
  sdk: "openai",
  // Apply the prompt template variables
  variables: {
    key: "value",
  },
});

const response = await openai.chat.completions.create({
  ...openAIParams,
});

console.log(response.choices[0]?.message.content);
`.trim()),bf=on.template(`
from anthropic import Anthropic

client = Anthropic()

messages=<%= messages %>
# ^ apply additional templating to messages if needed

completion = client.messages.create(
<% _.forEach(args, function(arg) { %><%= tab %><%= arg %>,
<% }); %>)

print(completion.content)
`.trim()),Sf=on.template(`
import Anthropic from "@anthropic-ai/sdk";

const client = new Anthropic();

const messages = <%= messages %>;
// ^ apply additional templating to messages if needed

const response = await client.messages.create({
<% _.forEach(args, function(arg) { %><%= tab %><%= arg %>,
<% }); %>});

console.log(response.content);
`.trim()),vf=on.template(`
from anthropic import Anthropic
from phoenix.client import Client

prompt = Client().prompts.get(prompt_version_id="<%= versionId %>")
# Format the prompt template with the appropriate variables
resp = Anthropic().messages.create(**prompt.format(variables={ "variable": "value" }))
  `.trim()),Cf=on.template(`
import Anthropic from "@anthropic-ai/sdk";
import { Client } from "@arizeai/phoenix-client";
import { toSDK, getPrompt } from "@arizeai/phoenix-client/prompts";

const client = new Client();
const anthropic = new Anthropic();

const prompt = await getPrompt({
  client,
  prompt: {
    versionId: "<%= versionId %>",
  },
});

const anthropicParams = toSDK({
  prompt,
  sdk: "anthropic",
  // Apply the prompt template variables
  variables: {
    key: "value",
  },
});

const response = await anthropic.messages.create({
  ...anthropicParams,
});

console.log(response.content);
`.trim()),qn={python:{openai:{assignmentOperator:"=",removeKeyQuotes:!1,stringQuote:'"',sdkTemplate:yf,clientTemplate:hf},anthropic:{assignmentOperator:"=",removeKeyQuotes:!1,stringQuote:'"',sdkTemplate:bf,clientTemplate:vf}},typescript:{openai:{assignmentOperator:": ",removeKeyQuotes:!0,stringQuote:'"',sdkTemplate:ff,clientTemplate:kf},anthropic:{assignmentOperator:": ",removeKeyQuotes:!0,stringQuote:'"',sdkTemplate:Sf,clientTemplate:Cf}}},ct=(n,a)=>{if(!("messages"in n.template))throw new Error("Prompt template does not contain messages");const t=[],{assignmentOperator:l,removeKeyQuotes:i,stringQuote:r}=a;if(n.modelName&&t.push(`model${l}${r}${n.modelName}${r}`),n.invocationParameters){const d=Object.entries(n.invocationParameters).map(([c,p])=>typeof p=="string"?`${c}${l}${r}${p}${r}`:Il(p)?`${c}${l}${dt({json:p,level:1,removeKeyQuotes:i})}`:`${c}${l}${p}`);t.push(...d)}let o="";if(n.template.messages.length>0&&(o=dt({json:n.template.messages,level:0,removeKeyQuotes:i}),t.push(l==="="?"messages=messages":"messages")),n.tools&&n.tools.length>0){const d=dt({json:n.tools.map(c=>c.definition),level:1,removeKeyQuotes:i});t.push(`tools${l}${d}`)}if(n.responseFormat&&"definition"in n.responseFormat){const d=dt({json:n.responseFormat.definition,level:1,removeKeyQuotes:i});t.push(`response_format${l}${d}`)}return{args:t,messages:o}},Li=n=>"tool_calls"in n&&n.tool_calls?{...n,tool_calls:n.tool_calls.map(a=>({...a,function:{...a.function,arguments:JSON.stringify(a.function.arguments)}}))}:n,Ff={python:{openai:n=>{const a=qn.python.openai,t={...n,template:{...n.template,messages:n.template.messages.map(r=>Li(r))}},{args:l,messages:i}=ct(t,a);return a.sdkTemplate({tab:un,args:l,messages:i})},anthropic:n=>{const a=qn.python.anthropic,{args:t,messages:l}=ct(n,a);return a.sdkTemplate({tab:un,args:t,messages:l})}},typescript:{openai:n=>{const a=qn.typescript.openai,t={...n,template:{...n.template,messages:n.template.messages.map(r=>Li(r))}},{args:l,messages:i}=ct(t,a);return a.sdkTemplate({tab:un,args:l,messages:i})},anthropic:n=>{const a=qn.typescript.anthropic,{args:t,messages:l}=ct(n,a);return a.sdkTemplate({tab:un,args:t,messages:l})}}},Kf={python:{openai:n=>qn.python.openai.clientTemplate({tab:un,versionId:n.versionId}),anthropic:n=>qn.python.openai.clientTemplate({tab:un,versionId:n.versionId})},typescript:{openai:n=>qn.typescript.openai.clientTemplate({tab:un,versionId:n.versionId}),anthropic:n=>qn.typescript.anthropic.clientTemplate({tab:un,versionId:n.versionId})}},Tf=({promptVersion:n,language:a})=>{var i;const t=Ff[a.toLocaleLowerCase()][(i=n.modelProvider)==null?void 0:i.toLocaleLowerCase()];if(!t||!("messages"in n.template))return null;const l={...n,template:{...n.template,messages:n.template.messages.map(r=>{try{return gf({message:Ns.parse(r),targetProvider:n.modelProvider})}catch(o){return console.warn("Cannot convert message"),console.error(o),null}}).filter(Boolean)}};return t(l)};function Pf({promptVersion:n,language:a}){var i;const t=Kf[a.toLocaleLowerCase()][(i=n.modelProvider)==null?void 0:i.toLocaleLowerCase()];if(!t)return null;const l={versionId:n.id};return t(l)}function zs({promptVersion:n}){const[a,t]=u.useState("Python"),l=I.useFragment(Vs,n),i=u.useMemo(()=>Tf({promptVersion:l,language:a}),[l,a]),r=u.useMemo(()=>Pf({promptVersion:l,language:a}),[l,a]);return e(Q,{title:"Code",variant:"compact",bodyStyle:{padding:0},extra:e(h,{gap:"size-100",alignItems:"center",children:e(Pt,{language:a,onChange:t,size:"S"})}),children:s(en,{defaultExpandedKeys:["sdk-inline","client"],children:[s(ce,{id:"sdk-inline",children:[e(oe,{arrowPosition:"start",children:s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",gap:"size-100",width:"100%",children:[e(v,{children:"SDK Inline"}),i?e(ie,{text:i}):null]})}),e(de,{children:i==null?e(C,{width:"100%",padding:"size-200",children:e(v,{color:"text-300",children:"No code snippet available for this prompt"})}):e(wi,{language:a,value:i})})]}),s(ce,{id:"client",children:[e(oe,{arrowPosition:"start",children:s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",width:"100%",gap:"size-100",children:[e(v,{children:"Using the Client"}),r?e(ie,{text:r}):null]})}),e(de,{children:r==null?e(C,{width:"100%",padding:"size-200",children:e(v,{color:"text-300",children:"No client code snippet available for this prompt"})}):e(wi,{language:a,value:r})})]})]})})}function wi({language:n,value:a}){switch(n){case"Python":return e(pr,{value:a,basicSetup:{lineNumbers:!0}});case"TypeScript":return e(rp,{value:a,basicSetup:{lineNumbers:!0}});default:fe()}}const $s={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptLatestVersionsListFragment",selections:[{alias:"latestVersions",args:[{kind:"Literal",name:"first",value:5}],concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{args:null,kind:"FragmentSpread",name:"PromptVersionSummaryFragment"}],storageKey:null}],storageKey:null}],storageKey:"promptVersions(first:5)"}],type:"Prompt",abstractKey:null};$s.hash="a473a6f0d927379542694312449a4c63";const Os=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptVersionSummaryFragment",selections:[n,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"PromptVersionTagsList_data"}],type:"PromptVersion",abstractKey:null}}();Os.hash="80901eff49852a413f643ee876638174";const Qs={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptVersionTagsList_data",selections:[{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],type:"PromptVersion",abstractKey:null};Qs.hash="25265fbc7ea915534615a56b4331236e";function js({promptVersion:n}){const a=I.useFragment(Qs,n);return e(h,{direction:"row",gap:"size-50",alignItems:"center",wrap:"wrap",children:a.tags.map(t=>e(If,{children:t.name},t.id))})}function If({children:n}){const a=u.useMemo(()=>{switch(n){case"production":return"var(--ac-global-color-green-1000)";case"staging":return"var(--ac-global-color-yellow-1000)";case"development":return"var(--ac-global-color-blue-1000)";default:return"var(--ac-global-color-grey-900)"}},[n]);return e(Ka,{color:a,children:n})}function qs(n){const a=I.useFragment(Os,n.promptVersion);return s(h,{direction:"column",gap:"size-50",children:[e(C,{width:"100%",children:e(h,{direction:"row",justifyContent:"space-between",alignItems:"center",width:"100%",children:s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Ka,{color:"var(--ac-global-color-blue-900)",children:a.sequenceNumber}),e("span",{children:`${a.id}`})]})})}),e(C,{"data-testid":"prompt-version-item-description",paddingStart:"size-400",children:s(h,{direction:"column",gap:"size-100",children:[e(Wa,{maxWidth:"100%",children:e(v,{color:"text-700",size:"XS",children:a.description||"No Description"})}),s(h,{justifyContent:"space-between",alignItems:"center",gap:"size-100",children:[e(js,{promptVersion:a}),s(h,{direction:"row",gap:"size-100",alignItems:"center",flex:"none",children:[a.user&&s(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(_l,{size:14,name:a.user.username,profilePictureUrl:a.user.profilePictureUrl}),e(v,{size:"XS",children:a.user.username})]}),e(v,{color:"text-300",size:"XS",children:Zu(a.createdAt,Date.now())})]})]})]})})]})}const xf=5,Df=K`
  padding-bottom: var(--ac-global-dimension-size-200);
  position: relative;
`;function _f(n){const{prompt:a}=n,t=I.useFragment($s,a),l=u.useMemo(()=>{var i,r;return(r=(i=t==null?void 0:t.latestVersions)==null?void 0:i.edges)==null?void 0:r.map(o=>o.version)},[t]);if(!l)throw new Error("Expected prompt versions to be defined");return s("div",{children:[e("ul",{children:l.map((i,r)=>{const o=r===xf-1;return s("li",{css:Df,children:[e(qs,{promptVersion:i}),i.sequenceNumber!=1?e(wf,{isLastConnector:o}):null]},i.id)})}),e(h,{direction:"row",justifyContent:"end",children:e(Oe,{to:"versions",children:"View all versions"})})]})}const Lf=K`
  position: absolute;
  top: 25px;
  left: 11px;
  height: calc(100% - 32px);
  width: 2px;
  --connector-color: var(--ac-global-color-grey-400);
  background: repeating-linear-gradient(
      to bottom,
      transparent 0 4px,
      var(--ac-global-color-grey-50) 4px 8px
    ),
    var(--connector-color);
  background-size: 4px 100%;
  background-position: 80%;
  background-repeat: no-repeat;
  &[data-last="true"] {
    background: repeating-linear-gradient(
        to bottom,
        transparent 0 4px,
        var(--ac-global-color-grey-50) 4px 8px
      ),
      linear-gradient(to bottom, var(--connector-color), transparent);
  }
`;function wf({isLastConnector:n}){return e("div",{css:Lf,"data-last":n})}const ni=()=>{const a=Xu().find(t=>t.pathname.split("/prompts/").length===2);if(!a)throw new Error("usePromptIdLoader must be used within a /prompts/:promptId route");return Yu(a.id)};function m2(){const n=ni();return e(Ef,{prompt:n.prompt})}function Ef({prompt:n}){var l,i,r;const a=I.useFragment(vs,n),t=(r=(i=(l=a==null?void 0:a.promptVersions)==null?void 0:l.edges)==null?void 0:i[0])==null?void 0:r.node;return s(h,{direction:"row",height:"100%",children:[e(C,{height:"100%",overflow:"auto",width:"100%","data-testid":"scroll-container",children:e(C,{padding:"size-200",children:s(h,{direction:"column",gap:"size-200",marginStart:"auto",marginEnd:"auto",maxWidth:900,children:[e(Ms,{title:"Prompt Template",promptVersion:t}),e(Is,{promptVersion:t}),e(zs,{promptVersion:t})]})})}),e(Mf,{prompt:a})]})}function Mf({prompt:n}){const a=I.useFragment(Ss,n),t=!!(a!=null&&a.description);return e(C,{flex:"none",width:400,borderStartColor:"dark",borderStartWidth:"thin",children:s(C,{paddingStart:"size-200",paddingEnd:"size-200",children:[s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(yi,{level:3,children:"Description"}),e(Wy,{prompt:a})]}),e(v,{color:t?"text-900":"text-700",children:a.description||"No Description"}),s("section",{children:[e(yi,{level:3,children:"Latest Versions"}),e(_f,{prompt:a})]})]})})}const Bs=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptLayout__main",selections:[n,a,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,concreteType:"Prompt",kind:"LinkedField",name:"sourcePrompt",plural:!1,selections:[n,a],storageKey:null},{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[n],storageKey:null}],storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null}}();Bs.hash="3f2a7eb87a4a433362def455a9151d45";const Us=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"Prompt",kind:"LinkedField",name:"clonePrompt",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ClonePromptDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ClonePromptDialogMutation",selections:a},params:{cacheID:"6ad0382f6acd0f00125307c887c0f4f2",id:null,metadata:{},name:"ClonePromptDialogMutation",operationKind:"mutation",text:`mutation ClonePromptDialogMutation(
  $input: ClonePromptInput!
) {
  clonePrompt(input: $input) {
    id
  }
}
`}}}();Us.hash="081b8cf05c35b46579fe5cbb85f7a761";const Vf=({promptId:n,promptName:a,promptDescription:t,setDialog:l})=>{var b;const i=ke(),r=le(),[o,d]=I.useMutation(Us),c=Ae({disabled:d,reValidateMode:"onBlur",mode:"onChange",defaultValues:{name:`${a}-clone`,description:t}}),{control:p,handleSubmit:y,formState:{isValid:m,errors:g},setError:f}=c,k=y(S=>{o({variables:{input:{promptId:n,name:S.name,description:S.description}},onCompleted:F=>{l(null),i({title:"Prompt cloned successfully",action:{text:"View Prompt",onClick:()=>{r(`/prompts/${F.clonePrompt.id}`)}}})},onError:F=>{var D;const P=Ce(F);(D=P==null?void 0:P[0])!=null&&D.includes("already exists")?f("name",{message:P==null?void 0:P[0]}):f("root",{message:P==null?void 0:P[0]})}})});return e(Z,{title:"Clone Prompt",children:e(u.Suspense,{fallback:e(ge,{}),children:e(C,{padding:"size-200",children:s("form",{onSubmit:k,children:[e(H,{control:p,name:"name",rules:{required:{message:"Name is required",value:!0},validate:{unique:S=>S.trim()===a.trim()?"Name must be different from the original prompt name":!0}},render:({field:{onChange:S,onBlur:F,value:P,disabled:D},fieldState:{error:w}})=>s(J,{isInvalid:!!(w!=null&&w.message),children:[e(G,{children:"Name"}),e(ne,{name:"name",type:"text",onChange:S,onBlur:F,value:P,disabled:D}),!w&&e(v,{slot:"description",children:"A name for the cloned prompt."}),e(ve,{children:w==null?void 0:w.message})]})}),e(H,{control:p,name:"description",render:({field:{onChange:S,onBlur:F,value:P,disabled:D},fieldState:{error:w}})=>s(J,{isInvalid:!!(w!=null&&w.message),isDisabled:D,value:P,onChange:S,onBlur:F,children:[e(G,{children:"Description"}),e(pa,{name:"description"}),!w&&e(v,{slot:"description",children:"A description for the cloned prompt."}),e(ve,{children:w==null?void 0:w.message})]})}),(g==null?void 0:g.root)&&e(v,{color:"danger",children:(b=g==null?void 0:g.root)==null?void 0:b.message}),s(h,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(A,{variant:"default",onPress:()=>l(null),isDisabled:d,children:"Cancel"}),e(A,{type:"submit",variant:"primary",isDisabled:!m,isPending:d,children:"Clone"})]})]})})})})},Rf=K`
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  .ac-tabs {
    flex: 1 1 auto;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    div[role="tablist"] {
      flex: none;
    }
    .ac-tabs__pane-container {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      div[role="tabpanel"]:not([hidden]) {
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }
    }
  }
`;function p2(){const[n,a]=u.useState(null),t=ni(),l=le(),{pathname:i}=kl();let r=0;i.includes("versions")?r=1:i.includes("config")&&(r=2);const o=I.useFragment(Bs,t.prompt);return s("main",{css:Rf,children:[e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",flex:"none",children:s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[s(h,{direction:"column",children:[e(te,{level:1,children:t.prompt.name}),o.sourcePrompt&&s(v,{color:"text-700",children:["cloned from"," ",e(Oe,{to:`/prompts/${o.sourcePrompt.id}`,children:o.sourcePrompt.name})]})]}),s(h,{direction:"row",gap:"size-100",children:[e(A,{size:"S",leadingVisual:e(L,{svg:e(sp,{})}),onPress:()=>{a(e(Vf,{promptId:o.id,promptName:o.name,promptDescription:o.description??void 0,setDialog:a}))},children:"Clone"}),e(A,{size:"S",leadingVisual:e(L,{svg:e(Ll,{})}),onPress:()=>{l(`/prompts/${t.prompt.id}/playground`)},children:"Edit in Playground"})]})]})}),s(He,{index:r,onChange:d=>{let c;d===1?c=`/prompts/${t.prompt.id}/versions`:d===2?c=`/prompts/${t.prompt.id}/config`:c=`/prompts/${t.prompt.id}`,l(c)},children:[e(ae,{name:"Prompt",children:({isSelected:d})=>d?e(xe,{}):null}),e(ae,{name:"Versions",extra:e(dn,{children:o.promptVersions.edges.length}),children:({isSelected:d})=>d?e(xe,{}):null}),e(ae,{name:"Config",children:({isSelected:d})=>d?e(xe,{}):null})]}),e(X,{onDismiss:()=>a(null),children:n})]})}const Hs=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"modelsInput"}],a={alias:null,args:null,kind:"ScalarField",name:"invocationInputField",storageKey:null},t={alias:"floatDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},l=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"modelsInput"}],concreteType:null,kind:"LinkedField",name:"modelInvocationParameters",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"canonicalName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"required",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null}],type:"InvocationParameterBase",abstractKey:"__isInvocationParameterBase"},{kind:"InlineFragment",selections:[{alias:"booleanDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"BooleanInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[t,a,{alias:null,args:null,kind:"ScalarField",name:"minValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxValue",storageKey:null}],type:"BoundedFloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[t,a],type:"FloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"intDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"IntInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"jsonDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"JSONInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"stringDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"StringInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"stringListDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"StringListInvocationParameter",abstractKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"fetchPlaygroundPromptSupportedInvocationParametersQuery",selections:l,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"fetchPlaygroundPromptSupportedInvocationParametersQuery",selections:l},params:{cacheID:"530366c9a8cc3b47d685ca0600a39bb5",id:null,metadata:{},name:"fetchPlaygroundPromptSupportedInvocationParametersQuery",operationKind:"query",text:`query fetchPlaygroundPromptSupportedInvocationParametersQuery(
  $modelsInput: ModelsInput!
) {
  modelInvocationParameters(input: $modelsInput) {
    __typename
    ... on InvocationParameterBase {
      __isInvocationParameterBase: __typename
      invocationName
      canonicalName
      required
      label
    }
    ... on BooleanInvocationParameter {
      booleanDefaultValue: defaultValue
      invocationInputField
    }
    ... on BoundedFloatInvocationParameter {
      floatDefaultValue: defaultValue
      invocationInputField
      minValue
      maxValue
    }
    ... on FloatInvocationParameter {
      floatDefaultValue: defaultValue
      invocationInputField
    }
    ... on IntInvocationParameter {
      intDefaultValue: defaultValue
      invocationInputField
    }
    ... on JSONInvocationParameter {
      jsonDefaultValue: defaultValue
      invocationInputField
    }
    ... on StringInvocationParameter {
      stringDefaultValue: defaultValue
      invocationInputField
    }
    ... on StringListInvocationParameter {
      stringListDefaultValue: defaultValue
      invocationInputField
    }
  }
}
`}}}();Hs.hash="1138fb98386e86196eaa52c12a6bb27c";const Gs=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"promptId"}],a=[{kind:"Variable",name:"id",variableName:"promptId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},o=[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],d={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"toolCallId",storageKey:null},p={alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"version",plural:!1,selections:[t,r,{alias:null,args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"invocationParameters",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateFormat",storageKey:null},{alias:null,args:null,concreteType:"ResponseFormat",kind:"LinkedField",name:"responseFormat",plural:!1,selections:o,storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"template",plural:!1,selections:[d,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptMessage",kind:"LinkedField",name:"messages",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"content",plural:!0,selections:[d,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TextContentValue",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}],type:"TextContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolCallContentValue",kind:"LinkedField",name:"toolCall",plural:!1,selections:[c,{alias:null,args:null,concreteType:"ToolCallFunction",kind:"LinkedField",name:"toolCall",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],storageKey:null}],type:"ToolCallContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolResultContentValue",kind:"LinkedField",name:"toolResult",plural:!1,selections:[c,{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}],type:"ToolResultContentPart",abstractKey:null}],storageKey:null}],storageKey:null}],type:"PromptChatTemplate",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ToolDefinition",kind:"LinkedField",name:"tools",plural:!0,selections:o,storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"fetchPlaygroundPromptQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[t,l,i,r,p],type:"Prompt",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"fetchPlaygroundPromptQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[d,{kind:"TypeDiscriminator",abstractKey:"__isNode"},t,{kind:"InlineFragment",selections:[l,i,r,p],type:"Prompt",abstractKey:null}],storageKey:null}]},params:{cacheID:"9beefbb59de3e9b98d785c3fd78b15d5",id:null,metadata:{},name:"fetchPlaygroundPromptQuery",operationKind:"query",text:`query fetchPlaygroundPromptQuery(
  $promptId: GlobalID!
) {
  prompt: node(id: $promptId) {
    __typename
    ... on Prompt {
      id
      name
      createdAt
      description
      version {
        id
        description
        modelName
        modelProvider
        invocationParameters
        templateType
        templateFormat
        responseFormat {
          definition
        }
        template {
          __typename
          ... on PromptChatTemplate {
            messages {
              role
              content {
                __typename
                ... on TextContentPart {
                  text {
                    text
                  }
                }
                ... on ToolCallContentPart {
                  toolCall {
                    toolCallId
                    toolCall {
                      name
                      arguments
                    }
                  }
                }
                ... on ToolResultContentPart {
                  toolResult {
                    toolCallId
                    result
                  }
                }
              }
            }
          }
        }
        tools {
          definition
        }
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();Gs.hash="84755f12352e245574192de304d654d5";const Af=n=>{switch(n){case"user":return"USER";case"ai":return"AI";case"system":return"SYSTEM";case"tool":return"TOOL";default:return"USER"}},Nf=(n,a)=>{const t=a.length>0?a.reduce((l,i)=>(i.invocationName&&(l[i.invocationName]=i),l),{}):{};return Object.entries(n).map(([l,i])=>{const r=t[l];return!r||!r.invocationInputField?{invocationName:l,valueJson:i}:{invocationName:l,canonicalName:r.canonicalName,[Ra(r.invocationInputField)]:i}})},zf=({promptId:n,promptName:a,promptVersion:t,supportedInvocationParameters:l})=>{var c,p;const i={...op(),prompt:{id:n,name:a}},r=t.modelName,o=t.modelProvider,d=xl({toolChoice:(c=t.invocationParameters)==null?void 0:c.tool_choice,targetProvider:o})??void 0;return{...i,model:{...i.model,modelName:r,provider:o,supportedInvocationParameters:l||[],invocationParameters:Nf({...t.invocationParameters,...(p=t.responseFormat)!=null&&p.definition?{response_format:t.responseFormat.definition}:{}},l||[])},template:{__type:"chat",messages:"messages"in t.template?t.template.messages.map(y=>{const m=y.content.map(Ot).filter(Boolean).map(S=>S.text.text).join(""),g=y.content.filter(Xl).filter(Boolean),k=y.content.filter(Yl).filter(Boolean).at(0),b=jn(y.role);return b==="tool"&&k?{id:Bn(),role:jn(y.role),content:typeof k.toolResult.result=="string"?k.toolResult.result:In(k.toolResult.result,null,2).json||"",toolCallId:k.toolResult.toolCallId}:b==="ai"&&g.length>0?{id:Bn(),role:jn(y.role),toolCalls:g.map(S=>mr(S,o))}:{id:Bn(),role:jn(y.role),content:m}}):[]},tools:t.tools.map(y=>({id:Ua(),definition:y.definition})),toolChoice:d}},$f=(n,a)=>{const t=a.length>0?a.reduce((l,i)=>((i.canonicalName||i.invocationName)&&(l[i.canonicalName||i.invocationName]=i),l),{}):{};return n.reduce((l,i)=>{const r=t[i.canonicalName||i.invocationName];return r&&(l[i.invocationName]=i[Ra(r.invocationInputField)]),l},{})},Of=[{invocationName:Pa,canonicalName:Un},{invocationName:Kn,canonicalName:Dn}],Qf=n=>{if(n.template.__type==="text_completion")return console.warn("Instance to prompt version conversion not supported for text completion"),null;const a=n.template.messages.map(l=>{var d;let i=[l.content?Ls(l.content):null];const r=((d=l.toolCalls)==null?void 0:d.map(ws))||[],o=l.toolCallId?[Es(l.toolCallId,l.content)]:[];return(r.length>0||o.length>0)&&(i=[]),{content:[...i,...r,...o].filter(c=>c!==null),role:Af(l.role)}});return{modelName:n.model.modelName||dp,modelProvider:n.model.provider,template:{messages:a},tools:n.tools.map(l=>({definition:l.definition})),responseFormat:n.model.invocationParameters.filter(l=>l.canonicalName===Dn||l.invocationName===Kn).map(l=>({definition:l.valueJson})).at(0)||void 0,invocationParameters:$f(fs(n.model.invocationParameters.filter(l=>!Of.some(i=>Wn(i,l))).concat(n.toolChoice?[{invocationName:Pa,valueJson:n.toolChoice,canonicalName:Un}]:[]),n.model.provider,n.model.modelName),n.model.supportedInvocationParameters)}},jf=Gs,qf=Hs,Bf=async({modelName:n,providerKey:a})=>{const t=await I.fetchQuery(he,qf,{modelsInput:{modelName:n,providerKey:a}}).toPromise();return t==null?void 0:t.modelInvocationParameters},Uf=async n=>I.fetchQuery(he,jf,{promptId:n}).toPromise(),Hf=n=>n?n==null?void 0:n.version:null,Ws=async n=>{var l;if(!n)return null;const a=await Uf(n),t=Hf(a==null?void 0:a.prompt);if(t&&t.templateType==="CHAT"){const i=await Bf({modelName:t.modelName,providerKey:t.modelProvider}),r=(l=a==null?void 0:a.prompt)==null?void 0:l.name;if(!r)throw new Error("Prompt name is required");return{instance:zf({promptId:n,promptName:r,promptVersion:t,supportedInvocationParameters:i}),promptVersion:t}}return null},g2=async({params:n})=>{const{promptId:a}=n;if(!a)throw new Error("Prompt ID is required");const t=await Ws(a);if(!t)throw new Error("Prompt not found");return{instanceWithPrompt:t.instance,templateFormat:t.promptVersion.templateFormat}},Js=function(){var n=[{alias:null,args:null,concreteType:"GenerativeProvider",kind:"LinkedField",name:"modelProviders",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependenciesInstalled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependencies",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PlaygroundQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"PlaygroundQuery",selections:n},params:{cacheID:"f19ebe151a3a9794fa2566c66751d259",id:null,metadata:{},name:"PlaygroundQuery",operationKind:"query",text:`query PlaygroundQuery {
  modelProviders {
    name
    dependenciesInstalled
    dependencies
  }
}
`}}}();Js.hash="9802d9d44657ca300abc1be4d0938560";const ai=u.createContext(null);function Gf({children:n,...a}){const[t]=u.useState(()=>cp(a));return e(ai.Provider,{value:t,children:n})}function $(n,a){const t=Ke.useContext(ai);if(!t)throw new Error("Missing PlaygroundContext.Provider in the tree");return Ya(t,n,a)}function ti(){const n=Ke.useContext(ai);if(!n)throw new Error("Missing PlaygroundContext.Provider in the tree");return n}const Zs=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"exampleId"}],a=[{kind:"Variable",name:"id",variableName:"exampleId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},i={alias:"latestRevision",args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},l,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null}],storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},o={alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"span",plural:!1,selections:[t,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[t,r,{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t],storageKey:null}],storageKey:null}],storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},c=[{kind:"Literal",name:"first",value:100}],p={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[t,r,{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExampleDetailsDialogQuery",selections:[{alias:"example",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[t,i,o],type:"DatasetExample",abstractKey:null},{args:null,kind:"FragmentSpread",name:"ExampleExperimentRunsTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExampleDetailsDialogQuery",selections:[{alias:"example",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[d,{kind:"TypeDiscriminator",abstractKey:"__isNode"},t,{kind:"InlineFragment",selections:[i,o,{alias:null,args:c,concreteType:"ExperimentRunConnection",kind:"LinkedField",name:"experimentRuns",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"run",args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},l,p,{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},p],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[d],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"experimentRuns(first:100)"},{alias:null,args:c,filters:null,handle:"connection",key:"ExampleExperimentRunsTable_experimentRuns",kind:"LinkedHandle",name:"experimentRuns"}],type:"DatasetExample",abstractKey:null}],storageKey:null}]},params:{cacheID:"ae7779e6fb1148a472e58fff0f5e0f66",id:null,metadata:{},name:"ExampleDetailsDialogQuery",operationKind:"query",text:`query ExampleDetailsDialogQuery(
  $exampleId: GlobalID!
) {
  example: node(id: $exampleId) {
    __typename
    ... on DatasetExample {
      id
      latestRevision: revision {
        input
        output
        metadata
      }
      span {
        id
        trace {
          id
          traceId
          project {
            id
          }
        }
      }
    }
    ...ExampleExperimentRunsTableFragment
    __isNode: __typename
    id
  }
}

fragment ExampleExperimentRunsTableFragment on DatasetExample {
  experimentRuns(first: 100) {
    edges {
      run: node {
        id
        startTime
        endTime
        error
        output
        trace {
          id
          traceId
          projectId
        }
        annotations {
          edges {
            annotation: node {
              id
              name
              label
              score
              explanation
              annotatorKind
              trace {
                id
                traceId
                projectId
              }
            }
          }
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Zs.hash="5c65343f3fa6361ad93f3e548a8f8c75";const Xs=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"patchDatasetExamples",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"EditExampleDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"EditExampleDialogMutation",selections:a},params:{cacheID:"7217082d3d3796ecb60481d17133c351",id:null,metadata:{},name:"EditExampleDialogMutation",operationKind:"mutation",text:`mutation EditExampleDialogMutation(
  $input: PatchDatasetExamplesInput!
) {
  patchDatasetExamples(input: $input) {
    __typename
  }
}
`}}}();Xs.hash="a5e0e601ed24ffaa37a99ba358f960d3";const nl={backgroundColor:"light",borderColor:"light",collapsible:!0,bodyStyle:{padding:0}};function Wf(n){const{exampleId:a,onCompleted:t}=n,[l,i]=u.useState(null),[r,o]=I.useMutation(Xs),{control:d,setError:c,handleSubmit:p,formState:{isValid:y}}=Ae({defaultValues:n.currentRevision}),m=u.useCallback(g=>{if(i(null),!Fn(g==null?void 0:g.input))return c("input",{message:"Input must be a valid JSON object"});if(!Fn(g==null?void 0:g.output))return c("output",{message:"Output must be a valid JSON object"});if(!Fn(g==null?void 0:g.metadata))return c("metadata",{message:"Metadata must be a valid JSON object"});r({variables:{input:{patches:[{exampleId:a,input:JSON.parse(g.input),output:JSON.parse(g.output),metadata:JSON.parse(g.metadata)}],versionDescription:g.description}},onCompleted:()=>{t()},onError:f=>{i(f.message)}})},[r,a,c,t]);return e(Z,{size:"fullscreen",title:`Edit Example: ${a}`,extra:e(A,{variant:"primary",size:"S",isDisabled:!y||o,leadingVisual:e(L,{svg:o?e(je,{}):e(gr,{})}),onPress:()=>p(m)(),children:"Save Changes"}),children:e("div",{css:K`
          overflow-y: auto;
          padding: var(--ac-global-dimension-size-400);
          /* Make widths configurable */
          .dataset-picker {
            width: 100%;
            .ac-dropdown--picker,
            .ac-dropdown-button {
              width: 100%;
            }
          }
        `,children:e(h,{direction:"row",justifyContent:"center",children:e(C,{width:"900px",paddingStart:"auto",paddingEnd:"auto",children:s(h,{direction:"column",gap:"size-200",children:[l?e(pe,{variant:"danger",children:l}):null,e(H,{control:d,name:"input",render:({field:{onChange:g,onBlur:f,value:k},fieldState:{invalid:b,error:S}})=>s(Q,{title:"Input",subTitle:"The input to the LLM, retriever, program, etc.",...nl,children:[b?e(pe,{variant:"danger",banner:!0,children:S==null?void 0:S.message}):null,e(Qe,{value:k,onChange:g,onBlur:f})]})}),e(H,{control:d,name:"output",render:({field:{onChange:g,onBlur:f,value:k},fieldState:{invalid:b,error:S}})=>s(Q,{title:"Output",subTitle:"The output of the LLM or program to be used as an expected output",...nl,backgroundColor:"green-100",borderColor:"green-700",children:[b?e(pe,{variant:"danger",banner:!0,children:S==null?void 0:S.message}):null,e(Qe,{value:k,onChange:g,onBlur:f})]})}),e(H,{control:d,name:"metadata",render:({field:{onChange:g,onBlur:f,value:k},fieldState:{invalid:b,error:S}})=>s(Q,{title:"Metadata",subTitle:"All data from the span to use during experimentation or evaluation",...nl,children:[b?e(pe,{variant:"danger",banner:!0,children:S==null?void 0:S.message}):null,e(Qe,{value:k,onChange:g,onBlur:f})]})}),e(H,{control:d,name:"description",render:({field:{onChange:g,onBlur:f,value:k},fieldState:{invalid:b,error:S}})=>s(J,{value:k,onChange:g,onBlur:f,isInvalid:b,children:[e(G,{children:"Revision Description"}),e(pa,{}),S?e(ve,{children:S==null?void 0:S.message}):e(v,{slot:"description",children:"A description of the changes made in this revision. Will be displayed in the version history."})]})})]})})})})})}function Jf(n){const{onCompleted:a,...t}=n,[l,i]=u.useState(null);return s(U,{children:[e(A,{size:"S",leadingVisual:e(L,{svg:e(It,{})}),onPress:()=>i(e(Wf,{...t,onCompleted:()=>{i(null),a()}})),children:"Edit Example"}),e(X,{type:"slideOver",isDismissable:!0,onDismiss:()=>i(null),children:l})]})}const Ys=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExampleExperimentRunsTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:t,kind:"FragmentSpread",name:"ExampleExperimentRunsTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExampleExperimentRunsTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"TypeDiscriminator",abstractKey:"__isNode"},i,{kind:"InlineFragment",selections:[{alias:null,args:t,concreteType:"ExperimentRunConnection",kind:"LinkedField",name:"experimentRuns",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"run",args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},r,{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},r],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:t,filters:null,handle:"connection",key:"ExampleExperimentRunsTable_experimentRuns",kind:"LinkedHandle",name:"experimentRuns"}],type:"DatasetExample",abstractKey:null}],storageKey:null}]},params:{cacheID:"2cfc5c04c7f88f6bbd464f6a09f87521",id:null,metadata:{},name:"ExampleExperimentRunsTableQuery",operationKind:"query",text:`query ExampleExperimentRunsTableQuery(
  $after: String = null
  $first: Int = 100
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...ExampleExperimentRunsTableFragment_2HEEH6
    __isNode: __typename
    id
  }
}

fragment ExampleExperimentRunsTableFragment_2HEEH6 on DatasetExample {
  experimentRuns(first: $first, after: $after) {
    edges {
      run: node {
        id
        startTime
        endTime
        error
        output
        trace {
          id
          traceId
          projectId
        }
        annotations {
          edges {
            annotation: node {
              id
              name
              label
              score
              explanation
              annotatorKind
              trace {
                id
                traceId
                projectId
              }
            }
          }
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Ys.hash="73457524533365ed047cb575ee6c93ab";const eo=function(){var n=["experimentRuns"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null}],storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:Ys,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"ExampleExperimentRunsTableFragment",selections:[{alias:"experimentRuns",args:null,concreteType:"ExperimentRunConnection",kind:"LinkedField",name:"__ExampleExperimentRunsTable_experimentRuns_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"run",args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},t,{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},t],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"DatasetExample",abstractKey:null}}();eo.hash="73457524533365ed047cb575ee6c93ab";const Zf=100;function Xf(){return e("tbody",{className:"is-empty",children:e("tr",{children:e("td",{colSpan:100,css:K`
            text-align: center;
            padding: var(--ac-global-dimension-size-300)
              var(--ac-global-dimension-size-300) !important;
          `,children:"No experiments have been run for this example."})})})}const Yf=K`
  display: flex;
  flex-direction: row;
  align-items: center;
  color: var(--ac-global-color-primary);
  gap: var(--ac-global-dimension-size-50);
`;function eh({example:n}){const a=u.useRef(null),t=le(),{data:l,loadNext:i,hasNext:r,isLoadingNext:o}=I.usePaginationFragment(eo,n),d=u.useMemo(()=>l.experimentRuns.edges.map(f=>{let k=null;return f.run.startTime&&f.run.endTime&&(k=new Date(f.run.endTime).getTime()-new Date(f.run.startTime).getTime()),{...f.run,output:JSON.stringify(f.run.output),latencyMs:k}}),[l]),p=Te({columns:[{header:"start time",accessorKey:"startTime",cell:Me},{header:"output",accessorKey:"output",cell:f=>{var b;const k=(b=f.row.original)==null?void 0:b.error;return k!==null?e(v,{color:"danger",children:k}):e(De,{...f})}},{header:"latency",accessorKey:"latencyMs",cell:({getValue:f})=>{const k=f();return k===null||typeof k!="number"?"--":e(Ve,{latencyMs:k})}},{header:"evaluations",accessorKey:"annotations",cell:({row:f})=>e(h,{direction:"row",gap:"size-50",wrap:"wrap",children:f.original.annotations.edges.map((k,b)=>{const S=k.annotation;return e(_a,{annotation:S,extra:S.trace&&e(C,{paddingTop:"size-100",children:s("div",{css:Yf,children:[e(L,{svg:e(xn,{})}),e("span",{children:"Click to view evaluator trace"})]})}),children:e(En,{annotation:S,onClick:()=>{S.trace&&t(`/projects/${S.trace.projectId}/traces/${S.trace.traceId}`)}},b)},b)})})},{id:"actions",cell:({row:f})=>{const k=f.original.trace;if(k)return e(A,{size:"S",leadingVisual:e(L,{svg:e(xt,{})}),onPress:()=>{t(`/projects/${k.projectId}/traces/${k.traceId}`)},"aria-label":"view trace"})}}],data:d,getCoreRowModel:Pe()}),y=p.getRowModel().rows,m=y.length===0,g=u.useCallback(f=>{if(f){const{scrollHeight:k,scrollTop:b,clientHeight:S}=f;k-b-S<300&&!o&&r&&i(Zf)}},[r,o,i]);return e("div",{css:K`
        flex: 1 1 auto;
        overflow: auto;
      `,ref:a,onScroll:f=>g(f.target),children:s("table",{css:ea,children:[e("thead",{children:p.getHeaderGroups().map(f=>e("tr",{children:f.headers.map(k=>e("th",{children:e("div",{children:W(k.column.columnDef.header,k.getContext())})},k.id))},f.id))}),m?e(Xf,{}):e("tbody",{children:y.map(f=>e("tr",{children:f.getVisibleCells().map(k=>e("td",{children:W(k.column.columnDef.cell,k.getContext())},k.id))},f.id))})]})})}function li({exampleId:n,onDismiss:a}){const[t,l]=u.useState(0),i=I.useLazyLoadQuery(Zs,{exampleId:n},{fetchKey:t,fetchPolicy:"store-and-network"}),r=u.useMemo(()=>{const m=i.example.latestRevision;return{input:JSON.stringify(m==null?void 0:m.input,null,2),output:JSON.stringify(m==null?void 0:m.output,null,2),metadata:JSON.stringify(m==null?void 0:m.metadata,null,2)}},[i]),o=u.useMemo(()=>{const m=i.example.span;return m?{id:m.id,traceId:m.trace.traceId,projectId:m.trace.project.id}:null},[i]),{input:d,output:c,metadata:p}=r,y=ke();return e(X,{type:"slideOver",isDismissable:!0,onDismiss:a,children:e(Z,{size:"XL",title:`Example: ${n}`,extra:s(h,{direction:"row",gap:"size-100",children:[o?e(Dt,{size:"S",to:`/projects/${o.projectId}/traces/${o.traceId}?selectedSpanNodeId=${o.id}`,children:"View Source Span"}):null,e(Jf,{exampleId:n,currentRevision:r,onCompleted:()=>{y({title:"Example updated",message:`Example ${n} has been updated.`}),l(m=>m+1)}})]}),children:s(Pn,{direction:"vertical",autoSaveId:"example-panel-group",children:[e(_e,{defaultSize:65,children:e("div",{css:K`
                overflow-y: auto;
                height: 100%;
              `,children:e(h,{direction:"row",justifyContent:"center",children:e(C,{width:"900px",paddingStart:"auto",paddingEnd:"auto",paddingTop:"size-200",paddingBottom:"size-200",children:s(h,{direction:"column",gap:"size-200",children:[e(Q,{title:"Input",...al,extra:e(ie,{text:d}),children:e(Ze,{value:d})}),e(Q,{title:"Output",...al,extra:e(ie,{text:c}),children:e(Ze,{value:c})}),e(Q,{title:"Metadata",...al,extra:e(ie,{text:p}),children:e(Ze,{value:p})})]})})})})}),e(Tn,{css:La}),e(_e,{defaultSize:35,children:s(h,{direction:"column",height:"100%",children:[e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderBottomColor:"dark",borderBottomWidth:"thin",flex:"none",children:e(te,{level:3,children:"Experiment Runs"})}),e(eh,{example:i.example})]})})]})})})}const al={backgroundColor:"light",borderColor:"light",variant:"compact",collapsible:!0,bodyStyle:{padding:0}};function nh(){const[n,a]=fn(),t=n.get("exampleId"),l=n.get("datasetId");return!t||!l?null:e(li,{exampleId:t,onDismiss:()=>{a(i=>(i.delete("exampleId"),i))}})}const ah=`
The playground is not available until an LLM provider client is installed on the server.
`,th=n=>`
# Installing one or more of the clients will enable the playground
${Array.from(n.reduce((a,t)=>(t.dependencies.forEach(l=>a.add(l)),a),new Set)).map(a=>`pip install ${a}`).join(`
`)}
`,lh=n=>e(C,{height:"100%",width:"100%",children:s(h,{direction:"column",alignItems:"center",justifyContent:"center",gap:"size-200",children:[e(yr,{message:ah,graphicKey:"not found",size:"L"}),e(v,{children:"The following clients are supported:"}),e(pr,{value:th(n.availableProviders)})]})}),ih={OPENAI:"OPENAI_API_KEY",ANTHROPIC:"ANTHROPIC_API_KEY",AZURE_OPENAI:"AZURE_OPENAI_API_KEY",GOOGLE:"GEMINI_API_KEY"};function rh(){const n=$(o=>Array.from(new Set(o.instances.map(d=>d.model.provider)))),a=$(o=>o.instances.some(d=>d.activeRunId!=null)),t=xa(o=>o.setCredential),l=xa(o=>o),[i,r]=u.useState(!1);return e("div",{css:K`
        .ac-dropdown-button {
          min-width: 0px;
        }
      `,children:s(ga,{placement:"bottom",isOpen:i,onOpenChange:o=>{r(o)},children:[e(vl,{size:"compact",isDisabled:a,children:"API Keys"}),e(kt,{children:e(C,{padding:"size-200",children:s(Ye,{onSubmit:o=>{o.preventDefault(),r(!1)},children:[e(te,{level:2,weight:"heavy",children:"API Keys"}),e(C,{paddingY:"size-50",children:e(v,{color:"text-700",size:"XS",children:"API keys are stored in your browser and used to communicate with their respective API's."})}),e(h,{direction:"column",gap:"size-100",children:n.map(o=>{const d=ih[o];return s(J,{size:"S",type:"password",isRequired:!0,onChange:c=>{t({provider:o,value:c})},value:l[o],children:[e(G,{children:d}),e(ne,{}),e(v,{slot:"description",children:`Alternatively, you can set the "${d}" environment variable on the phoenix server.`})]},o)})}),e(C,{paddingTop:"size-100",children:e(h,{direction:"row",gap:"size-100",width:"100%",justifyContent:"end",children:e(nn,{href:"/settings",children:"View all AI provider configurations"})})})]})})})]})})}const Ei=30,sh=K`
  display: flex;
  direction: row;
  align-items: center;
  .ac-dropdown > button {
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
    height: ${Ei}px;
  }
  & > button {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
    border-left: none;
    height: ${Ei}px;
  }
`;function oh(){const[n,a]=fn(),t=n.get("datasetId")??"";return s("div",{css:sh,children:[e(fr,{size:"compact",placeholder:"Test over a dataset",selectedKey:t,onSelectionChange:l=>{if(t!==null&&l===t){a(i=>(i.delete("datasetId"),i));return}a(i=>(i.set("datasetId",String(l)),i))}}),e(A,{size:"S",leadingVisual:e(L,{svg:e(up,{})}),onPress:()=>{a(l=>(l.delete("datasetId"),l))}})]})}const no=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"datasetId"}],a=[{kind:"Variable",name:"id",variableName:"datasetId"}],t={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"exampleCount",storageKey:null}],type:"Dataset",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundDatasetSectionQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundDatasetSectionQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"c36833ac260163836d9810cf8e137380",id:null,metadata:{},name:"PlaygroundDatasetSectionQuery",operationKind:"query",text:`query PlaygroundDatasetSectionQuery(
  $datasetId: GlobalID!
) {
  dataset: node(id: $datasetId) {
    __typename
    ... on Dataset {
      name
      exampleCount
    }
    __isNode: __typename
    id
  }
}
`}}}();no.hash="38aaf5a39c06500e51a82c91a9e27408";const ao=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"ChatCompletionOverDatasetMutationPayload",kind:"LinkedField",name:"chatCompletionOverDataset",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"experimentId",storageKey:null},{alias:null,args:null,concreteType:"ChatCompletionOverDatasetMutationExamplePayload",kind:"LinkedField",name:"examples",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"datasetExampleId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentRunId",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"result",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null}],type:"ChatCompletionMutationError",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"content",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorMessage",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"span",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t],storageKey:null},{alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ChatCompletionToolCall",kind:"LinkedField",name:"toolCalls",plural:!0,selections:[t,{alias:null,args:null,concreteType:"ChatCompletionFunctionCall",kind:"LinkedField",name:"function",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],storageKey:null}],type:"ChatCompletionMutationPayload",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundDatasetExamplesTableMutation",selections:l,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundDatasetExamplesTableMutation",selections:l},params:{cacheID:"4697f7aaa22729dbf83970ce9ae6475b",id:null,metadata:{},name:"PlaygroundDatasetExamplesTableMutation",operationKind:"mutation",text:`mutation PlaygroundDatasetExamplesTableMutation(
  $input: ChatCompletionOverDatasetInput!
) {
  chatCompletionOverDataset(input: $input) {
    __typename
    experimentId
    examples {
      datasetExampleId
      experimentRunId
      result {
        __typename
        ... on ChatCompletionMutationError {
          message
        }
        ... on ChatCompletionMutationPayload {
          content
          errorMessage
          span {
            id
            tokenCountCompletion
            tokenCountPrompt
            tokenCountTotal
            latencyMs
            project {
              id
            }
            context {
              traceId
            }
          }
          toolCalls {
            id
            function {
              name
              arguments
            }
          }
        }
      }
    }
  }
}
`}}}();ao.hash="c15f93fe1380986536971620c3bf3a11";const to=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"datasetExampleId",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[t],i=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:null,kind:"LinkedField",name:"chatCompletionOverDataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"content",storageKey:null},a],type:"TextChunk",abstractKey:null},{kind:"InlineFragment",selections:[t,a,{alias:null,args:null,concreteType:"FunctionCallChunk",kind:"LinkedField",name:"function",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],type:"ToolCallChunk",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Experiment",kind:"LinkedField",name:"experiment",plural:!1,selections:l,storageKey:null}],type:"ChatCompletionSubscriptionExperiment",abstractKey:null},{kind:"InlineFragment",selections:[a,{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"span",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:l,storageKey:null},{alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"experimentRun",plural:!1,selections:l,storageKey:null}],type:"ChatCompletionSubscriptionResult",abstractKey:null},{kind:"InlineFragment",selections:[a,{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null}],type:"ChatCompletionSubscriptionError",abstractKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundDatasetExamplesTableSubscription",selections:i,type:"Subscription",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundDatasetExamplesTableSubscription",selections:i},params:{cacheID:"3759bfb17a93aa0cf227c4ef7fa6cd30",id:null,metadata:{},name:"PlaygroundDatasetExamplesTableSubscription",operationKind:"subscription",text:`subscription PlaygroundDatasetExamplesTableSubscription(
  $input: ChatCompletionOverDatasetInput!
) {
  chatCompletionOverDataset(input: $input) {
    __typename
    ... on TextChunk {
      content
      datasetExampleId
    }
    ... on ToolCallChunk {
      id
      datasetExampleId
      function {
        name
        arguments
      }
    }
    ... on ChatCompletionSubscriptionExperiment {
      experiment {
        id
      }
    }
    ... on ChatCompletionSubscriptionResult {
      datasetExampleId
      span {
        id
        tokenCountCompletion
        tokenCountPrompt
        tokenCountTotal
        latencyMs
        project {
          id
        }
        context {
          traceId
        }
      }
      experimentRun {
        id
      }
    }
    ... on ChatCompletionSubscriptionError {
      datasetExampleId
      message
    }
  }
}
`}}}();to.hash="f1df5c75f1a62acde69f3f5d676f9213";const lo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"datasetVersionId"},{defaultValue:20,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"datasetVersionId",variableName:"datasetVersionId"},{kind:"Variable",name:"first",variableName:"first"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundDatasetExamplesTableRefetchQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:t,kind:"FragmentSpread",name:"PlaygroundDatasetExamplesTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundDatasetExamplesTableRefetchQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"TypeDiscriminator",abstractKey:"__isNode"},i,{kind:"InlineFragment",selections:[{alias:null,args:t,concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"examples",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:t,filters:["datasetVersionId"],handle:"connection",key:"PlaygroundDatasetExamplesTable_examples",kind:"LinkedHandle",name:"examples"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"fc176d05790f6c690eead96a6ece1c50",id:null,metadata:{},name:"PlaygroundDatasetExamplesTableRefetchQuery",operationKind:"query",text:`query PlaygroundDatasetExamplesTableRefetchQuery(
  $after: String = null
  $datasetVersionId: GlobalID
  $first: Int = 20
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...PlaygroundDatasetExamplesTableFragment_4a6F8Z
    __isNode: __typename
    id
  }
}

fragment PlaygroundDatasetExamplesTableFragment_4a6F8Z on Dataset {
  examples(datasetVersionId: $datasetVersionId, first: $first, after: $after) {
    edges {
      example: node {
        id
        revision {
          input
          output
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();lo.hash="ae68770500a29b14f7108d56c146fb99";const io=function(){var n=["examples"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"datasetVersionId"},{defaultValue:20,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:lo,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"PlaygroundDatasetExamplesTableFragment",selections:[{alias:"examples",args:[{kind:"Variable",name:"datasetVersionId",variableName:"datasetVersionId"}],concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"__PlaygroundDatasetExamplesTable_examples_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"Dataset",abstractKey:null}}();io.hash="ae68770500a29b14f7108d56c146fb99";const ro=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"datasetId"}],a=[{kind:"Variable",name:"id",variableName:"datasetId"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i=[{kind:"Literal",name:"first",value:20}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundDatasetExamplesTableQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"PlaygroundDatasetExamplesTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundDatasetExamplesTableQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},l,{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"examples",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"examples(first:20)"},{alias:null,args:i,filters:["datasetVersionId"],handle:"connection",key:"PlaygroundDatasetExamplesTable_examples",kind:"LinkedHandle",name:"examples"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"795ea41682593e1fedd5ced3252f7602",id:null,metadata:{},name:"PlaygroundDatasetExamplesTableQuery",operationKind:"query",text:`query PlaygroundDatasetExamplesTableQuery(
  $datasetId: GlobalID!
) {
  dataset: node(id: $datasetId) {
    __typename
    ...PlaygroundDatasetExamplesTableFragment
    __isNode: __typename
    id
  }
}

fragment PlaygroundDatasetExamplesTableFragment on Dataset {
  examples(first: 20) {
    edges {
      example: node {
        id
        revision {
          input
          output
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();ro.hash="f809b3d539d0032d9681a4a4450b1d6f";const dh=()=>{const n=(a,t)=>({exampleResponsesMap:{},updateExampleData:({instanceId:l,exampleId:i,patch:r})=>{const o=t().exampleResponsesMap,d=o[l]??{},c=d[i]??{};a({exampleResponsesMap:{...o,[l]:{...d,[i]:{...c,...r}}}})},appendExampleDataTextChunk:({instanceId:l,exampleId:i,textChunk:r})=>{const o=t().exampleResponsesMap,d=o[l]??{},c=d[i]??{},p=c.content??"";a({exampleResponsesMap:{...o,[l]:{...d,[i]:{...c,content:p+r}}}})},appendExampleDataToolCallChunk:({instanceId:l,exampleId:i,toolCallChunk:r})=>{var k;const o=t().exampleResponsesMap,d=o[l]??{},c=d[i]??{},p=c.toolCalls??{},{id:y,function:m}=r,g=p[y],f={...g,id:y,function:{name:((k=g==null?void 0:g.function)==null?void 0:k.name)??m.name,arguments:(g==null?void 0:g.function.arguments)!=null?g.function.arguments+m.arguments:m.arguments}};a({exampleResponsesMap:{...o,[l]:{...d,[i]:{...c,toolCalls:{...p,[y]:f}}}}})},setExampleDataForInstance:({instanceId:l,data:i})=>{const r=t().exampleResponsesMap;a({exampleResponsesMap:{...r,[l]:i}})},resetExampleData:()=>{a({exampleResponsesMap:{}})}});return ar()(n)},so=Ke.createContext(null);function ch({children:n}){const[a]=u.useState(()=>dh());return e(so.Provider,{value:a,children:n})}function va(n,a){const t=Ke.useContext(so);if(!t)throw new Error("Missing PlaygroundDatasetExamplesTableContext.Provider in the tree");return Ya(t,n,a)}function ii({children:n}){return s(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(L,{svg:e(wl,{}),color:"danger"}),e(v,{color:"danger",children:n})]})}const oo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"runId"}],a=[{kind:"Variable",name:"id",variableName:"runId"}],t={alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={kind:"InlineFragment",selections:[t,{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"example",plural:!1,selections:[l,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"ExperimentRun",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundExperimentRunDetailsDialogQuery",selections:[{alias:"run",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundExperimentRunDetailsDialogQuery",selections:[{alias:"run",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,{kind:"TypeDiscriminator",abstractKey:"__isNode"},l],storageKey:null}]},params:{cacheID:"1e3277995e47da369d84557def1a62bf",id:null,metadata:{},name:"PlaygroundExperimentRunDetailsDialogQuery",operationKind:"query",text:`query PlaygroundExperimentRunDetailsDialogQuery(
  $runId: GlobalID!
) {
  run: node(id: $runId) {
    __typename
    ... on ExperimentRun {
      output
      startTime
      endTime
      error
      example {
        id
        revision {
          input
          output
        }
      }
      annotations {
        edges {
          annotation: node {
            id
            name
            label
            score
            explanation
            annotatorKind
          }
        }
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();oo.hash="2eee337b0f8c4e738dd6580efa1e3c96";function uh({runId:n}){var d,c,p;const t=I.useLazyLoadQuery(oo,{runId:n}).run,l=(d=t.example)==null?void 0:d.id,i=(c=t.example)==null?void 0:c.revision,r=i==null?void 0:i.input,o=i==null?void 0:i.output;return e(Z,{title:`Experiment Run for Example: ${l}`,size:"fullscreen",children:s(Pn,{direction:"vertical",autoSaveId:"example-compare-panel-group",children:[e(_e,{defaultSize:33,children:e(C,{overflow:"auto",height:"100%",padding:"size-200",children:s(h,{direction:"row",gap:"size-200",flex:"1 1 auto",children:[e(C,{width:"50%",children:e(Q,{title:"Input",...Mi,bodyStyle:{padding:0,maxHeight:"300px",overflowY:"auto"},extra:e(ie,{text:JSON.stringify(r)}),children:e(Ze,{value:JSON.stringify(r,null,2)})})}),e(C,{width:"50%",children:e(Q,{title:"Reference Output",...Mi,extra:e(ie,{text:JSON.stringify(o)}),bodyStyle:{padding:0,maxHeight:"300px",overflowY:"auto"},children:e(Ze,{value:JSON.stringify(o,null,2)})})})]})})}),e(Tn,{css:La}),e(_e,{defaultSize:67,children:s(h,{direction:"column",height:"100%",children:[e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderBottomColor:"dark",borderBottomWidth:"thin",flex:"none",children:e(te,{level:2,children:"Experiment Run Output"})}),e("div",{css:K`
                overflow-y: auto;
                height: 100%;
                padding: var(--ac-global-dimension-static-size-200);
              `,children:s(h,{direction:"row",children:[e(C,{flex:!0,children:t.error?e(C,{padding:"size-200",children:e(ph,{error:t.error})}):e(Ze,{value:JSON.stringify(t.output,null,2)})}),s(oa,{width:"size-3000",children:[t.startTime&&t.endTime&&e(mh,{startTime:t.startTime,endTime:t.endTime}),e("ul",{css:K`
                      margin-top: var(--ac-global-dimension-static-size-100);
                      display: flex;
                      flex-direction: column;
                      justify-content: flex-start;
                      align-items: flex-end;
                      gap: var(--ac-global-dimension-static-size-100);
                    `,children:(p=t.annotations)==null?void 0:p.edges.map(y=>e("li",{children:e(En,{annotation:y.annotation})},y.annotation.id))})]})]})})]})})]})})}function mh({startTime:n,endTime:a}){const t=u.useMemo(()=>{let l=null;return n&&a&&(l=new Date(a).getTime()-new Date(n).getTime()),l},[n,a]);return t===null?null:e(Ve,{latencyMs:t})}function ph({error:n}){return s(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(L,{svg:e(wl,{}),color:"danger"}),e(v,{color:"danger",children:n})]})}const Mi={backgroundColor:"light",borderColor:"light",variant:"compact",collapsible:!0,bodyStyle:{padding:0}},co=function(){var n={defaultValue:null,kind:"LocalArgument",name:"id"},a={defaultValue:null,kind:"LocalArgument",name:"traceId"},t=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},r={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"traceId",variableName:"traceId"}],concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"projectSessionId",storageKey:null},{alias:null,args:[{kind:"Literal",name:"first",value:1e3}],concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"span",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},{alias:"statusCode",args:null,kind:"ScalarField",name:"propagatedStatusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},i,{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:"spans(first:1000)"},i],storageKey:null}],type:"Project",abstractKey:null};return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"TraceDetailsQuery",selections:[{alias:"project",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[r],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"TraceDetailsQuery",selections:[{alias:"project",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r,{kind:"TypeDiscriminator",abstractKey:"__isNode"},l],storageKey:null}]},params:{cacheID:"ac9147f8bf0ef8c809d19877e0ee5f2c",id:null,metadata:{},name:"TraceDetailsQuery",operationKind:"query",text:`query TraceDetailsQuery(
  $traceId: ID!
  $id: GlobalID!
) {
  project: node(id: $id) {
    __typename
    ... on Project {
      trace(traceId: $traceId) {
        projectSessionId
        spans(first: 1000) {
          edges {
            span: node {
              id
              spanId
              name
              spanKind
              statusCode: propagatedStatusCode
              startTime
              parentId
              latencyMs
              tokenCountTotal
              tokenCountPrompt
              tokenCountCompletion
            }
          }
        }
        latencyMs
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();co.hash="aedd511ed255adab3a80dde8956a01c4";const uo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},r={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},c={alias:"statusCode",args:null,kind:"ScalarField",name:"propagatedStatusCode",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"statusMessage",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},S=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"mimeType",storageKey:null}],F={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:S,storageKey:null},P={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:S,storageKey:null},D={alias:null,args:null,kind:"ScalarField",name:"attributes",storageKey:null},w={alias:null,args:null,concreteType:"SpanEvent",kind:"LinkedField",name:"events",plural:!0,selections:[o,{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null}],storageKey:null},T={alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null},x={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},M={alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},R={alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},O={alias:null,args:null,concreteType:"DocumentEvaluation",kind:"LinkedField",name:"documentEvaluations",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"documentPosition",storageKey:null},o,x,M,R],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanDetailsQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"InlineFragment",selections:[l,i,r,o,d,c,p,y,m,g,f,k,b,F,P,D,{kind:"RequiredField",field:w,action:"THROW"},T,O,{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[l,o],storageKey:null},{args:null,kind:"FragmentSpread",name:"SpanFeedback_annotations"},{args:null,kind:"FragmentSpread",name:"SpanAside_span"}],type:"Span",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanDetailsQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},l,{kind:"InlineFragment",selections:[i,r,o,d,c,p,y,m,g,f,k,b,F,P,D,w,T,O,{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[l,o,x,M,R,{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},{alias:"code",args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null}],type:"Span",abstractKey:null}],storageKey:null}]},params:{cacheID:"515a203910ba9b52d926bf76e2d2203f",id:null,metadata:{},name:"SpanDetailsQuery",operationKind:"query",text:`query SpanDetailsQuery(
  $id: GlobalID!
) {
  span: node(id: $id) {
    __typename
    ... on Span {
      id
      spanId
      trace {
        id
        traceId
      }
      name
      spanKind
      statusCode: propagatedStatusCode
      statusMessage
      startTime
      parentId
      latencyMs
      tokenCountTotal
      tokenCountPrompt
      tokenCountCompletion
      input {
        value
        mimeType
      }
      output {
        value
        mimeType
      }
      attributes
      events {
        name
        message
        timestamp
      }
      documentRetrievalMetrics {
        evaluationName
        ndcg
        precision
        hit
      }
      documentEvaluations {
        documentPosition
        name
        label
        score
        explanation
      }
      spanAnnotations {
        id
        name
      }
      ...SpanFeedback_annotations
      ...SpanAside_span
    }
    __isNode: __typename
    id
  }
}

fragment SpanAside_span on Span {
  id
  code: statusCode
  startTime
  endTime
  tokenCountTotal
  tokenCountPrompt
  tokenCountCompletion
  spanAnnotations {
    id
    name
    label
    annotatorKind
    score
  }
}

fragment SpanFeedback_annotations on Span {
  spanAnnotations {
    id
    name
    label
    score
    explanation
    annotatorKind
  }
}
`}}}();uo.hash="c13d143f94fdc27c486314c1ca9c1781";function Vi(n){return Array.isArray(n)&&n.every(a=>typeof a=="object"&&ue.message in a&&gh(a[ue.message]))}function gh(n){return typeof n=="object"&&n!==null&&Ne.role in n}const tl=K`
  display: flex;
  align-items: center;
  .ac-text {
    display: inline-block;
    max-width: 9rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
`;function Xe(n){const{name:a,metric:t,k:l,score:i}=n,r=typeof l=="number"?`${t}@${l}`:t,o=u.useMemo(()=>t==="hit"?i?"true":"false":typeof i=="number"&&Qn(i)||"--",[i,t]);return s(me,{delay:500,offset:3,children:[e($e,{children:e("div",{css:mp,children:s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(pp,{color:"var(--ac-global-color-seafoam-1000)"}),a?e("div",{css:tl,children:e(v,{weight:"heavy",size:"XS",color:"inherit",children:a})}):null,e("div",{css:tl,children:e(v,{size:"XS",color:"inherit",children:r})}),e("div",{css:tl,children:e(v,{size:"XS",children:o})})]})})}),e(Zn,{children:s(h,{direction:"row",gap:"size-100",children:[s(v,{weight:"heavy",color:"inherit",children:[a," ",r]}),e(v,{color:"inherit",children:o})]})})]})}function mo({spanNodeId:n,projectId:a,size:t="M"}){const[l,i]=u.useState(null);return s(U,{children:[e(A,{size:t,leadingVisual:e(L,{svg:e(It,{})}),onPress:()=>i(e(hr,{spanNodeId:n,projectId:a})),children:"Annotate"}),e(X,{type:"slideOver",isDismissable:!0,onDismiss:()=>i(null),children:l})]})}const po=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanAsideSpanQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"SpanAside_span"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanAsideSpanQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},t,{kind:"InlineFragment",selections:[{alias:"code",args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null}],storageKey:null}],type:"Span",abstractKey:null}],storageKey:null}]},params:{cacheID:"878027b90513af8f947e6aa408450057",id:null,metadata:{},name:"SpanAsideSpanQuery",operationKind:"query",text:`query SpanAsideSpanQuery(
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...SpanAside_span
    __isNode: __typename
    id
  }
}

fragment SpanAside_span on Span {
  id
  code: statusCode
  startTime
  endTime
  tokenCountTotal
  tokenCountPrompt
  tokenCountCompletion
  spanAnnotations {
    id
    name
    label
    annotatorKind
    score
  }
}
`}}}();po.hash="cb5cab60889623d77ad0c96c98b3f8ac";const go=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:po,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"SpanAside_span",selections:[n,{alias:"code",args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null}],storageKey:null}],type:"Span",abstractKey:null}}();go.hash="cb5cab60889623d77ad0c96c98b3f8ac";const yh=K`
  display: flex;
  padding-top: var(--ac-global-dimension-size-50);
  flex-direction: column;
  gap: var(--ac-global-dimension-size-100);
  align-items: flex-start;
`;function fh(n){const[a]=I.useRefetchableFragment(go,n.span),{startTime:t,endTime:l,code:i,tokenCountCompletion:r,tokenCountPrompt:o,tokenCountTotal:d}=a,c=u.useMemo(()=>new Date(t),[t]),p=u.useMemo(()=>l?new Date(l):null,[l]),y=u.useMemo(()=>p?p.getTime()-c.getTime():null,[p,c]),m=kr(i),g=a.spanAnnotations,f=g.length>0;return e(C,{padding:"size-200",borderColor:"dark",backgroundColor:"dark",borderLeftWidth:"thin",width:"230px",flex:"none",minHeight:"100%",children:s(h,{direction:"column",gap:"size-200",children:[e(ba,{label:"Status",children:s(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(_t,{statusCode:i}),e(v,{color:m,children:i})]})}),e(ba,{label:"Start Time",children:e(v,{children:pn(c)})}),p&&e(ba,{label:"End Time",children:e(v,{size:"M",children:pn(p)})}),e(ba,{label:"Latency",children:e(v,{children:typeof y=="number"?e(Ve,{latencyMs:y}):"--"})}),d?e(ba,{label:"Total Tokens",children:e(na,{tokenCountTotal:d,tokenCountPrompt:o??0,tokenCountCompletion:r??0,size:"L"})},"tokens"):null,f&&e(ba,{label:"Feedback",children:e("ul",{css:yh,children:g.map(k=>e("li",{children:e(En,{annotation:k,annotationDisplayPreference:"label"})},k.id))})})]})})}function ba({label:n,children:a}){return s(h,{direction:"column",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:n}),a]})}function hh(n){const{spanId:a,traceId:t}=n;return e("div",{css:K`
        button.ac-dropdown-button {
          min-width: 50px;
          .ac-dropdown-button__text {
            padding-right: 10px;
          }
        }
      `,children:s(ga,{placement:"bottom right",children:[e(vl,{addonBefore:e(L,{svg:e(Ft,{})}),children:"Code"}),e(kt,{children:e(C,{padding:"size-200",children:s(h,{direction:"column",gap:"size-100",children:[s(h,{direction:"row",gap:"size-100",alignItems:"end",children:[s(J,{value:a,isReadOnly:!0,size:"M",children:[e(G,{children:"Span ID"}),e(ne,{})]}),e(ie,{text:a,size:"M"})]}),s(h,{direction:"row",gap:"size-100",alignItems:"end",children:[s(J,{value:t,isReadOnly:!0,size:"M",children:[e(G,{children:"Trace ID"}),e(ne,{})]}),e(ie,{text:t,size:"M"})]})]})})})]})})}const yo={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SpanFeedback_annotations",selections:[{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null}],type:"Span",abstractKey:null};yo.hash="6cde9ca22bfc99084304e3e817be01dc";function kh(){const[n,a]=u.useState(null);return s(C,{padding:"size-200",children:[s(h,{direction:"column",gap:"size-100",alignItems:"center",children:[e(bt,{graphicKey:"documents"}),e(v,{children:"No annotations for this span"}),e(A,{variant:"default",size:"S",onPress:()=>{a(e(Z,{title:"Span Annotations",isDismissable:!0,children:s(C,{padding:"size-200",children:[e("p",{css:K`
              margin: 0 0 var(--ac-global-dimension-size-100) 0;
            `,children:"Annotations are pivotal for tracking and improving the performance of your application. Phoenix allows for both LLM and HUMAN annotations."}),e(nn,{href:"https://docs.arize.com/phoenix/tracing/concepts-tracing/how-to-evaluate-traces",children:"View annotation documentation"})]})}))},leadingVisual:e(L,{svg:e(Ll,{})}),children:"How to Annotate"})]}),e(X,{onDismiss:()=>a(null),isDismissable:!0,children:n})]})}const bh=[{header:"name",accessorKey:"name",size:100},{header:"label",accessorKey:"label",size:100},{header:"score",accessorKey:"score",size:100},{header:"explanation",accessorKey:"explanation",cell:gp,size:400}];function Ri({annotations:n}){const a=u.useMemo(()=>[...n],[n]),t=Te({columns:bh,data:a,getCoreRowModel:Pe()}),i=t.getRowModel().rows.length===0;return s("table",{css:tn,children:[e("thead",{children:t.getHeaderGroups().map(r=>e("tr",{children:r.headers.map(o=>e("th",{colSpan:o.colSpan,children:o.isPlaceholder?null:e(U,{children:W(o.column.columnDef.header,o.getContext())})},o.id))},r.id))}),i?e(ln,{}):e("tbody",{children:t.getRowModel().rows.map(r=>e("tr",{children:r.getVisibleCells().map(o=>e("td",{style:{width:o.column.getSize()},children:W(o.column.columnDef.cell,o.getContext())},o.id))},r.id))})]})}function Sh({span:n}){const a=I.useFragment(yo,n),t=u.useMemo(()=>a.spanAnnotations.filter(r=>r.annotatorKind==="HUMAN"),[a.spanAnnotations]),l=u.useMemo(()=>a.spanAnnotations.filter(r=>r.annotatorKind==="LLM"),[a.spanAnnotations]);return a.spanAnnotations.length>0?s(en,{defaultExpandedKeys:["evaluations","human"],children:[s(ce,{id:"evaluations",children:[e(oe,{children:"Evaluations"}),e(de,{children:e(Ri,{annotations:l})})]}),s(ce,{id:"human",children:[e(oe,{children:"Human Annotations"}),e(de,{children:e(Ri,{annotations:t})})]})]}):e(kh,{})}function vh(n){return n==="__REDACTED__"}const Ch=K`
  position: relative;
  overflow: hidden;
  width: 200px;
  height: 200px;
  border-radius: var(--ac-global-rounding-small);
  border: 1px solid var(--ac-global-color-grey-500);
  background-color: var(--ac-global-color-grey-200);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  transition:
    width 0.1s ease-in-out,
    height 0.1s ease-in-out opacity 0.1s ease-in-out;
  button {
    position: absolute;
    right: var(--ac-global-dimension-size-100);
    top: var(--ac-global-dimension-size-100);
    z-index: 1;
    opacity: 0;
  }
  &:hover button {
    opacity: 1;
  }
  img {
    width: inherit;
    height: inherit;
    object-fit: contain;
  }

  &.is-expanded {
    width: 100%;
    height: 100%;
    img {
      object-fit: cover;
    }
  }
`;function Fh(n){const[a,t]=u.useState(!1);let l;const i=vh(n.url);return i?l=e(Kh,{}):l=e("img",{src:n.url}),s("div",{className:em({"is-expanded":a}),css:Ch,children:[!i&&e(A,{variant:"default",size:"S",onPress:()=>t(!a),leadingVisual:e(L,{svg:a?e(yp,{}):e(Ja,{})}),"aria-label":"Expand / Collapse Image"}),l]})}const Kh=()=>s("svg",{width:"130",height:"130",viewBox:"0 0 130 130",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e("rect",{x:"1.5",y:"1.5",width:"127",height:"127",rx:"6.5",strokeOpacity:"0.8",strokeWidth:"3"}),e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M40 27.5H90C96.8917 27.5 102.5 33.1083 102.5 40V90C102.5 96.8917 96.8917 102.5 90 102.5H40C33.1083 102.5 27.5 96.8917 27.5 90V40C27.5 33.1083 33.1083 27.5 40 27.5ZM40 35.8333H90C92.3 35.8333 94.1667 37.7 94.1667 40V74.85L80.8208 63.4667C76.6958 59.9583 70.2417 59.9583 66.1542 63.4417L35.8333 88.7417V40C35.8333 37.7 37.7 35.8333 40 35.8333ZM54.5833 50.4167C54.5833 53.8667 51.7833 56.6667 48.3333 56.6667C44.8833 56.6667 42.0833 53.8667 42.0833 50.4167C42.0833 46.9667 44.8833 44.1667 48.3333 44.1667C51.7833 44.1667 54.5833 46.9667 54.5833 50.4167ZM42.3375 94.1667H90C92.3 94.1667 94.1667 92.3 94.1667 90V85.8083L75.4125 69.8083C74.4083 68.9458 72.55 68.9417 71.525 69.8125L42.3375 94.1667Z",fill:"var(--ac-global-color-grey-300)"})]}),fo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"addExamplesToDataset",plural:!1,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"dataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanToDatasetExampleDialogAddExampleToDatasetMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanToDatasetExampleDialogAddExampleToDatasetMutation",selections:a},params:{cacheID:"d93c9d47668fc266ba09ecb14c2b72ae",id:null,metadata:{},name:"SpanToDatasetExampleDialogAddExampleToDatasetMutation",operationKind:"mutation",text:`mutation SpanToDatasetExampleDialogAddExampleToDatasetMutation(
  $input: AddExamplesToDatasetInput!
) {
  addExamplesToDataset(input: $input) {
    dataset {
      id
    }
  }
}
`}}}();fo.hash="75120065d239f28304e9dd91fc34bec9";const ho=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"spanId"}],a=[{kind:"Variable",name:"id",variableName:"spanId"}],t={kind:"InlineFragment",selections:[{alias:"revision",args:null,concreteType:"SpanAsExampleRevision",kind:"LinkedField",name:"asExampleRevision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null}],storageKey:null}],type:"Span",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanToDatasetExampleDialogQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanToDatasetExampleDialogQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"68887dda2ffa7793e66ff83d472c72f8",id:null,metadata:{},name:"SpanToDatasetExampleDialogQuery",operationKind:"query",text:`query SpanToDatasetExampleDialogQuery(
  $spanId: GlobalID!
) {
  span: node(id: $spanId) {
    __typename
    ... on Span {
      revision: asExampleRevision {
        input
        output
        metadata
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();ho.hash="647a1865dacf40ce9bbb255b572a9a68";const ll={backgroundColor:"light",borderColor:"light",collapsible:!0,bodyStyle:{padding:0}};function Th({spanId:n,onCompleted:a}){const[t,l]=u.useState(null),i=I.useLazyLoadQuery(ho,{spanId:n},{fetchPolicy:"store-and-network"}),{span:{revision:r}}=i,[o,d]=I.useMutation(fo),{control:c,setError:p,handleSubmit:y,formState:{isValid:m}}=Ae({defaultValues:{input:JSON.stringify(r==null?void 0:r.input,null,2),output:JSON.stringify(r==null?void 0:r.output,null,2),metadata:JSON.stringify(r==null?void 0:r.metadata,null,2),datasetId:""}}),g=u.useCallback(f=>{if(l(null),!Fn(f==null?void 0:f.input))return p("input",{message:"Input must be a valid JSON object"});if(!Fn(f==null?void 0:f.output))return p("output",{message:"Output must be a valid JSON object"});if(!Fn(f==null?void 0:f.metadata))return p("metadata",{message:"Metadata must be a valid JSON object"});if(!(f!=null&&f.datasetId))return p("datasetId",{message:"Dataset is required"});o({variables:{input:{datasetId:f.datasetId,examples:[{input:JSON.parse(f.input),output:JSON.parse(f.output),metadata:JSON.parse(f.metadata),spanId:n}]}},onCompleted:()=>{a(f.datasetId)},onError:k=>{const b=Ce(k);l((b==null?void 0:b[0])??k.message)}})},[o,p,n,a]);return e(Z,{size:"fullscreen",title:"Add Example to Dataset",extra:e(A,{variant:"primary",size:"S",isDisabled:!m||d,onPress:()=>y(g)(),leadingVisual:e(L,{svg:d?e(je,{}):e(Ha,{})}),children:"Add Example"}),children:e("div",{css:K`
          overflow-y: auto;
          padding: var(--ac-global-dimension-size-400);
          /* Make widths configurable */
          .dataset-picker {
            width: 100%;
            .ac-dropdown--picker,
            .ac-dropdown-button {
              width: 100%;
            }
          }
        `,children:e(h,{direction:"row",justifyContent:"center",children:e(C,{width:"900px",paddingStart:"auto",paddingEnd:"auto",children:s(h,{direction:"column",gap:"size-200",children:[t?e(pe,{variant:"danger",children:t}):null,e(H,{control:c,name:"datasetId",render:({field:{onChange:f,onBlur:k},fieldState:{invalid:b,error:S}})=>s(h,{direction:"row",gap:"size-100",alignItems:"end",children:[e(fr,{onSelectionChange:f,onBlur:k,validationState:b?"invalid":"valid",errorMessage:S==null?void 0:S.message,label:"Dataset"}),e(fp,{})]})}),e(H,{control:c,name:"input",render:({field:{onChange:f,onBlur:k,value:b},fieldState:{invalid:S,error:F}})=>s(Q,{title:"Input",subTitle:"The input to the LLM, retriever, program, etc.",...ll,children:[S?e(pe,{variant:"danger",banner:!0,children:F==null?void 0:F.message}):null,e(Qe,{value:b,onChange:f,onBlur:k})]})}),e(H,{control:c,name:"output",render:({field:{onChange:f,onBlur:k,value:b},fieldState:{invalid:S,error:F}})=>s(Q,{title:"Output",subTitle:"The output of the LLM or program to be used as an expected output",...ll,backgroundColor:"green-100",borderColor:"green-700",children:[S?e(pe,{variant:"danger",banner:!0,children:F==null?void 0:F.message}):null,e(Qe,{value:b,onChange:f,onBlur:k})]})}),e(H,{control:c,name:"metadata",render:({field:{onChange:f,onBlur:k,value:b},fieldState:{invalid:S,error:F}})=>s(Q,{title:"Metadata",subTitle:"All data from the span to use during experimentation or evaluation",...ll,children:[S?e(pe,{variant:"danger",banner:!0,children:F==null?void 0:F.message}):null,e(Qe,{value:b,onChange:f,onBlur:k})]})})]})})})})})}const Ph=n=>u.useMemo(()=>Le(n),[n]),Ih=n=>n.events.some(a=>a.name==="exception"),Se={backgroundColor:"light",borderColor:"light",variant:"compact",collapsible:!0};function xh({spanNodeId:n,projectId:a}){const t=le(),{span:l}=I.useLazyLoadQuery(uo,{id:n});if(l.__typename!=="Span")throw new Error("Expected a span, but got a different type"+l.__typename);const i=u.useMemo(()=>Ih(l),[l]),r=Ge(d=>d.showSpanAside),o=Ge(d=>d.setShowSpanAside);return s(h,{direction:"column",flex:"1 1 auto",height:"100%",children:[e(C,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-150",paddingEnd:"size-200",flex:"none",children:s(h,{direction:"row",gap:"size-200",alignItems:"center",children:[s(h,{direction:"row",gap:"size-100",width:"100%",height:"100%",alignItems:"center",children:[e(El,{spanKind:l.spanKind}),e(v,{children:l.name})]}),s(h,{flex:"none",direction:"row",alignItems:"center",gap:"size-100",children:[e(A,{variant:"default",leadingVisual:e(L,{svg:e(fa,{})}),isDisabled:l.spanKind!=="llm",onPress:()=>{t(`/playground/spans/${l.id}`)},children:"Playground"}),e(hh,{traceId:l.trace.traceId,spanId:l.spanId}),e(Lh,{span:l}),e(mo,{spanNodeId:l.id,projectId:a}),s(me,{placement:"top",offset:5,children:[e(A,{variant:"default","aria-label":"Toggle showing span details",onPress:()=>{o(!r)},leadingVisual:e(L,{svg:r?e(hp,{}):e(kp,{})})}),e(Ee,{children:r?"Hide Span Details":"Show Span Details"})]})]})]})}),s(He,{children:[e(ae,{name:"Info",children:s(h,{direction:"row",height:"100%",children:[e(_h,{children:e(Lt,{children:e(wh,{span:l})})}),r?e(fh,{span:l}):null]})}),e(ae,{name:"Feedback",extra:e(dn,{variant:"light",children:l.spanAnnotations.length}),children:d=>d?e(Sh,{span:l}):null}),e(ae,{name:"Attributes",title:"Attributes",children:e(C,{padding:"size-200",children:e(Q,{title:"All Attributes",...Se,titleExtra:So,extra:e(ie,{text:l.attributes}),children:e(Jn,{children:l.attributes})})})}),e(ae,{name:"Events",extra:e(dn,{variant:i?"danger":"light",children:l.events.length}),children:e(Wh,{events:l.events})})]})]})}const Dh=K`
  flex: 1 1 auto;
  overflow-y: auto;
  // Overflow fails to take into account padding
  & > *:after {
    content: "";
    display: block;
    height: var(--ac-global-dimension-static-size-400);
  }
`;function _h({children:n}){return e("div",{css:Dh,"data-testid":"span-info-wrap",children:n})}function Lh({span:n}){const[a,t]=u.useState(null),l=ke(),i=le(),r=u.useCallback(()=>{t(e(Th,{spanId:n.id,onCompleted:o=>{t(null),l({title:"Span Added to Dataset",message:"Successfully added span to dataset",action:{text:"View Dataset",onClick:()=>{i(`/datasets/${o}/examples`)}}})}}))},[n.id,l,i]);return s(U,{children:[e(A,{variant:"default",leadingVisual:e(L,{svg:e(Ct,{})}),onPress:r,children:"Add to Dataset"}),e(u.Suspense,{children:e(X,{type:"slideOver",isDismissable:!0,onDismiss:()=>t(null),children:a})})]})}function wh({span:n}){const{spanKind:a,attributes:t}=n,{json:l,parseError:i}=Ph(t),r=u.useMemo(()=>n.statusMessage?e(pe,{variant:"danger",title:"Status Description",children:n.statusMessage}):null,[n]);if(i||!l)return e(C,{padding:"size-200",children:s(h,{direction:"column",gap:"size-200",children:[r,e(pe,{variant:"warning",title:"Un-parsable attributes",children:`Failed to parse span attributes. ${i instanceof Error?i.message:""}`}),e(Q,{...Se,title:"Attributes",children:e(C,{padding:"size-100",children:t})})]})});let o;switch(a){case"llm":{o=e(Eh,{span:n,spanAttributes:l});break}case"retriever":{o=e(Mh,{span:n,spanAttributes:l});break}case"reranker":{o=e(Vh,{span:n,spanAttributes:l});break}case"embedding":{o=e(Rh,{span:n,spanAttributes:l});break}case"tool":{o=e(Ah,{span:n,spanAttributes:l});break}default:o=e(ko,{span:n})}return e(C,{padding:"size-200",children:s(h,{direction:"column",gap:"size-200",children:[r,o,l!=null&&l.metadata?e(Q,{...Se,title:"Metadata",children:e(Jn,{children:JSON.stringify(l.metadata)})}):null]})})}function Eh(n){const{spanAttributes:a,span:t}=n,{input:l,output:i}=t,r=u.useMemo(()=>a[ue.llm]||null,[a]),o=u.useMemo(()=>{if(r==null)return null;const M=r[ze.model_name];return typeof M=="string"?M:null},[r]),d=u.useMemo(()=>{if(r==null)return[];const M=r[ze.input_messages];return Vi(M)?(M==null?void 0:M.map(R=>R[ue.message]).filter(Boolean))||[]:[]},[r]),c=u.useMemo(()=>{if(r==null)return[];const M=r[ze.tools];return Array.isArray(M)?M==null?void 0:M.map(O=>O[ue.tool]).filter(Boolean):[]},[r]),p=u.useMemo(()=>c.reduce((M,R)=>(R!=null&&R.json_schema&&M.push(R.json_schema),M),[]),[c]),y=u.useMemo(()=>{if(r==null)return[];const M=r[ze.output_messages];return Vi(M)?M.map(R=>R[ue.message]).filter(Boolean)||[]:[]},[r]),m=u.useMemo(()=>{if(r==null)return[];const M=r[ze.prompts];return Sp(M)?M:[]},[r]),g=u.useMemo(()=>{if(r==null)return null;const M=r[ze.prompt_template];return M??null},[r]),f=u.useMemo(()=>r==null?"{}":r[ze.invocation_parameters]||"{}",[r]),k=u.useMemo(()=>o==null?null:s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Ml,{spanKind:"llm"}),e(v,{size:"M",weight:"heavy",children:o})]}),[o]),b=l!=null&&l.value!=null,S=d.length>0,F=p.length>0,P=i!=null&&i.value!=null,D=y.length>0,w=m.length>0,T=Object.keys(Le(f).json||{}).length>0,x=g!=null;return s(h,{direction:"column",gap:"size-200",children:[e(Q,{collapsible:!0,backgroundColor:"light",borderColor:"light",bodyStyle:{padding:0},titleSeparator:!1,variant:"compact",title:k,children:s(He,{children:[S?e(ae,{name:"Input Messages",hidden:!S,children:e(Ai,{messages:d})}):null,F?e(ae,{name:"Tools",hidden:!F,children:e(Oh,{toolSchemas:p})}):null,b?e(ae,{name:"Input",hidden:!b,children:e(C,{padding:"size-200",children:e(an,{children:e(Q,{...Se,title:"LLM Input",extra:s(h,{direction:"row",gap:"size-100",children:[e(gn,{}),e(ie,{text:l.value})]}),children:e(_n,{...l})})})})}):null,x?e(ae,{name:"Prompt Template",hidden:!x,children:e(C,{padding:"size-200",children:s(h,{direction:"column",gap:"size-100",children:[e(C,{borderRadius:"medium",borderColor:"light",backgroundColor:"light",borderWidth:"thin",padding:"size-200",children:s(mt,{text:g.template,children:[e(v,{color:"text-700",fontStyle:"italic",children:"prompt template"}),e(bo,{children:g.template})]})}),e(C,{borderRadius:"medium",borderColor:"light",backgroundColor:"light",borderWidth:"thin",padding:"size-200",children:s(mt,{text:JSON.stringify(g.variables),children:[e(v,{color:"text-700",fontStyle:"italic",children:"template variables"}),e(Jn,{children:JSON.stringify(g.variables)})]})})]})})}):null,e(ae,{name:"Prompts",hidden:!w,children:e(Qh,{prompts:m})}),e(ae,{name:"Invocation Params",hidden:!T,children:e(mt,{text:f,padding:"size-100",children:e(Jn,{children:f})})})]})}),P||D?e(Cl,{...Se,children:s(He,{children:[D?e(ae,{name:"Output Messages",hidden:!D,children:e(Ai,{messages:y})}):null,P?e(ae,{name:"Output",hidden:!P,children:e(C,{padding:"size-200",children:e(an,{children:e(Q,{...Se,title:"LLM Output",extra:s(h,{direction:"row",gap:"size-100",children:[e(gn,{}),e(ie,{text:i.value})]}),children:e(_n,{...i})})})})}):null]})}):null]})}function Mh(n){const{spanAttributes:a,span:t}=n,{input:l}=t,i=u.useMemo(()=>a[ue.retrieval]||null,[a]),r=u.useMemo(()=>{var y;return i==null?[]:((y=i[nm.documents])==null?void 0:y.map(m=>m[ue.document]).filter(Boolean))||[]},[i]),o=u.useMemo(()=>t.documentEvaluations.reduce((m,g)=>{const f=g.documentPosition,k=m[f]||[];return{...m,[f]:[...k,g]}},{}),[t.documentEvaluations]),d=l!=null&&l.value!=null,c=r.length>0,p=t.documentRetrievalMetrics.length>0;return s(h,{direction:"column",gap:"size-200",children:[d?e(an,{children:e(Q,{title:"Input",...Se,extra:s(h,{direction:"row",gap:"size-100",children:[e(gn,{}),e(ie,{text:l.value})]}),children:e(_n,{...l})})}):null,c?e(an,{children:e(Q,{title:"Documents",...Se,titleExtra:p&&e(h,{direction:"row",alignItems:"center",gap:"size-100",children:t.documentRetrievalMetrics.map(y=>s(U,{children:[e(Xe,{name:y.evaluationName,metric:"ndcg",score:y.ndcg},"ndcg"),e(Xe,{name:y.evaluationName,metric:"precision",score:y.precision},"precision"),e(Xe,{name:y.evaluationName,metric:"hit",score:y.hit},"hit")]}))}),extra:e(gn,{}),children:e("ul",{css:K`
                display: flex;
                flex-direction: column;
                gap: var(--ac-global-dimension-static-size-200);
              `,children:r.map((y,m)=>e("li",{children:e(yl,{document:y,documentEvaluations:o[m],borderColor:"seafoam-700",backgroundColor:"seafoam-100",tokenColor:"var(--ac-global-color-seafoam-1000)"})},m))})})}):null]})}function Vh(n){const{spanAttributes:a}=n,t=u.useMemo(()=>a[ue.reranker]||null,[a]),l=u.useMemo(()=>t==null?null:t[Xt.query]||null,[t]),i=u.useMemo(()=>{var c;return t==null?[]:((c=t[Xt.input_documents])==null?void 0:c.map(p=>p[ue.document]).filter(Boolean))||[]},[t]),r=u.useMemo(()=>{var c;return t==null?[]:((c=t[Xt.output_documents])==null?void 0:c.map(p=>p[ue.document]).filter(Boolean))||[]},[t]),o=i.length,d=r.length;return s(h,{direction:"column",gap:"size-200",children:[e(an,{children:l&&e(Q,{title:"Query",...Se,children:e(wa,{children:l})})}),e(Q,{title:"Input Documents",titleExtra:e(dn,{variant:"light",children:o}),...Se,defaultOpen:!1,bodyStyle:{padding:0},children:e("ul",{css:K`
              padding: var(--ac-global-dimension-static-size-200);
              display: flex;
              flex-direction: column;
              gap: var(--ac-global-dimension-static-size-200);
            `,children:i.map((c,p)=>e("li",{children:e(yl,{document:c,borderColor:"seafoam-700",backgroundColor:"seafoam-100",tokenColor:"var(--ac-global-color-seafoam-1000)"})},p))})}),e(Q,{title:"Output Documents",titleExtra:e(dn,{variant:"light",children:d}),...Se,bodyStyle:{padding:0},children:e("ul",{css:K`
              padding: var(--ac-global-dimension-static-size-200);
              display: flex;
              flex-direction: column;
              gap: var(--ac-global-dimension-static-size-200);
            `,children:r.map((c,p)=>e("li",{children:e(yl,{document:c,borderColor:"celery-700",backgroundColor:"celery-100",tokenColor:"var(--ac-global-color-celery-1000)"})},p))})})]})}function Rh(n){const{spanAttributes:a}=n,t=u.useMemo(()=>a[ue.embedding]||null,[a]),l=u.useMemo(()=>{var o;return t==null?[]:((o=t[Yt.embeddings])==null?void 0:o.map(d=>d[ue.embedding]).filter(Boolean))||[]},[t]),i=l.length>0,r=t==null?void 0:t[Yt.model_name];return e(h,{direction:"column",gap:"size-200",children:i?e(Q,{title:"Embeddings"+(typeof r=="string"?`: ${r}`:""),...Se,children:e("ul",{css:K`
                display: flex;
                flex-direction: column;
                gap: var(--ac-global-dimension-static-size-200);
              `,children:l.map((o,d)=>e("li",{children:e(an,{children:e(Q,{...Se,backgroundColor:"purple-100",borderColor:"purple-700",title:"Embedded Text",children:e(wa,{children:o[Yt.text]||""})})})},d))})}):e(ko,{span:n.span})})}function Ah(n){const{span:a,spanAttributes:t}=n,{input:l,output:i}=a,r=typeof(l==null?void 0:l.value)=="string",o=typeof(i==null?void 0:i.value)=="string",d=(l==null?void 0:l.mimeType)==="text",c=(i==null?void 0:i.mimeType)==="text",p=u.useMemo(()=>t[ue.tool]||{},[t]),y=Object.keys(p).length>0,m=p[ut.name],g=p[ut.description],f=p[ut.parameters];return!r&&!o&&!y?null:s(h,{direction:"column",gap:"size-200",children:[r?e(an,{children:e(Q,{title:"Input",...Se,extra:s(h,{direction:"row",gap:"size-100",children:[d?e(gn,{}):null,e(ie,{text:l.value})]}),children:e(_n,{...l})})}):null,o?e(an,{children:e(Q,{title:"Output",...Se,backgroundColor:"green-100",borderColor:"green-700",extra:s(h,{direction:"row",gap:"size-100",children:[c?e(gn,{}):null,e(ie,{text:i.value})]}),children:e(_n,{...i})})}):null,y?e(Q,{title:"Tool"+(typeof m=="string"?`: ${m}`:""),...Se,children:s(h,{direction:"column",children:[g!=null?e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderBottomColor:"dark",borderBottomWidth:"thin",backgroundColor:"light",children:s(h,{direction:"column",alignItems:"start",gap:"size-50",children:[e(v,{color:"text-700",fontStyle:"italic",children:"Description"}),e(v,{children:g})]})}):null,f!=null?e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderBottomColor:"dark",borderBottomWidth:"thin",children:s(h,{direction:"column",alignItems:"start",width:"100%",children:[e(v,{color:"text-700",fontStyle:"italic",children:"Parameters"}),e(Jn,{children:JSON.stringify(f)})]})}):null]})}):null]})}const Nh=["irrelevant","unrelated"];function yl({document:n,documentEvaluations:a,backgroundColor:t,borderColor:l,tokenColor:i}){const r=n[Aa.metadata],o=a&&a.length,d=n[Aa.content];return e(Q,{...Se,backgroundColor:t,borderColor:l,bodyStyle:{padding:0},title:s(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(L,{svg:e(br,{})}),s(te,{level:4,children:["document ",n[Aa.id]]})]}),extra:typeof n[Aa.score]=="number"&&e(Ka,{color:i,children:`score ${Vl(n[Aa.score])}`}),children:s(h,{direction:"column",children:[d&&e(C,{padding:"size-200",children:e(wa,{children:d})}),r&&e(U,{children:e(C,{borderColor:l,borderTopWidth:"thin",children:e(Jn,{children:JSON.stringify(r)})})}),o&&e(C,{borderColor:l,borderTopWidth:"thin",padding:"size-200",children:s(h,{direction:"column",gap:"size-100",children:[e(te,{level:3,weight:"heavy",children:"Evaluations"}),e("ul",{children:a.map((c,p)=>{const y=c.label&&Nh.includes(c.label)?"var(--ac-global-color-danger)":i;return e("li",{children:e(C,{padding:"size-200",borderWidth:"thin",borderColor:l,borderRadius:"medium",children:s(h,{direction:"column",gap:"size-50",children:[s(h,{direction:"row",gap:"size-100",children:[e(v,{weight:"heavy",elementType:"h5",children:c.name}),c.label&&e(Ka,{color:y,children:c.label}),typeof c.score=="number"&&e(Ka,{color:y,children:s(h,{direction:"row",gap:"size-50",children:[e(v,{size:"XS",weight:"heavy",color:"inherit",children:"score"}),e(v,{size:"XS",children:Qn(c.score)})]})})]}),typeof c.explanation&&e("p",{css:K`
                                margin-top: var(
                                  --ac-global-dimension-static-size-100
                                );
                                margin-bottom: 0;
                              `,children:c.explanation})]})})},p)})})]})})]})})}function zh({message:n}){var d;const a=n[Ne.content],t=n[Ne.contents],l=((d=n[Ne.tool_calls])==null?void 0:d.map(c=>c[ue.tool_call]).filter(Boolean))||[],i=n[Ne.function_call_arguments_json]&&n[Ne.function_call_name],r=n[Ne.role]||"unknown",o=lt(r);return e(an,{children:s(Q,{...Se,...o,title:r+(n[Ne.name]?`: ${n[Ne.name]}`:""),extra:s(h,{direction:"row",gap:"size-100",children:[e(gn,{}),e(ie,{text:a||JSON.stringify(n)})]}),children:[e(Lt,{children:t?e(qh,{messageContents:t}):null}),s(h,{direction:"column",alignItems:"start",children:[a?e(wa,{children:a}):null,l.length>0?l.map((c,p)=>{var m,g,f;const y=Le((m=c==null?void 0:c.function)==null?void 0:m.arguments);return s("pre",{css:K`
                      text-wrap: wrap;
                      margin: var(--ac-global-dimension-static-size-100) 0;
                    `,children:[(g=c==null?void 0:c.function)==null?void 0:g.name,"(",y.json?JSON.stringify(y.json,null,2):`${(f=c==null?void 0:c.function)==null?void 0:f.arguments}`,")"]},p)}):null,i?s("pre",{css:K`
                text-wrap: wrap;
                margin: var(--ac-global-dimension-static-size-100) 0;
              `,children:[n[Ne.function_call_name],"(",JSON.stringify(JSON.parse(n[Ne.function_call_arguments_json]),null,2),")"]}):null]})]})})}function $h({toolSchema:n,index:a}){return e(Q,{title:s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Ml,{spanKind:"tool"}),e(v,{weight:"heavy",children:"Tool"})]}),titleExtra:s(dn,{variant:"light",children:["#",a+1]}),...Se,backgroundColor:"yellow-100",borderColor:"yellow-700",bodyStyle:{padding:0},extra:e(ie,{text:n}),children:e(_n,{value:n,mimeType:"json"})})}function Ai({messages:n}){return e("ul",{css:K`
        display: flex;
        flex-direction: column;
        gap: var(--ac-global-dimension-static-size-100);
        padding: var(--ac-global-dimension-static-size-200);
      `,children:n.map((a,t)=>e("li",{children:e(zh,{message:a})},t))})}function Oh({toolSchemas:n}){return e("ul",{css:K`
        display: flex;
        flex-direction: column;
        gap: var(--ac-global-dimension-static-size-100);
        padding: var(--ac-global-dimension-static-size-200);
      `,children:n.map((a,t)=>e("li",{children:e($h,{toolSchema:a,index:t})},t))})}function Qh({prompts:n}){return e("ul",{"data-testid":"llm-prompts-list",css:K`
        padding: var(--ac-global-dimension-size-200);
        display: flex;
        flex-direction: column;
        gap: var(--ac-global-dimension-size-100);
      `,children:n.map((a,t)=>e("li",{children:e(C,{backgroundColor:"grey-100",borderColor:"grey-500",borderWidth:"thin",borderRadius:"medium",padding:"size-100",children:e(mt,{text:a,children:e(_n,{value:a,mimeType:"text"})})})},t))})}const jh=K`
  display: flex;
  flex-direction: row;
  gap: var(--ac-global-dimension-size-200);
  flex-wrap: wrap;
`;function qh({messageContents:n}){return e("ul",{css:jh,"data-testid":"message-content-list",children:n.map((a,t)=>e(Uh,{messageContentAttribute:a},t))})}const Bh=K`
  flex: 1 1 100%;
`;function Uh({messageContentAttribute:n}){var r;const{message_content:a}=n,t=a==null?void 0:a.text,l=a==null?void 0:a.image,i=(r=l==null?void 0:l.image)==null?void 0:r.url;return s("li",{css:t?Bh:null,children:[t?e("pre",{css:K`
            white-space: pre-wrap;
            padding: 0;
            margin: 0;
          `,children:t}):null,i?e(Fh,{url:i}):null]})}function ko({span:n}){const{input:a,output:t}=n,l=a==null&&t==null,i=(a==null?void 0:a.mimeType)==="text",r=(t==null?void 0:t.mimeType)==="text";return s(h,{direction:"column",gap:"size-200",children:[a&&a.value!=null?e(an,{children:e(Q,{title:"Input",...Se,extra:s(h,{direction:"row",gap:"size-100",children:[i?e(gn,{}):null,e(ie,{text:a.value})]}),children:e(_n,{...a})})}):null,t&&t.value!=null?e(an,{children:e(Q,{title:"Output",...Se,backgroundColor:"green-100",borderColor:"green-700",extra:s(h,{direction:"row",gap:"size-100",children:[r?e(gn,{}):null,e(ie,{text:t.value})]}),children:e(_n,{...t})})}):null,l?e(Q,{title:"All Attributes",titleExtra:So,...Se,extra:e(ie,{text:n.attributes}),children:e(Jn,{children:n.attributes})}):null]})}const Hh=K`
  .cm-editor,
  .cm-gutters {
    background-color: transparent;
  }
`;function mt({text:n,children:a,padding:t}){const l=t?`var(--ac-global-dimension-${t})`:"0";return s("div",{css:K`
        position: relative;
        .copy-to-clipboard-button {
          transition: opacity 0.2s ease-in-out;
          opacity: 0;
          position: absolute;
          right: ${l};
          top: ${l};
          z-index: 1;
        }
        &:hover .copy-to-clipboard-button {
          opacity: 1;
        }
      `,children:[e(ie,{text:n}),a]})}function Jn({children:n}){const{theme:a}=Mn(),t=a==="light"?aa:ta,{value:l,mimeType:i}=u.useMemo(()=>{try{return{value:JSON.stringify(JSON.parse(n),null,2),mimeType:"json"}}catch{return{value:n,mimeType:"text"}}},[n]);return i==="json"?e(la,{value:l,basicSetup:{lineNumbers:!0,foldGutter:!0,bracketMatching:!0,syntaxHighlighting:!0,highlightActiveLine:!1,highlightActiveLineGutter:!1},extensions:[Vg(),Zr.lineWrapping],editable:!1,theme:t,css:Hh}):e(bo,{children:l})}function bo({children:n}){return e("pre",{css:K`
        white-space: pre-wrap;
        padding: 0;
      `,children:n})}function _n({value:n,mimeType:a}){let t;switch(a){case"json":t=e(Jn,{children:n});break;case"text":t=e(wa,{children:n});break;default:fe()}return t}function Gh({text:n}){return s(h,{direction:"column",alignItems:"center",flex:"1 1 auto",height:"size-2400",justifyContent:"center",gap:"size-100",children:[e(bt,{graphicKey:"documents"}),e(v,{children:n})]})}function Wh({events:n}){return n.length===0?e(Gh,{text:"No events"}):e(ht,{children:n.map((a,t)=>{const l=a.name==="exception";return e(ft,{children:s(h,{direction:"row",alignItems:"center",gap:"size-100",children:[e(C,{flex:"none",children:e("div",{"data-event-type":l?"exception":"info",css:K`
                    &[data-event-type="exception"] {
                      --px-event-icon-color: var(--ac-global-color-danger);
                    }
                    &[data-event-type="info"] {
                      --px-event-icon-color: var(--ac-global-color-info);
                    }
                    .ac-icon-wrap {
                      color: var(--px-event-icon-color);
                    }
                  `,children:e(L,{svg:l?e(bp,{}):e(xn,{})})})}),s(h,{direction:"column",gap:"size-25",flex:"1 1 auto",children:[e(v,{weight:"heavy",children:a.name}),e(v,{color:"text-700",children:a.message})]}),e(C,{children:e(v,{color:"text-700",children:new Date(a.timestamp).toLocaleString()})})]})},t)})})}const So=e(h,{alignItems:"center",justifyContent:"center",children:e(C,{marginStart:"size-100",children:s(Da,{children:[e(te,{weight:"heavy",level:4,children:"Span Attributes"}),e(Xn,{children:e(v,{children:"Attributes are key-value pairs that represent metadata associated with a span. For detailed descriptions of specific attributes, consult the semantic conventions section of the OpenInference tracing specification."})}),e("footer",{children:e(nn,{href:"https://github.com/Arize-ai/openinference/blob/main/spec/semantic_conventions.md",children:"Semantic Conventions"})})]})})}),vo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null}],type:"Span",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"TraceHeaderRootSpanAnnotationsQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"TraceHeaderRootSpanAnnotationsQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"72a83342701c8636f9f95241c5f879e6",id:null,metadata:{},name:"TraceHeaderRootSpanAnnotationsQuery",operationKind:"query",text:`query TraceHeaderRootSpanAnnotationsQuery(
  $id: GlobalID!
) {
  span: node(id: $id) {
    __typename
    ... on Span {
      spanAnnotations {
        name
        label
        score
        annotatorKind
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();vo.hash="6c3505c6379d4b0066df22d2599c1c0f";function Jh(n){const t=I.useLazyLoadQuery(vo,{id:n},{fetchPolicy:"store-and-network"}).span.spanAnnotations??[];return t.length>0?s(h,{direction:"column",gap:"size-50",children:[e(v,{elementType:"h3",size:"M",color:"text-700",children:"Feedback"}),e(h,{direction:"row",gap:"size-50",children:t.map(i=>e(_a,{annotation:i,children:e(En,{annotation:i,annotationDisplayPreference:"label"})},i.name))})]}):null}const il="selectedSpanNodeId";function Zh(n){const a=n.find(i=>i.parentId==null);if(a)return a;const t=new Set(n.map(i=>i.spanId)),l=n.filter(i=>i.parentId!=null&&!t.has(i.parentId));return l.length===1?l[0]:null}function ri(n){var m,g;const{traceId:a,projectId:t}=n,[l,i]=fn(),r=I.useLazyLoadQuery(co,{traceId:a,id:t},{fetchPolicy:"store-and-network"}),o=((m=r.project.trace)==null?void 0:m.latencyMs)!=null?r.project.trace.latencyMs:null,d=u.useMemo(()=>{var k;return(((k=r.project.trace)==null?void 0:k.spans.edges)||[]).map(b=>b.span)},[r]),p=l.get(il)??d[0].id,y=u.useMemo(()=>Zh(d),[d]);return u.useEffect(()=>()=>{i(f=>(f.delete(il),f),{replace:!0})},[]),s("main",{css:K`
        flex: 1 1 auto;
        overflow: hidden;
        display: flex;
        flex-direction: column;
      `,children:[e(Xh,{rootSpan:y,latencyMs:o,sessionId:(g=r.project.trace)==null?void 0:g.projectSessionId}),s(Pn,{direction:"horizontal",autoSaveId:"trace-panel-group",css:K`
          flex: 1 1 auto;
          overflow: hidden;
        `,children:[e(_e,{defaultSize:30,minSize:5,children:e(e0,{children:e(vp,{spans:d,selectedSpanNodeId:p,onSpanClick:f=>{i(k=>(k.set(il,f.id),k),{replace:!0})}})})}),e(Tn,{css:Rl}),e(_e,{children:e(Yh,{children:p?e(u.Suspense,{fallback:e(ge,{}),children:e(xh,{spanNodeId:p,projectId:t})}):null})})]})]})}function Xh({rootSpan:n,latencyMs:a,sessionId:t}){const{projectId:l}=qe(),{statusCode:i}=n??{statusCode:"UNSET"},r=kr(i);return e(C,{padding:"size-200",borderBottomWidth:"thin",borderBottomColor:"dark",children:s(h,{direction:"row",gap:"size-400",alignItems:"center",children:[s(h,{direction:"column",children:[e(v,{elementType:"h3",size:"M",color:"text-700",children:"Trace Status"}),e(v,{size:"XL",children:s(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(_t,{statusCode:i}),e(v,{size:"L",color:r,children:i})]})})]}),s(h,{direction:"column",children:[e(v,{elementType:"h3",size:"M",color:"text-700",children:"Latency"}),e(v,{size:"XL",children:typeof a=="number"?e(Ve,{latencyMs:a,size:"L"}):"--"})]}),n?Jh(n.id):null,t&&e("span",{css:K`
              margin-left: auto;
            `,children:e(Oe,{to:`/projects/${l}/sessions/${t}`,children:s(h,{alignItems:"center",children:["View Session ",e(L,{svg:e(Sr,{})})]})})})]})})}function Yh({children:n}){return e("div",{"data-testid":"scrolling-tabs-wrapper",css:K`
        height: 100%;
        overflow: hidden;
        .ac-tabs {
          height: 100%;
          overflow: hidden;
          .ac-tabs__extra {
            width: 100%;
            padding-right: var(--ac-global-dimension-size-200);
            padding-bottom: var(--ac-global-dimension-size-50);
          }
          .ac-tabs__pane-container {
            min-height: 100%;
            height: 100%;
            overflow-y: auto;
            div[role="tabpanel"] {
              height: 100%;
            }
          }
        }
      `,children:n})}function e0({children:n}){return e("div",{"data-testid":"scrolling-panel-content",css:K`
        height: 100%;
        overflow-y: auto;
      `,children:n})}const Bt=()=>{const{projectId:n}=qe();if(!n)throw new Error("projectId is required");const t=kl().pathname.split("/"),l=t.indexOf(n);if(l===-1)throw new Error("projectId not found in path");const i=t.slice(0,l+1).join("/"),r=t[l+1];return{rootPath:i,tab:r}};function y2(){const{traceId:n,projectId:a}=qe(),t=le(),{rootPath:l,tab:i}=Bt();return e(X,{type:"slideOver",isDismissable:!0,onDismiss:()=>t(`${l}/${i}`),children:e(Z,{size:"fullscreen",title:"Trace Details",children:e(ri,{traceId:n,projectId:a})})})}function Co({traceId:n,projectId:a,title:t}){const l=le();return e(Z,{title:t,size:"fullscreen",extra:e(A,{onPress:()=>l(`/projects/${a}/traces/${n}`),children:"View Trace in Project"}),children:e(ri,{traceId:n,projectId:a})})}const n0=n=>{const a=n;return Hn(a.function)?typeof a.function.arguments=="string":!1};function Fo({toolCall:n}){const a=u.useMemo(()=>{const{provider:t,validatedToolCall:l}=Cp(n);switch(t){case"OPENAI":case"AZURE_OPENAI":return{name:l.function.name,input:l.function.arguments};case"ANTHROPIC":return{name:l.name,input:l.input};case"UNKNOWN":{if(!n0(n))return null;const{json:i}=Le(n.function.arguments);return{name:n.function.name??"",input:Hn(i)?i:n.function.arguments}}default:return fe()}},[n]);return a==null?s(v,{children:["Invalid tool call format: ",JSON.stringify(n)]}):s("pre",{css:K`
        text-wrap: wrap;
        margin: var(--ac-global-dimension-static-size-100) 0;
      `,children:[a.name,"(",typeof a.input=="string"?a.input:JSON.stringify(a.input,null,2),")"]})}const a0=10,t0=n=>n.examples.reduce((a,t)=>{const{datasetExampleId:l,result:i,experimentRunId:r}=t,o={experimentRunId:r};switch(i.__typename){case"ChatCompletionMutationError":return{...a,[l]:{...o,errorMessage:i.message}};case"ChatCompletionMutationPayload":{const{errorMessage:d,content:c,span:p,toolCalls:y}=i;return{...a,[l]:{...o,span:p,content:c,errorMessage:d,toolCalls:y.reduce((m,g)=>(m[g.id]=g,m),{})}}}case"%other":return a;default:fe()}},{}),l0=K`
  position: relative;
  display: flex;
  flex-direction: column;
  justify-content: center;
  height: 100%;
  min-height: 75px;
  padding: var(--ac-global-dimension-static-size-200);
  .controls {
    transition: opacity 0.2s ease-in-out;
    opacity: 0;
    display: none;
    z-index: 1;
  }
  &:hover .controls {
    opacity: 1;
    display: flex;
    // make them stand out
    button {
      border-color: var(--ac-global-color-primary);
    }
  }
`,i0=K`
  position: absolute;
  top: -4px;
  right: var(--ac-global-dimension-static-size-100);
  display: flex;
  flex-direction: row;
  gap: var(--ac-global-dimension-static-size-100);
`;function Ko(n){return s("div",{css:l0,children:[n.children,e("div",{css:i0,className:"controls",children:n.controls})]})}function To({children:n}){return e("div",{css:K`
        max-height: 300px;
        overflow-y: auto;
        padding: var(--ac-global-dimension-static-size-100)
          var(--ac-global-dimension-static-size-200);
      `,children:n})}function r0({getValue:n,collapseSingleKey:a}){const t=n();return e(To,{children:e(nt,{json:t,space:2,collapseSingleKey:a})})}function s0({isRunning:n,instanceVariables:a,datasetExampleInput:t}){const l=u.useMemo(()=>{const i=Hn(t)?t:{};return a.filter(r=>i[r]==null)},[t,a]);return n?e(ge,{}):l.length===0?null:e(ii,{children:`Missing input for variable${l.length>1?"s":""}: ${l.join(", ")}`})}function o0({exampleData:n,setDialog:a}){const{span:t,content:l,toolCalls:i,errorMessage:r,experimentRunId:o}=n,d=t!=null,c=o!=null,p=u.useMemo(()=>{if(d||c)return s(U,{children:[c&&s(me,{children:[e(A,{size:"S","aria-label":"View experiment run details",leadingVisual:e(L,{svg:e(Ja,{})}),onPress:()=>{u.startTransition(()=>{a(e(uh,{runId:o}))})}}),e(Ee,{children:"View run details"})]}),d&&e(U,{children:s(me,{children:[e(A,{size:"S","aria-label":"View run trace",leadingVisual:e(L,{svg:e(xt,{})}),onPress:()=>{u.startTransition(()=>{a(e(Co,{traceId:t.context.traceId,projectId:t.project.id,title:"Experiment Run Trace"}))})}}),e(Ee,{children:"View Trace"})]})})]})},[o,c,d,a,t]);return e(Ko,{controls:p,children:s(h,{direction:"column",gap:"size-200",children:[r!=null?e(ii,{children:r}):null,e(v,{children:l}),i!=null?Object.values(i).map(y=>y==null?null:e(Fo,{toolCall:y},y.id)):null,d?e(c0,{span:t}):null]})})}const d0=u.memo(function({isRunning:a,instanceId:t,exampleId:l,setDialog:i,instanceVariables:r,datasetExampleInput:o}){const d=va(c=>{var p;return(p=c.exampleResponsesMap[t])==null?void 0:p[l]});return d==null?e(s0,{isRunning:a,instanceVariables:r,datasetExampleInput:o}):e(o0,{exampleData:d,setDialog:i})});function c0({span:n}){return s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(na,{tokenCountTotal:n.tokenCountTotal||0,tokenCountPrompt:n.tokenCountPrompt||0,tokenCountCompletion:n.tokenCountCompletion||0}),e(Ve,{latencyMs:n.latencyMs||0})]})}function Po({table:n}){return e("tbody",{children:n.getRowModel().rows.map(a=>e("tr",{children:a.getVisibleCells().map(t=>e("td",{style:{padding:0,height:1,width:`calc(var(--col-${t.column.id}-size) * 1px)`,wordBreak:"break-all"},children:W(t.column.columnDef.cell,t.getContext())},t.id))},a.id))})}const u0=Ke.memo(Po,(n,a)=>n.table.options.data===a.table.options.data);function m0({datasetId:n}){const a=I.useRelayEnvironment(),t=$(V=>V.instances),l=$(V=>V.allInstanceMessages),i=$(V=>V.templateFormat),r=$(V=>V.updateInstance),o=va(V=>V.updateExampleData),d=va(V=>V.setExampleDataForInstance),c=va(V=>V.resetExampleData),p=va(V=>V.appendExampleDataToolCallChunk),y=va(V=>V.appendExampleDataTextChunk),[m,g]=u.useState(null),[,f]=fn(),k=t.some(V=>V.activeRunId!==null),b=xa(V=>V),S=$(V=>V.markPlaygroundInstanceComplete),F=ti(),P=Fe(),D=u.useCallback(V=>q=>{var we;if(q==null)return;const ee=q.chatCompletionOverDataset;switch(ee.__typename){case"ChatCompletionSubscriptionExperiment":r({instanceId:V,patch:{experimentId:ee.experiment.id},dirty:null});break;case"ChatCompletionSubscriptionResult":if(ee.datasetExampleId==null)return;o({instanceId:V,exampleId:ee.datasetExampleId,patch:{span:ee.span,experimentRunId:(we=ee.experimentRun)==null?void 0:we.id}});break;case"ChatCompletionSubscriptionError":if(ee.datasetExampleId==null)return;o({instanceId:V,exampleId:ee.datasetExampleId,patch:{errorMessage:ee.message}});break;case"TextChunk":if(ee.datasetExampleId==null)return;y({instanceId:V,exampleId:ee.datasetExampleId,textChunk:ee.content});break;case"ToolCallChunk":{if(ee.datasetExampleId==null)return;p({instanceId:V,exampleId:ee.datasetExampleId,toolCallChunk:ee});break}case"%other":return;default:return fe()}},[y,p,o,r]),[w]=I.useMutation(ao),T=u.useCallback(V=>(q,ee)=>{if(S(V),ee){P({title:"Chat completion failed",message:ee[0].message});return}r({instanceId:V,patch:{experimentId:q.chatCompletionOverDataset.experimentId},dirty:null}),d({instanceId:V,data:t0(q.chatCompletionOverDataset)})},[S,P,d,r]);u.useEffect(()=>{if(!k)return;const{instances:V,streaming:q,updateInstance:ee}=F.getState();if(c(),q){const we=[];for(const Ie of V){const{activeRunId:Gt}=Ie;if(ee({instanceId:Ie.id,patch:{experimentId:null},dirty:null}),Gt===null)continue;const Wt={input:Di({credentials:b,instanceId:Ie.id,playgroundStore:F,datasetId:n})},Jt={subscription:to,variables:Wt,onNext:D(Ie.id),onCompleted:()=>{S(Ie.id)},onError:ka=>{S(Ie.id);const Zt=Cr(ka);Zt!=null&&Zt.length>0?P({title:"Failed to get output",message:Zt.join(`
`),expireMs:1e4}):P({title:"Failed to get output",message:ka.message,expireMs:1e4})}},rt=et.requestSubscription(a,Jt);we.push(rt)}return()=>{for(const Ie of we)Ie.dispose()}}else{const we=[];for(const Ie of V){const{activeRunId:Gt}=Ie;if(Gt===null)continue;ee({instanceId:Ie.id,patch:{experimentId:null},dirty:null});const Wt={input:Di({credentials:b,instanceId:Ie.id,playgroundStore:F,datasetId:n})},Jt=w({variables:Wt,onCompleted:T(Ie.id),onError(rt){S(Ie.id);const ka=Ce(rt);ka!=null&&ka.length>0?P({title:"Failed to get output",message:ka.join(`
`),expireMs:1e4}):P({title:"Failed to get output",message:rt.message,expireMs:1e4})}});we.push(Jt)}return()=>{for(const Ie of we)Ie.dispose()}}},[b,n,a,w,k,S,P,T,D,F,c]);const{dataset:x}=I.useLazyLoadQuery(ro,{datasetId:n}),M=u.useRef(null),{data:R,loadNext:O,hasNext:N,isLoadingNext:j}=I.usePaginationFragment(io,x),Y=u.useMemo(()=>R.examples.edges.map(V=>{const q=V.example,ee=q.revision;return{id:q.id,input:ee.input,output:ee.output}}),[R]),se=u.useMemo(()=>t.map((V,q)=>{const ee=zt(V,l),we=us({instance:ee,templateFormat:i});return{id:`instance-${V.id}`,header:()=>s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Al,{index:q}),e("span",{children:"Output"})]}),cell:({row:Ie})=>e(d0,{instanceId:V.id,exampleId:Ie.original.id,isRunning:k,setDialog:g,instanceVariables:we,datasetExampleInput:Ie.original.input}),size:500}}),[k,t,i,l]),ye=[{header:"input",accessorKey:"input",cell:({row:V})=>e(Ko,{controls:s(me,{children:[e(A,{size:"S","aria-label":"View example details",leadingVisual:e(L,{svg:e(Ja,{})}),onPress:()=>{f(q=>(q.set("exampleId",V.original.id),q))}}),e(Ee,{children:"View Example"})]}),children:e(To,{children:e(nt,{json:V.original.input,disableTitle:!0,space:2,collapseSingleKey:!1})})}),size:200},{header:"reference output",accessorKey:"output",cell:V=>r0({...V,collapseSingleKey:!0}),size:200},...se],be=Te({columns:ye,data:Y,getCoreRowModel:Pe(),columnResizeMode:"onChange"}),$n=be.getRowModel().rows.length===0,_=u.useCallback(V=>{if(V){const{scrollHeight:q,scrollTop:ee,clientHeight:we}=V;q-ee-we<300&&!j&&N&&O(a0)}},[N,j,O]),z=Ke.useMemo(()=>{const V=be.getFlatHeaders(),q={};for(let ee=0;ee<V.length;ee++){const we=V[ee];q[`--header-${we.id}-size`]=we.getSize(),q[`--col-${we.column.id}-size`]=we.column.getSize()}return q},[be.getState().columnSizingInfo,be.getState().columnSizing,ye.length]);return s("div",{css:K`
        flex: 1 1 auto;
        overflow: auto;
        height: 100%;
      `,ref:M,onScroll:V=>_(V.target),children:[s("table",{css:K(tn,vr),style:{...z,width:be.getTotalSize(),minWidth:"100%"},children:[e("thead",{children:be.getHeaderGroups().map(V=>e("tr",{children:V.headers.map(q=>s("th",{style:{width:`calc(var(--header-${q==null?void 0:q.id}-size) * 1px)`},children:[e("div",{children:W(q.column.columnDef.header,q.getContext())}),e("div",{onMouseDown:q.getResizeHandler(),onTouchStart:q.getResizeHandler(),className:`resizer ${q.column.getIsResizing()?"isResizing":""}`})]},q.id))},V.id))}),$n?e(ln,{}):be.getState().columnSizingInfo.isResizingColumn?e(u0,{table:be}):e(Po,{table:be})]}),e(X,{isDismissable:!0,type:"slideOver",onDismiss:()=>{g(null)},children:m})]})}function p0({datasetId:n}){const a=$(o=>o.instances),t=a.some(o=>o.activeRunId!=null),l=u.useMemo(()=>a.map(o=>o.experimentId).filter(o=>o!=null),[a]),i=le(),r=I.useLazyLoadQuery(no,{datasetId:n});return s(h,{direction:"column",height:"100%",children:[e(C,{flex:"none",backgroundColor:"dark",paddingX:"size-200",paddingY:"size-100",borderBottomColor:"light",borderBottomWidth:"thin",height:50,children:s(h,{justifyContent:"space-between",alignItems:"center",height:"100%",children:[s(h,{gap:"size-100",children:[s(v,{children:[r.dataset.name??"Dataset"," results"]}),r.dataset.exampleCount!=null?s(v,{fontStyle:"italic",color:"text-700",children:[r.dataset.exampleCount," examples"]}):null]}),l.length>0&&s(A,{size:"S",isDisabled:t,leadingVisual:e(L,{svg:t?e(je,{}):e(Fr,{})}),onPress:()=>{i(`/datasets/${n}/compare?experimentId=${l.join("&experimentId=")}`)},children:["View Experiment",a.length>1?"s":""]})]})}),e(ch,{children:e(m0,{datasetId:n})})]})}const g0=()=>{const n=$(d=>d.input),a=$(d=>d.instances),t=$(d=>d.allInstanceMessages),l=$(d=>d.templateFormat),i=u.useMemo(()=>a.map(d=>zt(d,t)),[a,t]),{variableKeys:r,variablesMap:o}=u.useMemo(()=>ms({instances:i,templateFormat:l,input:n}),[n,i,l]);return{variableKeys:r,variablesMap:o}},y0={lineNumbers:!1,highlightActiveLine:!1,foldGutter:!1,highlightActiveLineGutter:!1,bracketMatching:!1,syntaxHighlighting:!1,defaultKeymap:!1},f0=[Zr.lineWrapping,Ul.of([...Rg.filter(n=>n.key!=="Mod-Enter")])],h0=({label:n,defaultValue:a,onChange:t})=>{const{theme:l}=Mn(),i=u.useRef(a),[r,o]=u.useState(0),[d,c]=u.useState(()=>a);return u.useEffect(()=>{a==null&&(c(""),o(y=>y+1)),i.current=a},[a]),u.useEffect(()=>{c(i.current),o(y=>y+1)},[n]),e(Yn,{label:n,children:e(Ue,{width:"100%",children:e(la,{theme:l==="light"?aa:ta,basicSetup:y0,value:d,extensions:f0,onChange:t},r)})})};function k0(){const{variableKeys:n,variablesMap:a}=g0(),t=$(i=>i.setVariableValue),l=$(i=>i.templateFormat);if(n.length===0){let i="";switch(l){case Je.FString:{i="{input name}";break}case Je.Mustache:{i="{{input name}}";break}case Je.NONE:return null;default:fe()}return e(C,{padding:"size-100",children:e(h,{direction:"column",justifyContent:"center",alignItems:"center",children:s(v,{color:"text-700",children:["Add variable inputs to your prompt using"," ",e(v,{color:"text-900",children:i})," within your prompt template."]})})})}return e(h,{direction:"column",gap:"size-200",width:"100%",children:n.map((i,r)=>e(h0,{label:i,defaultValue:a[i]??"",onChange:o=>t(i,o)},r))})}const Io=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"ChatCompletionMutationPayload",kind:"LinkedField",name:"chatCompletion",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"content",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorMessage",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"span",plural:!1,selections:[a],storageKey:null},{alias:null,args:null,concreteType:"ChatCompletionToolCall",kind:"LinkedField",name:"toolCalls",plural:!0,selections:[a,{alias:null,args:null,concreteType:"ChatCompletionFunctionCall",kind:"LinkedField",name:"function",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundOutputMutation",selections:t,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundOutputMutation",selections:t},params:{cacheID:"9dc63d3e40081b276c1cbd5f21405c6f",id:null,metadata:{},name:"PlaygroundOutputMutation",operationKind:"mutation",text:`mutation PlaygroundOutputMutation(
  $input: ChatCompletionInput!
) {
  chatCompletion(input: $input) {
    __typename
    content
    errorMessage
    span {
      id
    }
    toolCalls {
      id
      function {
        name
        arguments
      }
    }
  }
}
`}}}();Io.hash="085e7cb2bebd2c6c6e44b511364c6dd9";const xo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:null,kind:"LinkedField",name:"chatCompletion",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"content",storageKey:null}],type:"TextChunk",abstractKey:null},{kind:"InlineFragment",selections:[a,{alias:null,args:null,concreteType:"FunctionCallChunk",kind:"LinkedField",name:"function",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],type:"ToolCallChunk",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"span",plural:!1,selections:[a],storageKey:null}],type:"ChatCompletionSubscriptionResult",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null}],type:"ChatCompletionSubscriptionError",abstractKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundOutputSubscription",selections:t,type:"Subscription",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundOutputSubscription",selections:t},params:{cacheID:"aca7bf342ad2dc5db66b07e236a68268",id:null,metadata:{},name:"PlaygroundOutputSubscription",operationKind:"subscription",text:`subscription PlaygroundOutputSubscription(
  $input: ChatCompletionInput!
) {
  chatCompletion(input: $input) {
    __typename
    ... on TextChunk {
      content
    }
    ... on ToolCallChunk {
      id
      function {
        name
        arguments
      }
    }
    ... on ChatCompletionSubscriptionResult {
      span {
        id
      }
    }
    ... on ChatCompletionSubscriptionError {
      message
    }
  }
}
`}}}();xo.hash="bb5936a61a0e99dbb4a298a6e552a01c";const b0=({instance:n,outputContent:a,toolCalls:t,cleanupOutput:l})=>{const i=n.id,r=$(o=>o.addMessage);return s(me,{delay:500,offset:10,children:[e(A,{size:"S",leadingVisual:e(L,{svg:e(kn,{})}),"aria-label":"Move the output message to the end of the prompt",onPress:()=>{if(n.template.__type!=="chat")return;const o=Array.isArray(a)?a:a?[{id:Bn(),role:jn("ai"),content:a}]:[];t.length>0&&o.push({id:Bn(),role:jn("ai"),toolCalls:Kr({provider:n.model.provider,toolCalls:t.map(d=>{var c;return{...d,function:{...d.function,arguments:((c=Le(d.function.arguments))==null?void 0:c.json)??d.function.arguments}}})})}),r({playgroundInstanceId:i,messages:o}),l()},children:"Prompt"}),e(Ee,{children:"Move the output message to the end of the prompt"})]})},Do=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"spanId"}],a=[{kind:"Variable",name:"id",variableName:"spanId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null}],type:"Span",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"RunMetadataFooterQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,l],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"RunMetadataFooterQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,l],storageKey:null}]},params:{cacheID:"447ee90c4f55ded6a8a64e73fc30c065",id:null,metadata:{},name:"RunMetadataFooterQuery",operationKind:"query",text:`query RunMetadataFooterQuery(
  $spanId: GlobalID!
) {
  span: node(id: $spanId) {
    __typename
    id
    ... on Span {
      spanId
      trace {
        id
        traceId
        project {
          id
        }
      }
      tokenCountCompletion
      tokenCountPrompt
      tokenCountTotal
      latencyMs
    }
  }
}
`}}}();Do.hash="d8025b7f870ac81e2d1e3249bb818186";function S0({spanId:n}){const[a,t]=u.useState(null),l=I.useLazyLoadQuery(Do,{spanId:n},{fetchPolicy:"store-and-network"});if(!l.span||!l.span.trace||!l.span.trace.project)return null;const{trace:i}=l.span;return s(C,{borderTopColor:"light",borderTopWidth:"thin",paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",children:[s(h,{direction:"row",gap:"size-200",justifyContent:"space-between",children:[s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(na,{tokenCountTotal:l.span.tokenCountTotal||0,tokenCountPrompt:l.span.tokenCountPrompt||0,tokenCountCompletion:l.span.tokenCountCompletion||0}),e(Ve,{latencyMs:l.span.latencyMs||0})]}),s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(A,{size:"S",leadingVisual:e(L,{svg:e(It,{})}),onPress:()=>t(e(hr,{spanNodeId:n,projectId:i.project.id})),children:"Annotate"}),e(A,{size:"S",leadingVisual:e(L,{svg:e(xt,{})}),onPress:()=>{u.startTransition(()=>{t(e(u.Suspense,{children:e(Co,{traceId:i.traceId,projectId:i.project.id,title:"Playground Trace"})}))})},children:"View Trace"})]})]}),e(X,{type:"slideOver",isDismissable:!0,onDismiss:()=>t(null),children:a})]})}function v0({index:n,title:a}){return s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Al,{index:n}),e("span",{children:a})]})}const C0=n=>Hn(n)&&(typeof n.id=="string"||typeof n.id=="number")?n.id:JSON.stringify(n);function Ni({message:n}){const{role:a,content:t,toolCalls:l}=n,i=lt(a);return s(Q,{title:a,...i,variant:"compact",extra:e(gn,{}),children:[t!=null&&!Array.isArray(t)&&e(wa,{children:t}),l&&l.length>0?l.map(r=>e(Fo,{toolCall:r},C0(r))):null]})}function F0({content:n,partialToolCalls:a}){return Ky(n)?n.map((t,l)=>e(Ni,{message:t},l)):typeof n=="string"||a.length>0?e(Ni,{message:{id:Bn(),content:n,role:"ai",toolCalls:a}}):"click run to see output"}function K0(n){const a=n.playgroundInstanceId,t=$(N=>N.instances),l=$(N=>N.streaming),i=xa(N=>N),r=$(N=>N.instances.findIndex(j=>j.id===a)),o=t.find(N=>N.id===a),d=$(N=>N.updateInstance),[c,p]=u.useState(null),y=$(N=>N.markPlaygroundInstanceComplete),m=I.useRelayEnvironment(),g=ti();if(!o)throw new Error(`No instance found for id ${a}`);if(o.template.__type!=="chat")throw new Error("We only support chat templates for now");const[f,k]=u.useState(!1),[b]=I.useMutation(Io),S=(o==null?void 0:o.activeRunId)!=null,F=Fe(),P=u.useCallback(({title:N,message:j,...Y})=>{p({title:N,message:j}),F({title:N,message:j,...Y})},[F]),[D,w]=u.useState(o.output),[T,x]=u.useState([]),M=u.useCallback(({chatCompletion:N})=>{if(k(!1),N.__typename==="TextChunk"){const j=N.content;w(Y=>Y!=null?Y+j:j);return}else if(N.__typename==="ToolCallChunk"){x(j=>{let Y=!1;const se=j.map(ye=>ye.id===N.id?(Y=!0,{...ye,function:{...ye.function,arguments:ye.function.arguments+N.function.arguments}}):ye);return Y||se.push({id:N.id,function:{name:N.function.name,arguments:N.function.arguments}}),se});return}if(N.__typename==="ChatCompletionSubscriptionResult"&&N.span!=null){d({instanceId:a,patch:{spanId:N.span.id},dirty:null});return}N.__typename==="ChatCompletionSubscriptionError"&&(y(n.playgroundInstanceId),N.message!=null&&P({title:"Chat completion failed",message:N.message}))},[a,y,P,n.playgroundInstanceId,d]),R=u.useCallback((N,j)=>{if(k(!1),y(n.playgroundInstanceId),d({instanceId:a,patch:{spanId:N.chatCompletion.span.id},dirty:null}),j){P({title:"Chat completion failed",message:j[0].message});return}if(N.chatCompletion.errorMessage!=null){P({title:"Chat completion failed",message:N.chatCompletion.errorMessage});return}w(N.chatCompletion.content??void 0),x(N.chatCompletion.toolCalls)},[a,y,P,n.playgroundInstanceId,d]),O=u.useCallback(()=>{w(void 0),x([]),p(null),d({instanceId:a,patch:{spanId:null},dirty:null})},[a,d]);return u.useEffect(()=>{if(!S){k(!1);return}k(!0),O();const N=wy({playgroundStore:g,instanceId:a,credentials:i});if(l){const Y={subscription:xo,variables:{input:N},onNext:ye=>{ye&&M(ye)},onCompleted:()=>{k(!1),y(n.playgroundInstanceId)},onError:ye=>{k(!1),y(n.playgroundInstanceId);const be=Cr(ye);be!=null&&be.length>0?P({title:"Failed to get output",message:be.join(`
`)}):P({title:"Failed to get output",message:ye.message})}};return et.requestSubscription(m,Y).dispose}return b({variables:{input:N},onCompleted:R,onError(Y){k(!1),y(n.playgroundInstanceId);const se=Ce(Y);se!=null&&se.length>0?P({title:"Failed to get output",message:se.join(`
`)}):P({title:"Failed to get output",message:Y.message})}}).dispose},[O,i,m,b,S,a,y,P,R,M,g,n.playgroundInstanceId,l,d]),e(Q,{title:e(v0,{index:r,title:"Output"}),extra:D!=null||(T==null?void 0:T.length)>0?e(b0,{outputContent:D,toolCalls:T,instance:o,cleanupOutput:O}):null,titleSeparator:!0,collapsible:!0,variant:"compact",bodyStyle:{padding:0},children:f?e(C,{padding:"size-200",children:e(ge,{message:"Running..."})}):c?e(C,{padding:"size-200",children:e(ii,{children:c.message})}):s(U,{children:[e(C,{padding:"size-200",children:e(an,{children:e(F0,{content:D,partialToolCalls:T})})}),e(u.Suspense,{children:o.spanId?e(S0,{spanId:o.spanId}):null})]})})}function T0(){return u.useMemo(()=>window.navigator.userAgent.toLowerCase().includes("mac")?"Cmd":"Ctrl",[])}function P0(){const n=T0(),a=$(r=>r.runPlaygroundInstances),t=$(r=>r.cancelPlaygroundInstances),l=$(r=>r.instances.some(o=>o.activeRunId!=null)),i=u.useCallback(()=>{l?t():a()},[l,t,a]);return am("mod+enter",r=>{r.preventDefault(),r.stopPropagation(),i()},{enableOnFormTags:!0,enableOnContentEditable:!0,preventDefault:!0}),e(A,{variant:"primary",leadingVisual:e(L,{svg:l?e(je,{}):e(fa,{})}),size:"S",onPress:()=>{i()},trailingVisual:s(Fp,{children:[e(ml,{children:n}),e("span",{"aria-hidden":"true",children:n==="Cmd"?"":"Ctrl"}),e(ml,{children:"enter"}),e("span",{"aria-hidden":"true",children:""})]}),children:l?"Cancel":"Run"})}function I0(){const n=$(i=>i.streaming),a=$(i=>i.setStreaming),t=Ge(i=>i.setPlaygroundStreamingEnabled),l=$(i=>i.instances.some(r=>r.activeRunId!=null));return window.Config.websocketsEnabled===!1?null:e(ya,{labelPlacement:"start",isSelected:n,onChange:()=>{a(!n),t(!n)},isDisabled:l,children:"Stream"})}const _o=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"Prompt",kind:"LinkedField",name:"createChatPromptVersion",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"UpsertPromptFromTemplateDialogUpdateMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"UpsertPromptFromTemplateDialogUpdateMutation",selections:a},params:{cacheID:"5560d38314208ef482b716e9817358fe",id:null,metadata:{},name:"UpsertPromptFromTemplateDialogUpdateMutation",operationKind:"mutation",text:`mutation UpsertPromptFromTemplateDialogUpdateMutation(
  $input: CreateChatPromptVersionInput!
) {
  createChatPromptVersion(input: $input) {
    id
    name
  }
}
`}}}();_o.hash="96205130072396cb213f4fa790a7a6b1";const Lo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"Prompt",kind:"LinkedField",name:"createChatPrompt",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"UpsertPromptFromTemplateDialogCreateMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"UpsertPromptFromTemplateDialogCreateMutation",selections:a},params:{cacheID:"73d9d27e0df3bc27e4af4dd3d77f41fb",id:null,metadata:{},name:"UpsertPromptFromTemplateDialogCreateMutation",operationKind:"mutation",text:`mutation UpsertPromptFromTemplateDialogCreateMutation(
  $input: CreateChatPromptInput!
) {
  createChatPrompt(input: $input) {
    id
    name
  }
}
`}}}();Lo.hash="fa52cba6c2bfaa6298a5360253dc9bc5";const wo=function(){var n=[{alias:null,args:null,concreteType:"PromptConnection",kind:"LinkedField",name:"prompts",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SavePromptFormQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"SavePromptFormQuery",selections:n},params:{cacheID:"654725a48bf8fb568b8e05fd37696920",id:null,metadata:{},name:"SavePromptFormQuery",operationKind:"query",text:`query SavePromptFormQuery {
  prompts {
    edges {
      prompt: node {
        id
        name
      }
    }
  }
}
`}}}();wo.hash="a9d184ea6bad7c7ff3b15460ce72b9fd";const Eo=function(){var n=[{alias:null,args:null,concreteType:"PromptConnection",kind:"LinkedField",name:"prompts",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptComboBoxQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"PromptComboBoxQuery",selections:n},params:{cacheID:"72f4804265380881fdc62b5d8e66bb8b",id:null,metadata:{},name:"PromptComboBoxQuery",operationKind:"query",text:`query PromptComboBoxQuery {
  prompts {
    edges {
      prompt: node {
        __typename
        id
        name
      }
    }
  }
}
`}}}();Eo.hash="1acc413e40da1ea527fb431f10b46cf2";function Mo({onChange:n,container:a,promptId:t,...l}){const r=I.useLazyLoadQuery(Eo,{},{fetchPolicy:"store-and-network",fetchKey:t??void 0}).prompts.edges,o=u.useMemo(()=>r.map(d=>d.prompt),[r]);return e(zl,{size:"M","data-testid":"prompt-picker",selectedKey:t??null,"aria-label":"prompt picker",width:"100%",menuTrigger:"focus",stopPropagation:!0,container:a,defaultItems:o,placeholder:"Select a prompt...",renderEmptyState:()=>e("div",{children:"No prompts found"}),onSelectionChange:d=>{if(!(typeof d!="string"&&d!=null)){if(d===t){n(null);return}n(d)}},...l,children:d=>e(Nl,{textValue:d.name,id:d.id,children:d.name},d.id)})}const x0=/^[a-z0-9]([_a-z0-9-]*[a-z0-9])?$/,Vo={value:x0,message:"Invalid identifier. Must be alphanumeric and with dashes or underscores"};function D0({onCreate:n,onUpdate:a,isSubmitting:t=!1,defaultSelectedPromptId:l}){var D,w,T,x;const i=u.useRef(null),r=I.useLazyLoadQuery(wo,{},{fetchPolicy:"network-only"}),[o,d]=u.useState(l??null),c=(w=(D=r==null?void 0:r.prompts)==null?void 0:D.edges)==null?void 0:w.find(M=>{var R;return((R=M==null?void 0:M.prompt)==null?void 0:R.id)===o}),[p,y]=u.useState(((T=c==null?void 0:c.prompt)==null?void 0:T.name)??""),m=c?"update":"create",g=m==="create"?"Create Prompt":"Update Prompt",{control:f,handleSubmit:k,formState:{isDirty:b,isValid:S},trigger:F}=Ae({values:{promptId:o??void 0,name:m==="update"&&c?(x=c==null?void 0:c.prompt)==null?void 0:x.name:p},defaultValues:{description:""},reValidateMode:"onChange",resetOptions:{keepDefaultValues:!0}}),P=u.useCallback(M=>{m==="create"?n(M):a(M)},[n,a,m]);return s(h,{direction:"column",gap:"size-100",ref:i,children:[e(C,{paddingX:"size-200",paddingTop:"size-200",children:e(H,{name:"name",control:f,rules:{required:{message:"Prompt is required",value:!0},pattern:Vo},render:({field:{onBlur:M,onChange:R},fieldState:O})=>{var N;return e(Mo,{label:"Prompt",description:"The prompt to update, or prompt name to create",placeholder:"Select or enter new prompt name",isRequired:!0,onBlur:M,defaultInputValue:p,onInputChange:j=>{y(j),R(j),F("name")},container:i.current??void 0,errorMessage:(N=O.error)==null?void 0:N.message,allowsCustomValue:!0,onChange:j=>{R(j),d(j)},promptId:o})}})}),s(Ye,{onSubmit:k(P),children:[e(C,{paddingX:"size-200",paddingBottom:"size-200",children:e(H,{name:"description",control:f,render:({field:{onChange:M,onBlur:R,value:O},fieldState:{invalid:N,error:j}})=>s(J,{isInvalid:N,onChange:M,onBlur:R,value:O,size:"S",children:[e(G,{children:m==="create"?"Prompt Description":"Change Description"}),e(pa,{}),j?e(ve,{children:j.message}):e(v,{slot:"description",children:m==="create"?"A description of your prompt (optional)":"A description of your changes to the prompt (optional)"})]})})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",children:e(A,{variant:b?"primary":"default",size:"S",isDisabled:t||!S,type:"submit",children:g})})})]})]})}const zi=(n,a)=>{const t=a.getState(),l=t.allInstanceMessages,i=t.instances.find(c=>c.id===n);if(!i)throw new Error(`Instance ${n} not found`);const r=zt(i,l),o=Qf(r);if(!o)throw new Error(`Could not convert instance ${n} to prompt`);const d=t.templateFormat;return{promptInput:o,templateFormat:d}},_0=({instanceId:n,setDialog:a,selectedPromptId:t})=>{const l=le(),i=ke(),r=Fe(),o=ti(),[d,c]=I.useMutation(Lo),[p,y]=I.useMutation(_o),m=u.useCallback((k,b)=>{const S=o.getState();S.instances.find(P=>P.id===n)&&S.updateInstance({instanceId:n,patch:{prompt:{id:k,name:b}},dirty:!1})},[o,n]),g=u.useCallback(k=>{const{promptInput:b,templateFormat:S}=zi(n,o);d({variables:{input:{name:k.name,description:k.description,promptVersion:{...b,templateFormat:S}}},onCompleted:F=>{i({title:"Prompt successfully created",action:{text:"View Prompt",onClick:()=>{l(`/prompts/${F.createChatPrompt.id}`)}}}),m(F.createChatPrompt.id,F.createChatPrompt.name),a(null)},onError:F=>{const P=Ce(F);r({title:"Error creating prompt",message:P==null?void 0:P[0]}),a(null)}})},[d,n,l,r,i,m,a,o]),f=u.useCallback(k=>{if(!k.promptId)throw new Error("Prompt ID is required");const{promptInput:b,templateFormat:S}=zi(n,o);p({variables:{input:{promptId:k.promptId,promptVersion:{...b,templateFormat:S,description:k.description}}},onCompleted:F=>{i({title:"Prompt successfully updated",action:{text:"View Prompt",onClick:()=>{l(`/prompts/${F.createChatPromptVersion.id}`)}}}),m(F.createChatPromptVersion.id,F.createChatPromptVersion.name),a(null)},onError:F=>{const P=Ce(F);r({title:"Error updating prompt",message:P==null?void 0:P[0]}),a(null)}})},[n,l,r,i,a,o,p,m]);return e(Z,{title:"Create Prompt from Template",children:e(u.Suspense,{fallback:e(ge,{}),children:e(D0,{onCreate:g,onUpdate:f,isSubmitting:c||y,defaultSelectedPromptId:t})})})},Ro={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ModelConfigButtonDialogQuery",selections:[{args:null,kind:"FragmentSpread",name:"ModelProviderPickerFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"ModelConfigButtonDialogQuery",selections:[{alias:null,args:null,concreteType:"GenerativeProvider",kind:"LinkedField",name:"modelProviders",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependenciesInstalled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependencies",storageKey:null}],storageKey:null}]},params:{cacheID:"64ad561d3ca07bdded6af274c73eb18a",id:null,metadata:{},name:"ModelConfigButtonDialogQuery",operationKind:"query",text:`query ModelConfigButtonDialogQuery {
  ...ModelProviderPickerFragment
}

fragment ModelProviderPickerFragment on Query {
  modelProviders {
    key
    name
    dependenciesInstalled
    dependencies
  }
}
`}};Ro.hash="4b1b96842c19ea5721b7fcf1cdb86426";const Ba=1024,L0=E.object({type:E.literal("enabled"),budget_tokens:E.number().min(Ba)}),w0=({onChange:n,value:a})=>{const[t,l]=u.useState(0),r=L0.safeParse(a).data,o=u.useRef(r==null?void 0:r.budget_tokens),d=p=>{n(p?{type:"enabled",budget_tokens:o.current||Ba}:null)},c=p=>{const y=p!=null&&!isNaN(p);o.current=y?p:Ba,n({type:"enabled",budget_tokens:o.current}),y||l(m=>m+1)};return s(U,{children:[e(ya,{onChange:d,isSelected:(r==null?void 0:r.type)==="enabled",children:"Thinking Enabled"}),(r==null?void 0:r.type)==="enabled"&&s(Tr,{value:r==null?void 0:r.budget_tokens,onChange:c,isDisabled:(r==null?void 0:r.type)!=="enabled",isRequired:!0,defaultValue:Ba,minValue:Ba,children:[e(G,{children:"Budget Tokens"}),e(ne,{}),e(v,{slot:"description",children:"Determines how many tokens Claude can use for its internal reasoning process. Must be 1024 and less than max_tokens."})]},t)]})};function E0({defaultValue:n,onChange:a,label:t,errorMessage:l}){const[i,r]=u.useState(n==null?"":In(n).json??""),o=u.useCallback(d=>{r(d);const{json:c}=Le(d);c==null&&d!==""||a(c)},[a]);return e("div",{css:K`
        & .ac-view {
          width: 100%;
        }
      `,children:e(Yn,{label:t,errorMessage:l,validationState:l?"invalid":void 0,children:e(Ue,{children:e(Qe,{value:i,onChange:o,optionalLint:!0})})})})}const M0=({field:n,value:a,onChange:t,errors:l,control:i})=>{var m;const r=n.invocationName;if(!r)throw new Error("Invocation name is required");const o=(m=l[r])==null?void 0:m.message,d=n.required?`${n.label||r} is required`:void 0,c=n.minValue!=null?`${n.label||r} must be at least ${n.minValue}`:void 0,p=n.maxValue!=null?`${n.label||r} must be at most ${n.maxValue}`:void 0;if(n.canonicalName==="ANTHROPIC_EXTENDED_THINKING")return e(w0,{onChange:t,value:a});const{__typename:y}=n;switch(y){case"InvocationParameterBase":return null;case"BoundedFloatInvocationParameter":return typeof a!="number"&&a!==void 0?null:e(Tp,{label:n.label,defaultValue:a,step:.1,minValue:n.minValue,maxValue:n.maxValue,onChange:g=>t(g),children:e(Kp,{})});case"FloatInvocationParameter":case"IntInvocationParameter":return e(H,{control:i,name:r,rules:{required:d,min:c,max:p},render:({field:{onBlur:g}})=>s(Tr,{isRequired:n.required,value:Number(a),onBlur:g,onChange:f=>{t(f)},children:[e(G,{children:n.label}),e(ne,{}),o?e(ve,{children:o}):null]})});case"StringListInvocationParameter":return!Array.isArray(a)&&a!==void 0?null:e(H,{control:i,name:r,rules:{required:d},render:({field:{onBlur:g}})=>s(J,{isRequired:n.required,defaultValue:(a==null?void 0:a.join(", "))??"",onBlur:g,onChange:f=>{if(f===""){t(void 0);return}t(f.split(/, */g))},children:[e(G,{children:n.label}),e(ne,{}),o?e(ve,{children:o}):e(v,{slot:"description",children:"A comma separated list of strings"})]})});case"StringInvocationParameter":return e(H,{control:i,name:r,rules:{required:d},render:({field:{onBlur:g}})=>s(J,{isRequired:n.required,defaultValue:(a==null?void 0:a.toString())||"",type:"text",onBlur:g,onChange:f=>{if(f===""){t(void 0);return}t(f)},children:[e(G,{children:n.label}),e(ne,{}),o?e(ve,{children:o}):null]})});case"BooleanInvocationParameter":return e(ya,{onChange:t,defaultSelected:!!a,children:n.label});case"JSONInvocationParameter":return e(H,{control:i,name:r,rules:{required:d},render:()=>e(E0,{defaultValue:a,onChange:t,label:n.label??n.invocationName??"",errorMessage:o})});default:return null}},V0=(n,a)=>{if(n.invocationInputField===void 0)throw new Error("Invocation input field is required");return a[Ra(n.invocationInputField)]},R0=(n,a)=>{if(n.invocationName===void 0)throw new Error("Invocation name is required");if(n.invocationInputField===void 0)throw new Error("Invocation input field is required");return{invocationName:n.invocationName,canonicalName:n.canonicalName,[Ra(n.invocationInputField)]:a}},A0=({instanceId:n})=>{const a=$(f=>f.instances.find(k=>k.id===n));if(!a)throw new Error("Instance not found");const{model:t}=a,l=$(f=>f.upsertInvocationParameterInput),i=$(f=>f.deleteInvocationParameterInput),r=a.model.supportedInvocationParameters,o=a.model.invocationParameters,d=u.useCallback((f,k)=>{if(!f.invocationName)throw new Error("Invocation name is required");k===void 0?i({instanceId:n,invocationParameterInputInvocationName:f.invocationName}):l({instanceId:n,invocationParameterInput:R0(f,k)})},[n,l,i]),c=u.useMemo(()=>r.filter(f=>!(f.canonicalName!=null&&Wg.includes(f.canonicalName))).reduce((f,k)=>{const b=o.find(F=>Wn(F,k)),S=b?V0(k,b):void 0;return{...f,[k.invocationName]:S??null}},{}),[o,r]),p=Ae({values:c,mode:"onBlur",delayError:0,shouldFocusError:!1,resetOptions:{keepErrors:!0}}),y=p.trigger,m=u.useMemo(()=>on.debounce(y,250),[y]);return u.useEffect(()=>{m()},[c,m]),t.provider!=="AZURE_OPENAI"&&t.modelName===null?null:Object.entries(c).map(([f,k])=>{const b=r.find(F=>F.invocationName===f);if(!b)return null;const S=`${t.provider??"model"}-${b.invocationName}`;return e(M0,{field:b,value:k,onChange:F=>d(b,F),control:p.control,errors:p.formState.errors},S)})},si=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"providerKey"}],a=[{alias:null,args:[{fields:[{kind:"Variable",name:"providerKey",variableName:"providerKey"}],kind:"ObjectValue",name:"input"}],concreteType:"GenerativeModel",kind:"LinkedField",name:"models",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ModelComboBoxQuery",selections:a,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ModelComboBoxQuery",selections:a},params:{cacheID:"a3417a3b2ae9ad193a5fd68335cfd660",id:null,metadata:{},name:"ModelComboBoxQuery",operationKind:"query",text:`query ModelComboBoxQuery(
  $providerKey: GenerativeProviderKey!
) {
  models(input: {providerKey: $providerKey}) {
    name
  }
}
`}}}();si.hash="fc5563c6dca10fdeda807cd7061e275a";function N0({onChange:n,container:a,modelName:t,queryReference:l,...i}){const r=I.usePreloadedQuery(si,l),o=u.useMemo(()=>r.models.map(m=>({name:m.name,id:m.name})),[r.models]),[d,c]=u.useState({selectedKey:t??null,inputValue:t??""}),p=m=>{if(typeof m=="string"){const g=o.find(f=>f.id===m);(g==null?void 0:g.name)!=null&&n(g.name)}},y=m=>{c(g=>({inputValue:m,selectedKey:g.selectedKey}))};return u.useEffect(()=>{c({selectedKey:t??null,inputValue:t??""})},[t]),e(zl,{size:"L",label:"Model",isRequired:!0,"data-testid":"model-picker",selectedKey:d.selectedKey,"aria-label":"model picker",onInputChange:y,inputValue:d.inputValue,onSelectionChange:p,width:"100%",allowsCustomValue:!0,onBlur:()=>{d.inputValue!==""&&n(d.inputValue)},onKeyUp:m=>{m.key==="Enter"&&n(d.inputValue)},menuTrigger:"focus",container:a,description:"Choose a model from the list, or enter a custom model name",defaultItems:o,...i,children:m=>e(Nl,{textValue:m.name,id:m.id,children:m.name},m.id)})}function Ao(n){const[a,t,l]=I.useQueryLoader(si);return u.useEffect(()=>(t({providerKey:n.provider}),()=>l()),[l,t,n.provider]),a!=null?e(N0,{queryReference:a,...n}):null}const No={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ModelProviderPickerFragment",selections:[{alias:null,args:null,concreteType:"GenerativeProvider",kind:"LinkedField",name:"modelProviders",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependenciesInstalled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependencies",storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};No.hash="1d4ba7f81a958c9a17bd45dce0456ddb";function z0(n){return n==="OPENAI"||n==="AZURE_OPENAI"||n==="ANTHROPIC"||n==="GOOGLE"}function $0({onChange:n,query:a,...t}){var d,c;const l=I.useFragment(No,a),i=l.modelProviders.filter(p=>p.dependenciesInstalled),r=i.length!==l.modelProviders.length,o=t.provider&&!i.some(p=>p.key===t.provider);return s(h,{direction:"row",gap:"size-100",children:[e(Fl,{label:"Provider","data-testid":"model-provider-picker",selectedKey:t.provider??void 0,"aria-label":"Model Provider",placeholder:"Select a provider",onSelectionChange:p=>{const y=p;z0(y)&&n(y)},width:"100%",...t,children:l.modelProviders.map(p=>e(re,{children:s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e($l,{provider:p.key,height:16}),p.name]})},p.key))}),o?s(me,{delay:0,offset:5,children:[e("span",{children:e($e,{children:e(L,{color:"red-700",svg:e(xn,{})})})}),s(Ee,{children:["The selected provider is not installed. Install"," ",((c=(d=l.modelProviders.find(p=>p.key===t.provider))==null?void 0:d.dependencies)==null?void 0:c.join(", "))??"the dependencies"," ","to use its models in Playground."]})]}):r?s(me,{delay:0,offset:5,children:[e("span",{children:e($e,{children:e(L,{svg:e(xn,{})})})}),s(Ee,{children:["Some providers are missing dependencies. Install them to use their models in Playground.",e("br",{}),e("br",{}),"Missing providers:",e("br",{}),l.modelProviders.filter(p=>!p.dependenciesInstalled).map(p=>{var y;return s(U,{children:[((y=p.dependencies)==null?void 0:y.join(", "))??p.name,e("br",{})]})})]})]}):null]})}const O0=150,Q0=K`
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-size-200);
  .ac-field,
  .ac-dropdown,
  .ac-dropdown-button,
  .ac-slider {
    width: 100%;
  }
  // Makes the filled slider track blue
  .ac-slider-controls > .ac-slider-track:first-child::before {
    background: var(--ac-global-color-primary);
  }
  padding: var(--ac-global-dimension-size-200);
  overflow: auto;
`;function j0({instance:n,container:a}){const t=$(r=>r.updateModel),l=u.useCallback(({configKey:r,value:o})=>{t({instanceId:n.id,patch:{...n.model,[r]:o}})},[n.id,n.model,t]),i=u.useMemo(()=>tr(r=>{l({configKey:"modelName",value:r})},250),[l]);return s(U,{children:[e(Ao,{modelName:n.model.modelName,provider:n.model.provider,onChange:r=>{i(r)},container:a??void 0}),s(J,{defaultValue:n.model.baseUrl??"",onChange:r=>{l({configKey:"baseUrl",value:r})},children:[e(G,{children:"Base URL"}),e(ne,{placeholder:"e.x. https://my-llm.com/v1"})]})]})}function q0({instance:n}){const a=$(i=>i.updateModel),t=u.useCallback(({configKey:i,value:r})=>{a({instanceId:n.id,patch:{...n.model,[i]:r}})},[n.id,n.model,a]),l=u.useMemo(()=>tr(i=>{t({configKey:"modelName",value:i})},250),[t]);return s(U,{children:[s(J,{defaultValue:n.model.modelName??"",onChange:i=>{l(i)},children:[e(G,{children:"Deployment Name"}),e(ne,{placeholder:"e.x. azure-openai-deployment-name"})]}),s(J,{defaultValue:n.model.endpoint??"",onChange:i=>{t({configKey:"endpoint",value:i})},children:[e(G,{children:"Endpoint"}),e(ne,{placeholder:"e.x. https://my.openai.azure.com"})]}),e(zl,{size:"L",label:"API Version","data-testid":"azure-api-version-combobox",selectedKey:n.model.apiVersion??void 0,"aria-label":"api version picker",placeholder:"Select an AzureOpenAI API Version",inputValue:n.model.apiVersion??"",onInputChange:i=>{t({configKey:"apiVersion",value:i})},onSelectionChange:i=>{typeof i=="string"&&t({configKey:"apiVersion",value:i})},allowsCustomValue:!0,children:Pp.map(i=>e(Nl,{textValue:i,id:i,children:i},i))})]})}function B0(n){const[a,t]=u.useState(null),l=$(d=>d.instances.find(c=>c.id===n.playgroundInstanceId));if(!l)throw new Error(`Playground instance ${n.playgroundInstanceId} not found`);const i=l.model.supportedInvocationParameters,r=l.model.invocationParameters,o=ys(r,i);return s(u.Fragment,{children:[e(A,{size:"S",onPress:()=>{u.startTransition(()=>{t(e(U0,{...n}))})},leadingVisual:e($l,{provider:l.model.provider,height:16}),children:s(h,{direction:"row",gap:"size-100",alignItems:"center",height:"100%",children:[e(Wa,{maxWidth:O0,children:e(v,{children:l.model.modelName||"--"})}),o?null:s(me,{delay:0,offset:5,children:[e("span",{children:e($e,{children:e(L,{color:"danger",svg:e(xn,{})})})}),e(Ee,{children:"Some required invocation parameters are not configured."})]})]})}),e(X,{type:"slideOver",isDismissable:!0,onDismiss:()=>{t(null)},children:a})]})}function U0(n){const a=$(r=>r.instances.find(o=>o.id===n.playgroundInstanceId));if(!a)throw new Error(`Playground instance ${n.playgroundInstanceId} not found`);const t=Ge(r=>r.setModelConfigForProvider),l=ke(),i=u.useCallback(()=>{const{supportedInvocationParameters:r,...o}=a.model;t({provider:a.model.provider,modelConfig:o}),l({title:"Model Configuration Saved",message:`${ul[a.model.provider]} model configuration saved as default for later use.`,expireMs:3e3})},[a.model,l,t]);return e(Z,{title:"Model Configuration",size:"M",extra:s(me,{delay:0,offset:5,children:[e(A,{size:"S",variant:"default",onPress:i,leadingVisual:e(L,{svg:e(gr,{})}),children:"Save as Default"}),s(Ee,{children:["Saves the current configuration as the default for"," ",ul[a.model.provider]??"this provider","."]})]}),children:e(u.Suspense,{children:e(H0,{...n})})})}function H0(n){const{playgroundInstanceId:a}=n,t=$(f=>f.instances.find(k=>k.id===a));if(!t)throw new Error(`Playground instance ${n.playgroundInstanceId} not found`);const l=Ge(f=>f.modelConfigByProvider),i=$(f=>f.updateProvider),r=$(f=>f.updateModel),o=t.model.supportedInvocationParameters,d=t.model.invocationParameters,c=ys(d,o),p=I.useLazyLoadQuery(Ro,{}),y=u.useCallback(f=>{r({instanceId:a,patch:{modelName:f}})},[a,r]),[m,g]=u.useState();return s("form",{css:Q0,children:[c?null:s(h,{direction:"row",gap:"size-100",children:[e(L,{color:"danger",svg:e(xn,{})}),e(v,{color:"danger",children:"Some required invocation parameters are not configured."})]}),e($0,{provider:t.model.provider,query:p,onChange:f=>{i({instanceId:a,provider:f,modelConfigByProvider:l})}}),t.model.provider==="OPENAI"?e(j0,{instance:t,container:m??null}):t.model.provider==="AZURE_OPENAI"?e(q0,{instance:t}):e(Ao,{modelName:t.model.modelName,provider:t.model.provider,onChange:y,container:m??void 0}),e(u.Suspense,{children:e(A0,{instanceId:a})}),e("div",{ref:g})]})}const zo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"invocationInputField",storageKey:null},t={alias:"floatDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},l=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:null,kind:"LinkedField",name:"modelInvocationParameters",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"canonicalName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"required",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null}],type:"InvocationParameterBase",abstractKey:"__isInvocationParameterBase"},{kind:"InlineFragment",selections:[{alias:"booleanDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"BooleanInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[t,a,{alias:null,args:null,kind:"ScalarField",name:"minValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxValue",storageKey:null}],type:"BoundedFloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[t,a],type:"FloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"intDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"IntInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"jsonDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"JSONInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"stringDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"StringInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"stringListDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"StringListInvocationParameter",abstractKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ModelSupportedParamsFetcherQuery",selections:l,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ModelSupportedParamsFetcherQuery",selections:l},params:{cacheID:"8f18509b17f3f97c2413ef8b6557d972",id:null,metadata:{},name:"ModelSupportedParamsFetcherQuery",operationKind:"query",text:`query ModelSupportedParamsFetcherQuery(
  $input: ModelsInput!
) {
  modelInvocationParameters(input: $input) {
    __typename
    ... on InvocationParameterBase {
      __isInvocationParameterBase: __typename
      invocationName
      canonicalName
      required
      label
    }
    ... on BooleanInvocationParameter {
      booleanDefaultValue: defaultValue
      invocationInputField
    }
    ... on BoundedFloatInvocationParameter {
      floatDefaultValue: defaultValue
      invocationInputField
      minValue
      maxValue
    }
    ... on FloatInvocationParameter {
      floatDefaultValue: defaultValue
      invocationInputField
    }
    ... on IntInvocationParameter {
      intDefaultValue: defaultValue
      invocationInputField
    }
    ... on JSONInvocationParameter {
      jsonDefaultValue: defaultValue
      invocationInputField
    }
    ... on StringInvocationParameter {
      stringDefaultValue: defaultValue
      invocationInputField
    }
    ... on StringListInvocationParameter {
      stringListDefaultValue: defaultValue
      invocationInputField
    }
  }
}
`}}}();zo.hash="8bf1a32724929bdc4a02d32809ba59d7";const G0=({instanceId:n})=>{var p;const t=$(y=>y.instances).find(y=>y.id===n);if(!t)throw new Error("Instance not found");const l=t.model.provider,i=t.model.modelName,r=Ge(y=>y.modelConfigByProvider),o=$(y=>y.updateModelSupportedInvocationParameters),{modelInvocationParameters:d}=I.useLazyLoadQuery(zo,{input:{providerKey:l,modelName:i}}),c=(p=t.prompt)==null?void 0:p.id;return u.useEffect(()=>{o({instanceId:n,supportedInvocationParameters:d,modelConfigByProvider:r})},[d,n,o,r,c]),null},$o=n=>a=>a.instances.find(t=>t.id===n),Oo=n=>a=>a.allInstanceMessages[n];function W0({playgroundInstanceId:n,messageId:a}){const t=u.useMemo(()=>$o(n),[n]),l=$(t);if(l==null)throw new Error(`Instance ${n} not found`);const i=u.useMemo(()=>Oo(a),[a]),r=$(i);if(r==null)throw new Error(`Message ${a} not found`);const o=r.toolCalls,d=$(k=>k.updateMessage),[c,p]=u.useState(()=>JSON.stringify(o,null,2)),[y,m]=u.useState(o);u.useEffect(()=>{JSON.stringify(o)!==JSON.stringify(y)&&(p(JSON.stringify(o,null,2)),m(o))},[y,o]);const g=u.useCallback(k=>{p(k);const{json:b}=Le(k);if(b==null)return;const{success:S}=Ip.safeParse(b);S&&(m(b),d({instanceId:n,messageId:a,patch:{toolCalls:b}}))},[n,a,d]),f=u.useMemo(()=>{switch(l.model.provider){case"OPENAI":case"AZURE_OPENAI":return Dp;case"ANTHROPIC":return xp;case"GOOGLE":return null}},[l.model.provider]);return e(Qe,{value:c,jsonSchema:f,onChange:g})}function J0(n){return n==="text"||n==="toolCalls"}function Z0({messageMode:n,onChange:a}){return s(Ol,{selectedKeys:[n],"aria-label":"Message Mode",onSelectionChange:t=>{if(t.size===0)return;const l=t.keys().next().value;J0(l)&&a(l)},children:[s(me,{placement:"top",delay:0,offset:10,children:[e(da,{"aria-label":"text input",id:"text",children:e(L,{svg:e(Dl,{})})}),e(Ee,{children:"Text input"})]}),s(me,{placement:"top",delay:0,offset:10,children:[e(da,{"aria-label":"tool calling",id:"toolCalls",children:e(L,{svg:e(Ft,{})})}),e(Ee,{children:"Tool calling"})]})]})}const X0=K`
  .ac-field-label {
    display: none;
  }
`;function Y0({role:n,includeLabel:a=!0,onChange:t}){return s(Fl,{selectedKey:n,css:a?void 0:X0,label:"Role","data-testid":"messages-role-picker","aria-label":"Role for the chat message",size:"compact",onSelectionChange:l=>{if(!os(l))throw new Error(`Invalid chat message role: ${l}`);t(l)},children:[e(re,{children:"System"},"system"),e(re,{children:"User"},"user"),e(re,{children:"AI"},"ai"),e(re,{children:"Tool"},"tool")]})}const e1=32;function n1({instanceId:n,hasResponseFormat:a}){const t=$(m=>m.instances),l=$(m=>m.updateInstance),i=$(m=>m.addMessage),r=$(m=>m.upsertInvocationParameterInput),o=t.find(m=>m.id===n);if(!o)throw new Error(`Playground instance ${n} not found`);const{template:d}=o;if(d.__type!=="chat")throw new Error(`Invalid template type ${d.__type}`);const c=o.model.supportedInvocationParameters,p=c==null?void 0:c.some(m=>Wn(m,{canonicalName:Dn,invocationName:Kn})),y=c==null?void 0:c.some(m=>Wn(m,{canonicalName:Un,invocationName:Pa}));return s(h,{direction:"row",justifyContent:"end",gap:"size-100",minHeight:e1,children:[p?e(A,{size:"S","aria-label":"response format",leadingVisual:e(L,{svg:e(Ha,{})}),isDisabled:a,onPress:()=>{r({instanceId:n,invocationParameterInput:{valueJson:_p(),invocationName:Kn,canonicalName:Dn}})},children:"Response Format"}):null,y?e(A,{"aria-label":"add tool",size:"S",leadingVisual:e(L,{svg:e(Ha,{})}),onPress:()=>{const m={tools:[...o.tools,xy({provider:o.model.provider,toolNumber:o.tools.length+1})]};if(o.tools.length===0){const g=xl({toolChoice:"auto",targetProvider:o.model.provider});g&&(m.toolChoice=g)}l({instanceId:n,patch:m,dirty:!0})},children:"Tool"}):null,e(A,{"aria-label":"add message",size:"S",leadingVisual:e(L,{svg:e(Ha,{})}),onPress:()=>{i({playgroundInstanceId:n,messages:[{id:Bn(),role:"user",content:""}]})},children:"Message"})]})}const a1=400;function t1({playgroundInstanceId:n}){const a=$(c=>c.deleteInvocationParameterInput),t=$(c=>c.instances.find(p=>p.id===n)),l=$(c=>c.upsertInvocationParameterInput);if(!t)throw new Error(`Instance ${n} not found`);const i=t.model.invocationParameters.find(c=>c.invocationName===Kn||c.canonicalName===Dn),[r]=u.useState(JSON.stringify((i==null?void 0:i.valueJson)??{},null,2)),o=u.useRef(r),d=u.useCallback(c=>{o.current=c;const{json:p}=Le(c);if(p==null)return;const{success:y}=Gl.safeParse(p);y&&l({instanceId:n,invocationParameterInput:{invocationName:Kn,valueJson:p,canonicalName:Dn}})},[n,l]);return s(ce,{id:"response-format",children:[e(oe,{arrowPosition:"start",children:"Response Format"}),e(de,{children:e(C,{padding:"size-200",children:e(Q,{variant:"compact",title:"Schema",bodyStyle:{padding:0},extra:s(h,{direction:"row",gap:"size-100",children:[e(ie,{text:o}),e(A,{"aria-label":"Delete Response Format",leadingVisual:e(L,{svg:e(We,{})}),size:"S",onPress:()=>{a({instanceId:n,invocationParameterInputInvocationName:Kn})}})]}),children:e(Pr,{preInitializationMinHeight:a1,children:e(Qe,{value:r,onChange:d,jsonSchema:dy})})})})})]})}const l1=400;function i1({playgroundInstanceId:n,toolId:a}){const[t,l]=u.useState(0),i=$(S=>S.updateInstance),r=$(S=>S.instances.find(F=>F.id===n));if(r==null)throw new Error(`Playground instance ${n} not found`);const o=r.tools,d=o.find(S=>S.id===a);if(d==null)throw new Error(`Tool ${a} not found`);const[c,p]=u.useState(JSON.stringify(d.definition,null,2)),y=u.useRef(c),[m,g]=u.useState(d.definition);u.useEffect(()=>{JSON.stringify(d.definition)!==JSON.stringify(m)&&(g(d.definition),p(JSON.stringify(d.definition,null,2)),l(S=>S+1))},[d.definition,m]);const f=u.useCallback(S=>{y.current=S;const{json:F}=Le(S);if(F==null)return;const{success:P}=sr.safeParse(F);P&&(g(F),i({instanceId:n,patch:{tools:o.map(D=>D.id===d.id?{...D,definition:F}:D)},dirty:!0}))},[o,n,d.id,i]),k=u.useMemo(()=>ps(d),[d]),b=u.useMemo(()=>{switch(r.model.provider){case"OPENAI":case"AZURE_OPENAI":return wp;case"ANTHROPIC":return Lp;case"GOOGLE":return null}},[r.model.provider]);return e(Q,{collapsible:!0,backgroundColor:"yellow-100",borderColor:"yellow-700",variant:"compact",title:s(h,{direction:"row",gap:"size-100",children:[e(Ml,{spanKind:"tool"}),e(v,{children:k??"Tool"})]}),bodyStyle:{padding:0},extra:s(h,{direction:"row",gap:"size-100",children:[e(ie,{text:y}),e(A,{"aria-label":"Delete tool",leadingVisual:e(L,{svg:e(We,{})}),size:"S",onPress:()=>{const S=o.filter(D=>D.id!==d.id),F=typeof r.toolChoice=="object"&&k!=null&&Ep(r.toolChoice)===k;let P=r.toolChoice;S.length===0?P=void 0:F&&(P="auto"),i({instanceId:n,patch:{tools:S,toolChoice:P},dirty:!0})}})]}),children:e(Pr,{preInitializationMinHeight:l1,children:e(Qe,{value:c,onChange:f,jsonSchema:b},t)})})}function r1(n){const a=n.playgroundInstanceId,t=$(d=>d.instances.find(c=>c.id===n.playgroundInstanceId)),l=$(d=>d.updateInstance);if(t==null)throw new Error(`Playground instance ${a} not found`);const{tools:i}=t;if(i==null)throw new Error(`Playground instance ${a} does not have tools`);const r=u.useMemo(()=>i.map(d=>ps(d)).filter(d=>d!=null),[i]),o=t.model.provider;return Mp(o)?s(ce,{id:"tools",children:[s(oe,{arrowPosition:"start",children:["Tools",e(dn,{variant:"light",children:i.length})]}),e(de,{children:e(C,{padding:"size-200",children:s(h,{direction:"column",children:[e(St,{children:e(Vp,{provider:o,choice:t.toolChoice,onChange:d=>{l({instanceId:a,patch:{toolChoice:d},dirty:!0})},toolNames:r})}),e(h,{direction:"column",gap:"size-200",children:i.map(d=>e(i1,{playgroundInstanceId:a,toolId:d.id},d.id))})]})})})]}):null}const Qo=1,s1=Qo+1;function o1(n){const a=n.playgroundInstanceId,t=$(m=>m.templateFormat),l=$(m=>m.updateInstance),i=u.useMemo(()=>$o(a),[a]),r=$(i);if(!r)throw new Error(`Playground instance ${a} not found`);const o=r.tools.length>0,d=r.model.invocationParameters.find(m=>Wn(m,{canonicalName:Dn,invocationName:Kn}))!=null,{template:c}=r;if(c.__type!=="chat")throw new Error(`Invalid template type ${c.__type}`);const p=c.messageIds,y=tm(fi(dm),fi(om,{coordinateGetter:sm}));return s(rm,{sensors:y,onDragEnd:({active:m,over:g})=>{if(!g||m.id===g.id)return;const f=p.findIndex(S=>S===m.id),k=p.findIndex(S=>S===g.id),b=im(p,f,k);l({instanceId:a,patch:{template:{__type:"chat",messageIds:b}},dirty:!0})},children:[e(lm,{items:p,children:e("ul",{css:K`
            display: flex;
            flex-direction: column;
            gap: var(--ac-global-dimension-size-200);
            padding: var(--ac-global-dimension-size-200);
          `,children:p.map(m=>e(c1,{playgroundInstanceId:a,templateFormat:t,messageId:m},m))})}),e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderColor:"dark",borderTopWidth:"thin",borderBottomWidth:o||d?"thin":void 0,children:e(n1,{instanceId:a,hasResponseFormat:d})}),o||d?s(en,{defaultExpandedKeys:["tools","response-format"],children:[o?e(r1,{...n}):null,d?e(t1,{...n}):null]}):null]})}function d1({message:n,updateMessage:a,templateFormat:t,playgroundInstanceId:l,messageMode:i}){const r=u.useCallback(o=>{a({content:o})},[a]);if(i==="toolCalls")return e(C,{paddingTop:"size-100",paddingStart:"size-250",paddingEnd:"size-250",paddingBottom:"size-200",children:e(Yn,{label:"Tool Calls",children:e(Ue,{width:"100%",children:e(W0,{playgroundInstanceId:l,messageId:n.id})})})});if(n.role==="tool"){const o=$t(n.content);return s(St,{onSubmit:d=>{d.preventDefault()},children:[e(C,{paddingX:"size-200",paddingY:"size-100",borderColor:"yellow-700",borderBottomWidth:"thin",children:e(J,{value:n.toolCallId,onChange:d=>a({toolCallId:d}),"aria-label":"Tool Call ID",size:"S",children:e(ne,{placeholder:"Tool Call ID"})})}),e(Qe,{value:o,"aria-label":"tool message content",height:"100%",onChange:d=>a({content:d}),onBlur:()=>{if(n.content!=null&&typeof n.content=="string"){const{json:d}=Le(n.content);a({content:JSON.stringify(d,null,2)})}}})]})}return e(Kt,{children:e(Tt,{height:"100%",defaultValue:n.content||"","aria-label":"Message content",templateFormat:t,onChange:r,placeholder:n.role==="system"?"You are a helpful assistant":n.role==="ai"?"Hello, how can I help you today?":"What is the weather in San Francisco?"})})}function c1({playgroundInstanceId:n,templateFormat:a,messageId:t}){const l=$(N=>N.updateMessage),i=$(N=>N.deleteMessage),{attributes:r,listeners:o,setNodeRef:d,transform:c,transition:p,setActivatorNodeRef:y,isDragging:m}=cm({id:t}),g=u.useMemo(()=>N=>{var j;return(j=N.instances.find(Y=>Y.id===n))==null?void 0:j.model},[n]),f=$(g);if(!f)throw new Error(`Instance model not found for instance ${n}`);const k=u.useMemo(()=>Oo(t),[t]),b=$(k),S=lt(b.role),F={transform:um.Translate.toString(c),transition:p,zIndex:m?s1:Qo},P=b.toolCalls!=null&&b.toolCalls.length>0,[D,w]=u.useState(P?"toolCalls":"text"),[T,x]=u.useState(b.content),[M,R]=u.useState(b.toolCalls),O=u.useCallback(N=>{l({instanceId:n,messageId:t,patch:N})},[n,t,l]);return e("li",{ref:d,style:F,children:e(Q,{collapsible:!0,variant:"compact",bodyStyle:{padding:0},...S,title:e("div",{css:K`
              // Align the role picker with the prompt picker in PlaygroundTemplate header
              margin-left: var(--ac-global-dimension-size-150);
            `,children:e(Y0,{includeLabel:!1,role:b.role,onChange:N=>{let j=b.toolCalls;N!=="ai"&&(j=void 0,w("text")),l({instanceId:n,messageId:t,patch:{role:N,toolCalls:j}})}})}),extra:s(h,{direction:"row",gap:"size-100",children:[b.role==="ai"?e(Z0,{messageMode:D,onChange:N=>{switch(w(N),N){case"text":R(b.toolCalls),l({instanceId:n,messageId:t,patch:{content:T,toolCalls:void 0}});break;case"toolCalls":x(b.content),l({instanceId:n,messageId:t,patch:{content:"",toolCalls:M!=null?Kr({toolCalls:M,provider:f.provider}):[Dy(f.provider)]}});break;default:fe()}}}):null,e(ie,{text:D==="toolCalls"?JSON.stringify(b.toolCalls):$t(b.content)}),e(A,{"aria-label":"Delete message",leadingVisual:e(L,{svg:e(We,{})}),size:"S",onPress:()=>{i({instanceId:n,messageId:t})}}),e(Rp,{ref:y,listeners:o,attributes:r})]}),children:e("div",{children:e(d1,{message:b,messageMode:D,playgroundInstanceId:n,templateFormat:a,updateMessage:O})})})})}function u1(n){const[a,t]=u.useState(null),l=n.playgroundInstanceId,i=$(b=>b.updateInstance),r=$(b=>b.addMessage),o=$(b=>b.setDirty),d=$(b=>b.instances),c=d.find(b=>b.id===l),p=d.findIndex(b=>b.id===l),y=c==null?void 0:c.prompt,m=y==null?void 0:y.id,g=c==null?void 0:c.dirty,f=u.useCallback(async b=>{if(!b){i({instanceId:l,patch:{prompt:null},dirty:!1});return}const S=await Ws(b);S&&(i({instanceId:l,patch:{...S.instance,template:{__type:"chat",messageIds:[]}},dirty:!1}),r({playgroundInstanceId:l,messages:S.instance.template.messages}),o(l,!1))},[l,i,r,o]);if(!c)throw new Error(`Playground instance ${l} not found`);const{template:k}=c;return s(U,{children:[e(Q,{title:s(h,{direction:"row",gap:"size-100",alignItems:"center",marginEnd:"size-100",children:[e(Al,{index:p}),e(Mo,{promptId:m,onChange:f})]}),collapsible:!0,variant:"compact",bodyStyle:{padding:0},extra:s(h,{direction:"row",gap:"size-100",children:[e(u.Suspense,{fallback:e("div",{children:e(ge,{size:"S"})}),children:e(G0,{instanceId:l})}),e(B0,{...n}),e(p1,{instanceId:l,setDialog:t,dirty:g}),d.length>1?e(m1,{...n}):null]}),children:k.__type==="chat"?e(u.Suspense,{children:e(o1,{...n})}):"Completion Template"}),e(X,{isDismissable:!0,onDismiss:()=>{t(null)},children:a})]})}function m1(n){const a=$(t=>t.deleteInstance);return s(me,{children:[e($e,{children:e(A,{size:"S","aria-label":"Delete this instance of the playground",leadingVisual:e(L,{svg:e(We,{})}),onPress:()=>{a(n.playgroundInstanceId)}})}),e(Ee,{children:e(Xn,{children:"Delete this instance of the playground"})})]})}function p1({instanceId:n,setDialog:a,dirty:t}){const l=$(r=>r.instances.find(o=>o.id===n));if(!l)throw new Error(`Instance ${n} not found`);return e(U,{children:s(me,{delay:100,offset:5,placement:"top",children:[e($e,{children:e(A,{variant:t?"primary":void 0,size:"S",onPress:()=>{var r;a(e(_0,{instanceId:n,setDialog:a,selectedPromptId:(r=l.prompt)==null?void 0:r.id}))},children:"Save"})}),e(Ee,{children:e(Xn,{children:"Save this prompt"})})]})})}function g1({size:n}){const a=$(l=>l.templateFormat),t=$(l=>l.setTemplateFormat);return e("div",{css:K`
        & * {
          white-space: nowrap;
        }
      `,children:s(Ol,{size:n,defaultSelectedKeys:[a],"aria-label":"Template Format",onSelectionChange:l=>{if(l.size===0)return;const i=l.keys().next().value;typeof i=="string"&&Ap(i)&&t(i)},children:[e(da,{"aria-label":"None",id:Je.NONE,children:"None"}),e(da,{"aria-label":"Mustache",id:Je.Mustache,children:"Mustache"}),e(da,{"aria-label":"F-String",id:Je.FString,children:"F-String"})]})})}const y1=K`
  display: flex;
  overflow: hidden;
  flex-direction: column;
  height: 100%;
`;function oi(n){const{modelProviders:a}=I.useLazyLoadQuery(Js,{}),t=Ge(c=>c.modelConfigByProvider),l=Ge(c=>c.playgroundStreamingEnabled),[,i]=fn(),r=a.some(c=>c.dependenciesInstalled);u.useEffect(()=>{i(c=>(c.delete("selectedSpanNodeId"),c),{replace:!0})},[i]);const o=window.Config.websocketsEnabled?l:!1,d=window.Config.websocketsEnabled;return r?s(Gf,{...n,streaming:o,modelConfigByProvider:t,children:[s("div",{css:y1,children:[e(C,{borderBottomColor:"dark",borderBottomWidth:"thin",padding:"size-200",flex:"none",children:s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(te,{level:1,children:"Playground"}),s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[d?e(I0,{}):null,e(oh,{}),e(rh,{}),e(P0,{})]})]})}),e(F1,{})]}),e(u.Suspense,{children:e(nh,{})})]}):e(lh,{availableProviders:a})}function f1(){const n=$(i=>i.addInstance),a=$(i=>i.instances),t=a.length,l=a.some(i=>i.activeRunId!=null);return e(A,{size:"S","aria-label":"add prompt",leadingVisual:e(L,{svg:e(kn,{})}),isDisabled:t>=Ng||l,onPress:()=>{n()},children:"Compare"})}const h1=K`
  display: flex;
  flex-direction: column;
  height: 100%;
  overflow: hidden;
  & > .ac-disclosure-group {
    display: flex;
    flex-direction: column;
    height: 100%;
    overflow: hidden;
    flex: 1 1 auto;
    & > .ac-disclosure {
      height: 100%;
      display: flex;
      flex-direction: column;
      overflow-x: hidden;
      overflow-y: auto;
      flex: 1 1 auto;
      // prevent the accordion item header from growing to fill the accordion item
      // using two selectors as fallback just incase the component lib changes subtly
      & > [role="button"],
      & > #prompts-heading {
        flex: 0 0 auto;
      }
      .ac-disclosure-panel {
        height: 100%;
        overflow: hidden;
        flex: 1 1 auto;
      }
    }
  }
`,k1=K`
  padding: var(--ac-global-dimension-size-200);
  scrollbar-gutter: stable;
  height: 100%;
  flex: 1 1 auto;
  overflow: auto;
  box-sizing: border-box;
`,b1=K`
  height: 100%;
  overflow: auto;
`,S1=632,v1=["prompts"],C1=["input","output"];function F1(){const n=$(m=>m.instances),a=$(m=>m.templateFormat),[t]=fn(),l=t.get("datasetId"),i=l!=null,o=n.length===1,d=n.some(m=>m.activeRunId!=null),c=n.filter(m=>m.prompt).some(m=>m.dirty),p=u.useCallback(({currentLocation:m,nextLocation:g})=>{const f=m.pathname!==g.pathname;return(d||c)&&f},[d,c]),y=mm(p);return u.useEffect(()=>{const m=d,g=f=>{f.preventDefault(),f.returnValue=!0};if(m)return window.addEventListener("beforeunload",g),()=>{window.removeEventListener("beforeunload",g)}},[d]),s(u.Fragment,{children:[s(Pn,{direction:o&&!i?"horizontal":"vertical",autoSaveId:o?"playground-horizontal":"playground-vertical",children:[e(_e,{children:e("div",{css:h1,children:e(en,{defaultExpandedKeys:v1,children:s(ce,{id:"prompts",size:"L",children:[s(oe,{arrowPosition:"start",justifyContent:"space-between",children:["Prompts",e(wt,{children:s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(g1,{size:"S"}),e(f1,{})]})})]}),e(de,{children:e("div",{css:k1,children:e(h,{direction:"row",gap:"size-200",maxWidth:"100%",children:n.map(m=>e(C,{flex:"1 1 0px",minWidth:S1,children:e(u1,{playgroundInstanceId:m.id})},`${m.id}-prompt`))})})})]})})})}),e(Tn,{css:Rl}),e(_e,{children:i?e(u.Suspense,{fallback:e(ge,{}),children:e(p0,{datasetId:l})}):e("div",{css:b1,children:s(en,{defaultExpandedKeys:C1,children:[a!==Je.NONE?s(ce,{id:"input",size:"L",children:[e(oe,{arrowPosition:"start",children:"Inputs"}),e(de,{children:e(C,{padding:"size-200",height:"100%",children:e(k0,{})})})]}):null,s(ce,{id:"output",size:"L",children:[e(oe,{arrowPosition:"start",children:"Output"}),e(de,{children:e(C,{padding:"size-200",height:"100%",children:e(h,{direction:"row",gap:"size-200",children:n.map(m=>e(C,{flex:"1 1 0px",children:e(K0,{playgroundInstanceId:m.id})},`${m.id}-output`))})})})]})]})})})]}),y!=null&&e(Np,{blocker:y,message:d?"Playground run is still in progress, leaving the page may result in incomplete runs. Are you sure you want to leave?":"You have unsaved changes. Are you sure you want to leave?"})]},"playground-content")}function f2(){const{instanceWithPrompt:n,templateFormat:a}=Be(),{instance:t}=u.useMemo(()=>{const{instance:l}=or();return{instance:{...l,...n,template:n.template}}},[n]);return e(oi,{instances:[t],templateFormat:a})}const jo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"},{defaultValue:null,kind:"LocalArgument",name:"promptId"}],a=[{kind:"Variable",name:"input",variableName:"input"}],t=[{kind:"Variable",name:"id",variableName:"promptId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"TagPromptVersionButtonSetTagMutation",selections:[{alias:null,args:a,concreteType:"PromptVersionTagMutationPayload",kind:"LinkedField",name:"setPromptVersionTag",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:"prompt",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"PromptVersionsList__main"}],type:"Prompt",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"TagPromptVersionButtonSetTagMutation",selections:[{alias:null,args:a,concreteType:"PromptVersionTagMutationPayload",kind:"LinkedField",name:"setPromptVersionTag",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:"prompt",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},l],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"8fb2730b63a6d441fbac8e5f5a438c9b",id:null,metadata:{},name:"TagPromptVersionButtonSetTagMutation",operationKind:"mutation",text:`mutation TagPromptVersionButtonSetTagMutation(
  $input: SetPromptVersionTagInput!
  $promptId: GlobalID!
) {
  setPromptVersionTag(input: $input) {
    query {
      prompt: node(id: $promptId) {
        __typename
        ... on Prompt {
          ...PromptVersionsList__main
        }
        __isNode: __typename
        id
      }
    }
  }
}

fragment PromptVersionSummaryFragment on PromptVersion {
  id
  description
  sequenceNumber
  createdAt
  user {
    id
    username
    profilePictureUrl
  }
  ...PromptVersionTagsList_data
}

fragment PromptVersionTagsList_data on PromptVersion {
  tags {
    id
    name
  }
}

fragment PromptVersionsList__main on Prompt {
  promptVersions {
    edges {
      version: node {
        id
        ...PromptVersionSummaryFragment
      }
    }
  }
}
`}}}();jo.hash="6d6be37ba7956dbb351980e05b62cac1";const qo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"promptId"},{defaultValue:null,kind:"LocalArgument",name:"versionId"}],a=[{kind:"Variable",name:"id",variableName:"promptId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],i={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"versionTags",plural:!0,selections:l,storageKey:null}],type:"Prompt",abstractKey:null},r=[{kind:"Variable",name:"id",variableName:"versionId"}],o={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:l,storageKey:null}],type:"PromptVersion",abstractKey:null},d={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},c={kind:"TypeDiscriminator",abstractKey:"__isNode"};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"TagPromptVersionButtonTagsQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i],storageKey:null},{alias:"promptVersion",args:r,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[o],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"TagPromptVersionButtonTagsQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[d,i,c,t],storageKey:null},{alias:"promptVersion",args:r,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[d,o,c,t],storageKey:null}]},params:{cacheID:"51965c86ef2f0e2192aed200cd90bef9",id:null,metadata:{},name:"TagPromptVersionButtonTagsQuery",operationKind:"query",text:`query TagPromptVersionButtonTagsQuery(
  $promptId: GlobalID!
  $versionId: GlobalID!
) {
  prompt: node(id: $promptId) {
    __typename
    ... on Prompt {
      versionTags {
        id
        name
      }
    }
    __isNode: __typename
    id
  }
  promptVersion: node(id: $versionId) {
    __typename
    ... on PromptVersion {
      tags {
        id
        name
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();qo.hash="62f9ce0c869fb321ed64215c26ee5e56";const Bo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"},{defaultValue:null,kind:"LocalArgument",name:"promptVersionId"}],a=[{kind:"Variable",name:"input",variableName:"input"}],t=[{kind:"Variable",name:"id",variableName:"promptVersionId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"NewPromptVersionTagDialogMutation",selections:[{alias:null,args:a,concreteType:"PromptVersionTagMutationPayload",kind:"LinkedField",name:"setPromptVersionTag",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"PromptVersionTagsList_data"}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"NewPromptVersionTagDialogMutation",selections:[{alias:null,args:a,concreteType:"PromptVersionTagMutationPayload",kind:"LinkedField",name:"setPromptVersionTag",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],type:"PromptVersion",abstractKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},l],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"f649353c182b494e5d15015c95ecc083",id:null,metadata:{},name:"NewPromptVersionTagDialogMutation",operationKind:"mutation",text:`mutation NewPromptVersionTagDialogMutation(
  $input: SetPromptVersionTagInput!
  $promptVersionId: GlobalID!
) {
  setPromptVersionTag(input: $input) {
    query {
      node(id: $promptVersionId) {
        __typename
        ...PromptVersionTagsList_data
        __isNode: __typename
        id
      }
    }
  }
}

fragment PromptVersionTagsList_data on PromptVersion {
  tags {
    id
    name
  }
}
`}}}();Bo.hash="c057a8cd7cddac787f887e505ff0f9e6";function K1({onNewTagCreated:n,promptVersionId:a,onDismiss:t}){const{control:l,handleSubmit:i,formState:{isDirty:r}}=Ae({defaultValues:{name:"",description:""}}),[o,d]=Ke.useState(null),[c,p]=I.useMutation(Bo);return e(X,{onDismiss:t,isDismissable:!0,type:"modal",children:s(Z,{title:"New Prompt Tag",children:[o?e(pe,{variant:"danger",banner:!0,children:o}):null,s(Ye,{onSubmit:i(m=>{d(null),c({variables:{input:{name:m.name,description:m.description,promptVersionId:a},promptVersionId:a},onCompleted:()=>{n(m),t()},onError:g=>{d(g.message)}})}),children:[s(C,{padding:"size-200",children:[e(H,{name:"name",control:l,rules:{required:"Name is required",pattern:Vo},render:({field:{name:m,onChange:g,onBlur:f,value:k},fieldState:{invalid:b,error:S}})=>s(J,{isInvalid:b,onChange:g,onBlur:f,name:m,value:k.toString(),children:[e(G,{children:"Tag Name"}),e(ne,{placeholder:"e.x. prod"}),S!=null&&S.message?e(ve,{children:S.message}):e(v,{slot:"description",children:"The identifier of the tag"})]})}),e(H,{name:"description",control:l,render:({field:{name:m,onChange:g,onBlur:f,value:k},fieldState:{invalid:b,error:S}})=>s(J,{isInvalid:b,onChange:g,name:m,onBlur:f,value:k.toString(),children:[e(G,{children:"Description"}),e(pa,{placeholder:"A description of the tag"}),S!=null&&S.message?e(ve,{children:S.message}):e(v,{slot:"description",children:"A description of the tag (optional)"})]})})]}),e(C,{paddingX:"size-200",paddingY:"size-100",borderTopColor:"dark",borderTopWidth:"thin",children:e(h,{gap:"size-100",justifyContent:"end",children:e(A,{variant:r?"primary":"default",size:"S",type:"submit",isDisabled:p,children:"Create Tag"})})})]})]})})}function T1(){const[n,a]=u.useState(!1),[t,l]=u.useState(0),i=ke(),{promptId:r,versionId:o}=qe();if(!r)throw new Error("Expected promptId to be defined");if(!o)throw new Error("Expected versionId to be defined");return s("div",{children:[s(hl,{children:[e(A,{size:"S",leadingVisual:e(L,{svg:e(zp,{})}),children:"Tag Version"}),s(Ir,{placement:"bottom end",children:[e(xr,{}),s(fl,{children:[e(u.Suspense,{fallback:e(C,{padding:"size-100",children:e(ge,{size:"S"})}),children:e(P1,{promptId:r,versionId:o,fetchKey:t,onTagSet:d=>{l(c=>c+1),i({title:"Tag Set",message:`The tag ${d} has been set on the version`})}})}),e(C,{padding:"size-100",width:"250px",children:e(A,{leadingVisual:e(L,{svg:e(Ha,{})}),size:"S",css:K`
                  width: 100%;
                `,onPress:()=>a(!0),children:"New Tag"})})]})]})]}),n&&e(K1,{promptVersionId:o,onDismiss:()=>a(!1),onNewTagCreated:d=>{l(c=>c+1),i({title:"Tag Created",message:`The tag ${d.name} has been created and been set on the version`})}})]})}function P1({promptId:n,versionId:a,fetchKey:t,onTagSet:l}){var y,m;const i=I.useLazyLoadQuery(qo,{promptId:n,versionId:a},{fetchKey:t,fetchPolicy:"store-and-network"}),r=u.useMemo(()=>{var g,f;return((f=(g=i==null?void 0:i.prompt)==null?void 0:g.versionTags)==null?void 0:f.map(k=>k.name))||[]},[(y=i==null?void 0:i.prompt)==null?void 0:y.versionTags]),o=u.useMemo(()=>{var g,f;return((f=(g=i==null?void 0:i.promptVersion)==null?void 0:g.tags)==null?void 0:f.map(k=>k.name))||[]},[(m=i==null?void 0:i.promptVersion)==null?void 0:m.tags]),d=u.useMemo(()=>Array.from(new Set([...Si.map(g=>g.name),...r])),[r]),[c,p]=I.useMutation(jo);return e("ul",{children:d.map(g=>{const f=o.includes(g);return e("li",{children:e(C,{paddingY:"size-100",paddingX:"size-200",borderBottomColor:"light",borderBottomWidth:"thin",children:s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e("input",{type:"checkbox",name:g,checked:f,disabled:f||p,onChange:k=>{if(k.target.checked){const b=!o.includes(g);let S="";if(b){const F=Si.find(P=>P.name===g);S=(F==null?void 0:F.description)||""}c({variables:{input:{name:g,promptVersionId:a,description:S},promptId:n},onCompleted:()=>{l(g)}})}}}),e("span",{children:g})]})})},g)})})}function h2(){const{promptVersion:n}=Be();return e(I1,{promptVersion:n})}function I1({promptVersion:n}){return e(C,{width:"100%",overflow:"auto",elementType:"section",children:e(C,{padding:"size-200",width:"100%",overflow:"auto",children:s(h,{direction:"column",gap:"size-200",maxWidth:900,marginStart:"auto",marginEnd:"auto",children:[s(h,{direction:"row",justifyContent:"space-between",children:[s(h,{direction:"row",gap:"size-100",children:[e(te,{level:2,children:`Version: ${n.id}`}),e(js,{promptVersion:n})]}),s(h,{direction:"row",gap:"size-100",children:[e(ie,{text:n.id,children:"Version ID"}),e(T1,{})]})]}),e(Ms,{promptVersion:n}),e(Is,{promptVersion:n}),e(zs,{promptVersion:n})]})})})}const Uo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"invocationParameters",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"modelName",storageKey:null},d=[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],c={alias:null,args:null,concreteType:"ToolDefinition",kind:"LinkedField",name:"tools",plural:!0,selections:d,storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"toolCallId",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"promptVersionLoaderQuery",selections:[{alias:"promptVersion",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,l,{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"PromptInvocationParameters__main"},{args:null,kind:"FragmentSpread",name:"PromptChatMessagesCard__main"},{args:null,kind:"FragmentSpread",name:"PromptCodeExportCard__main"},{args:null,kind:"FragmentSpread",name:"PromptModelConfigurationCard__main"},{args:null,kind:"FragmentSpread",name:"PromptVersionTagsList_data"},i,r,o,c,{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[p],storageKey:null}],type:"PromptVersion",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"promptVersionLoaderQuery",selections:[{alias:"promptVersion",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,l,{kind:"InlineFragment",selections:[r,{alias:"provider",args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"template",plural:!1,selections:[t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptMessage",kind:"LinkedField",name:"messages",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"content",plural:!0,selections:[t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TextContentValue",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}],type:"TextContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolCallContentValue",kind:"LinkedField",name:"toolCall",plural:!1,selections:[y,{alias:null,args:null,concreteType:"ToolCallFunction",kind:"LinkedField",name:"toolCall",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null},p],storageKey:null}],storageKey:null}],type:"ToolCallContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolResultContentValue",kind:"LinkedField",name:"toolResult",plural:!1,selections:[y,{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}],type:"ToolResultContentPart",abstractKey:null}],storageKey:null}],storageKey:null}],type:"PromptChatTemplate",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"template",storageKey:null}],type:"PromptStringTemplate",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateFormat",storageKey:null},o,{alias:null,args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:"ResponseFormat",kind:"LinkedField",name:"responseFormat",plural:!1,selections:d,storageKey:null},c,{alias:"model",args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[l,p],storageKey:null},i],type:"PromptVersion",abstractKey:null}],storageKey:null}]},params:{cacheID:"619de31a7a111f736e33d8aad0e16f97",id:null,metadata:{},name:"promptVersionLoaderQuery",operationKind:"query",text:`query promptVersionLoaderQuery(
  $id: GlobalID!
) {
  promptVersion: node(id: $id) {
    __typename
    id
    ... on PromptVersion {
      ...PromptInvocationParameters__main
      ...PromptChatMessagesCard__main
      ...PromptCodeExportCard__main
      ...PromptModelConfigurationCard__main
      ...PromptVersionTagsList_data
      description
      invocationParameters
      modelName
      tools {
        definition
      }
      tags {
        name
      }
    }
  }
}

fragment PromptChatMessagesCard__main on PromptVersion {
  provider: modelProvider
  template {
    __typename
    ... on PromptChatTemplate {
      messages {
        role
        content {
          __typename
          ... on TextContentPart {
            text {
              text
            }
          }
          ... on ToolCallContentPart {
            toolCall {
              toolCallId
              toolCall {
                arguments
                name
              }
            }
          }
          ... on ToolResultContentPart {
            toolResult {
              toolCallId
              result
            }
          }
        }
      }
    }
    ... on PromptStringTemplate {
      template
    }
  }
  templateType
  templateFormat
}

fragment PromptCodeExportCard__main on PromptVersion {
  id
  invocationParameters
  modelName
  modelProvider
  responseFormat {
    definition
  }
  tools {
    definition
  }
  template {
    __typename
    ... on PromptChatTemplate {
      messages {
        role
        content {
          __typename
          ... on TextContentPart {
            __typename
            text {
              text
            }
          }
          ... on ToolCallContentPart {
            __typename
            toolCall {
              toolCallId
              toolCall {
                name
                arguments
              }
            }
          }
          ... on ToolResultContentPart {
            __typename
            toolResult {
              toolCallId
              result
            }
          }
        }
      }
    }
    ... on PromptStringTemplate {
      template
    }
  }
  templateFormat
  templateType
}

fragment PromptInvocationParameters__main on PromptVersion {
  invocationParameters
}

fragment PromptLLM__main on PromptVersion {
  model: modelName
  provider: modelProvider
}

fragment PromptModelConfigurationCard__main on PromptVersion {
  model: modelName
  provider: modelProvider
  ...PromptLLM__main
  ...PromptInvocationParameters__main
  ...PromptTools__main
  ...PromptResponseFormatFragment
}

fragment PromptResponseFormatFragment on PromptVersion {
  responseFormat {
    definition
  }
}

fragment PromptTools__main on PromptVersion {
  tools {
    definition
  }
}

fragment PromptVersionTagsList_data on PromptVersion {
  tags {
    id
    name
  }
}
`}}}();Uo.hash="ab4959340d5259ba050f4d3ab7f4e261";async function k2(n){const{versionId:a}=n.params;return await I.fetchQuery(he,Uo,{id:a}).toPromise().catch(()=>{throw new Error("Prompt version not found")})}const Ho=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Literal",name:"first",value:1}],concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"promptVersion",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],storageKey:null}],storageKey:"promptVersions(first:1)"}],type:"Prompt",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"promptVersionsLoaderQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"promptVersionsLoaderQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,{kind:"TypeDiscriminator",abstractKey:"__isNode"},t],storageKey:null}]},params:{cacheID:"6b4dac4f67e74b03bfd1c4802b844fb0",id:null,metadata:{},name:"promptVersionsLoaderQuery",operationKind:"query",text:`query promptVersionsLoaderQuery(
  $id: GlobalID!
) {
  prompt: node(id: $id) {
    __typename
    ... on Prompt {
      promptVersions(first: 1) {
        edges {
          promptVersion: node {
            id
          }
        }
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();Ho.hash="b5ea8ee71d6ce7848581a446f803c1aa";async function b2({params:n}){var r,o,d;if(n.versionId)return null;const t=n.promptId,l=await et.fetchQuery(he,Ho,{id:t}).toPromise();if(!((d=(o=(r=l==null?void 0:l.prompt)==null?void 0:r.promptVersions)==null?void 0:o.edges)!=null&&d.length))throw new Error("Prompt does not have any versions");const i=l.prompt.promptVersions.edges[0].promptVersion;return Ga(`/prompts/${t}/versions/${i.id}`)}const Go={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptVersionsPageContent__main",selections:[{args:null,kind:"FragmentSpread",name:"PromptVersionsList__main"}],type:"Prompt",abstractKey:null};Go.hash="994c1d93ccbab49fef121d5d73cd2b62";const Wo={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptVersionsList__main",selections:[{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{args:null,kind:"FragmentSpread",name:"PromptVersionSummaryFragment"}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null};Wo.hash="30cac642c3466fa8405eb71f29d27be3";const x1=K`
  border-bottom: 1px solid var(--ac-global-color-grey-300);
  transition: background-color 0.1s ease-in;

  &[data-active="true"],
  &:hover {
    background-color: var(--ac-global-color-grey-200);
  }

  & > a {
    text-decoration: none;
    color: inherit;
  }
`,D1=({version:n,active:a})=>e("div",{css:x1,"data-active":a,children:e(pm,{to:`${n.id}`,children:e(C,{width:"100%",paddingY:"size-100",paddingX:"size-200",children:e(qs,{promptVersion:n})})})}),$i=400,_1=({prompt:n,itemActive:a})=>{const{promptVersions:t}=I.useFragment(Wo,n);return e(C,{height:"100%",overflow:"auto",width:$i,minWidth:$i,borderRightWidth:"thin",borderColor:"grey-300",children:e(h,{direction:"column",children:t.edges.map(({version:l})=>e(D1,{version:l,active:a==null?void 0:a(l)},l.id))})})};function S2(){const{prompt:n}=ni(),{versionId:a}=qe();return e(L1,{prompt:n,promptVersionId:a})}function L1({prompt:n,promptVersionId:a}){const t=I.useFragment(Go,n),l=u.useCallback(i=>i.id===a,[a]);return e(C,{height:"100%",children:s(h,{direction:"row",height:"100%",children:[e(_1,{prompt:t,itemActive:l}),e(xe,{})]})})}const Jo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"sessionId",storageKey:null}],type:"ProjectSession",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"sessionLoaderQuery",selections:[{alias:"session",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,l],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"sessionLoaderQuery",selections:[{alias:"session",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,l],storageKey:null}]},params:{cacheID:"aa110794a0fd7ac02812e8e14196930b",id:null,metadata:{},name:"sessionLoaderQuery",operationKind:"query",text:`query sessionLoaderQuery(
  $id: GlobalID!
) {
  session: node(id: $id) {
    __typename
    id
    ... on ProjectSession {
      sessionId
    }
  }
}
`}}}();Jo.hash="26e5a5dbde9bd4ecfd7ae5fc1c078860";async function v2(n){const{sessionId:a}=n.params;return await I.fetchQuery(he,Jo,{id:a}).toPromise()}const Zo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"mimeType",storageKey:null}],i={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"numTraces",storageKey:null},{alias:null,args:null,concreteType:"TokenUsage",kind:"LinkedField",name:"tokenUsage",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"completion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"prompt",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sessionId",storageKey:null},{alias:"latencyP50",args:[{kind:"Literal",name:"probability",value:.5}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.5)"},{alias:null,args:null,concreteType:"TraceConnection",kind:"LinkedField",name:"traces",plural:!1,selections:[{alias:null,args:null,concreteType:"TraceEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"trace",args:null,concreteType:"Trace",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"rootSpan",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"attributes",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t],storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:l,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:l,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountCompletion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"ProjectSession",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SessionDetailsQuery",selections:[{alias:"session",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SessionDetailsQuery",selections:[{alias:"session",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,{kind:"TypeDiscriminator",abstractKey:"__isNode"},t],storageKey:null}]},params:{cacheID:"537f0044aba3bca68c76ef30c43a810c",id:null,metadata:{},name:"SessionDetailsQuery",operationKind:"query",text:`query SessionDetailsQuery(
  $id: GlobalID!
) {
  session: node(id: $id) {
    __typename
    ... on ProjectSession {
      numTraces
      tokenUsage {
        total
        completion
        prompt
      }
      sessionId
      latencyP50: traceLatencyMsQuantile(probability: 0.5)
      traces {
        edges {
          trace: node {
            id
            traceId
            rootSpan {
              id
              attributes
              project {
                id
              }
              input {
                value
                mimeType
              }
              output {
                value
                mimeType
              }
              cumulativeTokenCountTotal
              cumulativeTokenCountCompletion
              cumulativeTokenCountPrompt
              latencyMs
              startTime
              spanAnnotations {
                name
                label
                score
                explanation
                annotatorKind
              }
              spanId
            }
          }
        }
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();Zo.hash="48d10974b52b961361ff750b74e21d8e";const w1=n=>{const{json:a}=Le(n);if(a==null||!Hn(a))return null;const t=a[ue.user];if(t==null||!Hn(t))return null;const l=t[gm.id];return on.isString(l)||on.isNumber(l)?l:null};function Oi({role:n,value:a,mimeType:t}){const l=u.useMemo(()=>{if(t!=="json")return String(a);const r=Le(a);return r.json==null?"--":JSON.stringify(r.json,null,2)},[a,t]),i=lt(n==="HUMAN"?"user":"assistant");return e(C,{alignSelf:n==="HUMAN"?"start":"end",borderRadius:"medium",borderColor:"dark",borderWidth:"thin",padding:"size-200",maxWidth:"70%",...i,children:s(h,{direction:"column",gap:"size-50",children:[e(v,{color:"text-700",children:n}),t==="json"?e(Ze,{value:l}):e(v,{children:l})]})})}function E1({traceId:n,rootSpan:a,index:t}){const l=u.useMemo(()=>new Date(a.startTime),[a.startTime]),i=u.useMemo(()=>w1(a.attributes),[a.attributes]);return e(C,{height:"100%",children:s(h,{direction:"column",justifyContent:"space-between",height:"100%",children:[s(h,{direction:"column",gap:"size-200",children:[s(h,{direction:"row",justifyContent:"space-between",children:[s(v,{children:["Trace #",t+1]}),e(Oe,{to:`/projects/${a.project.id}/traces/${n}?selectedSpanNodeId=${a.id}`,children:s(h,{alignItems:"center",children:["View Trace",e(L,{svg:e(Sr,{})})]})})]}),s(h,{direction:"row",justifyContent:"space-between",children:[i!=null?s(v,{color:"text-700",children:["user: ",i]}):null,e(v,{color:"text-700",flex:"end",marginStart:"auto",children:pn(l)})]}),s(h,{direction:"row",gap:"size-100",children:[e(na,{tokenCountTotal:a.cumulativeTokenCountTotal??0,tokenCountCompletion:a.cumulativeTokenCountCompletion??0,tokenCountPrompt:a.cumulativeTokenCountPrompt??0}),a.latencyMs!=null?e(Ve,{latencyMs:a.latencyMs}):"--"]})]}),s(h,{direction:"row",justifyContent:"space-between",alignItems:"end",children:[s(h,{direction:"column",gap:"size-100",maxWidth:"50%",children:[e(v,{children:"Feedback"}),e(h,{gap:"size-50",direction:"column",children:a.spanAnnotations.length>0?a.spanAnnotations.map(r=>e(_a,{annotation:r,children:e(En,{annotation:r,annotationDisplayPreference:"label"})},r.name)):"--"})]}),e("span",{children:e(mo,{size:"S",spanNodeId:a.id,projectId:a.project.id})})]})]})})}function M1({rootSpan:n}){var a,t,l,i;return s(h,{direction:"column",gap:"size-100",children:[e(Oi,{role:"HUMAN",value:(a=n.input)==null?void 0:a.value,mimeType:(t=n.input)==null?void 0:t.mimeType}),e(Oi,{role:"AI",value:(l=n.output)==null?void 0:l.value,mimeType:(i=n.output)==null?void 0:i.mimeType})]})}function V1({traces:n}){const a=u.useMemo(()=>((n==null?void 0:n.edges)||[]).map(({trace:l})=>l).filter(l=>l.rootSpan!==null),[n]);return e(C,{height:"100%",flex:"1 1 auto",overflow:"auto",children:a.map(({traceId:t,rootSpan:l},i)=>e(C,{borderBottomColor:"dark",borderBottomWidth:"thin",children:s(h,{direction:"row",children:[e(C,{borderRightWidth:"thin",borderEndColor:"dark",padding:"size-200",flex:"1 1 auto",children:e(M1,{rootSpan:l})}),e(C,{width:350,padding:"size-200",flex:"none",children:e(E1,{traceId:t,rootSpan:l,index:i})})]})},l.spanId))})}function R1({traceCount:n,tokenUsage:a,latencyP50:t}){return e(C,{padding:"size-200",borderBottomWidth:"thin",borderBottomColor:"dark",children:s(h,{direction:"row",gap:"size-400",children:[s(h,{direction:"column",children:[e(v,{elementType:"h3",color:"text-700",children:"Traces Count"}),e(v,{size:"L",children:n})]}),a!=null?s(h,{direction:"column",children:[e(v,{elementType:"h3",color:"text-700",children:"Total Tokens"}),e(na,{tokenCountTotal:a.total,tokenCountCompletion:a.completion,tokenCountPrompt:a.prompt,size:"L"})]}):null,t!=null?s(h,{direction:"column",children:[e(v,{elementType:"h3",color:"text-700",children:"Latency P50"}),e(Ve,{latencyMs:t,size:"L"})]}):null]})})}function A1(n){const{sessionId:a}=n,t=I.useLazyLoadQuery(Zo,{id:a},{fetchPolicy:"store-and-network"});if(t.session==null)throw new Error("Session not found");return s("main",{css:K`
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        height: 100%;
        overflow: hidden;
      `,children:[e(R1,{traceCount:t.session.numTraces??0,tokenUsage:t.session.tokenUsage,latencyP50:t.session.latencyP50}),e(V1,{traces:t.session.traces})]})}function C2(){var i;const n=Be(),{sessionId:a}=qe(),t=le(),{rootPath:l}=Bt();return e(X,{type:"slideOver",isDismissable:!0,onDismiss:()=>t(`${l}/sessions`),children:e(Z,{size:"fullscreen",title:`Session ID: ${((i=n.session)==null?void 0:i.sessionId)??"--"}`,children:e(Lt,{children:e(A1,{sessionId:a})})})})}const Xo=function(){var n=[{alias:null,args:null,concreteType:"Functionality",kind:"LinkedField",name:"functionality",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"modelInferences",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"homeLoaderQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"homeLoaderQuery",selections:n},params:{cacheID:"8bfba02258509f0b645b86f3322838d8",id:null,metadata:{},name:"homeLoaderQuery",operationKind:"query",text:`query homeLoaderQuery {
  functionality {
    modelInferences
  }
}
`}}}();Xo.hash="a248736e236c8d5348e0ecfbe9440ca2";async function F2(n){const a=await I.fetchQuery(he,Xo,{}).toPromise();return a!=null&&a.functionality.modelInferences?Ga("/model"):Ga("/projects")}const Yo=function(){var n={defaultValue:null,kind:"LocalArgument",name:"endTime"},a={defaultValue:null,kind:"LocalArgument",name:"startTime"},t=[{kind:"Variable",name:"endTime",variableName:"endTime"},{kind:"Variable",name:"startTime",variableName:"startTime"}],l=[{kind:"Literal",name:"first",value:50}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},o={fields:[{kind:"Variable",name:"end",variableName:"endTime"},{kind:"Variable",name:"start",variableName:"startTime"}],kind:"ObjectValue",name:"timeRange"},d={alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},c=[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],p={alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"ModelPageQuery",selections:[{args:t,kind:"FragmentSpread",name:"ModelSchemaTable_dimensions"},{args:t,kind:"FragmentSpread",name:"ModelEmbeddingsTable_embeddingDimensions"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"ModelPageQuery",selections:[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:null,args:l,concreteType:"DimensionConnection",kind:"LinkedField",name:"dimensions",plural:!1,selections:[{alias:null,args:null,concreteType:"DimensionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"dimension",args:null,concreteType:"Dimension",kind:"LinkedField",name:"node",plural:!1,selections:[i,r,{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dataType",storageKey:null},{alias:"cardinality",args:[{kind:"Literal",name:"metric",value:"cardinality"},o],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"percentEmpty",args:[{kind:"Literal",name:"metric",value:"percentEmpty"},o],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"min",args:[{kind:"Literal",name:"metric",value:"min"},o],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"mean",args:[{kind:"Literal",name:"metric",value:"mean"},o],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"max",args:[{kind:"Literal",name:"metric",value:"max"},o],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"psi",args:[{kind:"Literal",name:"metric",value:"psi"},o],kind:"ScalarField",name:"driftMetric",storageKey:null}],storageKey:null},d,{alias:null,args:null,concreteType:"Dimension",kind:"LinkedField",name:"node",plural:!1,selections:c,storageKey:null}],storageKey:null},p],storageKey:"dimensions(first:50)"},{alias:null,args:l,filters:null,handle:"connection",key:"ModelSchemaTable_dimensions",kind:"LinkedHandle",name:"dimensions"},{alias:null,args:l,concreteType:"EmbeddingDimensionConnection",kind:"LinkedField",name:"embeddingDimensions",plural:!1,selections:[{alias:null,args:null,concreteType:"EmbeddingDimensionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"embedding",args:null,concreteType:"EmbeddingDimension",kind:"LinkedField",name:"node",plural:!1,selections:[i,r,{alias:"euclideanDistance",args:[{kind:"Literal",name:"metric",value:"euclideanDistance"},o],kind:"ScalarField",name:"driftMetric",storageKey:null}],storageKey:null},d,{alias:null,args:null,concreteType:"EmbeddingDimension",kind:"LinkedField",name:"node",plural:!1,selections:c,storageKey:null}],storageKey:null},p],storageKey:"embeddingDimensions(first:50)"},{alias:null,args:l,filters:null,handle:"connection",key:"ModelEmbeddingsTable_embeddingDimensions",kind:"LinkedHandle",name:"embeddingDimensions"}],storageKey:null}]},params:{cacheID:"18059ac8df6b3c15d5e4bc04ca2c9877",id:null,metadata:{},name:"ModelPageQuery",operationKind:"query",text:`query ModelPageQuery(
  $startTime: DateTime!
  $endTime: DateTime!
) {
  ...ModelSchemaTable_dimensions_3uKjWt
  ...ModelEmbeddingsTable_embeddingDimensions_3uKjWt
}

fragment ModelEmbeddingsTable_embeddingDimensions_3uKjWt on Query {
  model {
    embeddingDimensions(first: 50) {
      edges {
        embedding: node {
          id
          name
          euclideanDistance: driftMetric(metric: euclideanDistance, timeRange: {start: $startTime, end: $endTime})
        }
        cursor
        node {
          __typename
        }
      }
      pageInfo {
        endCursor
        hasNextPage
      }
    }
  }
}

fragment ModelSchemaTable_dimensions_3uKjWt on Query {
  model {
    dimensions(first: 50) {
      edges {
        dimension: node {
          id
          name
          type
          dataType
          cardinality: dataQualityMetric(metric: cardinality, timeRange: {start: $startTime, end: $endTime})
          percentEmpty: dataQualityMetric(metric: percentEmpty, timeRange: {start: $startTime, end: $endTime})
          min: dataQualityMetric(metric: min, timeRange: {start: $startTime, end: $endTime})
          mean: dataQualityMetric(metric: mean, timeRange: {start: $startTime, end: $endTime})
          max: dataQualityMetric(metric: max, timeRange: {start: $startTime, end: $endTime})
          psi: driftMetric(metric: psi, timeRange: {start: $startTime, end: $endTime})
        }
        cursor
        node {
          __typename
        }
      }
      pageInfo {
        endCursor
        hasNextPage
      }
    }
  }
}
`}}}();Yo.hash="b612239336c7638df42037315b00f635";function K2(n){const{referenceInferences:a}=bn(),{timeRange:t}=Vn(),l=I.useLazyLoadQuery(Yo,{startTime:t.start.toISOString(),endTime:t.end.toISOString()});return s("main",{children:[s(Ql,{children:[e(Dr,{}),a?e(_r,{inferencesRole:"reference",timeRange:{start:new Date(a.startTime),end:new Date(a.endTime)}}):null]}),e("section",{css:K`
          margin: var(--ac-global-dimension-static-size-200);
        `,children:e(Cl,{title:"Model Schema",variant:"compact",bodyStyle:{padding:0},children:s(He,{children:[e(ae,{name:"All",children:s(en,{defaultExpandedKeys:["embeddings","dimensions"],children:[s(ce,{id:"embeddings",children:[e(oe,{children:"Embeddings"}),e(de,{children:e(vi,{model:l})})]}),s(ce,{id:"dimensions",children:[e(oe,{children:"Dimensions"}),e(de,{children:e(Ci,{model:l})})]})]})},"all"),e(ae,{name:"Embeddings",children:e(vi,{model:l})},"embeddings"),e(ae,{name:"Dimensions",children:e(Ci,{model:l})},"dimensions")]})})}),e(xe,{})]})}const ed={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"EmbeddingPageModelQuery",selections:[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"MetricSelector_dimensions"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"EmbeddingPageModelQuery",selections:[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:"numericDimensions",args:[{kind:"Literal",name:"include",value:{dataTypes:["numeric"]}}],concreteType:"DimensionConnection",kind:"LinkedField",name:"dimensions",plural:!1,selections:[{alias:null,args:null,concreteType:"DimensionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Dimension",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:'dimensions(include:{"dataTypes":["numeric"]})'}],storageKey:null}]},params:{cacheID:"4ccf476dd862525b059197daccd0d4d9",id:null,metadata:{},name:"EmbeddingPageModelQuery",operationKind:"query",text:`query EmbeddingPageModelQuery {
  model {
    ...MetricSelector_dimensions
  }
}

fragment MetricSelector_dimensions on Model {
  numericDimensions: dimensions(include: {dataTypes: [numeric]}) {
    edges {
      node {
        id
        name
        type
      }
    }
  }
}
`}};ed.hash="374499f7f8ce6919e4a0a4ecbe380c52";const nd=function(){var n={defaultValue:null,kind:"LocalArgument",name:"clusterMinSamples"},a={defaultValue:null,kind:"LocalArgument",name:"clusterSelectionEpsilon"},t={defaultValue:null,kind:"LocalArgument",name:"dataQualityMetricColumnName"},l={defaultValue:null,kind:"LocalArgument",name:"fetchDataQualityMetric"},i={defaultValue:null,kind:"LocalArgument",name:"fetchPerformanceMetric"},r={defaultValue:null,kind:"LocalArgument",name:"id"},o={defaultValue:null,kind:"LocalArgument",name:"minClusterSize"},d={defaultValue:null,kind:"LocalArgument",name:"minDist"},c={defaultValue:null,kind:"LocalArgument",name:"nNeighbors"},p={defaultValue:null,kind:"LocalArgument",name:"nSamples"},y={defaultValue:null,kind:"LocalArgument",name:"performanceMetric"},m={defaultValue:null,kind:"LocalArgument",name:"timeRange"},g=[{kind:"Variable",name:"id",variableName:"id"}],f={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null},F=[f,{alias:null,args:null,kind:"ScalarField",name:"eventId",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"coordinates",plural:!1,selections:[k,{kind:"InlineFragment",selections:[b,S,{alias:null,args:null,kind:"ScalarField",name:"z",storageKey:null}],type:"Point3D",abstractKey:null},{kind:"InlineFragment",selections:[b,S],type:"Point2D",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"EmbeddingMetadata",kind:"LinkedField",name:"embeddingMetadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"linkToData",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"rawData",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"EventMetadata",kind:"LinkedField",name:"eventMetadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"predictionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"predictionLabel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"actualLabel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"predictionScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"actualScore",storageKey:null}],storageKey:null}],P=[{alias:null,args:null,kind:"ScalarField",name:"primaryValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"referenceValue",storageKey:null}],D={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"clusterMinSamples",variableName:"clusterMinSamples"},{kind:"Variable",name:"clusterSelectionEpsilon",variableName:"clusterSelectionEpsilon"},{kind:"Variable",name:"minClusterSize",variableName:"minClusterSize"},{kind:"Variable",name:"minDist",variableName:"minDist"},{kind:"Variable",name:"nNeighbors",variableName:"nNeighbors"},{kind:"Variable",name:"nSamples",variableName:"nSamples"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"UMAPPoints",kind:"LinkedField",name:"UMAPPoints",plural:!1,selections:[{alias:null,args:null,concreteType:"UMAPPoint",kind:"LinkedField",name:"data",plural:!0,selections:F,storageKey:null},{alias:null,args:null,concreteType:"UMAPPoint",kind:"LinkedField",name:"referenceData",plural:!0,selections:F,storageKey:null},{alias:null,args:null,concreteType:"UMAPPoint",kind:"LinkedField",name:"corpusData",plural:!0,selections:F,storageKey:null},{alias:null,args:null,concreteType:"Cluster",kind:"LinkedField",name:"clusters",plural:!0,selections:[f,{alias:null,args:null,kind:"ScalarField",name:"eventIds",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"driftRatio",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"primaryToCorpusRatio",storageKey:null},{condition:"fetchDataQualityMetric",kind:"Condition",passingValue:!0,selections:[{alias:null,args:[{fields:[{kind:"Variable",name:"columnName",variableName:"dataQualityMetricColumnName"},{kind:"Literal",name:"metric",value:"mean"}],kind:"ObjectValue",name:"metric"}],concreteType:"DatasetValues",kind:"LinkedField",name:"dataQualityMetric",plural:!1,selections:P,storageKey:null}]},{condition:"fetchPerformanceMetric",kind:"Condition",passingValue:!0,selections:[{alias:null,args:[{fields:[{kind:"Variable",name:"metric",variableName:"performanceMetric"}],kind:"ObjectValue",name:"metric"}],concreteType:"DatasetValues",kind:"LinkedField",name:"performanceMetric",plural:!1,selections:P,storageKey:null}]}],storageKey:null},{alias:null,args:null,concreteType:"Retrieval",kind:"LinkedField",name:"contextRetrievals",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"queryId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"documentId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"relevance",storageKey:null}],storageKey:null}],storageKey:null}],type:"EmbeddingDimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,t,l,i,r,o,d,c,p,y,m],kind:"Fragment",metadata:null,name:"EmbeddingPageUMAPQuery",selections:[{alias:"embedding",args:g,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[D],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[r,m,d,c,p,o,n,a,l,t,i,y],kind:"Operation",name:"EmbeddingPageUMAPQuery",selections:[{alias:"embedding",args:g,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[k,D,{kind:"TypeDiscriminator",abstractKey:"__isNode"},f],storageKey:null}]},params:{cacheID:"d30210c52f86b9d9a7ac958f866aa93e",id:null,metadata:{},name:"EmbeddingPageUMAPQuery",operationKind:"query",text:`query EmbeddingPageUMAPQuery(
  $id: GlobalID!
  $timeRange: TimeRange!
  $minDist: Float!
  $nNeighbors: Int!
  $nSamples: Int!
  $minClusterSize: Int!
  $clusterMinSamples: Int!
  $clusterSelectionEpsilon: Float!
  $fetchDataQualityMetric: Boolean!
  $dataQualityMetricColumnName: String
  $fetchPerformanceMetric: Boolean!
  $performanceMetric: PerformanceMetric!
) {
  embedding: node(id: $id) {
    __typename
    ... on EmbeddingDimension {
      UMAPPoints(timeRange: $timeRange, minDist: $minDist, nNeighbors: $nNeighbors, nSamples: $nSamples, minClusterSize: $minClusterSize, clusterMinSamples: $clusterMinSamples, clusterSelectionEpsilon: $clusterSelectionEpsilon) {
        data {
          id
          eventId
          coordinates {
            __typename
            ... on Point3D {
              x
              y
              z
            }
            ... on Point2D {
              x
              y
            }
          }
          embeddingMetadata {
            linkToData
            rawData
          }
          eventMetadata {
            predictionId
            predictionLabel
            actualLabel
            predictionScore
            actualScore
          }
        }
        referenceData {
          id
          eventId
          coordinates {
            __typename
            ... on Point3D {
              x
              y
              z
            }
            ... on Point2D {
              x
              y
            }
          }
          embeddingMetadata {
            linkToData
            rawData
          }
          eventMetadata {
            predictionId
            predictionLabel
            actualLabel
            predictionScore
            actualScore
          }
        }
        corpusData {
          id
          eventId
          coordinates {
            __typename
            ... on Point3D {
              x
              y
              z
            }
            ... on Point2D {
              x
              y
            }
          }
          embeddingMetadata {
            linkToData
            rawData
          }
          eventMetadata {
            predictionId
            predictionLabel
            actualLabel
            predictionScore
            actualScore
          }
        }
        clusters {
          id
          eventIds
          driftRatio
          primaryToCorpusRatio
          dataQualityMetric(metric: {columnName: $dataQualityMetricColumnName, metric: mean}) @include(if: $fetchDataQualityMetric) {
            primaryValue
            referenceValue
          }
          performanceMetric(metric: {metric: $performanceMetric}) @include(if: $fetchPerformanceMetric) {
            primaryValue
            referenceValue
          }
        }
        contextRetrievals {
          queryId
          documentId
          relevance
        }
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();nd.hash="f1ee7ce02317f1c3fe96b77af405095f";function N1(){const{theme:n}=Mn();return u.useMemo(()=>n==="light"?$p:Op,[n])}function z1(){const{embeddingDimensionId:n}=qe();if(!n)throw new Error("Missing embeddingDimensionId in URL params");return n}const ad={euclideanDistance:{name:"Euclidean Distance",shortName:"Euc. Distance",definition:"Euclidean distance over time captures how much your primary inferences's embeddings are drifting from the reference data. Euclidean distance of the embeddings is calculated by taking the centroid of the embedding vectors for each inferences and calculating the distance between the two centroids."},queryDistance:{name:"Query Distance",shortName:"Query Distance",definition:"The query distance is the euclidean distance of the centroid of queries from the centroid of the corpus."},accuracyScore:{name:"Accuracy Score",shortName:"Accuracy",definition:"Accuracy classification score. In multi-label classification, this function computes subset accuracy: the set of labels predicted for a sample must exactly match the corresponding set of labels in the ground truth."}};function ca(n){const a=ad[n];return a!=null?a.shortName:n}function rl(n){const a=ad[n];return a&&a.definition!=null&&a.definition||null}function Sa(n){return`${n.column}:${n.dir}`}function $1(){const{referenceInferences:n}=bn(),a=!!n,t=B(c=>c.clusterSort),l=B(c=>c.setClusterSort),[i,r]=u.useState(!1),o=u.useMemo(()=>{const c=[];return a&&c.push({label:"Most drift",value:Sa({column:"driftRatio",dir:"desc"})}),[...c,{label:"Largest clusters",value:Sa({column:"size",dir:"desc"})},{label:"Smallest clusters",value:Sa({column:"size",dir:"asc"})},{label:"Highest metric value",value:Sa({column:"primaryMetricValue",dir:"desc"})},{label:"Lowest metric value",value:Sa({column:"primaryMetricValue",dir:"asc"})}]},[a]),d=Sa(t);return e("div",{css:K`
        .ac-action-button {
          background: none;
          border: none;
          color: ${"var(--ac-global-text-color-700)"};
          font-size: var(--ac-global-font-size-xs);
          line-height: var(--ac-global-line-height-xs);
          cursor: pointer;
          outline: none;
          &:hover {
            color: var(--ac-global-text-color-900);
          }
        }
      `,children:s(ga,{placement:"bottom right","aria-label":"Sort clusters by",isOpen:i,onOpenChange:c=>r(c),children:[s(Km,{children:["Sort",e("span",{"aria-hidden":!0,"data-testid":"dropdown-caret",css:K`
              margin-left: var(--ac-global-dimension-static-size-50);
              border-bottom-color: #0000;
              border-left-color: #0000;
              border-right-color: #0000;
              border-style: solid;
              border-width: 3px 3px 0;
              content: "";
              display: inline-block;
              height: 0;
              vertical-align: middle;
              width: 0;
            `})]}),e(kt,{children:e(vt,{style:{width:200},selectedKeys:[d],selectionMode:"single",items:o,onSelectionChange:c=>{if(c instanceof Set&&c.size>0){const[p]=c.values(),[y,m]=p.split(":");l({column:y,dir:m})}r(!1)},children:c=>e(re,{children:c.label},c.value)})})]})})}const td=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"clusters"}],a=[{alias:null,args:[{kind:"Variable",name:"clusters",variableName:"clusters"}],concreteType:"ExportedFile",kind:"LinkedField",name:"exportClusters",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"fileName",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"EmbeddingActionMenuExportClustersMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"EmbeddingActionMenuExportClustersMutation",selections:a},params:{cacheID:"1bef6586fcb3d6eb7034204fbe49633c",id:null,metadata:{},name:"EmbeddingActionMenuExportClustersMutation",operationKind:"mutation",text:`mutation EmbeddingActionMenuExportClustersMutation(
  $clusters: [ClusterInput!]!
) {
  exportClusters(clusters: $clusters) {
    fileName
  }
}
`}}}();td.hash="b5ff2517dbb0d19a1b24dea1796a3576";function O1(){const n=B(r=>r.clusters),{notifyError:a,notifySuccess:t}=Lr(),[l,i]=I.useMutation(td);return e(wn,{align:"end",buttonSize:"compact",icon:i?e(L,{svg:e(je,{})}):null,onAction:r=>{switch(r){case"export_cluster":l({variables:{clusters:n.map(o=>({eventIds:o.eventIds,id:o.id}))},onCompleted:o=>{const{fileName:d}=o.exportClusters;t({title:"Clusters Exported",message:"dataframe is available via px.active_session().exports or can be downloaded by clicking below",action:{text:"Download",onClick:()=>{window.open(`/exports?filename=${d}`,"_self")}}})},onError:o=>{a({title:"Failed to export clusters",message:`Failed to export clusters: ${o.message}`})}});break}},children:s(re,{children:[e(L,{svg:e(Et,{})}),"Export clusters"]},"export_cluster")})}const ld={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MetricSelector_dimensions",selections:[{alias:"numericDimensions",args:[{kind:"Literal",name:"include",value:{dataTypes:["numeric"]}}],concreteType:"DimensionConnection",kind:"LinkedField",name:"dimensions",plural:!1,selections:[{alias:null,args:null,concreteType:"DimensionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Dimension",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:'dimensions(include:{"dataTypes":["numeric"]})'}],type:"Model",abstractKey:null};ld.hash="55d03de16503d7af254c17cef7d18ee0";const Ca=":";function Q1(n){return["drift","performance","dataQuality","retrieval"].includes(n)}function Na(n){const{type:a,metric:t}=n;switch(a){case"drift":return`${a}${Ca}${t}`;case"retrieval":return`${a}${Ca}${t}`;case"performance":return`${a}${Ca}${t}`;case"dataQuality":{const{name:l}=n.dimension;return`${a}${Ca}${t}${Ca}${l}`}default:fe()}}function j1({metricKey:n,dimensions:a}){const[t,l,i]=n.split(Ca);if(!Q1(t))throw new Error(`Invalid metric type: ${t}`);switch(t){case"drift":return{type:t,metric:l};case"retrieval":return{type:t,metric:l};case"performance":return{type:t,metric:l};case"dataQuality":{const r=a.find(o=>o.name===i);if(!r)throw new Error(`Invalid dimension name: ${i}`);return{type:t,metric:l,dimension:r}}default:fe()}}const q1=s(Da,{variant:"info",children:[e(te,{level:4,weight:"heavy",children:"Analysis Metric"}),s(Xn,{children:[e("p",{children:"Select a metric to drive the analysis of your embeddings."}),e("p",{children:"To analyze the the drift between your two inferences, select a drift metric and the UI will highlight areas of high drift."}),e("p",{children:"To analyze the quality of your embeddings, select a dimension data quality metric by which to analyze the point cloud. The UI will highlight areas where the data quality is degrading."})]})]});function B1({model:n}){const[,a]=u.useTransition(),t=I.useFragment(ld,n),{referenceInferences:l,corpusInferences:i}=bn(),r=!!l,o=!!i,d=B(f=>f.metric),c=B(f=>f.loading),p=B(f=>f.setMetric),y=t.numericDimensions.edges.map(f=>f.node),m=y.length>0,g=u.useCallback(f=>{const k=j1({metricKey:f,dimensions:y});a(()=>{p(k)})},[p,y,a]);return s(Fl,{label:"metric",labelExtra:q1,selectedKey:d?Na(d):void 0,onSelectionChange:g,placeholder:"Select a metric...",isDisabled:c,children:[r?e(st,{title:"Drift",children:e(re,{children:"Euclidean Distance"},Na({type:"drift",metric:"euclideanDistance"}))}):null,o?e(st,{title:"Retrieval",children:e(re,{children:"Query Distance"},Na({type:"retrieval",metric:"queryDistance"}))}):null,e(st,{title:"Performance",children:e(re,{children:"Accuracy Score"},Na({type:"performance",metric:"accuracyScore"}))}),m?e(st,{title:"Data Quality",children:y.map(f=>e(re,{children:`${f.name} avg`},Na({type:"dataQuality",metric:"average",dimension:f})))}):null]})}const id=function(){var n={defaultValue:null,kind:"LocalArgument",name:"countGranularity"},a={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},t={defaultValue:null,kind:"LocalArgument",name:"embeddingDimensionId"},l={defaultValue:null,kind:"LocalArgument",name:"fetchDataQuality"},i={defaultValue:null,kind:"LocalArgument",name:"fetchDrift"},r={defaultValue:null,kind:"LocalArgument",name:"fetchPerformance"},o={defaultValue:null,kind:"LocalArgument",name:"fetchQueryDistance"},d={defaultValue:null,kind:"LocalArgument",name:"metricGranularity"},c={defaultValue:null,kind:"LocalArgument",name:"performanceMetric"},p={defaultValue:null,kind:"LocalArgument",name:"timeRange"},y=[{kind:"Variable",name:"id",variableName:"embeddingDimensionId"}],m={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},g={kind:"Variable",name:"granularity",variableName:"metricGranularity"},f={kind:"Variable",name:"timeRange",variableName:"timeRange"},k=[g,{kind:"Literal",name:"metric",value:"euclideanDistance"},f],b=[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],S={kind:"InlineFragment",selections:[{condition:"fetchDrift",kind:"Condition",passingValue:!0,selections:[{alias:"euclideanDistanceTimeSeries",args:k,concreteType:"DriftTimeSeries",kind:"LinkedField",name:"driftTimeSeries",plural:!1,selections:b,storageKey:null}]},{condition:"fetchQueryDistance",kind:"Condition",passingValue:!0,selections:[{alias:null,args:k,concreteType:"DriftTimeSeries",kind:"LinkedField",name:"retrievalMetricTimeSeries",plural:!1,selections:b,storageKey:null}]},{alias:"trafficTimeSeries",args:[{kind:"Variable",name:"granularity",variableName:"countGranularity"},{kind:"Literal",name:"metric",value:"count"},f],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:b,storageKey:null}],type:"EmbeddingDimension",abstractKey:null},F=[{kind:"Variable",name:"id",variableName:"dimensionId"}],P={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:[g,{kind:"Literal",name:"metric",value:"mean"},f],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:b,storageKey:null}],type:"Dimension",abstractKey:null},D={alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{condition:"fetchPerformance",kind:"Condition",passingValue:!0,selections:[{alias:null,args:[g,{fields:[{kind:"Variable",name:"metric",variableName:"performanceMetric"}],kind:"ObjectValue",name:"metric"},f],concreteType:"PerformanceTimeSeries",kind:"LinkedField",name:"performanceTimeSeries",plural:!1,selections:b,storageKey:null}]}],storageKey:null},w={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null};return{fragment:{argumentDefinitions:[n,a,t,l,i,r,o,d,c,p],kind:"Fragment",metadata:null,name:"MetricTimeSeriesQuery",selections:[{alias:"embedding",args:y,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[m,S],storageKey:null},{condition:"fetchDataQuality",kind:"Condition",passingValue:!0,selections:[{alias:"dimension",args:F,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[P],storageKey:null}]},D],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[t,p,d,n,i,o,l,a,r,c],kind:"Operation",name:"MetricTimeSeriesQuery",selections:[{alias:"embedding",args:y,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[w,m,S],storageKey:null},{condition:"fetchDataQuality",kind:"Condition",passingValue:!0,selections:[{alias:"dimension",args:F,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[w,P,{kind:"TypeDiscriminator",abstractKey:"__isNode"},m],storageKey:null}]},D]},params:{cacheID:"a68a8204bf7fdd13e6915b338d4b5497",id:null,metadata:{},name:"MetricTimeSeriesQuery",operationKind:"query",text:`query MetricTimeSeriesQuery(
  $embeddingDimensionId: GlobalID!
  $timeRange: TimeRange!
  $metricGranularity: Granularity!
  $countGranularity: Granularity!
  $fetchDrift: Boolean!
  $fetchQueryDistance: Boolean!
  $fetchDataQuality: Boolean!
  $dimensionId: GlobalID!
  $fetchPerformance: Boolean!
  $performanceMetric: PerformanceMetric!
) {
  embedding: node(id: $embeddingDimensionId) {
    __typename
    id
    ... on EmbeddingDimension {
      euclideanDistanceTimeSeries: driftTimeSeries(metric: euclideanDistance, timeRange: $timeRange, granularity: $metricGranularity) @include(if: $fetchDrift) {
        data {
          timestamp
          value
        }
      }
      retrievalMetricTimeSeries(metric: euclideanDistance, timeRange: $timeRange, granularity: $metricGranularity) @include(if: $fetchQueryDistance) {
        data {
          timestamp
          value
        }
      }
      trafficTimeSeries: dataQualityTimeSeries(metric: count, timeRange: $timeRange, granularity: $countGranularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
  dimension: node(id: $dimensionId) @include(if: $fetchDataQuality) {
    __typename
    ... on Dimension {
      name
      dataQualityTimeSeries(metric: mean, timeRange: $timeRange, granularity: $metricGranularity) {
        data {
          timestamp
          value
        }
      }
    }
    __isNode: __typename
    id
  }
  model {
    performanceTimeSeries(metric: {metric: $performanceMetric}, timeRange: $timeRange, granularity: $metricGranularity) @include(if: $fetchPerformance) {
      data {
        timestamp
        value
      }
    }
  }
}
`}}}();id.hash="f31abad2141a5a1c461ef2a598ffa4f3";const Qi=new Intl.NumberFormat([],{maximumFractionDigits:2}),rd=()=>{const n=Rn(),a=n.blue400,t=n.gray500;return{color:a,barColor:t}};function U1({active:n,payload:a,label:t}){var r,o,d;const{color:l,barColor:i}=rd();if(n&&a&&a.length){const c=((r=a[1])==null?void 0:r.value)??null,p=((o=a[0])==null?void 0:o.value)??null,y=typeof c=="number"?Qi.format(c):"--",m=typeof p=="number"?Qi.format(p):"--";return s(An,{children:[e(v,{weight:"heavy",size:"S",children:`${pn(new Date(t))}`}),e(Re,{color:l,name:((d=a[1])==null?void 0:d.payload.metricName)??"Metric",value:y}),e(Re,{color:i,shape:"square",name:"Count",value:m}),e(Vt,{}),s("div",{css:K`
            display: flex;
            flex-direction: row;
            align-items: center;
            color: var(--ac-global-color-primary);
            gap: var(--ac-global-dimension-static-size-50);

            margin-top: var(--ac-global-dimension-static-size-50);
          `,children:[e(L,{svg:e(xn,{})}),e("span",{children:"Click to view the point cloud at this time"})]})]})}return null}function H1(n){switch(n.type){case"drift":return"Embedding Drift";case"performance":return"Model Performance";case"dataQuality":return"Data Quality";case"retrieval":return"Query Distance";default:fe()}}function G1(n){if(n)switch(n.type){case"drift":return ca(n.metric);case"performance":return ca(n.metric);case"dataQuality":return`${n.dimension.name} avg`;case"retrieval":return ca(n.metric);default:fe()}else return"Count"}function W1(n){switch(n.type){case"drift":return rl(n.metric);case"performance":return rl(n.metric);case"dataQuality":return null;case"retrieval":return rl(n.metric);default:fe()}}function J1({embeddingDimensionId:n}){const a=B(T=>T.metric),t=a.type==="drift",l=a.type==="retrieval",i=a.type==="dataQuality",r=a.type==="performance",{timeRange:o}=Vn(),{selectedTimestamp:d,setSelectedTimestamp:c}=Mt(),p=Ea(o),y=I.useLazyLoadQuery(id,{embeddingDimensionId:n,timeRange:{start:o.start.toISOString(),end:o.end.toISOString()},metricGranularity:wr(o),countGranularity:p,fetchDrift:t,fetchQueryDistance:l,fetchDataQuality:i,fetchPerformance:r,dimensionId:a.type==="dataQuality"?a.dimension.id:n,performanceMetric:a.type==="performance"?a.metric:"accuracyScore"}),m=Ma({samplingIntervalMinutes:p.samplingIntervalMinutes}),g=u.useCallback(T=>{const{activePayload:x}=T;if(x!=null&&x.length>0){const M=x[0].payload;c(new Date(M.timestamp))}},[c]),f=Z1({data:y,metric:a}),b=X1(y).reduce((T,x)=>(T[x.timestamp]=x.value,T),{})??{},S=f.map(T=>{const x=b[T.timestamp];return{...T,traffic:x,timestamp:new Date(T.timestamp).getTime()}}),F=G1(a),P=W1(a),{color:D,barColor:w}=rd();return s("section",{css:K`
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        overflow: hidden;
        h3 {
          padding: var(--ac-global-dimension-static-size-100)
            var(--ac-global-dimension-static-size-200) 0
            var(--ac-global-dimension-static-size-200);
          flex: none;
          display: flex;
          flex-direction: row;
          align-items: center;
          gap: var(--ac-global-dimension-static-size-50);
        }
        & > div {
          flex: 1 1 auto;
          width: 100%;
          overflow: hidden;
        }
      `,children:[s(te,{level:3,children:[H1(a),P!=null?s(Da,{children:[e(te,{level:4,children:F}),e(Xn,{children:P})]}):null]}),e("div",{children:e(Nn,{width:"100%",height:"100%",children:s(tt,{data:S,margin:{top:25,right:18,left:18,bottom:10},onClick:g,children:[s("defs",{children:[s("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:D,stopOpacity:.8}),e("stop",{offset:"95%",stopColor:D,stopOpacity:0})]}),s("linearGradient",{id:"barColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:w,stopOpacity:.3}),e("stop",{offset:"95%",stopColor:w,stopOpacity:0})]})]}),e(ia,{...Va,tickFormatter:T=>m(new Date(T)),style:{fill:"var(--ac-global-text-color-700)"}}),e(yn,{stroke:"var(--ac-global-color-grey-500)",label:{value:F,angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(yn,{yAxisId:"right",orientation:"right",label:{value:"Count",angle:90,position:"insideRight",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(ra,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(zn,{content:e(U1,{})}),e(Ia,{yAxisId:"right",dataKey:"traffic",fill:"url(#barColor)",spacing:5}),e(Za,{type:"monotone",dataKey:"value",stroke:D,fillOpacity:1,fill:"url(#colorUv)"}),d!=null?e(Yr,{...Er,x:d.getTime()}):null]})})})]})}function Z1({data:n,metric:a}){var t,l,i,r,o,d;if(((t=n.embedding.euclideanDistanceTimeSeries)==null?void 0:t.data)!=null&&n.embedding.euclideanDistanceTimeSeries.data.length>0)return n.embedding.euclideanDistanceTimeSeries.data.map(c=>({metricName:ca(a.metric),...c}));if(((l=n.embedding.retrievalMetricTimeSeries)==null?void 0:l.data)!=null&&n.embedding.retrievalMetricTimeSeries.data.length>0)return n.embedding.retrievalMetricTimeSeries.data.map(c=>({metricName:ca(a.metric),...c}));if(n.dimension&&((r=(i=n.dimension)==null?void 0:i.dataQualityTimeSeries)==null?void 0:r.data)!=null&&n.dimension.dataQualityTimeSeries.data.length>0){const c=n.dimension.name||"unknown";return n.dimension.dataQualityTimeSeries.data.map(p=>({metricName:`${c} avg`,...p}))}else{if(n.model&&((o=n.model.performanceTimeSeries)==null?void 0:o.data)!=null&&n.model.performanceTimeSeries.data.length>0)return n.model.performanceTimeSeries.data.map(c=>({metricName:ca(a.metric),...c}));if(((d=n.embedding.trafficTimeSeries)==null?void 0:d.data)!=null)return n.embedding.trafficTimeSeries.data.map(c=>({metricName:"Count",...c}))}return[]}function X1(n){var a;return((a=n.embedding.trafficTimeSeries)==null?void 0:a.data)!=null?[...n.embedding.trafficTimeSeries.data]:[]}const sd=function(){var n={defaultValue:null,kind:"LocalArgument",name:"corpusEventIds"},a={defaultValue:null,kind:"LocalArgument",name:"primaryEventIds"},t={defaultValue:null,kind:"LocalArgument",name:"referenceEventIds"},l=[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,concreteType:"DimensionWithValue",kind:"LinkedField",name:"dimensions",plural:!0,selections:[{alias:null,args:null,concreteType:"Dimension",kind:"LinkedField",name:"dimension",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"EventMetadata",kind:"LinkedField",name:"eventMetadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"predictionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"predictionLabel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"predictionScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"actualLabel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"actualScore",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PromptResponse",kind:"LinkedField",name:"promptAndResponse",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"prompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"response",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"documentText",storageKey:null}],i=[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"primaryInferences",plural:!1,selections:[{alias:null,args:[{kind:"Variable",name:"eventIds",variableName:"primaryEventIds"}],concreteType:"Event",kind:"LinkedField",name:"events",plural:!0,selections:l,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"referenceInferences",plural:!1,selections:[{alias:null,args:[{kind:"Variable",name:"eventIds",variableName:"referenceEventIds"}],concreteType:"Event",kind:"LinkedField",name:"events",plural:!0,selections:l,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"corpusInferences",plural:!1,selections:[{alias:null,args:[{kind:"Variable",name:"eventIds",variableName:"corpusEventIds"}],concreteType:"Event",kind:"LinkedField",name:"events",plural:!0,selections:l,storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"PointSelectionPanelContentQuery",selections:i,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,t,n],kind:"Operation",name:"PointSelectionPanelContentQuery",selections:i},params:{cacheID:"8b48064eba35d0d6c8dc834c2f7795c0",id:null,metadata:{},name:"PointSelectionPanelContentQuery",operationKind:"query",text:`query PointSelectionPanelContentQuery(
  $primaryEventIds: [ID!]!
  $referenceEventIds: [ID!]!
  $corpusEventIds: [ID!]!
) {
  model {
    primaryInferences {
      events(eventIds: $primaryEventIds) {
        id
        dimensions {
          dimension {
            name
            type
          }
          value
        }
        eventMetadata {
          predictionId
          predictionLabel
          predictionScore
          actualLabel
          actualScore
        }
        promptAndResponse {
          prompt
          response
        }
        documentText
      }
    }
    referenceInferences {
      events(eventIds: $referenceEventIds) {
        id
        dimensions {
          dimension {
            name
            type
          }
          value
        }
        eventMetadata {
          predictionId
          predictionLabel
          predictionScore
          actualLabel
          actualScore
        }
        promptAndResponse {
          prompt
          response
        }
        documentText
      }
    }
    corpusInferences {
      events(eventIds: $corpusEventIds) {
        id
        dimensions {
          dimension {
            name
            type
          }
          value
        }
        eventMetadata {
          predictionId
          predictionLabel
          predictionScore
          actualLabel
          actualScore
        }
        promptAndResponse {
          prompt
          response
        }
        documentText
      }
    }
  }
}
`}}}();sd.hash="4bd627481610322f2acbcf73dfbfaadc";const ji=K`
  margin: var(--ac-global-dimension-static-size-200);
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-static-size-100);
  & > div {
    display: flex;
    flex-direction: row;
    dt {
      font-weight: bold;
      flex: none;
      width: 130px;
    }
    dd {
      flex: 1 1 auto;
      margin-inline-start: 0;
    }
  }
`;function za(n){return e("div",{css:K`
        max-height: 200px;
        overflow-y: auto;
      `,children:e("pre",{css:K`
          padding: var(--ac-global-dimension-static-size-200);
          color: var(--ac-global-text-color-900);
          white-space: normal;
          margin: 0;
        `,children:n.children})})}function Y1({event:n}){const a=n.retrievedDocuments&&n.retrievedDocuments.length>0,t=!n.id.includes("CORPUS");return s("section",{css:K`
        height: 100%;
        overflow-y: auto;
      `,children:[e(tk,{event:n}),s(en,{defaultExpandedKeys:["prediction","document","dimensions","retrievals"],children:[t?s(ce,{id:"prediction",children:[e(oe,{children:"Prediction Details"}),e(de,{children:s("dl",{css:ji,children:[n.predictionId!=null&&s("div",{children:[e("dt",{children:"Prediction ID"}),e("dd",{css:K`
                        display: flex;
                        align-items: center;
                      `,children:n.predictionId})]}),n.predictionLabel!=null&&s("div",{children:[e("dt",{children:"Prediction Label"}),e("dd",{children:n.predictionLabel})]}),n.predictionScore!=null&&s("div",{children:[e("dt",{children:"Prediction Score"}),e("dd",{children:n.predictionScore})]}),n.actualLabel!=null&&s("div",{children:[e("dt",{children:"Actual Label"}),e("dd",{children:n.actualLabel})]}),n.actualScore!=null&&s("div",{children:[e("dt",{children:"Actual Score"}),e("dd",{children:n.actualScore})]})]})})]}):s(ce,{id:"document",children:[e(oe,{children:"Document Details"}),e(de,{children:e("dl",{css:ji,children:n.predictionId!=null&&s("div",{children:[e("dt",{children:"Document ID"}),e("dd",{css:K`
                        display: flex;
                        align-items: center;
                      `,children:n.predictionId})]})})})]}),s(ce,{id:"dimensions",children:[e(oe,{children:"Dimensions"}),e(de,{children:e(nk,{dimensions:n.dimensions})})]}),a&&s(ce,{id:"retrievals",children:[s(oe,{children:["Retrieved Documents",e(dn,{variant:"light",children:n.retrievedDocuments.length})]}),e(de,{children:e("ul",{css:K`
                  padding: var(--ac-global-dimension-static-size-100);
                  li + li {
                    margin-top: var(--ac-global-dimension-static-size-100);
                  }
                `,children:n.retrievedDocuments.map(l=>e("li",{children:e(ek,{document:l})},l.id))})})]})]})]})}function ek({document:n}){return e(C,{borderRadius:"medium",backgroundColor:"light",children:s(h,{direction:"column",children:[e(C,{width:"100%",borderBottomWidth:"thin",borderBottomColor:"dark",children:s(h,{direction:"row",justifyContent:"space-between",margin:"size-100",alignItems:"center",children:[s(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(L,{svg:e(br,{})}),s(te,{level:4,children:["document ",n.id]})]}),typeof n.relevance=="number"&&e(Ka,{color:"var(--ac-global-color-blue-1000)",children:`relevance ${Vl(n.relevance)}`})]})}),e("pre",{css:K`
            padding: var(--ac-global-dimension-static-size-200);
            white-space: normal;
            margin: 0;
          `,children:n.text})]})})}function nk({dimensions:n}){const a=u.useMemo(()=>n.map(i=>({name:i.dimension.name,type:i.dimension.type,value:i.value??"--"})),[n]),t=u.useMemo(()=>[{header:()=>"Name",accessorKey:"name"},{header:()=>"Type",accessorKey:"type"},{header:()=>"Value",accessorKey:"value"}],[]),l=Te({columns:t,data:a,getCoreRowModel:Pe()});return s("table",{css:tn,children:[e("thead",{children:l.getHeaderGroups().map(i=>e("tr",{children:i.headers.map(r=>e("th",{colSpan:r.colSpan,children:r.isPlaceholder?null:e("div",{children:W(r.column.columnDef.header,r.getContext())})},r.id))},i.id))}),l.getCoreRowModel().rows.length?e("tbody",{children:l.getRowModel().rows.map(i=>e("tr",{children:i.getVisibleCells().map(r=>e("td",{children:W(r.column.columnDef.cell,r.getContext())},r.id))},i.id))}):e(lk,{})]})}function ak({dataUrl:n}){const a=Qp(n),t=jp(n);return a?e("video",{src:n,controls:!0,css:K`
          width: 100%;
          height: 500px;
          background-color: black;
        `}):t?e("audio",{src:n,controls:!0,autoPlay:!0}):e("img",{src:n,alt:"event image",width:"100%",height:"200px",css:K`
        object-fit: contain;
        background-color: black;
      `})}function tk({event:n}){const a=n.linkToData||void 0,t=n.rawData,l=n.prompt||n.response?{prompt:n.prompt,response:n.response}:null,i=n.documentText;let r=null;return a?r=s(h,{direction:"column",children:[e(ak,{dataUrl:a}),t&&s(ce,{id:"raw",children:[e(oe,{children:"Raw Data"}),e(de,{children:e(za,{children:t})})]})]}):i?r=s(ce,{id:"document",children:[e(oe,{children:"Document"}),e(de,{children:e(za,{children:i})})]}):l?r=s(en,{defaultExpandedKeys:["prompt","response"],children:[s(ce,{id:"prompt",children:[e(oe,{children:"Prompt"}),e(de,{children:e(za,{children:l.prompt})})]}),s(ce,{id:"response",children:[e(oe,{children:"Response"}),e(de,{children:e(za,{children:l.response})})]})]}):n.rawData&&n.rawData&&n.rawData,r}function lk(){return e("tbody",{className:"is-empty",children:e("tr",{children:e("td",{colSpan:100,css:K`
            text-align: center;
            padding: var(--ac-global-dimension-size-300)
              var(--ac-global-dimension-size-300) !important;
          `,children:e(yr,{graphicKey:"documents",message:"This embedding has no associated dimensions"})})})})}const od=function(){var n=[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:null,args:null,concreteType:"ExportedFile",kind:"LinkedField",name:"exportedFiles",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fileName",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ExportSelectionButtonExportsQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"ExportSelectionButtonExportsQuery",selections:n},params:{cacheID:"2f7e3554305121746dc799b6a8d120da",id:null,metadata:{},name:"ExportSelectionButtonExportsQuery",operationKind:"query",text:`query ExportSelectionButtonExportsQuery {
  model {
    exportedFiles {
      fileName
    }
  }
}
`}}}();od.hash="7e6db431afe21f137e54505645c787f4";const dd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"eventIds"}],a=[{alias:null,args:[{kind:"Variable",name:"eventIds",variableName:"eventIds"}],concreteType:"ExportedFile",kind:"LinkedField",name:"exportEvents",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"fileName",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExportSelectionButtonMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExportSelectionButtonMutation",selections:a},params:{cacheID:"d370df04ca30a5059288c7aa298239a8",id:null,metadata:{},name:"ExportSelectionButtonMutation",operationKind:"mutation",text:`mutation ExportSelectionButtonMutation(
  $eventIds: [ID!]!
) {
  exportEvents(eventIds: $eventIds) {
    fileName
  }
}
`}}}();dd.hash="8b0d6962e2034d4c148d1b9919111d2f";const ik=`import phoenix as px

exports = px.active_session().exports
dataframe = exports[-1]
dataframe`,rk=K`
  .cm-content {
    padding: var(--ac-global-dimension-static-size-100);
  }
`;function sk({value:n}){const{theme:a}=Mn(),t=a==="light"?aa:ta;return e(la,{value:n,basicSetup:!1,extensions:[at()],editable:!1,theme:t,css:rk})}function ok(){const n=B(o=>o.selectedEventIds),[a,t]=I.useMutation(dd),[l,i]=u.useState(null),r=u.useCallback(()=>{a({variables:{eventIds:[...n]},onCompleted:o=>{i(o.exportEvents)}})},[a,n]);return s(U,{children:[e(A,{size:"S",leadingVisual:e(L,{svg:t?e(je,{}):e(Et,{})}),"aria-label":"Export selection / cluster",isDisabled:t,onPress:r,children:t?"Exporting":"Export"}),e(X,{type:"slideOver",isDismissable:!0,onDismiss:()=>i(null),children:l!=null&&s(Z,{title:"Cluster Exports",size:"M",children:[e(pe,{variant:"success",banner:!0,title:"Export succeeded",extra:e(A,{variant:"success",size:"S",onPress:()=>{window.open(`/exports?filename=${l.fileName}`,"_self")},children:"Download"})}),s("div",{css:K`
                display: flex;
                flex-direction: column;
                justify-content: space-between;
                align-items: flex-start;
                padding: 16px;
                gap: 16px;
              `,children:[e("p",{css:K`
                  margin: 0;
                  flex: 1 1 auto;
                `,children:"You can retrieve your export in your notebook via"}),e(C,{borderColor:"light",borderWidth:"thin",borderRadius:"medium",children:e(sk,{value:ik})})]}),e(en,{defaultExpandedKeys:["all-exports"],children:s(ce,{id:"all-exports",children:[e(oe,{children:"Latest Exports"}),e(de,{children:e(u.Suspense,{fallback:e(ge,{}),children:e(dk,{})})})]})})]})})]})}function dk(){const n=I.useLazyLoadQuery(od,{},{fetchPolicy:"network-only"});return e(ht,{children:n.model.exportedFiles.map((a,t)=>e(ft,{children:s("div",{css:K`
              display: flex;
              flex-direction: row;
              justify-content: space-between;
              align-items: center;
            `,children:[a.fileName,e(A,{size:"S","aria-label":"Download",variant:"default",leadingVisual:e(L,{svg:e(Tm,{})}),onPress:()=>{window.open(`/exports?filename=${a.fileName}`,"_self")}})]})},t))})}function ck(n){const{getInferencesNameByRole:a}=bn(),{events:t,onItemSelected:l}=n,i=B(p=>p.eventIdToDataMap),r=B(p=>p.eventIdToGroup),o=B(p=>p.pointGroupColors),d=B(p=>p.selectionGridSize),c=B(p=>p.setHoveredEventId);return e("div",{css:K`
        flex: 1 1 auto;
        overflow-y: auto;
      `,"data-testid":"grid-view-scroll-container",children:e("ul",{"data-grid-size":d,css:K`
          &[data-grid-size="small"] {
            --grid-item-min-width: 100px;
            --grid-item-height: 100px;
          }
          &[data-grid-size="medium"] {
            --grid-item-min-width: 200px;
            --grid-item-height: 200px;
          }
          &[data-grid-size="large"] {
            --grid-item-min-width: 300px;
            --grid-item-height: 200px;
          }
          padding: var(--ac-global-dimension-static-size-200);
          transition: all 0.2s ease-in-out;
          display: grid;
          grid-template-columns: repeat(
            auto-fill,
            minmax(var(--grid-item-min-width), 1fr)
          );
          flex-wrap: wrap;
          gap: var(--ac-global-dimension-static-size-200);
          & > li {
            min-width: var(--grid-item-min-width);
            height: var(--grid-item-height);
          }
        `,children:t.map((p,y)=>{const m=i.get(p.id),{rawData:g=null,linkToData:f=null}=(m==null?void 0:m.embeddingMetadata)??{},{predictionLabel:k=null,actualLabel:b=null}=(m==null?void 0:m.eventMetadata)??{},S=qp(p.id),F=a(S),P=r[p.id],D=o[P];return e("li",{children:e(Bp,{rawData:g,linkToData:f,inferencesName:F,group:P,onClick:()=>{l(p.id)},onMouseOver:()=>{c(p.id)},onMouseOut:()=>{c(null)},color:D,size:d,predictionLabel:k,actualLabel:b,promptAndResponse:p.promptAndResponse,documentText:p.documentText,autoPlay:!1})},y)})})})}function uk({data:n,onPointSelected:a}){const{primaryInferences:t,referenceInferences:l}=bn(),i=B(y=>y.metric),[r,o]=u.useState([]),{columns:d,tableData:c}=u.useMemo(()=>{const y=n.filter(D=>D.id.includes("CORPUS")===!1);let m=!1,g=!1,f=!1,k=!1,b=!1;n.forEach(D=>{D.linkToData&&(m=!0),D.rawData&&(g=!0),(D.prompt||D.response)&&(f=!0),D.predictionLabel&&(k=!0),D.actualLabel&&(b=!0)});const S=[];l&&S.push({header:"Inference Set",accessorKey:"id",size:50,cell:({getValue:D})=>e(mk,{id:D(),primaryInferencesName:t.name,referenceInferencesName:(l==null?void 0:l.name)??"reference"})}),m&&S.push({header:"Link",accessorKey:"linkToData",cell:({getValue:D})=>{const w=D();if(typeof w=="string"){const T=w.split("/").pop();return e(nn,{href:w,children:T})}return null}}),f?(S.push({header:"Prompt",accessorKey:"prompt",cell:De,size:200}),S.push({header:"Response",accessorKey:"response",cell:De,size:200})):g&&S.push({header:"Raw Data",accessorKey:"rawData"}),k&&S.push({header:"Prediction Label",accessorKey:"predictionLabel",size:50}),b&&S.push({header:"Actual Label",accessorKey:"actualLabel",size:50});const F=[];if(i&&i.type==="dataQuality"){const D=i.dimension.name;F.push({header:i.dimension.name,accessorKey:"metric",cell:Up,sortingFn:"basic"}),y.forEach(w=>{var x;const T=(x=w.dimensions.find(M=>M.dimension.name===D))==null?void 0:x.value;w.metric=T!=null?Number(T):null})}return{columns:[...S,...F,{header:"",id:"view-details",size:50,cell:({row:D})=>e(A,{"aria-label":"view point details",size:"S",onPress:()=>{a(D.original.id)},children:"view details"})}],tableData:y}},[n,a,t,l,i]),p=Te({columns:d,data:c,state:{sorting:r},getCoreRowModel:Pe(),onSortingChange:o,getSortedRowModel:hn()});return s("table",{css:tn,children:[e("thead",{children:p.getHeaderGroups().map(y=>e("tr",{children:y.headers.map(m=>s("th",{children:[m.isPlaceholder?null:s("div",{className:m.column.getCanSort()?"cursor-pointer":"",onClick:m.column.getToggleSortingHandler(),children:[W(m.column.columnDef.header,m.getContext()),m.column.getIsSorted()?e(L,{className:"sort-icon",svg:m.column.getIsSorted()==="asc"?e(rn,{}):e(sn,{})}):null]}),e("div",{onMouseDown:m.getResizeHandler(),onTouchStart:m.getResizeHandler(),className:`resizer ${m.column.getIsResizing()?"isResizing":""}`,style:{transform:m.column.getIsResizing()?`translateX(${p.getState().columnSizingInfo.deltaOffset}px)`:""}})]},m.id))},y.id))}),e("tbody",{children:p.getRowModel().rows.map(y=>e("tr",{children:y.getVisibleCells().map(m=>e("td",{style:{width:m.column.getSize()},children:W(m.column.columnDef.cell,m.getContext())},m.id))},y.id))})]})}function mk({id:n,primaryInferencesName:a,referenceInferencesName:t}){const l=n.includes("PRIMARY"),i=N1();return s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Gp,{shape:Hp.circle,color:i[l?0:1]}),l?a:t]})}const pk=K`
  width: 100%;
  height: 100%;
  position: relative;
  display: flex;
  flex-direction: column;
  /* Give spacing for the close icon */
  & > .ac-tabs {
    padding-top: 17px;
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    [role="tablist"] {
      flex: none;
    }
    .ac-tabs__pane-container {
      display: flex;
      flex-direction: column;
      flex: 1 1 auto;
      overflow: hidden;
      [role="tabpanel"] {
        display: flex;
        flex-direction: column;
        flex: 1 1 auto;
        overflow: hidden;
      }
    }
  }
`;function gk({event:n,relevance:a}){return{id:n.eventMetadata.predictionId||"unknown id",text:n.documentText??"empty document",relevance:a}}function yk(){const n=B(T=>T.selectedEventIds),a=B(T=>T.setSelectedEventIds),t=B(T=>T.setSelectedClusterId),l=B(T=>T.selectionDisplay),[i,r]=Ke.useState(null),{primaryEventIds:o,referenceEventIds:d,corpusEventIds:c}=u.useMemo(()=>{const T=[],x=[],M=[];return n.forEach(R=>{R.includes("PRIMARY")?T.push(R):R.includes("CORPUS")?M.push(R):x.push(R)}),{primaryEventIds:T,referenceEventIds:x,corpusEventIds:M}},[n]),p=I.useLazyLoadQuery(sd,{primaryEventIds:[...o],referenceEventIds:[...d],corpusEventIds:[...c]}),y=u.useMemo(()=>{var R,O,N,j,Y,se;const T=((O=(R=p.model)==null?void 0:R.primaryInferences)==null?void 0:O.events)??[],x=((j=(N=p.model)==null?void 0:N.referenceInferences)==null?void 0:j.events)??[],M=((se=(Y=p.model)==null?void 0:Y.corpusInferences)==null?void 0:se.events)??[];return[...T,...x,...M]},[p]),m=()=>{a(new Set),t(null)},g=B(T=>T.eventIdToDataMap),f=B(T=>T.pointData),k=B(T=>T.selectionSearchText),b=u.useMemo(()=>y.map(T=>{var R,O,N,j,Y,se,ye;const x=g.get(T.id),M=[];return f!=null&&(x==null?void 0:x.retrievals)!=null&&x.retrievals.forEach(({documentId:be,relevance:Sn})=>{const $n=f[be];$n!=null&&M.push(gk({event:$n,relevance:Sn}))}),{id:T.id,predictionId:((R=T.eventMetadata)==null?void 0:R.predictionId)??null,actualLabel:((O=T.eventMetadata)==null?void 0:O.actualLabel)??null,actualScore:((N=T.eventMetadata)==null?void 0:N.actualScore)??null,predictionLabel:((j=T.eventMetadata)==null?void 0:j.predictionLabel)??null,predictionScore:((Y=T.eventMetadata)==null?void 0:Y.predictionScore)??null,rawData:(x==null?void 0:x.embeddingMetadata.rawData)??null,linkToData:(x==null?void 0:x.embeddingMetadata.linkToData)??null,dimensions:T.dimensions,prompt:((se=T.promptAndResponse)==null?void 0:se.prompt)??null,response:((ye=T.promptAndResponse)==null?void 0:ye.response)??null,retrievedDocuments:M,documentText:T.documentText??null}}),[y,g,f]),S=u.useMemo(()=>{if(k){const T=k.toLowerCase();return b.filter(x=>{var M,R,O,N;return x.id.includes(T)||((M=x.documentText)==null?void 0:M.toLowerCase().includes(T))||((R=x.predictionId)==null?void 0:R.includes(T))||((O=x.prompt)==null?void 0:O.toLowerCase().includes(T))||((N=x.response)==null?void 0:N.toLowerCase().includes(T))})}return b},[b,k]),F=u.useMemo(()=>{if(k){const T=k.toLowerCase();return y.filter(x=>{var M,R,O,N,j,Y,se;return x.id.includes(T)||((M=x.documentText)==null?void 0:M.toLowerCase().includes(T))||((O=(R=x.eventMetadata)==null?void 0:R.predictionId)==null?void 0:O.includes(T))||((j=(N=x.promptAndResponse)==null?void 0:N.prompt)==null?void 0:j.toLowerCase().includes(T))||((se=(Y=x.promptAndResponse)==null?void 0:Y.response)==null?void 0:se.toLowerCase().includes(T))})}return y},[y,k]),P=u.useMemo(()=>i?b.find(x=>x.id===i)??null:null,[b,i]),D=y.length,w=F.length;return s("section",{css:pk,children:[s("div",{role:"toolbar",css:K`
          position: absolute;
          top: var(--ac-global-dimension-static-size-100);
          right: var(--ac-global-dimension-static-size-200);
          display: flex;
          flex-direction: row-reverse;
          gap: var(--ac-global-dimension-static-size-100);
        `,children:[e(A,{size:"S",leadingVisual:e(L,{svg:e(Pm,{})}),"aria-label":"Clear selection",onPress:m}),e(ok,{})]}),e(He,{children:s(ae,{name:"Selection",children:[e(fk,{numSelectedEvents:D,numMatchingEvents:w,searchText:k}),l===Mr.list?e("div",{css:K`
                flex: 1 1 auto;
                overflow-y: auto;
              `,children:e(uk,{data:S,onPointSelected:r})}):e(ck,{events:F,onItemSelected:r})]})}),e(X,{type:"slideOver",isDismissable:!0,onDismiss:()=>r(null),children:P&&e(Z,{title:"Embedding Details",size:"L",children:e(Y1,{event:P})})})]})}function fk({numSelectedEvents:n,numMatchingEvents:a,searchText:t}){const l=B(p=>p.selectionDisplay),i=B(p=>p.setSelectionDisplay),r=B(p=>p.selectionGridSize),o=B(p=>p.setSelectionGridSize),d=B(p=>p.setSelectionSearchText),c=u.useMemo(()=>t?`${a}/${n} match "${t}"`:`${n} selected`,[n,a,t]);return e(Ql,{extra:s("div",{css:K`
            display: flex;
            flex-direction: row;
            gap: var(--ac-global-dimension-static-size-100);
          `,children:[e(Im,{placeholder:"Search by text or ID",onChange:p=>{d(p)}}),l===Mr.gallery&&e(Wp,{size:r,onChange:o}),e(Jp,{mode:l,onChange:p=>{i(p)}})]}),children:e(v,{children:c})})}const cd=nd;function T2(){const{referenceInferences:n,corpusInferences:a}=bn(),{timeRange:t}=Vn(),l=u.useMemo(()=>{let i={};return a!=null?i=Yp():n!=null?i=eg():i=ng(),i={...i,umapParameters:{...window.Config.UMAP}},i},[a,n]);return e(Vr,{initialTimestamp:t.end,children:e(ag,{...l,children:e(hk,{})})})}function hk(){const n=z1(),{primaryInferences:a,referenceInferences:t}=bn(),l=B(F=>F.umapParameters),i=B(F=>F.getHDSCANParameters),r=B(F=>F.getMetric),o=B(F=>F.reset),d=B(F=>F.setLoading),[c,p]=u.useState(!0),[y,m,g]=I.useQueryLoader(cd),{selectedTimestamp:f}=Mt(),k=u.useMemo(()=>f??new Date(a.endTime),[f,a.endTime]),b=u.useMemo(()=>({start:lr(k,2).toISOString(),end:k.toISOString()}),[k]),S=I.useLazyLoadQuery(ed,{});return u.useEffect(()=>{o(),d(!0);const F=r();return m({id:n,timeRange:b,...l,...i(),fetchDataQualityMetric:F.type==="dataQuality",fetchPerformanceMetric:F.type==="performance",dataQualityMetricColumnName:F.type==="dataQuality"?F.dimension.name:null,performanceMetric:F.type==="performance"?F.metric:"accuracyScore"},{fetchPolicy:"network-only"}),()=>{g()}},[d,o,n,m,g,l,i,r,b]),s("main",{css:K`
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      `,children:[e(Tk,{}),s(Ql,{extra:s(h,{direction:"row",justifyContent:"center",alignItems:"center",gap:"size-100",children:[e(ya,{onChange:F=>{p(F)},defaultSelected:!0,labelPlacement:"start",children:"Show Timeseries"}),e(O1,{})]}),children:[e(Dr,{}),t?e(_r,{inferencesRole:"reference",timeRange:{start:new Date(t.startTime),end:new Date(t.endTime)}}):null,e(B1,{model:S.model})]}),s(Pn,{direction:"vertical",children:[c?s(U,{children:[e(_e,{defaultSize:20,collapsible:!0,order:1,children:e(u.Suspense,{fallback:e(ge,{}),children:e(J1,{embeddingDimensionId:n})})}),e(Tn,{css:La})]}):null,e(_e,{order:2,children:e("div",{css:K`
              width: 100%;
              height: 100%;
              position: relative;
            `,children:e(u.Suspense,{fallback:e(tg,{}),children:y?e(bk,{queryReference:y}):null})})})]})]})}function kk(n){if(n.__typename!=="Point3D")throw new Error(`Expected Point3D but got ${n.__typename} for coordinates`);return[n.x,n.y,n.z]}function bk({queryReference:n}){const a=I.usePreloadedQuery(cd,n),t=u.useMemo(()=>{var p,y;return((y=(p=a.embedding)==null?void 0:p.UMAPPoints)==null?void 0:y.data)??[]},[a]),l=u.useMemo(()=>{var p,y;return((y=(p=a.embedding)==null?void 0:p.UMAPPoints)==null?void 0:y.referenceData)??[]},[a]),i=u.useMemo(()=>{var p,y;return((y=(p=a.embedding)==null?void 0:p.UMAPPoints)==null?void 0:y.corpusData)??[]},[a]),r=u.useMemo(()=>{var p,y;return((y=(p=a.embedding)==null?void 0:p.UMAPPoints)==null?void 0:y.contextRetrievals)??[]},[a]),o=u.useMemo(()=>[...t,...l,...i].map(y=>({...y,position:kk(y.coordinates),metaData:{id:y.eventId}})),[l,t,i]),d=B(p=>p.setInitialData),c=B(p=>p.setClusters);return ym(()=>{var y,m;const p=((m=(y=a.embedding)==null?void 0:y.UMAPPoints)==null?void 0:m.clusters)||[];d({points:o,clusters:p,retrievals:r})},[o,n,r,d,c]),e("div",{css:K`
        flex: 1 1 auto;
        display: flex;
        flex-direction: row;
        align-items: stretch;
        width: 100%;
        height: 100%;
      `,"data-testid":"point-cloud-display",children:s(Pn,{direction:"horizontal",children:[e(_e,{id:"embedding-left",defaultSize:15,maxSize:30,minSize:10,collapsible:!0,children:s(Pn,{autoSaveId:"embedding-controls-vertical",direction:"vertical",children:[e(_e,{css:K`
                display: flex;
                flex-direction: column;
                .ac-tabs {
                  height: 100%;
                  overflow: hidden;
                  display: flex;
                  flex-direction: column;
                  [role="tablist"] {
                    flex: none;
                  }
                  .ac-tabs__pane-container {
                    flex: 1 1 auto;
                    overflow: hidden;
                    display: flex;
                    flex-direction: column;
                    & > div {
                      height: 100%;
                    }
                  }
                }
              `,children:e(Fk,{})}),e(Tn,{css:La}),e(_e,{css:K`
                .ac-tabs {
                  height: 100%;
                  overflow: hidden;
                  .ac-tabs__pane-container {
                    height: 100%;
                    overflow-y: auto;
                  }
                }
              `,children:s(He,{children:[e(ae,{name:"Display",children:e(lg,{})}),e(ae,{name:"Hyperparameters",children:e(ig,{})})]})})]})}),e(Tn,{css:Rl}),e(_e,{children:s("div",{css:K`
              position: relative;
              width: 100%;
              height: 100%;
            `,children:[e(Sk,{}),e(rg,{})]})})]})})}function Sk(){return B(a=>a.selectedEventIds).size===0?null:e("div",{css:K`
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
      `,"data-testid":"selection-panel",children:s(Pn,{direction:"vertical",children:[e(_e,{}),e(Tn,{css:La,style:{zIndex:1}}),e(_e,{id:"embedding-point-selection",defaultSize:40,minSize:20,order:2,style:{zIndex:1},children:e(vk,{children:e(u.Suspense,{fallback:e(ge,{}),children:e(yk,{})})})})]})})}function vk(n){return e("div",{css:K`
        background-color: var(--ac-global-color-grey-75);
        width: 100%;
        height: 100%;
      `,children:n.children})}const Ck=1,Fk=Ke.memo(function(){const{referenceInferences:a}=bn(),t=B(m=>m.clusters),l=B(m=>m.selectedClusterId),i=B(m=>m.metric),r=B(m=>m.setSelectedClusterId),o=B(m=>m.setSelectedEventIds),d=B(m=>m.setHighlightedClusterId),c=B(m=>m.setClusterColorMode),p=a==null||i.type==="drift",y=u.useCallback(m=>{c(m===Ck?Fi.highlight:Fi.default)},[c]);return s(He,{onChange:y,children:[e(ae,{name:"Clusters",extra:e(dn,{children:t.length}),children:s(h,{direction:"column",height:"100%",children:[e(C,{borderBottomColor:"dark",borderBottomWidth:"thin",backgroundColor:"dark",flex:"none",padding:"size-50",children:e(h,{direction:"row",justifyContent:"end",children:e($1,{})})}),e(C,{flex:"1 1 auto",overflow:"auto",children:e("ul",{css:K`
                flex: 1 1 auto;
                display: flex;
                flex-direction: column;
                gap: var(--ac-global-dimension-size-100);
                margin: var(--ac-global-dimension-size-100);
              `,children:t.map(m=>e("li",{children:e(Zp,{clusterId:m.id,numPoints:m.eventIds.length,isSelected:l===m.id,driftRatio:m.driftRatio,primaryToCorpusRatio:m.primaryToCorpusRatio,primaryMetricValue:m.primaryMetricValue,referenceMetricValue:m.referenceMetricValue,metricName:Kk(i),hideReference:p,onClick:()=>{l!==m.id?(r(m.id),o(new Set(m.eventIds))):(r(null),o(new Set))},onMouseEnter:()=>{d(m.id)},onMouseLeave:()=>{d(null)}})},m.id))})})]})}),e(ae,{name:"Configuration",children:e(C,{overflow:"auto",height:"100%",children:e(Xp,{})})})]})});function Kk(n){const{type:a,metric:t}=n;switch(a){case"dataQuality":return`${n.dimension.name} avg`;case"drift":{switch(t){case"euclideanDistance":return"Cluster Drift";default:fe()}break}case"performance":return ca(t);case"retrieval":{switch(t){case"queryDistance":return"% Query";default:fe()}break}default:fe()}}function Tk(){const{notifyError:n}=Lr(),a=B(l=>l.errorMessage),t=B(l=>l.setErrorMessage);return u.useEffect(()=>{a!==null&&n({title:"An error occurred",message:a,action:{text:"Dismiss",onClick:()=>{t(null)}}})},[a,n,t]),null}const ud=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"embeddingLoaderQuery",selections:[{alias:"embedding",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[t,l],type:"EmbeddingDimension",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"embeddingLoaderQuery",selections:[{alias:"embedding",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},t,{kind:"InlineFragment",selections:[l],type:"EmbeddingDimension",abstractKey:null}],storageKey:null}]},params:{cacheID:"cff0ac130f1ef79784f7bef4161ac60d",id:null,metadata:{},name:"embeddingLoaderQuery",operationKind:"query",text:`query embeddingLoaderQuery(
  $id: GlobalID!
) {
  embedding: node(id: $id) {
    __typename
    ... on EmbeddingDimension {
      id
      name
    }
    __isNode: __typename
    id
  }
}
`}}}();ud.hash="c049e57d92943f64b5e751e0daa89dc8";async function P2(n){const{embeddingDimensionId:a}=n.params;return I.fetchQuery(he,ud,{id:a}).toPromise()}const md=function(){var n={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},a={defaultValue:null,kind:"LocalArgument",name:"hasReference"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},l=[{kind:"Variable",name:"id",variableName:"dimensionId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={kind:"Variable",name:"timeRange",variableName:"timeRange"},o=[r],d=[{kind:"Variable",name:"hasReference",variableName:"hasReference"},r],c={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},p=[{alias:null,args:null,kind:"ScalarField",name:"primaryValue",storageKey:null}],y={kind:"Literal",name:"metric",value:"cardinality"},m={kind:"Literal",name:"metric",value:"percentEmpty"},g={kind:"Literal",name:"inferencesRole",value:"reference"};return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"DimensionPageQuery",selections:[{alias:"dimension",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[i,{args:o,kind:"FragmentSpread",name:"DimensionSegmentsBarChart_dimension"},{args:o,kind:"FragmentSpread",name:"DimensionCountStats_dimension"},{args:o,kind:"FragmentSpread",name:"DimensionDriftStats_dimension"},{args:d,kind:"FragmentSpread",name:"DimensionCardinalityStats_dimension"},{args:d,kind:"FragmentSpread",name:"DimensionPercentEmptyStats_dimension"},{args:o,kind:"FragmentSpread",name:"DimensionQuantilesStats_dimension"}],type:"Dimension",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,t,a],kind:"Operation",name:"DimensionPageQuery",selections:[{alias:"dimension",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[c,{kind:"TypeDiscriminator",abstractKey:"__isNode"},i,{kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"primaryTimeRange",variableName:"timeRange"}],concreteType:"Segments",kind:"LinkedField",name:"segmentsComparison",plural:!1,selections:[{alias:null,args:null,concreteType:"Segment",kind:"LinkedField",name:"segments",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"bin",plural:!1,selections:[c,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],type:"NominalBin",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"NumericRange",kind:"LinkedField",name:"range",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"start",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end",storageKey:null}],storageKey:null}],type:"IntervalBin",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"counts",plural:!1,selections:p,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"totalCounts",plural:!1,selections:p,storageKey:null}],storageKey:null},{alias:"count",args:[{kind:"Literal",name:"metric",value:"count"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"psi",args:[{kind:"Literal",name:"metric",value:"psi"},r],kind:"ScalarField",name:"driftMetric",storageKey:null},{alias:"cardinality",args:[y,r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"percentEmpty",args:[m,r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p99",args:[{kind:"Literal",name:"metric",value:"p99"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p75",args:[{kind:"Literal",name:"metric",value:"p75"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p50",args:[{kind:"Literal",name:"metric",value:"p50"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p25",args:[{kind:"Literal",name:"metric",value:"p25"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p1",args:[{kind:"Literal",name:"metric",value:"p01"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{condition:"hasReference",kind:"Condition",passingValue:!0,selections:[{alias:"referenceCardinality",args:[g,y],kind:"ScalarField",name:"dataQualityMetric",storageKey:'dataQualityMetric(inferencesRole:"reference",metric:"cardinality")'},{alias:"referencePercentEmpty",args:[g,m],kind:"ScalarField",name:"dataQualityMetric",storageKey:'dataQualityMetric(inferencesRole:"reference",metric:"percentEmpty")'}]}],type:"Dimension",abstractKey:null}],storageKey:null}]},params:{cacheID:"2ad937e56d4647309b9d78ac11f57265",id:null,metadata:{},name:"DimensionPageQuery",operationKind:"query",text:`query DimensionPageQuery(
  $dimensionId: GlobalID!
  $timeRange: TimeRange!
  $hasReference: Boolean!
) {
  dimension: node(id: $dimensionId) {
    __typename
    ... on Dimension {
      id
      ...DimensionSegmentsBarChart_dimension_3E0ZE6
      ...DimensionCountStats_dimension_3E0ZE6
      ...DimensionDriftStats_dimension_3E0ZE6
      ...DimensionCardinalityStats_dimension_1JBzL3
      ...DimensionPercentEmptyStats_dimension_1JBzL3
      ...DimensionQuantilesStats_dimension_3E0ZE6
    }
    __isNode: __typename
    id
  }
}

fragment DimensionCardinalityStats_dimension_1JBzL3 on Dimension {
  id
  cardinality: dataQualityMetric(metric: cardinality, timeRange: $timeRange)
  referenceCardinality: dataQualityMetric(metric: cardinality, inferencesRole: reference) @include(if: $hasReference)
}

fragment DimensionCountStats_dimension_3E0ZE6 on Dimension {
  id
  count: dataQualityMetric(metric: count, timeRange: $timeRange)
}

fragment DimensionDriftStats_dimension_3E0ZE6 on Dimension {
  id
  psi: driftMetric(metric: psi, timeRange: $timeRange)
}

fragment DimensionPercentEmptyStats_dimension_1JBzL3 on Dimension {
  id
  percentEmpty: dataQualityMetric(metric: percentEmpty, timeRange: $timeRange)
  referencePercentEmpty: dataQualityMetric(metric: percentEmpty, inferencesRole: reference) @include(if: $hasReference)
}

fragment DimensionQuantilesStats_dimension_3E0ZE6 on Dimension {
  p99: dataQualityMetric(metric: p99, timeRange: $timeRange)
  p75: dataQualityMetric(metric: p75, timeRange: $timeRange)
  p50: dataQualityMetric(metric: p50, timeRange: $timeRange)
  p25: dataQualityMetric(metric: p25, timeRange: $timeRange)
  p1: dataQualityMetric(metric: p01, timeRange: $timeRange)
}

fragment DimensionSegmentsBarChart_dimension_3E0ZE6 on Dimension {
  id
  segmentsComparison(primaryTimeRange: $timeRange) {
    segments {
      bin {
        __typename
        ... on NominalBin {
          __typename
          name
        }
        ... on IntervalBin {
          __typename
          range {
            start
            end
          }
        }
        ... on MissingValueBin {
          __typename
        }
      }
      counts {
        primaryValue
      }
    }
    totalCounts {
      primaryValue
    }
  }
}
`}}}();md.hash="d194bfd656408e8ba7cb427ddc80fc85";const pd=function(){var n={kind:"Literal",name:"metric",value:"cardinality"};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"hasReference"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionCardinalityStats_dimension",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:"cardinality",args:[n,{kind:"Variable",name:"timeRange",variableName:"timeRange"}],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{condition:"hasReference",kind:"Condition",passingValue:!0,selections:[{alias:"referenceCardinality",args:[{kind:"Literal",name:"inferencesRole",value:"reference"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:'dataQualityMetric(inferencesRole:"reference",metric:"cardinality")'}]}],type:"Dimension",abstractKey:null}}();pd.hash="8b4edef350e4df49e799afa70ca34918";function Pk(n){const a=I.useFragment(pd,n.dimension);return s(U,{children:[e(v,{elementType:"h3",size:"XS",color:"text-700",children:"Cardinality"}),e(v,{children:ua(a.cardinality)}),a.referenceCardinality!=null&&e(v,{size:"S",color:"purple-800",children:ua(a.referenceCardinality)})]})}const gd=function(){var n={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},a={defaultValue:null,kind:"LocalArgument",name:"granularity"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},l=[{kind:"Variable",name:"id",variableName:"dimensionId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={kind:"InlineFragment",selections:[{alias:"cardinalityTimeSeries",args:[{kind:"Variable",name:"granularity",variableName:"granularity"},{kind:"Literal",name:"metric",value:"cardinality"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null}],type:"Dimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"DimensionCardinalityTimeSeriesQuery",selections:[{alias:"dimension",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,r],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,t,a],kind:"Operation",name:"DimensionCardinalityTimeSeriesQuery",selections:[{alias:"dimension",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,r],storageKey:null}]},params:{cacheID:"f53e5ac5e0bfd6a0a6c50b761223a617",id:null,metadata:{},name:"DimensionCardinalityTimeSeriesQuery",operationKind:"query",text:`query DimensionCardinalityTimeSeriesQuery(
  $dimensionId: GlobalID!
  $timeRange: TimeRange!
  $granularity: Granularity!
) {
  dimension: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      cardinalityTimeSeries: dataQualityTimeSeries(metric: cardinality, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
}
`}}}();gd.hash="88ce04bb2022d5e2bc75c663abd7e5de";const it={top:25,right:18,left:18,bottom:5},Ik=new Intl.NumberFormat([],{maximumFractionDigits:2}),yd=()=>{const{gray300:n}=Rn();return{color:n}};function xk({active:n,payload:a,label:t}){var i;const{color:l}=yd();if(n&&a&&a.length){const r=((i=a[0])==null?void 0:i.value)??null,o=typeof r=="number"?Ik.format(r):"--";return s(An,{children:[e(v,{weight:"heavy",size:"S",children:`${pn(new Date(t))}`}),e(Re,{color:l,name:"Cardinality",value:o}),e(Vt,{})]})}return null}function Dk({dimensionId:n}){var d;const{timeRange:a}=Vn(),t=Ea(a),l=I.useLazyLoadQuery(gd,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},granularity:t}),{color:i}=yd(),r=((d=l.dimension.cardinalityTimeSeries)==null?void 0:d.data.map(c=>({timestamp:new Date(c.timestamp).valueOf(),value:c.value})))||[],o=Ma({samplingIntervalMinutes:t.samplingIntervalMinutes});return e(Nn,{width:"100%",height:"100%",children:s(tt,{data:r,margin:it,syncId:"dimensionDetails",children:[e("defs",{children:s("linearGradient",{id:"cardinalityColorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:i,stopOpacity:.8}),e("stop",{offset:"95%",stopColor:i,stopOpacity:0})]})}),e(ia,{...Va,tickFormatter:c=>o(new Date(c))}),e(yn,{stroke:"var(--ac-global-color-grey-500)",label:{value:"Cardinality",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(ra,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(zn,{content:e(xk,{})}),e(Za,{type:"monotone",dataKey:"value",stroke:i,fillOpacity:1,fill:"url(#cardinalityColorUv)"})]})})}const fd={argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionCountStats_dimension",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:"count",args:[{kind:"Literal",name:"metric",value:"count"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],kind:"ScalarField",name:"dataQualityMetric",storageKey:null}],type:"Dimension",abstractKey:null};fd.hash="6dccac51f3fb0853276677c692af5a43";function _k(n){const t=I.useFragment(fd,n.dimension).count??0;return s(U,{children:[e(v,{elementType:"h3",size:"XS",color:"text-700",children:"Total Count"}),e(v,{size:"L",children:ua(t)})]})}const hd=function(){var n={defaultValue:null,kind:"LocalArgument",name:"countGranularity"},a={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},l=[{kind:"Variable",name:"id",variableName:"dimensionId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={kind:"InlineFragment",selections:[{alias:"trafficTimeSeries",args:[{kind:"Variable",name:"granularity",variableName:"countGranularity"},{kind:"Literal",name:"metric",value:"count"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null}],type:"Dimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"DimensionCountTimeSeriesQuery",selections:[{alias:"embedding",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,r],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,t,n],kind:"Operation",name:"DimensionCountTimeSeriesQuery",selections:[{alias:"embedding",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,r],storageKey:null}]},params:{cacheID:"1f9eff6d8d453148844edae32b844df7",id:null,metadata:{},name:"DimensionCountTimeSeriesQuery",operationKind:"query",text:`query DimensionCountTimeSeriesQuery(
  $dimensionId: GlobalID!
  $timeRange: TimeRange!
  $countGranularity: Granularity!
) {
  embedding: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      trafficTimeSeries: dataQualityTimeSeries(metric: count, timeRange: $timeRange, granularity: $countGranularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
}
`}}}();hd.hash="9677ef7c6b298554824fe3fd3904c7aa";const Lk=new Intl.NumberFormat([],{maximumFractionDigits:2}),kd=()=>{const{gray300:n}=Rn();return{barColor:n}};function wk({active:n,payload:a,label:t}){var i;const{barColor:l}=kd();if(n&&a&&a.length){const r=((i=a[0])==null?void 0:i.value)??null,o=typeof r=="number"?Lk.format(r):"--";return s(An,{children:[e(v,{weight:"heavy",size:"S",children:`${pn(new Date(t))}`}),e(Re,{color:l,shape:"square",name:"Count",value:o})]})}return null}function Ek({dimensionId:n}){var c;const{timeRange:a}=Vn(),t=Ea(a),r=(((c=I.useLazyLoadQuery(hd,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},countGranularity:t}).embedding.trafficTimeSeries)==null?void 0:c.data)||[]).map(p=>({...p,timestamp:new Date(p.timestamp).valueOf()})),o=Ma({samplingIntervalMinutes:t.samplingIntervalMinutes}),{barColor:d}=kd();return e(Nn,{width:"100%",height:"100%",children:s(Hl,{data:r,margin:it,syncId:"dimensionDetails",children:[e("defs",{children:s("linearGradient",{id:"countBarColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:d,stopOpacity:1}),e("stop",{offset:"95%",stopColor:d,stopOpacity:.5})]})}),e(ia,{...Va,tickFormatter:p=>o(new Date(p))}),e(yn,{stroke:"var(--ac-global-color-grey-500)",label:{value:"Count",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(ra,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(zn,{...jl,content:e(wk,{})}),e(Ia,{dataKey:"value",fill:"url(#countBarColor)",spacing:5})]})})}const bd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"dimensionId"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"dimensionId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[{kind:"Variable",name:"primaryTimeRange",variableName:"timeRange"}],i={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},o={alias:null,args:null,concreteType:"NumericRange",kind:"LinkedField",name:"range",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"start",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end",storageKey:null}],storageKey:null},d=[{alias:null,args:null,kind:"ScalarField",name:"primaryValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"referenceValue",storageKey:null}],c={alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"counts",plural:!1,selections:d,storageKey:null},p={alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"totalCounts",plural:!1,selections:d,storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DimensionDriftBreakdownSegmentBarChartQuery",selections:[{alias:"dimension",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"InlineFragment",selections:[{kind:"RequiredField",field:{alias:null,args:l,concreteType:"Segments",kind:"LinkedField",name:"segmentsComparison",plural:!1,selections:[{alias:null,args:null,concreteType:"Segment",kind:"LinkedField",name:"segments",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"bin",plural:!1,selections:[{kind:"InlineFragment",selections:[i,r],type:"NominalBin",abstractKey:null},{kind:"InlineFragment",selections:[i,o],type:"IntervalBin",abstractKey:null},{kind:"InlineFragment",selections:[i],type:"MissingValueBin",abstractKey:null}],storageKey:null},c],storageKey:null},p],storageKey:null},action:"THROW"}],type:"Dimension",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DimensionDriftBreakdownSegmentBarChartQuery",selections:[{alias:"dimension",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,t,{kind:"InlineFragment",selections:[{alias:null,args:l,concreteType:"Segments",kind:"LinkedField",name:"segmentsComparison",plural:!1,selections:[{alias:null,args:null,concreteType:"Segment",kind:"LinkedField",name:"segments",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"bin",plural:!1,selections:[i,{kind:"InlineFragment",selections:[r],type:"NominalBin",abstractKey:null},{kind:"InlineFragment",selections:[o],type:"IntervalBin",abstractKey:null}],storageKey:null},c],storageKey:null},p],storageKey:null}],type:"Dimension",abstractKey:null}],storageKey:null}]},params:{cacheID:"7d11d88f419003f5ee8cd9d11312e427",id:null,metadata:{},name:"DimensionDriftBreakdownSegmentBarChartQuery",operationKind:"query",text:`query DimensionDriftBreakdownSegmentBarChartQuery(
  $dimensionId: GlobalID!
  $timeRange: TimeRange!
) {
  dimension: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      segmentsComparison(primaryTimeRange: $timeRange) {
        segments {
          bin {
            __typename
            ... on NominalBin {
              __typename
              name
            }
            ... on IntervalBin {
              __typename
              range {
                start
                end
              }
            }
            ... on MissingValueBin {
              __typename
            }
          }
          counts {
            primaryValue
            referenceValue
          }
        }
        totalCounts {
          primaryValue
          referenceValue
        }
      }
    }
  }
}
`}}}();bd.hash="6bb76e3cce4ee28c333e485b3aa2dffd";const qi=bl(".2f"),Sd=()=>{const{primary:n,reference:a}=Rn();return{primaryBarColor:n,referenceBarColor:a}};function Mk({active:n,payload:a,label:t}){var r,o,d,c,p,y;const{primaryBarColor:l,referenceBarColor:i}=Sd();if(n&&a&&a.length){const m=(o=(r=a[0])==null?void 0:r.payload)==null?void 0:o.primaryName,g=(d=a[0])==null?void 0:d.value,f=(p=(c=a[0])==null?void 0:c.payload)==null?void 0:p.referenceName,k=(y=a[1])==null?void 0:y.value;return s(An,{children:[e(v,{elementType:"h3",size:"S",weight:"heavy",children:t}),e(Re,{color:l,shape:"square",name:m,value:g!=null?`${qi(g)}%`:"--"}),e(Re,{color:i,shape:"square",name:f,value:k!=null?`${qi(k)}%`:"--"})]})}return null}function Vk(n){var g,f,k,b,S;const{primaryInferences:a,referenceInferences:t}=bn(),l=a.name,i=(t==null?void 0:t.name)||"reference",{selectedTimestamp:r}=Mt(),o=u.useMemo(()=>r??new Date(a.endTime),[r,a.endTime]),d=u.useMemo(()=>({start:lr(o,2).toISOString(),end:o.toISOString()}),[o]),c=I.useLazyLoadQuery(bd,{dimensionId:n.dimensionId,timeRange:d}),p=u.useMemo(()=>{var w,T,x,M,R;const F=((w=c.dimension.segmentsComparison)==null?void 0:w.segments)??[],P=((x=(T=c.dimension.segmentsComparison)==null?void 0:T.totalCounts)==null?void 0:x.primaryValue)??0,D=((R=(M=c.dimension.segmentsComparison)==null?void 0:M.totalCounts)==null?void 0:R.referenceValue)??0;return F.map(O=>{var be,Sn;const N=((be=O.counts)==null?void 0:be.primaryValue)??0,j=((Sn=O.counts)==null?void 0:Sn.referenceValue)??0,Y=Rr(O.bin),se=N/P*100,ye=j/D*100;return{name:Y,primaryName:l,referenceName:i,primaryPercent:se,referencePercent:ye}})},[(g=c.dimension.segmentsComparison)==null?void 0:g.segments,(k=(f=c.dimension.segmentsComparison)==null?void 0:f.totalCounts)==null?void 0:k.primaryValue,(S=(b=c.dimension.segmentsComparison)==null?void 0:b.totalCounts)==null?void 0:S.referenceValue,l,i]),{primaryBarColor:y,referenceBarColor:m}=Sd();return s(h,{direction:"column",height:"100%",children:[e(C,{flex:"none",paddingTop:"size-100",paddingStart:"size-200",children:e(v,{elementType:"h3",size:"S",color:"text-700",children:`Distribution comparison at ${pn(new Date(d.end))}`})}),e(C,{flex:!0,children:e(Nn,{children:s(Hl,{data:p,margin:{top:15,right:18,left:18,bottom:5},children:[s("defs",{children:[s("linearGradient",{id:"dimensionPrimarySegmentsBarColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:y,stopOpacity:1}),e("stop",{offset:"95%",stopColor:y,stopOpacity:.5})]}),s("linearGradient",{id:"dimensionReferenceSegmentsBarColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:m,stopOpacity:1}),e("stop",{offset:"95%",stopColor:m,stopOpacity:.5})]})]}),e(ia,{dataKey:"name",style:{fill:"var(--ac-global-text-color-700)"}}),e(yn,{stroke:"var(--ac-global-color-grey-500)",label:{value:"Percent",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(ra,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)"}),e(zn,{...jl,content:e(Mk,{})}),e(Ia,{dataKey:"primaryPercent",fill:"url(#dimensionPrimarySegmentsBarColor)"}),e(Ia,{dataKey:"referencePercent",fill:"url(#dimensionReferenceSegmentsBarColor)"})]})})})]})}const vd={argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionDriftStats_dimension",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:"psi",args:[{kind:"Literal",name:"metric",value:"psi"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],kind:"ScalarField",name:"driftMetric",storageKey:null}],type:"Dimension",abstractKey:null};vd.hash="f8a9fb08a14f63906e38bc247d50b189";const Rk=s(Da,{variant:"info",placement:"top end",children:[e(te,{weight:"heavy",level:4,children:"Population Stability Index"}),e(Xn,{children:e(v,{children:"PSI is a symmetric metric that measures the relative entropy, or difference in information represented by two distributions. It can be thought of as measuring the distance between two data distributions showing how different the two distributions are from each other."})}),e("footer",{children:e(nn,{href:"https://arize.com/blog-course/population-stability-index-psi/#:~:text=Population%20Stability%20Index%20(PSI)%20Overview,distributions%20are%20from%20each%20other.",children:"Learn more"})})]});function Ak(n){const a=I.useFragment(vd,n.dimension);return s(U,{children:[s(h,{direction:"row",alignItems:"center",gap:"size-25",children:[e(v,{elementType:"h3",size:"XS",color:"text-700",children:"PSI"}),Rk]}),e(v,{size:"L",children:Fa(a.psi)})]})}const Cd=function(){var n={defaultValue:null,kind:"LocalArgument",name:"countGranularity"},a={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},t={defaultValue:null,kind:"LocalArgument",name:"driftGranularity"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},i=[{kind:"Variable",name:"id",variableName:"dimensionId"}],r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},o={kind:"Variable",name:"timeRange",variableName:"timeRange"},d=[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],c={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"granularity",variableName:"driftGranularity"},{kind:"Literal",name:"metric",value:"psi"},o],concreteType:"DriftTimeSeries",kind:"LinkedField",name:"driftTimeSeries",plural:!1,selections:d,storageKey:null},{alias:"trafficTimeSeries",args:[{kind:"Variable",name:"granularity",variableName:"countGranularity"},{kind:"Literal",name:"metric",value:"count"},o],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:d,storageKey:null}],type:"Dimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,t,l],kind:"Fragment",metadata:null,name:"DimensionDriftTimeSeriesQuery",selections:[{alias:"embedding",args:i,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[r,c],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,l,t,n],kind:"Operation",name:"DimensionDriftTimeSeriesQuery",selections:[{alias:"embedding",args:i,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r,c],storageKey:null}]},params:{cacheID:"af2d25e28675891b3c8a6bc75027f731",id:null,metadata:{},name:"DimensionDriftTimeSeriesQuery",operationKind:"query",text:`query DimensionDriftTimeSeriesQuery(
  $dimensionId: GlobalID!
  $timeRange: TimeRange!
  $driftGranularity: Granularity!
  $countGranularity: Granularity!
) {
  embedding: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      driftTimeSeries(metric: psi, timeRange: $timeRange, granularity: $driftGranularity) {
        data {
          timestamp
          value
        }
      }
      trafficTimeSeries: dataQualityTimeSeries(metric: count, timeRange: $timeRange, granularity: $countGranularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
}
`}}}();Cd.hash="6312b58dbb252b17efdf08d44dd58630";const Fd=()=>{const{orange300:n,gray300:a}=Rn();return{color:n,barColor:a}};function Nk({active:n,payload:a,label:t}){var i;const{color:l}=Fd();if(n&&a&&a.length){const r=((i=a[1])==null?void 0:i.value)??null;return s(An,{children:[e(v,{weight:"heavy",size:"S",children:`${pn(new Date(t))}`}),e(Re,{color:l,name:"PSI",value:Fa(r)}),e(Vt,{}),s("div",{css:K`
            display: flex;
            flex-direction: row;
            align-items: center;
            color: var(--ac-global-color-primary);
            gap: var(--ac-global-dimension-static-size-50);

            margin-top: var(--ac-global-dimension-static-size-50);
          `,children:[e(L,{svg:e(xn,{})}),e("span",{children:"Click to view details"})]})]})}return null}function zk({dimensionId:n}){var f,k;const{timeRange:a}=Vn(),{selectedTimestamp:t,setSelectedTimestamp:l}=Mt(),i=Ea(a),r=I.useLazyLoadQuery(Cd,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},driftGranularity:wr(a),countGranularity:i}),o=((f=r.embedding.driftTimeSeries)==null?void 0:f.data)||[],d=((k=r.embedding.trafficTimeSeries)==null?void 0:k.data.reduce((b,S)=>(b[S.timestamp]=S.value,b),{}))??{},c=o.map(b=>{const S=d[b.timestamp];return{...b,traffic:S,timestamp:new Date(b.timestamp).valueOf()}}),p=Ma({samplingIntervalMinutes:i.samplingIntervalMinutes}),y=u.useCallback(b=>{const{activePayload:S}=b;if(S!=null&&S.length>0){const F=S[0].payload;l(new Date(F.timestamp))}},[l]),{color:m,barColor:g}=Fd();return e(Nn,{width:"100%",height:"100%",children:s(tt,{data:c,margin:it,onClick:y,syncId:"dimensionDetails",children:[s("defs",{children:[s("linearGradient",{id:"dimensionDriftColorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:m,stopOpacity:.8}),e("stop",{offset:"95%",stopColor:m,stopOpacity:0})]}),s("linearGradient",{id:"barColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:g,stopOpacity:.8}),e("stop",{offset:"95%",stopColor:g,stopOpacity:0})]})]}),e(ia,{...Va,tickFormatter:b=>p(new Date(b))}),e(yn,{stroke:"var(--ac-global-color-grey-500)",label:{value:"PSI",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-color-grey-500)"}}),e(yn,{yAxisId:"right",orientation:"right",tick:!1,tickLine:!1,width:0}),e(ra,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(zn,{content:e(Nk,{})}),e(Ia,{yAxisId:"right",dataKey:"traffic",fill:"url(#barColor)",spacing:5}),e(Za,{type:"monotone",dataKey:"value",stroke:m,fillOpacity:1,fill:"url(#dimensionDriftColorUv)"}),t!=null?e(Yr,{...Er,x:t.getTime()}):null]})})}const Kd=function(){var n={kind:"Literal",name:"metric",value:"percentEmpty"};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"hasReference"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionPercentEmptyStats_dimension",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:"percentEmpty",args:[n,{kind:"Variable",name:"timeRange",variableName:"timeRange"}],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{condition:"hasReference",kind:"Condition",passingValue:!0,selections:[{alias:"referencePercentEmpty",args:[{kind:"Literal",name:"inferencesRole",value:"reference"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:'dataQualityMetric(inferencesRole:"reference",metric:"percentEmpty")'}]}],type:"Dimension",abstractKey:null}}();Kd.hash="1e10d0449d6607d9292f355548c41c78";function $k(n){const a=I.useFragment(Kd,n.dimension);return s(U,{children:[e(v,{elementType:"h3",size:"XS",color:"text-700",children:"% Empty"}),e(v,{size:"L",children:pt(a.percentEmpty)}),a.referencePercentEmpty!=null&&e(v,{size:"M",color:"purple-800",children:pt(a.referencePercentEmpty)})]})}const Td=function(){var n={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},a={defaultValue:null,kind:"LocalArgument",name:"granularity"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},l=[{kind:"Variable",name:"id",variableName:"dimensionId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={kind:"InlineFragment",selections:[{alias:"percentEmptyTimeSeries",args:[{kind:"Variable",name:"granularity",variableName:"granularity"},{kind:"Literal",name:"metric",value:"percentEmpty"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null}],type:"Dimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"DimensionPercentEmptyTimeSeriesQuery",selections:[{alias:"embedding",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,r],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,t,a],kind:"Operation",name:"DimensionPercentEmptyTimeSeriesQuery",selections:[{alias:"embedding",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,r],storageKey:null}]},params:{cacheID:"9be05c72f19755036f4829777a96f97d",id:null,metadata:{},name:"DimensionPercentEmptyTimeSeriesQuery",operationKind:"query",text:`query DimensionPercentEmptyTimeSeriesQuery(
  $dimensionId: GlobalID!
  $timeRange: TimeRange!
  $granularity: Granularity!
) {
  embedding: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      percentEmptyTimeSeries: dataQualityTimeSeries(metric: percentEmpty, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
}
`}}}();Td.hash="1e843d6c8dbe05b389b24188c6bdb394";const Ok=new Intl.NumberFormat([],{maximumFractionDigits:2}),Pd=()=>{const{gray100:n}=Rn();return{color:n}};function Qk({active:n,payload:a,label:t}){var i;const{color:l}=Pd();if(n&&a&&a.length){const r=((i=a[0])==null?void 0:i.value)??null,o=typeof r=="number"?Ok.format(r):"--";return s(An,{children:[e(v,{weight:"heavy",size:"S",children:`${pn(new Date(t))}`}),e(Re,{color:l,name:"% Empty",value:o})]})}return null}function jk({dimensionId:n}){var d;const{timeRange:a}=Vn(),t=Ea(a),i=((d=I.useLazyLoadQuery(Td,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},granularity:t}).embedding.percentEmptyTimeSeries)==null?void 0:d.data.map(c=>({timestamp:new Date(c.timestamp).valueOf(),value:c.value})))||[],r=Ma({samplingIntervalMinutes:t.samplingIntervalMinutes}),{color:o}=Pd();return e(Nn,{width:"100%",height:"100%",children:s(tt,{data:i,margin:it,syncId:"dimensionDetails",children:[e("defs",{children:s("linearGradient",{id:"percentEmptyColorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:o,stopOpacity:.8}),e("stop",{offset:"95%",stopColor:o,stopOpacity:0})]})}),e(ia,{...Va,tickFormatter:c=>r(new Date(c))}),e(yn,{stroke:"var(--ac-global-color-grey-500)",label:{value:"% Empty",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(ra,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(zn,{content:e(Qk,{})}),e(es,{type:"monotone",dataKey:"value",stroke:o,fillOpacity:1,fill:"url(#percentEmptyColorUv)"})]})})}const Id=function(){var n={kind:"Variable",name:"timeRange",variableName:"timeRange"};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionQuantilesStats_dimension",selections:[{alias:"p99",args:[{kind:"Literal",name:"metric",value:"p99"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p75",args:[{kind:"Literal",name:"metric",value:"p75"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p50",args:[{kind:"Literal",name:"metric",value:"p50"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p25",args:[{kind:"Literal",name:"metric",value:"p25"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p1",args:[{kind:"Literal",name:"metric",value:"p01"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:null}],type:"Dimension",abstractKey:null}}();Id.hash="c306c8eafb1d34be464d3a658d5f94a7";function qk(n){const a=I.useFragment(Id,n.dimension);return e("ul",{css:K`
        display: flex;
        flex-direction: column;
        gap: var(--ac-global-dimension-static-size-50);
      `,children:Object.keys(a).map(t=>{const l=a[t];return s("li",{css:K`
              display: flex;
              flex-direction: column;
              align-items: flex-end;
            `,children:[e(v,{elementType:"h3",size:"XS",color:"text-700",children:t}),e(v,{size:"S","data-raw":l,children:Vl(l)})]},t)})})}const xd=function(){var n={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},a={defaultValue:null,kind:"LocalArgument",name:"granularity"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},l=[{kind:"Variable",name:"id",variableName:"dimensionId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={kind:"Variable",name:"granularity",variableName:"granularity"},o={kind:"Variable",name:"timeRange",variableName:"timeRange"},d=[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],c={kind:"InlineFragment",selections:[{alias:"p99TimeSeries",args:[r,{kind:"Literal",name:"metric",value:"p99"},o],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:d,storageKey:null},{alias:"p75TimeSeries",args:[r,{kind:"Literal",name:"metric",value:"p75"},o],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:d,storageKey:null},{alias:"p50TimeSeries",args:[r,{kind:"Literal",name:"metric",value:"p50"},o],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:d,storageKey:null},{alias:"p25TimeSeries",args:[r,{kind:"Literal",name:"metric",value:"p25"},o],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:d,storageKey:null},{alias:"p01TimeSeries",args:[r,{kind:"Literal",name:"metric",value:"p01"},o],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:d,storageKey:null}],type:"Dimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"DimensionQuantilesTimeSeriesQuery",selections:[{alias:"dimension",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,c],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,t,a],kind:"Operation",name:"DimensionQuantilesTimeSeriesQuery",selections:[{alias:"dimension",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,c],storageKey:null}]},params:{cacheID:"0bb3d9faf9d7f0c2e27995120ae24e1c",id:null,metadata:{},name:"DimensionQuantilesTimeSeriesQuery",operationKind:"query",text:`query DimensionQuantilesTimeSeriesQuery(
  $dimensionId: GlobalID!
  $timeRange: TimeRange!
  $granularity: Granularity!
) {
  dimension: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      p99TimeSeries: dataQualityTimeSeries(metric: p99, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
      p75TimeSeries: dataQualityTimeSeries(metric: p75, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
      p50TimeSeries: dataQualityTimeSeries(metric: p50, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
      p25TimeSeries: dataQualityTimeSeries(metric: p25, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
      p01TimeSeries: dataQualityTimeSeries(metric: p01, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
}
`}}}();xd.hash="134f0dad0e0ecc7863dfbb0f437d829b";const Bk=bl("~s");var Dd=(n=>(n.p99_p01="p99_p01",n.p75_p25="p75_p25",n.p50="p50",n))(Dd||{});const Uk=new Intl.NumberFormat([],{maximumFractionDigits:2});function $a(n){return typeof n=="number"?Uk.format(n):"--"}const _d=()=>{const n=Rn();return{outerColor:n.gray500,innerColor:n.gray300,lineColor:n.default}};function Hk({active:n,payload:a,label:t}){const{outerColor:l,innerColor:i,lineColor:r}=_d();if(n&&a&&a.length){const o=a[0].payload;return s(An,{children:[e(v,{weight:"heavy",size:"S",children:`${pn(new Date(t))}`}),e(Re,{color:l,name:"p99",value:$a(o.p99_p01[0])}),e(Re,{color:i,name:"p75",value:$a(o.p75_p25[0])}),e(Re,{color:r,name:"p50",value:$a(o.p50)}),e(Re,{color:i,name:"p25",value:$a(o.p75_p25[1])}),e(Re,{color:l,name:"p01",value:$a(o.p99_p01[1])})]})}return null}function Gk({dimensionId:n}){var D,w,T,x,M;const{timeRange:a}=Vn(),t=Ea(a),l=I.useLazyLoadQuery(xd,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},granularity:t}),i=((D=l.dimension.p99TimeSeries)==null?void 0:D.data.map(R=>R))||[],r=((w=l.dimension.p01TimeSeries)==null?void 0:w.data.map(R=>R))||[],o=((T=l.dimension.p75TimeSeries)==null?void 0:T.data.map(R=>R))||[],d=((x=l.dimension.p25TimeSeries)==null?void 0:x.data.map(R=>R))||[],c=((M=l.dimension.p50TimeSeries)==null?void 0:M.data.map(R=>R))||[],p=i.map((R,O)=>({timestamp:new Date(R.timestamp).valueOf(),p99_p01:[R.value,r[O].value],p75_p25:[o[O].value,d[O].value],p50:c[O].value})),y=Ma({samplingIntervalMinutes:t.samplingIntervalMinutes}),[m,g]=u.useState(Object.keys(Dd).reduce((R,O)=>(R[O]=!1,R),{})),f=R=>{m[R.dataKey]||g({...m})},k=()=>{g({...m})},b=R=>{g({...m,[String(R.dataKey)]:!m[R.dataKey]})},{outerColor:S,innerColor:F,lineColor:P}=_d();return e(Nn,{width:"100%",height:"100%",children:s(tt,{data:p,margin:it,syncId:"dimensionDetails",children:[s("defs",{children:[s("linearGradient",{id:"p99_p01ColorUV",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"10%",stopColor:S,stopOpacity:.7}),e("stop",{offset:"50%",stopColor:S,stopOpacity:.3}),e("stop",{offset:"90%",stopColor:S,stopOpacity:.7})]}),s("linearGradient",{id:"p75_p25ColorUV",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"10%",stopColor:F,stopOpacity:.7}),e("stop",{offset:"50%",stopColor:F,stopOpacity:.3}),e("stop",{offset:"90%",stopColor:F,stopOpacity:.7})]})]}),e(ia,{...Va,tickFormatter:R=>y(new Date(R))}),e(yn,{stroke:"var(--ac-global-color-grey-500)",label:{value:"Value",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},tickFormatter:R=>Bk(R),style:{fill:"var(--ac-global-text-color-700)"}}),e(ra,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(zn,{content:e(Hk,{})}),e(Ag,{onClick:b,onMouseOver:f,onMouseOut:k}),e(Za,{type:"monotone",dataKey:"p99_p01",name:"p99 - p01",fillOpacity:1,fill:"url(#p99_p01ColorUV)",stroke:S,hide:m.p99_p01===!0}),e(Za,{type:"monotone",dataKey:"p75_p25",name:"p75 - p25",fillOpacity:1,stroke:F,fill:"url(#p75_p25ColorUV)",hide:m.p75_p25===!0}),e(es,{type:"monotone",dataKey:"p50",stroke:P,hide:m.p50===!0})]})})}const Ld=function(){var n={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},a=[{alias:null,args:null,kind:"ScalarField",name:"primaryValue",storageKey:null}];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionSegmentsBarChart_dimension",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:[{kind:"Variable",name:"primaryTimeRange",variableName:"timeRange"}],concreteType:"Segments",kind:"LinkedField",name:"segmentsComparison",plural:!1,selections:[{alias:null,args:null,concreteType:"Segment",kind:"LinkedField",name:"segments",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"bin",plural:!1,selections:[{kind:"InlineFragment",selections:[n,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],type:"NominalBin",abstractKey:null},{kind:"InlineFragment",selections:[n,{alias:null,args:null,concreteType:"NumericRange",kind:"LinkedField",name:"range",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"start",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end",storageKey:null}],storageKey:null}],type:"IntervalBin",abstractKey:null},{kind:"InlineFragment",selections:[n],type:"MissingValueBin",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"counts",plural:!1,selections:a,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"totalCounts",plural:!1,selections:a,storageKey:null}],storageKey:null}],type:"Dimension",abstractKey:null}}();Ld.hash="8cef9841e9a5bd7d0d50acb5db9028b0";const Wk=bl(".2f"),wd=()=>{const{primary:n}=Rn();return{color:n}};function Jk({active:n,payload:a,label:t}){var i;const{color:l}=wd();if(n&&a&&a.length){const r=(i=a[0])==null?void 0:i.value;return e(An,{children:e(Re,{color:l,shape:"square",name:t,value:r!=null?`${Wk(r)}%`:"--"})})}return null}function Zk(n){const a=I.useFragment(Ld,n.dimension),t=u.useMemo(()=>{var o,d,c;const i=((o=a.segmentsComparison)==null?void 0:o.segments)??[],r=((c=(d=a.segmentsComparison)==null?void 0:d.totalCounts)==null?void 0:c.primaryValue)??0;return i.map(p=>{var f;const y=((f=p.counts)==null?void 0:f.primaryValue)??0,m=Rr(p.bin),g=y/r*100;return{name:m,percent:g}})},[a]),{color:l}=wd();return e(Nn,{children:s(Hl,{data:t,margin:{top:25,right:18,left:18,bottom:5},children:[e("defs",{children:s("linearGradient",{id:"dimensionSegmentsBarColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:l,stopOpacity:1}),e("stop",{offset:"95%",stopColor:l,stopOpacity:.5})]})}),e(ia,{dataKey:"name",style:{fill:"var(--ac-global-text-color-700)"}}),e(yn,{stroke:"var(--ac-global-color-grey-500)",label:{value:"% Volume",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(ra,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(zn,{...jl,content:e(Jk,{})}),e(Ia,{dataKey:"percent",fill:"url(#dimensionSegmentsBarColor)",spacing:15})]})})}function I2(){const{dimensionId:n}=qe(),{timeRange:a}=Vn(),t=Be(),{referenceInferences:l}=bn(),i=l!==null,r=i,o=t.dimension.shape!=="continuous",d=t.dimension.dataType==="numeric",c=le(),p=I.useLazyLoadQuery(md,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},hasReference:i});if(!n)throw new Error("Dimension ID is required to display a dimension");return e(Vr,{initialTimestamp:new Date(a.end),children:e(X,{type:"slideOver",isDismissable:!0,onDismiss:()=>c(-1),children:e(Z,{size:"L",title:t.dimension.name,children:e("main",{css:K`
              padding: var(--ac-global-dimension-static-size-100);
              display: flex;
              flex-direction: column;
              min-height: 400px;
              overflow-y: auto;
              height: 100%;
            `,children:e(u.Suspense,{fallback:e(ge,{}),children:s(h,{direction:"column",gap:"size-100",children:[e(C,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",height:"size-1600",children:e(Zk,{dimension:p.dimension})}),e(C,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",height:"size-1600","data-testid":"dimension-count-time-series-view",children:s(h,{direction:"row",alignItems:"stretch",height:"100%",children:[e(Ek,{dimensionId:n}),e(oa,{children:e(_k,{dimension:p.dimension})})]})}),r?e(C,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",children:s(h,{direction:"column",alignItems:"stretch",children:[e(C,{width:"100%",height:"size-1600",children:s(h,{direction:"row",alignItems:"stretch",height:"100%",children:[e(C,{flex:!0,children:e(zk,{dimensionId:n})}),e(oa,{children:e(Ak,{dimension:p.dimension})})]})}),e(C,{height:"size-1600",width:"100%",borderTopColor:"dark",borderTopWidth:"thin",children:e(u.Suspense,{fallback:e(ge,{}),children:e(Vk,{dimensionId:n})})})]})}):null,d?e(C,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",height:"size-3000",children:s(h,{direction:"row",alignItems:"stretch",height:"100%",children:[e(C,{flex:!0,children:e(Gk,{dimensionId:n})}),e(oa,{children:e(qk,{dimension:p.dimension})})]})}):null,o?e(C,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",height:"size-1600",children:s(h,{direction:"row",alignItems:"stretch",height:"100%",children:[e(C,{flex:!0,children:e(Dk,{dimensionId:n})}),e(oa,{children:e(Pk,{dimension:p.dimension})})]})}):null,e(C,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",height:"size-1600",children:s(h,{direction:"row",alignItems:"stretch",height:"100%",children:[e(jk,{dimensionId:n}),e(oa,{children:e($k,{dimension:p.dimension})})]})})]})})})})})})}const Ed=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"dataType",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"shape",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"dimensionLoaderQuery",selections:[{alias:"dimension",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[t,l,i,r],type:"Dimension",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"dimensionLoaderQuery",selections:[{alias:"dimension",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},t,{kind:"InlineFragment",selections:[l,i,r],type:"Dimension",abstractKey:null}],storageKey:null}]},params:{cacheID:"03a9aafe3f08a9d093b029ff4a9e3253",id:null,metadata:{},name:"dimensionLoaderQuery",operationKind:"query",text:`query dimensionLoaderQuery(
  $id: GlobalID!
) {
  dimension: node(id: $id) {
    __typename
    ... on Dimension {
      id
      name
      dataType
      shape
    }
    __isNode: __typename
    id
  }
}
`}}}();Ed.hash="5a662d77e69d2e9bb4eb2af4cad6b722";async function x2(n){const{dimensionId:a}=n.params;return I.fetchQuery(he,Ed,{id:a}).toPromise()}const D2=()=>e(fm,{to:"traces"}),Md=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={kind:"Variable",name:"timeRange",variableName:"timeRange"},l=[t];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectPageQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"ProjectPageHeader_stats"},{args:null,kind:"FragmentSpread",name:"StreamToggle_data"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectPageQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:l,kind:"ScalarField",name:"traceCount",storageKey:null},{alias:null,args:l,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:l,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:l,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:"latencyMsP50",args:[{kind:"Literal",name:"probability",value:.5},t],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:"latencyMsP99",args:[{kind:"Literal",name:"probability",value:.99},t],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"documentEvaluationNames",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"streamingLastUpdatedAt",storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"662cf4bec023d1f6542eb6ab6e13ffc4",id:null,metadata:{},name:"ProjectPageQuery",operationKind:"query",text:`query ProjectPageQuery(
  $id: GlobalID!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...ProjectPageHeader_stats
    ...StreamToggle_data
    __isNode: __typename
    id
  }
}

fragment ProjectPageHeader_stats on Project {
  traceCount(timeRange: $timeRange)
  tokenCountTotal(timeRange: $timeRange)
  tokenCountPrompt(timeRange: $timeRange)
  tokenCountCompletion(timeRange: $timeRange)
  latencyMsP50: latencyMsQuantile(probability: 0.5, timeRange: $timeRange)
  latencyMsP99: latencyMsQuantile(probability: 0.99, timeRange: $timeRange)
  spanAnnotationNames
  documentEvaluationNames
  id
}

fragment StreamToggle_data on Project {
  streamingLastUpdatedAt
  id
}
`}}}();Md.hash="bc529abcda2506cd71b12e5f4d579f36";const Vd=u.createContext(null);function ha(){const n=Ke.useContext(Vd);if(n===null)throw new Error("useStreamState must be used within a StreamStateProvider");return n}function Xk({initialFetchKey:n="initial",children:a}){const t=Ge(d=>d.traceStreamingEnabled),l=Ge(d=>d.setTraceStreamingEnabled),[i,r]=u.useState(n),o=u.useCallback(d=>{u.startTransition(()=>{r(d)})},[r]);return e(Vd.Provider,{value:{isStreaming:t,setIsStreaming:l,fetchKey:i,setFetchKey:o},children:a})}const Rd=function(){var n={defaultValue:null,kind:"LocalArgument",name:"id"},a={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"id"}],l={kind:"Variable",name:"timeRange",variableName:"timeRange"},i=[l];return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"ProjectPageHeaderQuery",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"ProjectPageHeader_stats"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"ProjectPageHeaderQuery",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:i,kind:"ScalarField",name:"traceCount",storageKey:null},{alias:null,args:i,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:i,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:i,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:"latencyMsP50",args:[{kind:"Literal",name:"probability",value:.5},l],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:"latencyMsP99",args:[{kind:"Literal",name:"probability",value:.99},l],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"documentEvaluationNames",storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"2b81cd60d6a8a82b6814df7a5a658114",id:null,metadata:{},name:"ProjectPageHeaderQuery",operationKind:"query",text:`query ProjectPageHeaderQuery(
  $timeRange: TimeRange
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...ProjectPageHeader_stats
    __isNode: __typename
    id
  }
}

fragment ProjectPageHeader_stats on Project {
  traceCount(timeRange: $timeRange)
  tokenCountTotal(timeRange: $timeRange)
  tokenCountPrompt(timeRange: $timeRange)
  tokenCountCompletion(timeRange: $timeRange)
  latencyMsP50: latencyMsQuantile(probability: 0.5, timeRange: $timeRange)
  latencyMsP99: latencyMsQuantile(probability: 0.99, timeRange: $timeRange)
  spanAnnotationNames
  documentEvaluationNames
  id
}
`}}}();Rd.hash="e110b84031cc6bfa6bb37751b9c69765";const Ad=function(){var n={kind:"Variable",name:"timeRange",variableName:"timeRange"},a=[n];return{argumentDefinitions:[{kind:"RootArgument",name:"timeRange"}],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:Rd,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"ProjectPageHeader_stats",selections:[{alias:null,args:a,kind:"ScalarField",name:"traceCount",storageKey:null},{alias:null,args:a,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:a,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:a,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:"latencyMsP50",args:[{kind:"Literal",name:"probability",value:.5},n],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:"latencyMsP99",args:[{kind:"Literal",name:"probability",value:.99},n],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"documentEvaluationNames",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Project",abstractKey:null}}();Ad.hash="e110b84031cc6bfa6bb37751b9c69765";const Nd=function(){var n={defaultValue:null,kind:"LocalArgument",name:"annotationName"},a={defaultValue:null,kind:"LocalArgument",name:"id"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},l=[{kind:"Variable",name:"id",variableName:"id"}],i=[{kind:"Variable",name:"annotationName",variableName:"annotationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}];return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"AnnotationSummaryValueQuery",selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:i,kind:"FragmentSpread",name:"AnnotationSummaryValueFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,t,a],kind:"Operation",name:"AnnotationSummaryValueQuery",selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"bae90b7000aa37d37050070d8504b41c",id:null,metadata:{},name:"AnnotationSummaryValueQuery",operationKind:"query",text:`query AnnotationSummaryValueQuery(
  $annotationName: String!
  $timeRange: TimeRange!
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...AnnotationSummaryValueFragment_4BTVrq
    __isNode: __typename
    id
  }
}

fragment AnnotationSummaryValueFragment_4BTVrq on Project {
  spanAnnotationSummary(annotationName: $annotationName, timeRange: $timeRange) {
    labelFractions {
      label
      fraction
    }
    meanScore
  }
  id
}
`}}}();Nd.hash="0a8e190e4d87acc87c161366f330e3af";const zd={argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"annotationName"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:Nd,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"AnnotationSummaryValueFragment",selections:[{alias:null,args:[{kind:"Variable",name:"annotationName",variableName:"annotationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Project",abstractKey:null};zd.hash="0a8e190e4d87acc87c161366f330e3af";const $d=function(){var n={defaultValue:null,kind:"LocalArgument",name:"annotationName"},a={defaultValue:null,kind:"LocalArgument",name:"id"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},l=[{kind:"Variable",name:"id",variableName:"id"}],i=[{kind:"Variable",name:"annotationName",variableName:"annotationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}];return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"AnnotationSummaryQuery",selections:[{alias:"project",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:i,kind:"FragmentSpread",name:"AnnotationSummaryValueFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n,t],kind:"Operation",name:"AnnotationSummaryQuery",selections:[{alias:"project",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"88dfad5d25db7e03286a789f3ba37c75",id:null,metadata:{},name:"AnnotationSummaryQuery",operationKind:"query",text:`query AnnotationSummaryQuery(
  $id: GlobalID!
  $annotationName: String!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...AnnotationSummaryValueFragment_4BTVrq
    __isNode: __typename
    id
  }
}

fragment AnnotationSummaryValueFragment_4BTVrq on Project {
  spanAnnotationSummary(annotationName: $annotationName, timeRange: $timeRange) {
    labelFractions {
      label
      fraction
    }
    meanScore
  }
  id
}
`}}}();$d.hash="6a15ba35fe9e1e35aa4c517ab6309a2b";function Yk({annotationName:n}){var i,r;const{projectId:a}=qe(),{timeRange:t}=Rt(),l=I.useLazyLoadQuery($d,{annotationName:n,id:a,timeRange:{start:(i=t==null?void 0:t.start)==null?void 0:i.toISOString(),end:(r=t==null?void 0:t.end)==null?void 0:r.toISOString()}});return s(h,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:n}),e(u.Suspense,{fallback:e(v,{size:"L",children:"--"}),children:e(eb,{annotationName:n,project:l.project})})]})}function eb(n){var f,k;const{project:a,annotationName:t}=n,{fetchKey:l}=ha(),[i,r]=I.useRefetchableFragment(zd,a);u.useEffect(()=>{u.startTransition(()=>{r({},{fetchPolicy:"store-and-network"})})},[l,r]);const o=Rn(),c=[Ar(t),o.default,o.gray600,o.gray400,o.gray200],p=(f=i==null?void 0:i.spanAnnotationSummary)==null?void 0:f.meanScore,y=(k=i==null?void 0:i.spanAnnotationSummary)==null?void 0:k.labelFractions,m=typeof p=="number",g=Array.isArray(y)&&y.length>0;return!m&&!g?e(v,{size:"L",children:"--"}):s(me,{delay:0,placement:"bottom",children:[e($e,{children:s(h,{direction:"row",alignItems:"center",gap:"size-50",children:[g?e(ns,{width:24,height:24,children:e(as,{data:y,dataKey:"fraction",nameKey:"label",cx:"50%",cy:"50%",innerRadius:8,outerRadius:11,strokeWidth:0,stroke:"transparent",children:y.map((b,S)=>e(ts,{fill:c[S%c.length]},`cell-${S}`))})}):null,e(v,{size:"L",children:m?Qn(p):"--"})]})}),e(Zn,{children:e(C,{width:"size-2400",children:s(h,{direction:"column",gap:"size-50",children:[g&&e("ul",{children:y.map((b,S)=>e("li",{children:e(Re,{color:c[S%c.length],name:b.label,shape:"square",value:Nr(b.fraction*100)})},b.label))}),g&&m?e(Vt,{}):null,m?s(h,{direction:"row",justifyContent:"space-between",children:[e(v,{children:"mean"}),e(v,{children:Qn(p)})]}):null]})})})]})}const Od=function(){var n={defaultValue:null,kind:"LocalArgument",name:"evaluationName"},a={defaultValue:null,kind:"LocalArgument",name:"id"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},l=[{kind:"Variable",name:"id",variableName:"id"}],i=[{kind:"Variable",name:"evaluationName",variableName:"evaluationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}];return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"DocumentEvaluationSummaryValueQuery",selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:i,kind:"FragmentSpread",name:"DocumentEvaluationSummaryValueFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,t,a],kind:"Operation",name:"DocumentEvaluationSummaryValueQuery",selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"DocumentEvaluationSummary",kind:"LinkedField",name:"documentEvaluationSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"averageNdcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averagePrecision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanReciprocalRank",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hitRate",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"60d7798d88e1408e6b6b0bebdc1716f5",id:null,metadata:{},name:"DocumentEvaluationSummaryValueQuery",operationKind:"query",text:`query DocumentEvaluationSummaryValueQuery(
  $evaluationName: String!
  $timeRange: TimeRange!
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...DocumentEvaluationSummaryValueFragment_1dJL9N
    __isNode: __typename
    id
  }
}

fragment DocumentEvaluationSummaryValueFragment_1dJL9N on Project {
  documentEvaluationSummary(evaluationName: $evaluationName, timeRange: $timeRange) {
    averageNdcg
    averagePrecision
    meanReciprocalRank
    hitRate
  }
  id
}
`}}}();Od.hash="15d0652aa260c80f62acec943f615d93";const Qd={argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"evaluationName"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:Od,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"DocumentEvaluationSummaryValueFragment",selections:[{alias:null,args:[{kind:"Variable",name:"evaluationName",variableName:"evaluationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"DocumentEvaluationSummary",kind:"LinkedField",name:"documentEvaluationSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"averageNdcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averagePrecision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanReciprocalRank",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hitRate",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Project",abstractKey:null};Qd.hash="15d0652aa260c80f62acec943f615d93";const jd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"evaluationName"},{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t=[{kind:"Variable",name:"evaluationName",variableName:"evaluationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DocumentEvaluationSummaryQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:t,kind:"FragmentSpread",name:"DocumentEvaluationSummaryValueFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DocumentEvaluationSummaryQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:t,concreteType:"DocumentEvaluationSummary",kind:"LinkedField",name:"documentEvaluationSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"averageNdcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averagePrecision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanReciprocalRank",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hitRate",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"3ebd1cf66ef8f31c995ec6aae6505e94",id:null,metadata:{},name:"DocumentEvaluationSummaryQuery",operationKind:"query",text:`query DocumentEvaluationSummaryQuery(
  $evaluationName: String!
  $id: GlobalID!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...DocumentEvaluationSummaryValueFragment_1dJL9N
    __isNode: __typename
    id
  }
}

fragment DocumentEvaluationSummaryValueFragment_1dJL9N on Project {
  documentEvaluationSummary(evaluationName: $evaluationName, timeRange: $timeRange) {
    averageNdcg
    averagePrecision
    meanReciprocalRank
    hitRate
  }
  id
}
`}}}();jd.hash="4d50474ffa9b9e4a68d07f6e0777c144";function nb({evaluationName:n}){var i,r;const{projectId:a}=qe(),{timeRange:t}=Rt(),l=I.useLazyLoadQuery(jd,{id:a,evaluationName:n,timeRange:{start:(i=t==null?void 0:t.start)==null?void 0:i.toISOString(),end:(r=t==null?void 0:t.end)==null?void 0:r.toISOString()}});return s(h,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:n}),e(u.Suspense,{fallback:e(v,{size:"L",children:"--"}),children:e(ab,{evaluationName:n,project:l==null?void 0:l.project})})]})}function ab(n){var p,y,m,g;const{project:a}=n,{fetchKey:t}=ha(),[l,i]=I.useRefetchableFragment(Qd,a);u.useEffect(()=>{u.startTransition(()=>{i({},{fetchPolicy:"store-and-network"})})},[t,i]);const r=(p=l==null?void 0:l.documentEvaluationSummary)==null?void 0:p.averageNdcg,o=(y=l==null?void 0:l.documentEvaluationSummary)==null?void 0:y.averagePrecision,d=(m=l==null?void 0:l.documentEvaluationSummary)==null?void 0:m.hitRate,c=(g=l==null?void 0:l.documentEvaluationSummary)==null?void 0:g.meanReciprocalRank;return s(me,{delay:0,placement:"bottom",children:[e($e,{children:e(h,{direction:"row",alignItems:"center",gap:"size-50",height:"28px",children:s(U,{children:[e(Xe,{metric:"ndcg",score:r},"ndcg"),e(Xe,{metric:"precision",score:o},"precision"),e(Xe,{metric:"hit rate",score:d},"hit")]})})}),e(Zn,{children:e(C,{width:"size-2400",children:s(h,{direction:"column",children:[s(h,{justifyContent:"space-between",children:[e(v,{children:"average ndcg"}),e(v,{children:typeof r=="number"?Qn(r):"--"})]}),s(h,{justifyContent:"space-between",children:[e(v,{children:"average precision"}),e(v,{children:typeof o=="number"?Qn(o):"--"})]}),s(h,{justifyContent:"space-between",children:[e(v,{children:"mean reciprocal rank"}),e(v,{children:typeof c=="number"?Qn(c):"--"})]}),s(h,{justifyContent:"space-between",children:[e(v,{children:"hit rate"}),e(v,{children:typeof d=="number"?Qn(d):"--"})]})]})})})]})}function tb(n){const{extra:a}=n,{fetchKey:t}=ha(),[l,i]=I.useRefetchableFragment(Ad,n.project);u.useEffect(()=>{u.startTransition(()=>{i({},{fetchPolicy:"store-and-network"})})},[t,i]);const r=l==null?void 0:l.latencyMsP50,o=l==null?void 0:l.latencyMsP99,d=l==null?void 0:l.tokenCountTotal,c=l==null?void 0:l.tokenCountPrompt,p=l==null?void 0:l.tokenCountCompletion,y=l==null?void 0:l.spanAnnotationNames,m=l==null?void 0:l.documentEvaluationNames;return e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-200",paddingBottom:"size-50",flex:"none",children:s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e("div",{css:K`
            overflow-x: auto;
            overflow-y: hidden;
            flex: 1 1 auto;
            background-image: linear-gradient(
                to right,
                var(--ac-global-color-grey-75),
                var(--ac-global-color-grey-75)
              ),
              linear-gradient(
                to right,
                var(--ac-global-color-grey-75),
                var(--ac-global-color-grey-75)
              ),
              linear-gradient(
                to right,
                rgba(var(--ac-global-color-grey-300-rgb), 0.9),
                rgba(var(--ac-global-color-grey-300-rgb), 0)
              ),
              linear-gradient(
                to left,
                rgba(var(--ac-global-color-grey-300-rgb), 0.9),
                rgba(var(--ac-global-color-grey-300-rgb), 0)
              );
            background-repeat: no-repeat;
            background-size:
              32px 100%,
              32px 100%,
              32px 100%,
              32px 100%;
            background-position:
              left center,
              right center,
              left center,
              right center;
            background-attachment: local, local, scroll, scroll;
          `,children:s(h,{direction:"row",gap:"size-400",alignItems:"center",children:[s(h,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Total Traces"}),e(v,{size:"L",children:ua(l==null?void 0:l.traceCount)})]}),s(h,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Total Tokens"}),s(me,{delay:0,placement:"bottom",children:[e($e,{children:e(v,{size:"L",children:ua(d)})}),e(Zn,{children:e(C,{width:"size-2400",children:s(h,{direction:"column",children:[s(h,{justifyContent:"space-between",children:[e(v,{children:"Prompt Tokens"}),e(v,{children:typeof c=="number"?el(c):"--"})]}),s(h,{justifyContent:"space-between",children:[e(v,{children:"Completion Tokens"}),e(v,{children:typeof p=="number"?el(p):"--"})]}),s(h,{justifyContent:"space-between",children:[e(v,{children:"Total Tokens"}),e(v,{children:typeof d=="number"?el(d):"--"})]})]})})})]})]}),s(h,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Latency P50"}),r!=null?e(Ve,{latencyMs:r,size:"L"}):e(v,{size:"L",children:"--"})]}),s(h,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Latency P99"}),o!=null?e(Ve,{latencyMs:o,size:"L"}):e(v,{size:"L",children:"--"})]}),y.map(g=>e(Lt,{fallback:sg,children:e(Yk,{annotationName:g},g)},g)),m.map(g=>e(nb,{evaluationName:g},`document-${g}`))]})}),e(C,{flex:"none",paddingStart:"size-100",children:a})]})})}const qd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i=[{kind:"Literal",name:"first",value:50},{kind:"Literal",name:"sort",value:{col:"startTime",dir:"desc"}},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],r=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectPageQueriesSessionsQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"SessionsTable_sessions"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectPageQueriesSessionsQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},l,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:i,concreteType:"ProjectSessionConnection",kind:"LinkedField",name:"sessions",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectSessionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"session",args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"sessionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numTraces",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"firstInput",plural:!1,selections:r,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"lastOutput",plural:!1,selections:r,storageKey:null},{alias:null,args:null,concreteType:"TokenUsage",kind:"LinkedField",name:"tokenUsage",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"prompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"completion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null}],storageKey:null},{alias:"traceLatencyMsP50",args:[{kind:"Literal",name:"probability",value:.5}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.5)"},{alias:"traceLatencyMsP99",args:[{kind:"Literal",name:"probability",value:.99}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.99)"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:i,filters:["sort","filterIoSubstring","timeRange"],handle:"connection",key:"SessionsTable_sessions",kind:"LinkedHandle",name:"sessions"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"3113f90b0217915c17fd7eb691c130bc",id:null,metadata:{},name:"ProjectPageQueriesSessionsQuery",operationKind:"query",text:`query ProjectPageQueriesSessionsQuery(
  $id: GlobalID!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...SessionsTable_sessions
    __isNode: __typename
    id
  }
}

fragment SessionsTable_sessions on Project {
  name
  sessions(first: 50, sort: {col: startTime, dir: desc}, timeRange: $timeRange) {
    edges {
      session: node {
        id
        sessionId
        numTraces
        startTime
        endTime
        firstInput {
          value
        }
        lastOutput {
          value
        }
        tokenUsage {
          prompt
          completion
          total
        }
        traceLatencyMsP50: traceLatencyMsQuantile(probability: 0.5)
        traceLatencyMsP99: traceLatencyMsQuantile(probability: 0.99)
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();qd.hash="7d7d389710762ff32a681c9e34ea9c60";const Bd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r=[{kind:"Literal",name:"first",value:50},{kind:"Literal",name:"rootSpansOnly",value:!0},{kind:"Literal",name:"sort",value:{col:"startTime",dir:"desc"}},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],o=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectPageQueriesSpansQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"SpansTable_spans"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectPageQueriesSpansQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},l,{kind:"InlineFragment",selections:[i,{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:null,args:r,concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"span",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},i,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:o,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:o,storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:r,filters:["sort","rootSpansOnly","filterCondition","timeRange"],handle:"connection",key:"SpansTable_spans",kind:"LinkedHandle",name:"spans"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"cf8f6a4b57f04a59237154dd5be738a7",id:null,metadata:{},name:"ProjectPageQueriesSpansQuery",operationKind:"query",text:`query ProjectPageQueriesSpansQuery(
  $id: GlobalID!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...SpansTable_spans
    __isNode: __typename
    id
  }
}

fragment SpanColumnSelector_annotations on Project {
  spanAnnotationNames
}

fragment SpansTable_spans on Project {
  name
  ...SpanColumnSelector_annotations
  spans(first: 50, sort: {col: startTime, dir: desc}, rootSpansOnly: true, timeRange: $timeRange) {
    edges {
      span: node {
        id
        spanKind
        name
        metadata
        statusCode
        startTime
        latencyMs
        tokenCountTotal
        tokenCountPrompt
        tokenCountCompletion
        spanId
        trace {
          id
          traceId
        }
        input {
          value: truncatedValue
        }
        output {
          value: truncatedValue
        }
        spanAnnotations {
          name
          label
          score
          annotatorKind
        }
        documentRetrievalMetrics {
          evaluationName
          ndcg
          precision
          hit
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Bd.hash="e542eba73c6dca4efa0c889866e493d8";const Ud=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={kind:"Literal",name:"first",value:50},o=[r,{kind:"Literal",name:"rootSpansOnly",value:!0},{kind:"Literal",name:"sort",value:{col:"startTime",dir:"desc"}},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],d={alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},c={alias:"statusCode",args:null,kind:"ScalarField",name:"propagatedStatusCode",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},g=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}],f={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:g,storageKey:null},k={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:g,storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},F={alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[l,i,{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},P={alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectPageQueriesTracesQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"TracesTable_spans"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectPageQueriesTracesQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},l,{kind:"InlineFragment",selections:[i,{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:"rootSpans",args:o,concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"rootSpan",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[l,d,i,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},c,p,y,{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountCompletion",storageKey:null},m,f,k,b,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[l,S,{alias:null,args:null,kind:"ScalarField",name:"numSpans",storageKey:null}],storageKey:null},F,P,{alias:null,args:[r],concreteType:"SpanConnection",kind:"LinkedField",name:"descendants",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[l,d,i,c,p,y,m,{alias:"cumulativeTokenCountTotal",args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:"cumulativeTokenCountPrompt",args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:"cumulativeTokenCountCompletion",args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},f,k,b,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[l,S],storageKey:null},F,P],storageKey:null}],storageKey:null}],storageKey:"descendants(first:50)"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:"rootSpans",args:o,filters:["sort","rootSpansOnly","filterCondition","timeRange"],handle:"connection",key:"TracesTable_rootSpans",kind:"LinkedHandle",name:"spans"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"efa78bce39bc2b4c09226b7d7b74038e",id:null,metadata:{},name:"ProjectPageQueriesTracesQuery",operationKind:"query",text:`query ProjectPageQueriesTracesQuery(
  $id: GlobalID!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...TracesTable_spans
    __isNode: __typename
    id
  }
}

fragment SpanColumnSelector_annotations on Project {
  spanAnnotationNames
}

fragment TracesTable_spans on Project {
  name
  ...SpanColumnSelector_annotations
  rootSpans: spans(first: 50, sort: {col: startTime, dir: desc}, rootSpansOnly: true, timeRange: $timeRange) {
    edges {
      rootSpan: node {
        id
        spanKind
        name
        metadata
        statusCode: propagatedStatusCode
        startTime
        latencyMs
        cumulativeTokenCountTotal
        cumulativeTokenCountPrompt
        cumulativeTokenCountCompletion
        parentId
        input {
          value: truncatedValue
        }
        output {
          value: truncatedValue
        }
        spanId
        trace {
          id
          traceId
          numSpans
        }
        spanAnnotations {
          id
          name
          label
          score
          annotatorKind
        }
        documentRetrievalMetrics {
          evaluationName
          ndcg
          precision
          hit
        }
        descendants(first: 50) {
          edges {
            node {
              id
              spanKind
              name
              statusCode: propagatedStatusCode
              startTime
              latencyMs
              parentId
              cumulativeTokenCountTotal: tokenCountTotal
              cumulativeTokenCountPrompt: tokenCountPrompt
              cumulativeTokenCountCompletion: tokenCountCompletion
              input {
                value: truncatedValue
              }
              output {
                value: truncatedValue
              }
              spanId
              trace {
                id
                traceId
              }
              spanAnnotations {
                id
                name
                label
                score
                annotatorKind
              }
              documentRetrievalMetrics {
                evaluationName
                ndcg
                precision
                hit
              }
            }
          }
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Ud.hash="115733d83356cd8ac9fd611fe725d41a";const Hd=Ud,Gd=Bd,Wd=qd,Jd=u.createContext({spansQueryReference:null,sessionsQueryReference:null,tracesQueryReference:null}),di=()=>{const n=u.useContext(Jd);if(!n)throw new Error("ProjectPageQueryReferenceContext not found");return n},Zd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"StreamToggleRefetchQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"StreamToggle_data"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"StreamToggleRefetchQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"streamingLastUpdatedAt",storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"4e136f41c0942f253822336dc0c5b291",id:null,metadata:{},name:"StreamToggleRefetchQuery",operationKind:"query",text:`query StreamToggleRefetchQuery(
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...StreamToggle_data
    __isNode: __typename
    id
  }
}

fragment StreamToggle_data on Project {
  streamingLastUpdatedAt
  id
}
`}}}();Zd.hash="30a8f0bcf1aa6021b2c9a47866f5dc49";const Xd={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:Zd,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"StreamToggle_data",selections:[{alias:null,args:null,kind:"ScalarField",name:"streamingLastUpdatedAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Project",abstractKey:null};Xd.hash="30a8f0bcf1aa6021b2c9a47866f5dc49";function Yd(n,a){const t=u.useRef(null);u.useEffect(()=>{t.current=n},[n]),u.useEffect(()=>{function l(){t.current&&t.current()}if(typeof a=="number"){const i=setInterval(l,a);return()=>clearInterval(i)}},[a])}const lb=2e3;function ib(n){const{isStreaming:a,setIsStreaming:t,setFetchKey:l}=ha(),[i,r]=I.useRefetchableFragment(Xd,n.project),o=u.useRef(i.streamingLastUpdatedAt),d=u.useCallback(()=>{a&&u.startTransition(()=>{r({},{fetchPolicy:"store-and-network"})})},[a,r]),c=i.streamingLastUpdatedAt;return u.useEffect(()=>{c!=null&&(o.current==null||o.current<c)&&(o.current=c,l(`fetch-traces-${c}`))},[l,c]),Yd(d,lb),e(ya,{labelPlacement:"start",isSelected:a,onChange:()=>{t(!a)},children:"Stream"})}const rb=K`
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  .ac-tabs {
    flex: 1 1 auto;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    div[role="tablist"] {
      flex: none;
    }
    .ac-tabs__pane-container {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      div[role="tabpanel"]:not([hidden]) {
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }
    }
  }
`;function _2(){const{projectId:n}=qe(),{timeRange:a}=Rt();return e(u.Suspense,{fallback:e(ge,{}),children:e(cb,{projectId:n,timeRange:a})})}const sb=["traces","spans","sessions"],ob=n=>sb.includes(n),db={traces:0,spans:1,sessions:2};function cb({projectId:n,timeRange:a}){const t=u.useMemo(()=>{var P,D;return{start:(P=a==null?void 0:a.start)==null?void 0:P.toISOString(),end:(D=a==null?void 0:a.end)==null?void 0:D.toISOString()}},[a]),l=le(),{rootPath:i,tab:r}=Bt(),o=I.useLazyLoadQuery(Md,{id:n,timeRange:t},{fetchPolicy:"store-and-network",fetchKey:`${n}-${t.start}-${t.end}`}),[d,c,p]=I.useQueryLoader(Hd),[y,m,g]=I.useQueryLoader(Gd),[f,k,b]=I.useQueryLoader(Wd),S=ob(r)?db[r]:0;u.useEffect(()=>(S===0?c({id:n,timeRange:t}):S===1?m({id:n,timeRange:t}):S===2&&k({id:n,timeRange:t}),()=>{g(),b(),p()}),[c,n,t,S,g,b,p,m,k]);const F=u.useCallback(P=>{u.startTransition(()=>{l(P===1?`${i}/spans`:P===2?`${i}/sessions`:`${i}/traces`)})},[l,i]);return e(Xk,{children:s("main",{css:rb,children:[e(tb,{project:o.project,extra:s(h,{direction:"row",alignItems:"center",gap:"size-100",children:[e(ib,{project:o.project}),e(zr,{})]})}),e(Jd.Provider,{value:{spansQueryReference:y??null,sessionsQueryReference:f??null,tracesQueryReference:d??null},children:s(He,{onChange:F,index:S,children:[e(ae,{name:"Traces",children:({isSelected:P})=>P?e(xe,{}):null}),e(ae,{name:"Spans",children:({isSelected:P})=>P?e(xe,{}):null}),e(ae,{name:"Sessions",children:({isSelected:P})=>P?e(xe,{}):null})]})})]})})}const ec=u.createContext(null);function nc(){const n=u.useContext(ec);if(n===null)throw new Error("useSessionSubstring must be used within a SessionSubstringProvider");return n}function ub(n){const[a,t]=u.useState(""),l=u.useCallback(i=>{u.startTransition(()=>{t(i)})},[]);return e(ec.Provider,{value:{filterIoSubstring:a,setFilterIoSubstring:l},children:n.children})}const ac=function(){var n={defaultValue:null,kind:"LocalArgument",name:"after"},a={defaultValue:null,kind:"LocalArgument",name:"filterIoSubstring"},t={defaultValue:50,kind:"LocalArgument",name:"first"},l={defaultValue:null,kind:"LocalArgument",name:"id"},i={defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},r={defaultValue:null,kind:"LocalArgument",name:"timeRange"},o=[{kind:"Variable",name:"id",variableName:"id"}],d={kind:"Variable",name:"after",variableName:"after"},c={kind:"Variable",name:"filterIoSubstring",variableName:"filterIoSubstring"},p={kind:"Variable",name:"first",variableName:"first"},y={kind:"Variable",name:"sort",variableName:"sort"},m={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},f=[d,c,p,y,{kind:"Variable",name:"timeRange",variableName:"timeRange"}],k=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}];return{fragment:{argumentDefinitions:[n,a,t,l,i,r],kind:"Fragment",metadata:null,name:"SessionsTableQuery",selections:[{alias:null,args:o,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:[d,c,p,y],kind:"FragmentSpread",name:"SessionsTable_sessions"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,a,t,i,r,l],kind:"Operation",name:"SessionsTableQuery",selections:[{alias:null,args:o,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[m,{kind:"TypeDiscriminator",abstractKey:"__isNode"},g,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:f,concreteType:"ProjectSessionConnection",kind:"LinkedField",name:"sessions",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectSessionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"session",args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[g,{alias:null,args:null,kind:"ScalarField",name:"sessionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numTraces",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"firstInput",plural:!1,selections:k,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"lastOutput",plural:!1,selections:k,storageKey:null},{alias:null,args:null,concreteType:"TokenUsage",kind:"LinkedField",name:"tokenUsage",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"prompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"completion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null}],storageKey:null},{alias:"traceLatencyMsP50",args:[{kind:"Literal",name:"probability",value:.5}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.5)"},{alias:"traceLatencyMsP99",args:[{kind:"Literal",name:"probability",value:.99}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.99)"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[m],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:f,filters:["sort","filterIoSubstring","timeRange"],handle:"connection",key:"SessionsTable_sessions",kind:"LinkedHandle",name:"sessions"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"07b07c6e6b2088166d9ae2faf0847ef8",id:null,metadata:{},name:"SessionsTableQuery",operationKind:"query",text:`query SessionsTableQuery(
  $after: String = null
  $filterIoSubstring: String = null
  $first: Int = 50
  $sort: ProjectSessionSort = {col: startTime, dir: desc}
  $timeRange: TimeRange
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...SessionsTable_sessions_2MhLSo
    __isNode: __typename
    id
  }
}

fragment SessionsTable_sessions_2MhLSo on Project {
  name
  sessions(first: $first, after: $after, sort: $sort, filterIoSubstring: $filterIoSubstring, timeRange: $timeRange) {
    edges {
      session: node {
        id
        sessionId
        numTraces
        startTime
        endTime
        firstInput {
          value
        }
        lastOutput {
          value
        }
        tokenUsage {
          prompt
          completion
          total
        }
        traceLatencyMsP50: traceLatencyMsQuantile(probability: 0.5)
        traceLatencyMsP99: traceLatencyMsQuantile(probability: 0.99)
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();ac.hash="73d205acbb256ea1f2cf68875634a21b";const tc=function(){var n=["sessions"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"filterIoSubstring"},{defaultValue:50,kind:"LocalArgument",name:"first"},{defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},{kind:"RootArgument",name:"timeRange"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:ac,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"SessionsTable_sessions",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:"sessions",args:[{kind:"Variable",name:"filterIoSubstring",variableName:"filterIoSubstring"},{kind:"Variable",name:"sort",variableName:"sort"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"ProjectSessionConnection",kind:"LinkedField",name:"__SessionsTable_sessions_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectSessionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"session",args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"sessionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numTraces",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"firstInput",plural:!1,selections:t,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"lastOutput",plural:!1,selections:t,storageKey:null},{alias:null,args:null,concreteType:"TokenUsage",kind:"LinkedField",name:"tokenUsage",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"prompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"completion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null}],storageKey:null},{alias:"traceLatencyMsP50",args:[{kind:"Literal",name:"probability",value:.5}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.5)"},{alias:"traceLatencyMsP99",args:[{kind:"Literal",name:"probability",value:.99}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.99)"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"Project",abstractKey:null}}();tc.hash="73d205acbb256ea1f2cf68875634a21b";const lc=u.createContext(null);function mb({children:n,...a}){const[t]=u.useState(()=>og(a));return e(lc.Provider,{value:t,children:n})}function Ln(n,a){const t=Ke.useContext(lc);if(!t)throw new Error("Missing TracingContext.Provider in the tree");return Ya(t,n,a)}const pb=K`
  flex: 1 1 auto;
  .cm-content {
    padding: var(--ac-global-dimension-static-size-100) 0;
  }
  .cm-editor {
    background-color: transparent !important;
  }
  .cm-focused {
    outline: none;
  }
  .cm-selectionLayer .cm-selectionBackground {
    background: var(--ac-global-color-cyan-400) !important;
  }
`,gb=K`
  border-width: var(--ac-global-border-size-thin);
  border-style: solid;
  border-color: var(--ac-global-input-field-border-color);
  border-radius: var(--ac-global-rounding-small);
  background-color: var(--ac-global-input-field-background-color);
  transition: all 0.2s ease-in-out;
  overflow-x: hidden;
  &:hover,
  &[data-is-focused="true"] {
    border-color: var(--ac-global-input-field-border-color-active);
    background-color: var(--ac-global-input-field-background-color-active);
  }
  &[data-is-invalid="true"] {
    border-color: var(--ac-global-color-danger);
  }
  box-sizing: border-box;
`;function yb(n){const{placeholder:a="Search messages"}=n,[t,l]=u.useState(!1),{filterIoSubstring:i,setFilterIoSubstring:r}=nc(),{theme:o}=Mn();return e("div",{"data-is-focused":t,className:"sessions-substring-field",css:gb,children:s(h,{direction:"row",children:[e(Kl,{children:e(L,{svg:e(ql,{})})}),e(la,{css:pb,indentWithTab:!1,basicSetup:{lineNumbers:!1,foldGutter:!1,bracketMatching:!1,syntaxHighlighting:!1,highlightActiveLine:!1,highlightActiveLineGutter:!1,defaultKeymap:!1},onFocus:()=>l(!0),onBlur:()=>l(!1),value:i,onChange:r,height:"36px",width:"100%",theme:o==="light"?aa:ta,placeholder:a}),e("button",{css:K`
            margin-right: var(--ac-global-dimension-static-size-100);
            color: var(--ac-global-text-color-700);
            visibility: ${i!==""?"visible":"hidden"};
          `,onClick:()=>r(""),className:"button--reset",children:e(L,{svg:e(At,{})})})]})})}const fb="pip install openinference-instrumentation",hb=`import uuid

import openai
from openinference.instrumentation import using_session
from openinference.semconv.trace import SpanAttributes
from opentelemetry import trace

client = openai.Client()
session_id = str(uuid.uuid4())

tracer = trace.get_tracer(__name__)

@tracer.start_as_current_span(name="agent", attributes={SpanAttributes.OPENINFERENCE_SPAN_KIND: "agent"})
def assistant(
  messages: list[dict],
  session_id: str = str,
):
  current_span = trace.get_current_span()
  current_span.set_attribute(SpanAttributes.SESSION_ID, session_id)
  current_span.set_attribute(SpanAttributes.INPUT_VALUE, messages[-1].get('content'))

  # Propagate the session_id down to spans crated by the OpenAI instrumentation
  # This is not strictly necessary, but it helps to correlate the spans to the same session
  with using_session(session_id):
   response = client.chat.completions.create(
       model="gpt-3.5-turbo",
       messages=[{"role": "system", "content": "You are a helpful assistant."}] + messages,
   ).choices[0].message

  current_span.set_attribute(SpanAttributes.OUTPUT_VALUE, response.content)
  return response

messages = [
  {"role": "user", "content": "hi! im bob"}
]
response = assistant(
  messages,
  session_id=session_id,
)
messages = messages + [
  response,
  {"role": "user", "content": "what's my name?"}
]
response = assistant(
  messages,
  session_id=session_id,
)`;function kb(){return s("div",{children:[e(C,{paddingTop:"size-200",paddingBottom:"size-100",children:e(te,{level:2,weight:"heavy",children:"Install Dependencies"})}),e(C,{paddingBottom:"size-100",children:s(v,{children:["Sessions are tracked via the OpenTelemetry attribute ",e("b",{children:"session.id"}),". The easiest way to get started with sessions is to use the OpenInference instrumentation package."]})}),e(Ue,{children:e(cn,{value:fb})}),e(C,{paddingTop:"size-200",paddingBottom:"size-100",children:e(te,{level:2,weight:"heavy",children:"Add Session ID to your Traces"})}),e(C,{paddingBottom:"size-100",children:e(v,{children:"Below is an example of how to add session IDs to a simple OpenAI application."})}),e(Ue,{children:e(cn,{value:hb})}),e(C,{paddingBottom:"size-100",paddingTop:"size-100",children:s(v,{children:["For more information on how to use sessions, consult the"," ",e(nn,{href:"https://docs.arize.com/phoenix/tracing/how-to-tracing/setup-sessions",children:"documentation"})]})})]})}const bb="npm install @arizeai/openinference-core --save",Sb=`import { trace } from "@opentelemetry/api";
import { SemanticConventions } from "@arizeai/openinference-semantic-conventions";
import { context } from "@opentelemetry/api";
import { setSession } from "@arizeai/openinference-core";

const tracer = trace.getTracer("agent");

const client = new OpenAI({
  apiKey: process.env["OPENAI_API_KEY"], // This is the default and can be omitted
});

async function assistant(params: {
  messages: { role: string; content: string }[];
  sessionId: string;
}) {
  return tracer.startActiveSpan("agent", async (span: Span) => {
    span.setAttribute(SemanticConventions.OPENINFERENCE_SPAN_KIND, "agent");
    span.setAttribute(SemanticConventions.SESSION_ID, params.sessionId);
    span.setAttribute(
      SemanticConventions.INPUT_VALUE,
      messages[messages.length - 1].content,
    );
    try {
      // This is not strictly necessary but it helps propagate the session ID
      // to all child spans
      return context.with(
        setSession(context.active(), { sessionId: params.sessionId }),
        async () => {
          // Calls within this block will generate spans with the session ID set
          const chatCompletion = await client.chat.completions.create({
            messages: params.messages,
            model: "gpt-3.5-turbo",
          });
          const response = chatCompletion.choices[0].message;
          span.setAttribute(SemanticConventions.OUTPUT_VALUE, response.content);
          span.end();
          return response;
        },
      );
    } catch (e) {
      span.error(e);
    }
  });
}

const sessionId = crypto.randomUUID();

let messages = [{ role: "user", content: "hi! im Tim" }];

const res = await assistant({
  messages,
  sessionId: sessionId,
});

messages = [res, { role: "assistant", content: "What is my name?" }];

await assistant({
  messages,
  sessionId: sessionId,
});
`;function vb(){return s("div",{children:[e(C,{paddingTop:"size-200",paddingBottom:"size-100",children:e(te,{level:2,weight:"heavy",children:"Install Dependencies"})}),e(C,{paddingBottom:"size-100",children:s(v,{children:["Sessions are tracked via the OpenTelemetry attribute ",e("b",{children:"session.id"}),". The easiest way to get started with sessions is to use the OpenInference instrumentation package."]})}),e(Ue,{children:e(cn,{value:bb})}),e(C,{paddingTop:"size-200",paddingBottom:"size-100",children:e(te,{level:2,weight:"heavy",children:"Add Session ID to your Traces"})}),e(C,{paddingBottom:"size-100",children:e(v,{children:"Below is an example of how to add session IDs to a simple OpenAI application."})}),e(Ue,{children:e(dg,{value:Sb})}),e(C,{paddingBottom:"size-100",children:s(v,{children:["For more information on how to use sessions, consult the"," ",e(nn,{href:"https://docs.arize.com/phoenix/tracing/how-to-tracing/setup-sessions",children:"documentation"})]})})]})}function Cb(){const[n,a]=u.useState("Python");return e(Z,{title:"Setup Sessions for this Project",size:"L",children:s(C,{padding:"size-400",overflow:"auto",children:[e(C,{paddingBottom:"size-100",children:e(Pt,{language:n,onChange:a})}),n==="Python"?e(kb,{}):e(vb,{})]})})}function Fb(){const[n,a]=u.useState(null),t=()=>{a(e(Cb,{}))};return s("tbody",{className:"is-empty",children:[e("tr",{children:e("td",{colSpan:100,css:K`
            text-align: center;
            padding: var(--ac-global-dimension-size-300)
              var(--ac-global-dimension-size-300) !important;
          `,children:s(h,{direction:"column",gap:"size-200",alignItems:"center",children:["No sessions found for this project",e(A,{leadingVisual:e(L,{svg:e(fa,{})}),onPress:t,children:"Setup Sessions"})]})})}),e(X,{onDismiss:()=>a(null),isDismissable:!0,type:"slideOver",children:n})]})}const ci=K`
  display: flex;
  flex-direction: column;
  flex: 1 1 auto;
  overflow: hidden;
  .span-filter-condition-field {
    flex: 1 1 auto;
  }

  // Style the column selector
  .ac-dropdown-button {
    min-width: var(--ac-global-dimension-static-size-300);
  }
`,Bi=50;function Kb(n){const a=u.useRef(null),[t,l]=u.useState([]),{filterIoSubstring:i}=nc(),r=le(),{fetchKey:o}=ha(),{data:d,loadNext:c,hasNext:p,isLoadingNext:y,refetch:m}=I.usePaginationFragment(tc,n.project),g=u.useMemo(()=>d.sessions.edges.map(({session:T})=>({...T,tokenCountTotal:T.tokenUsage.total})),[d.sessions]),f=[{header:"session id",accessorKey:"sessionId",enableSorting:!1,cell:De},{header:"first input",accessorKey:"firstInput.value",enableSorting:!1,cell:De},{header:"last output",accessorKey:"lastOutput.value",enableSorting:!1,cell:De},{header:"start time",accessorKey:"startTime",enableSorting:!0,cell:Me},{header:"end time",accessorKey:"endTime",enableSorting:!0,cell:Me},{header:"p50 latency",accessorKey:"traceLatencyMsP50",enableSorting:!1,cell:({getValue:T})=>{const x=T();return x===null||typeof x!="number"?null:e(Ve,{latencyMs:x})}},{header:"p99 latency",accessorKey:"traceLatencyMsP99",enableSorting:!1,cell:({getValue:T})=>{const x=T();return x===null||typeof x!="number"?null:e(Ve,{latencyMs:x})}},{header:"total tokens",accessorKey:"tokenCountTotal",enableSorting:!0,minSize:80,cell:({row:T,getValue:x})=>{const M=x();if(M==null||typeof M!="number")return"--";const{prompt:R,completion:O}=T.original.tokenUsage;return e(na,{tokenCountTotal:M,tokenCountPrompt:R||0,tokenCountCompletion:O||0})}},{header:"total traces",accessorKey:"numTraces",enableSorting:!0,cell:$r}];u.useEffect(()=>{const T=t[0];u.startTransition(()=>{m({sort:T?{col:T.id,dir:T.desc?"desc":"asc"}:{col:"startTime",dir:"desc"},after:null,first:Bi,filterIoSubstring:i},{fetchPolicy:"store-and-network"})})},[t,m,i,o]);const k=Ke.useCallback(T=>{if(T){const{scrollHeight:x,scrollTop:M,clientHeight:R}=T;x-M-R<300&&!y&&p&&c(Bi)}},[p,y,c]),[b,S]=u.useState({}),F=Ln(T=>T.columnVisibility),P=Te({columns:f,data:g,onExpandedChange:S,manualSorting:!0,state:{sorting:t,expanded:b,columnVisibility:F},enableSubRowSelection:!1,onSortingChange:l,getCoreRowModel:Pe(),getSortedRowModel:hn(),getExpandedRowModel:ir(),getRowId:T=>T.id}),D=P.getRowModel().rows,w=D.length===0;return s("div",{css:ci,children:[e(C,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-200",paddingEnd:"size-200",borderBottomColor:"grey-300",borderBottomWidth:"thin",flex:"none",children:e(yb,{})}),e("div",{css:K`
          flex: 1 1 auto;
          overflow: auto;
        `,onScroll:T=>k(T.target),ref:a,children:s("table",{css:ea,children:[e("thead",{children:P.getHeaderGroups().map(T=>e("tr",{children:T.headers.map(x=>e("th",{colSpan:x.colSpan,children:x.isPlaceholder?null:s("div",{"data-sortable":x.column.getCanSort(),className:x.column.getCanSort()?"cursor-pointer":"",onClick:x.column.getToggleSortingHandler(),style:{left:x.getStart(),width:x.getSize()},children:[W(x.column.columnDef.header,x.getContext()),x.column.getIsSorted()?e(L,{className:"sort-icon",svg:x.column.getIsSorted()==="asc"?e(sn,{}):e(rn,{})}):null]})},x.id))},T.id))}),w?e(Fb,{}):e("tbody",{children:D.map(T=>e("tr",{onClick:()=>r(`${encodeURIComponent(T.id)}`),children:T.getVisibleCells().map(x=>e("td",{children:W(x.column.columnDef.cell,x.getContext())},x.id))},T.id))})]})})]})}const ic=u.createContext(null);function Ut(){const n=u.useContext(ic);if(n===null)throw new Error("useSpanFilterCondition must be used within a SpanFilterConditionProvider");return n}function ui(n){const[a,t]=u.useState(""),l=u.useCallback(r=>{u.startTransition(()=>{t(r)})},[]),i=u.useCallback(r=>{u.startTransition(()=>{a.length>0?t(a+" and "+r):t(r)})},[a]);return e(ic.Provider,{value:{filterCondition:a,setFilterCondition:l,appendFilterCondition:i},children:n.children})}const Tb=["traces","spans","sessions"],Pb=n=>Tb.includes(n);function mi({children:n}){const{projectId:a}=qe();if(!a)throw new Error("projectId is required");const{tab:t}=Bt();if(!Pb(t))throw new Error(`Invalid tab: ${t}`);return e(mb,{projectId:a,tableId:t||"table",children:n})}function Ib({queryReference:n}){const a=I.usePreloadedQuery(Wd,n);return e(ub,{children:e(Kb,{project:a.project})})}const L2=()=>{const{sessionsQueryReference:n}=di();return n?s(mi,{children:[e(ui,{children:e(u.Suspense,{fallback:e(ge,{}),children:e(Ib,{queryReference:n})})}),e(u.Suspense,{children:e(xe,{})})]}):null},rc=function(){var n={defaultValue:null,kind:"LocalArgument",name:"after"},a={defaultValue:null,kind:"LocalArgument",name:"filterCondition"},t={defaultValue:50,kind:"LocalArgument",name:"first"},l={defaultValue:null,kind:"LocalArgument",name:"id"},i={defaultValue:!0,kind:"LocalArgument",name:"rootSpansOnly"},r={defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},o={defaultValue:null,kind:"LocalArgument",name:"timeRange"},d=[{kind:"Variable",name:"id",variableName:"id"}],c={kind:"Variable",name:"after",variableName:"after"},p={kind:"Variable",name:"filterCondition",variableName:"filterCondition"},y={kind:"Variable",name:"first",variableName:"first"},m={kind:"Variable",name:"rootSpansOnly",variableName:"rootSpansOnly"},g={kind:"Variable",name:"sort",variableName:"sort"},f={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},S=[c,p,y,m,g,{kind:"Variable",name:"timeRange",variableName:"timeRange"}],F=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}];return{fragment:{argumentDefinitions:[n,a,t,l,i,r,o],kind:"Fragment",metadata:null,name:"SpansTableSpansQuery",selections:[{alias:null,args:d,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:[c,p,y,m,g],kind:"FragmentSpread",name:"SpansTable_spans"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,a,t,i,r,o,l],kind:"Operation",name:"SpansTableSpansQuery",selections:[{alias:null,args:d,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[f,{kind:"TypeDiscriminator",abstractKey:"__isNode"},k,{kind:"InlineFragment",selections:[b,{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:null,args:S,concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"span",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[k,{alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},b,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[k,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:F,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:F,storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[b,{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[f],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:S,filters:["sort","rootSpansOnly","filterCondition","timeRange"],handle:"connection",key:"SpansTable_spans",kind:"LinkedHandle",name:"spans"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"b592300c2f0bc45cc519fba9d61b2e21",id:null,metadata:{},name:"SpansTableSpansQuery",operationKind:"query",text:`query SpansTableSpansQuery(
  $after: String = null
  $filterCondition: String = null
  $first: Int = 50
  $rootSpansOnly: Boolean = true
  $sort: SpanSort = {col: startTime, dir: desc}
  $timeRange: TimeRange
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...SpansTable_spans_xYL0c
    __isNode: __typename
    id
  }
}

fragment SpanColumnSelector_annotations on Project {
  spanAnnotationNames
}

fragment SpansTable_spans_xYL0c on Project {
  name
  ...SpanColumnSelector_annotations
  spans(first: $first, after: $after, sort: $sort, rootSpansOnly: $rootSpansOnly, filterCondition: $filterCondition, timeRange: $timeRange) {
    edges {
      span: node {
        id
        spanKind
        name
        metadata
        statusCode
        startTime
        latencyMs
        tokenCountTotal
        tokenCountPrompt
        tokenCountCompletion
        spanId
        trace {
          id
          traceId
        }
        input {
          value: truncatedValue
        }
        output {
          value: truncatedValue
        }
        spanAnnotations {
          name
          label
          score
          annotatorKind
        }
        documentRetrievalMetrics {
          evaluationName
          ndcg
          precision
          hit
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();rc.hash="6205d8a642077d21635556045b1aaef8";const sc=function(){var n=["spans"],a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"filterCondition"},{defaultValue:50,kind:"LocalArgument",name:"first"},{defaultValue:!0,kind:"LocalArgument",name:"rootSpansOnly"},{defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},{kind:"RootArgument",name:"timeRange"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:rc,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"SpansTable_spans",selections:[a,{args:null,kind:"FragmentSpread",name:"SpanColumnSelector_annotations"},{alias:"spans",args:[{kind:"Variable",name:"filterCondition",variableName:"filterCondition"},{kind:"Variable",name:"rootSpansOnly",variableName:"rootSpansOnly"},{kind:"Variable",name:"sort",variableName:"sort"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"SpanConnection",kind:"LinkedField",name:"__SpansTable_spans_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"span",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},a,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:l,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:l,storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},t],type:"Project",abstractKey:null}}();sc.hash="6205d8a642077d21635556045b1aaef8";const xb=K`
  border-radius: var(--ac-global-dimension-size-50);
  border: 1px solid var(--ac-global-color-grey-200);
  padding: var(--ac-global-dimension-size-50)
    var(--ac-global-dimension-size-100);
  transition: background-color 0.2s;

  &[role="button"] {
    cursor: pointer;
    &:hover {
      background-color: var(--ac-global-color-grey-200);
      border-color: var(--ac-global-color-grey-400);
    }
  }
  max-width: 100%;
  height: var(--ac-global-dimension-size-200);
`;function Db({metadata:n,onClick:a}){const t=u.useMemo(()=>{let l=n;return l.startsWith("{")&&(l=l.slice(1)),l.endsWith("}")&&(l=l.slice(0,-1)),l},[n]);return e("div",{css:K(xb),role:a?"button":"label","aria-label":"metadata",onClick:l=>{l.stopPropagation(),l.preventDefault(),a==null||a()},children:e(h,{direction:"row",justifyContent:"space-between",alignItems:"center",height:"100%",children:e(Wa,{maxWidth:"100%",children:e(v,{children:t})})})})}function _b(n){return n.replaceAll(`
`,"\\n").replaceAll('"','\\"')}function Lb(n){return typeof n=="boolean"?n?"True":"False":typeof n=="number"?n.toString():typeof n=="string"?`"${_b(n)}"`:""}const oc=(n,a)=>`metadata['${n}'] == ${Lb(a)}`;function wb({children:n,metadata:a,width:t}){const{appendFilterCondition:l}=Ut(),i=Object.entries(a).map(([r,o])=>({key:r,value:String(o),filterCondition:oc(r,o)}));return s(me,{delay:500,offset:3,children:[e($e,{children:n}),e(Zn,{UNSAFE_style:{minWidth:t},children:s(h,{direction:"row",wrap:"nowrap",gap:"size-100",children:[e(h,{flexBasis:"40%",children:s(h,{direction:"column",gap:"size-100",width:"100%",children:[e(v,{weight:"heavy",children:"Metadata"}),e("ul",{css:K`
                  display: flex;
                  flex-direction: column;
                  gap: var(--ac-global-dimension-size-100);
                  overflow-y: auto;
                  max-height: 200px;
                  scrollbar-gutter: stable;
                  padding-right: var(--ac-global-dimension-size-50);
                `,children:i.map(({key:r,value:o})=>e("li",{children:s(h,{direction:"row",gap:"size-100",children:[e(h,{flexBasis:"30%",width:0,children:e(Wa,{maxWidth:"100%",children:e(v,{weight:"heavy",color:"inherit",size:"XS",children:r})})}),e(h,{flexBasis:"70%",flexShrink:1,justifyContent:"end",width:0,children:e(Wa,{maxWidth:"100%",children:e(v,{color:"inherit",size:"XS",maxWidth:"100%",children:o})})})]})},r))})]})}),e(C,{borderColor:"dark",paddingStart:"size-200",paddingEnd:"size-100",marginStart:"size-200",flexBasis:"60%",borderStartWidth:"thin",children:s(h,{direction:"column",gap:"size-100",width:"100%",children:[e(v,{weight:"heavy",children:"Filters"}),e("ul",{css:K`
                  display: flex;
                  flex-direction: row;
                  gap: var(--ac-global-dimension-size-100);
                  padding: var(--ac-global-dimension-size-50) 0;
                  flex-wrap: wrap;
                `,children:i.map(({key:r,filterCondition:o})=>e("li",{children:s("button",{onClick:d=>{d.preventDefault(),d.stopPropagation(),l(o)},css:K`
                        all: unset;
                        color: var(--ac-global-text-color-900);
                        border: 1px solid var(--ac-global-color-grey-300);
                        border-radius: 4px;
                        padding: var(--ac-global-dimension-size-50)
                          var(--ac-global-dimension-size-100);
                        cursor: pointer;
                        transition: background-color 0.2s;
                        &:hover {
                          background-color: var(--ac-global-color-gray-300);
                        }
                      `,children:["Match ",r]})},r))})]})})]})})]})}const dc=({metadata:n})=>{const{appendFilterCondition:a}=Ut(),[t,l]=Ke.useMemo(()=>{try{if(typeof n!="string")throw new Error("Metadata is not a string");const i=cg(n),r=JSON.stringify(i);if(Object.keys(i).length===0)throw new Error("Metadata is empty");return[i,r]}catch{return[null,null]}},[n]);return!t||!l?"--":e("div",{style:{maxWidth:"300px"},children:e(wb,{width:"800px",metadata:t,children:e(Db,{metadata:l,onClick:()=>{const[i,r]=Object.entries(t)[0],o=oc(i,r);a(o)}})})})};function cc(n){const{appendFilterCondition:a}=Ut(),{annotation:t}=n,{name:l,label:i,score:r}=t,o=u.useMemo(()=>{const d=[];return i!=null&&(d.push({filterName:"Match label",filterCondition:`annotations['${l}'].label == "${i}"`}),d.push({filterName:"Exclude label",filterCondition:`annotations['${l}'].label != "${i}"`})),typeof r=="number"&&(d.push({filterName:"Greater than score",filterCondition:`annotations['${l}'].score > ${r}`}),d.push({filterName:"Less than score",filterCondition:`annotations['${l}'].score < ${r}`}),d.push({filterName:"Equals score",filterCondition:`annotations['${l}'].score == ${r}`})),d},[l,i,r]);return s(C,{borderStartWidth:"thin",borderColor:"dark",paddingStart:"size-200",paddingEnd:"size-100",marginStart:"size-200",width:300,children:[e(v,{weight:"heavy",children:"Filters"}),e("ul",{css:K`
          display: flex;
          flex-direction: row;
          gap: var(--ac-global-dimension-size-100);
          color: var(--ac-global-color-primary);
          padding: var(--ac-global-dimension-size-100) 0;
          flex-wrap: wrap;
        `,children:o.map(d=>e("li",{children:e(Eb,{onClick:()=>{a(d.filterCondition)},children:d.filterName})},d.filterName))})]})}function Eb({onClick:n,children:a}){return e("button",{onClick:t=>{t.preventDefault(),t.stopPropagation(),n()},className:"button--reset",css:K`
        color: var(--ac-global-text-color-900);
        border: 1px solid var(--ac-global-color-grey-300);
        border-radius: 4px;
        padding: var(--ac-global-dimension-size-50)
          var(--ac-global-dimension-size-100);
        cursor: pointer;
        transition: background-color 0.2s;
        &:hover {
          background-color: var(--ac-global-color-gray-300);
        }
      `,children:a})}function Mb({projectName:n}){const[a,t]=u.useState("Python");return e(Z,{title:"Send Traces to this Project",size:"L",children:s(C,{padding:"size-400",overflow:"auto",children:[e(C,{paddingBottom:"size-100",children:e(Pt,{language:a,onChange:t})}),a==="Python"?e(Or,{projectName:n}):e(Qr,{projectName:n})]})})}function uc({projectName:n}){const[a,t]=u.useState(null),l=()=>{t(e(Mb,{projectName:n}))};return s("tbody",{className:"is-empty",children:[e("tr",{children:e("td",{colSpan:100,css:K`
            text-align: center;
            padding: var(--ac-global-dimension-size-300)
              var(--ac-global-dimension-size-300) !important;
          `,children:s(h,{direction:"column",gap:"size-200",alignItems:"center",children:["No traces found that match the selected filters",e(A,{variant:"default",leadingVisual:e(L,{svg:e(fa,{})}),onPress:l,children:"Get Started"})]})})}),e(X,{onDismiss:()=>t(null),isDismissable:!0,type:"slideOver",children:a})]})}const mc={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SpanColumnSelector_annotations",selections:[{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null}],type:"Project",abstractKey:null};mc.hash="ad01e6897ad1ea779eb346d85783b8b4";const Vb=["spanKind","name"];function pc(n){return e(Tl,{menu:e(Rb,{...n}),triggerProps:{placement:"bottom end"},children:s(h,{direction:"row",alignItems:"center",gap:"size-100",children:[e(L,{svg:e(ug,{})}),"Columns"]})})}const gt=K`
  padding: var(--ac-global-dimension-static-size-50)
    var(--ac-global-dimension-static-size-100);
  label {
    display: flex;
    align-items: center;
    gap: var(--ac-global-dimension-static-size-100);
  }
`;function Rb(n){const{columns:a}=n,t=Ln(c=>c.columnVisibility),l=Ln(c=>c.setColumnVisibility),i=u.useMemo(()=>a.filter(c=>!Vb.includes(c.id)),[a]),r=u.useMemo(()=>i.every(c=>{const p=t[c.id];return p??!0}),[i,t]),o=u.useCallback(c=>{const{name:p,checked:y}=c.target;l({...t,[p]:y})},[t,l]),d=u.useCallback(c=>{const{checked:p}=c.target,y=i.reduce((m,g)=>({...m,[g.id]:p}),{});l(y)},[i,l]);return e("div",{css:K`
        overflow-y: auto;
        max-height: calc(100vh - 200px);
      `,children:s(C,{paddingTop:"size-50",paddingBottom:"size-50",children:[e(C,{borderBottomColor:"dark",borderBottomWidth:"thin",paddingBottom:"size-50",children:e("div",{css:gt,children:s("label",{children:[e("input",{type:"checkbox",name:"toggle-all",checked:r,onChange:d}),"span columns"]})})}),e("ul",{children:i.map(c=>{const p=t[c.id],y=p??!0,m=typeof c.columnDef.header=="string"?c.columnDef.header:c.id;return e("li",{css:gt,children:s("label",{children:[e("input",{type:"checkbox",name:c.id,checked:y,onChange:o}),m]})},c.id)})}),e(Ab,{...n})]})})}function Ab({query:n}){const a=I.useFragment(mc,n),t=Ln(o=>o.annotationColumnVisibility),l=Ln(o=>o.setAnnotationColumnVisibility),i=u.useMemo(()=>a.spanAnnotationNames.every(o=>t[o]||!1),[a.spanAnnotationNames,t]),r=u.useCallback(()=>{const o=a.spanAnnotationNames.reduce((d,c)=>({...d,[c]:!i}),{});l(o)},[a.spanAnnotationNames,l,i]);return s("section",{children:[e(C,{paddingTop:"size-50",paddingBottom:"size-50",borderColor:"dark",borderTopWidth:"thin",borderBottomWidth:"thin",children:e("div",{css:gt,children:s("label",{children:[e("input",{type:"checkbox",name:"toggle-evaluations-all",checked:i,onChange:r}),"feedback"]})})}),e("ul",{children:a.spanAnnotationNames.map(o=>{const d=t[o]??!1;return e("li",{css:gt,children:s("label",{children:[e("input",{type:"checkbox",name:o,checked:d,onChange:()=>{l({...t,[o]:!d})}}),o]})},o)})})]})}const gc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"condition"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"condition",variableName:"condition"}],concreteType:"ValidationResult",kind:"LinkedField",name:"validateSpanFilterCondition",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isValid",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorMessage",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanFilterConditionFieldValidationQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanFilterConditionFieldValidationQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"29583e7ec666cef832dc7effb9e75678",id:null,metadata:{},name:"SpanFilterConditionFieldValidationQuery",operationKind:"query",text:`query SpanFilterConditionFieldValidationQuery(
  $condition: String!
  $id: GlobalID!
) {
  project: node(id: $id) {
    __typename
    ... on Project {
      validateSpanFilterCondition(condition: $condition) {
        isValid
        errorMessage
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();gc.hash="22836f192038b0c40201d3b25aad65b4";const yc=K`
  flex: 1 1 auto;
  .cm-content {
    padding: var(--ac-global-dimension-static-size-100) 0;
  }
  .cm-editor {
    background-color: transparent !important;
  }
  .cm-focused {
    outline: none;
  }
  .cm-selectionLayer .cm-selectionBackground {
    background: var(--ac-global-color-cyan-400) !important;
  }
`,fc=K`
  border-width: var(--ac-global-border-size-thin);
  border-style: solid;
  border-color: var(--ac-global-input-field-border-color);
  border-radius: var(--ac-global-rounding-small);
  background-color: var(--ac-global-input-field-background-color);
  transition: all 0.2s ease-in-out;
  overflow-x: hidden;
  &:hover,
  &[data-is-focused="true"] {
    border-color: var(--ac-global-input-field-border-color-active);
    background-color: var(--ac-global-input-field-background-color-active);
  }
  &[data-is-invalid="true"] {
    border-color: var(--ac-global-color-danger);
  }
  box-sizing: border-box;
`;function Nb(n){const a=n.matchBefore(/\w*/);return!a||a.from==a.to&&!n.explicit?null:{from:a.from,options:[{label:"span_kind",type:"variable",info:"The span variant: CHAIN, LLM, RETRIEVER, TOOL, etc."},{label:"status_code",type:"variable",info:"The span status: OK, UNSET, or ERROR"},{label:"input.value",type:"variable",info:"The input value of a span, typically a query"},{label:"output.value",type:"variable",info:"The output value of a span, typically a response"},{label:"name",type:"variable",info:"The name given to a span - e.x. OpenAI"},{label:"latency_ms",type:"variable",info:"Latency (i.e. duration) in milliseconds"},{label:"cumulative_token_count.prompt",type:"variable",info:"Sum of token count for prompt from self and all child spans"},{label:"cumulative_token_count.completion",type:"variable",info:"Sum of token count for completion from self and all child spans"},{label:"cumulative_token_count.total",type:"variable",info:"Sum of token count total (prompt + completion) from self and all child spans"},{label:"llm spans",type:"text",apply:"span_kind == 'LLM'",detail:"macro"},{label:"retriever spans",type:"text",apply:"span_kind == 'RETRIEVER'",detail:"macro"},{label:"search input",type:"text",apply:"'' in input.value",detail:"macro"},{label:"search output",type:"text",apply:"'' in output.value",detail:"macro"},{label:"status_code error",type:"text",apply:"status_code == 'ERROR'",detail:"macro"},{label:"Latency >= 10s",type:"text",apply:"latency_ms >= 10_000",detail:"macro"},{label:"Tokens >= 1,000",type:"text",apply:"llm.token_count.total >= 1_000",detail:"macro"},{label:"Hallucinations",type:"text",apply:"annotations['Hallucination'].label == 'hallucinated'",detail:"macro"},{label:"Annotations",type:"text",apply:"annotations['Hallucination'].label == 'hallucinated'",detail:"macro"},{label:"Metadata",type:"text",apply:"metadata['topic'] == 'agent'",detail:"macro"},{label:"Substring",type:"text",apply:"'agent' in input.value",detail:"macro"}]}}async function zb(n,a){if(!n)return{isValid:!0,errorMessage:null};const t=await et.fetchQuery(he,gc,{condition:n,id:a}).toPromise();if(!t)throw new Error("Filter condition validation is null");return t.project.validateSpanFilterCondition}const $b=[Ul.of([{key:"Enter",run:n=>!0}]),at(),Xr({override:[Nb]})];function hc(n){const{onValidCondition:a,placeholder:t="filter condition (e.x. span_kind == 'LLM')"}=n,[l,i]=u.useState(!1),[r,o]=u.useState(""),{filterCondition:d,setFilterCondition:c,appendFilterCondition:p}=Ut(),y=u.useDeferredValue(d),{theme:m}=Mn(),g=m==="light"?aa:ta,{projectId:f}=qe();u.useEffect(()=>{zb(y,f).then(S=>{S!=null&&S.isValid?(o(""),u.startTransition(()=>{a(y)})):o((S==null?void 0:S.errorMessage)??"Invalid filter condition")})},[a,y,f]);const k=r!=="";return s("div",{"data-is-focused":l,"data-is-invalid":k,className:"span-filter-condition-field",css:fc,children:[s(h,{direction:"row",children:[e(Kl,{children:e(L,{svg:e(ql,{})})}),e(la,{css:yc,indentWithTab:!1,basicSetup:{lineNumbers:!1,foldGutter:!1,bracketMatching:!0,syntaxHighlighting:!0,highlightActiveLine:!1,highlightActiveLineGutter:!1,defaultKeymap:!1},onFocus:()=>i(!0),onBlur:()=>i(!1),value:d,onChange:c,height:"36px",width:"100%",theme:g,placeholder:t,extensions:$b}),e("button",{css:K`
            margin-right: var(--ac-global-dimension-static-size-100);
            color: var(--ac-global-text-color-700);
            visibility: ${d!==""?"visible":"hidden"};
          `,onClick:()=>c(""),className:"button--reset",children:e(L,{svg:e(At,{})})}),s(ga,{placement:"bottom right",children:[e($e,{children:e("button",{css:K`
                color: var(--ac-global-text-color-700);
                background-color: var(--ac-global-color-grey-300);
                padding-left: var(--ac-global-dimension-static-size-100);
                padding-right: var(--ac-global-dimension-static-size-100);
                height: 100%;
              `,className:"button--reset",children:e(L,{svg:e(kn,{})})})}),e(Ob,{onAddFilterConditionSnippet:p})]})]}),s(me,{isOpen:k&&l,placement:"bottom",children:[e($e,{children:e("div",{})}),e(Zn,{children:r!=""?e(v,{color:"danger",children:r}):e(v,{color:"success",children:"Valid Expression"})})]})]})}function Ob(n){const{onAddFilterConditionSnippet:a}=n;return e(C,{width:"500px",padding:"size-200",borderRadius:"medium",borderWidth:"thin",borderColor:"light",backgroundColor:"light",children:s(h,{direction:"column",gap:"size-100",children:[e(sa,{label:"filter by kind",initialSnippet:"span_kind == 'LLM'",onAddFilterConditionSnippet:a},"kind"),e(sa,{label:"filter by token count",initialSnippet:"cumulative_token_count.total > 1000",onAddFilterConditionSnippet:a},"token_count"),e(sa,{label:"filter by annotation label",initialSnippet:"annotations['Hallucination'].label == 'hallucinated'",onAddFilterConditionSnippet:a},"annotation_label"),e(sa,{label:"filter by evaluation label",initialSnippet:"evals['Hallucination'].label == 'hallucinated'",onAddFilterConditionSnippet:a},"eval_label"),e(sa,{label:"filter by evaluation score",initialSnippet:"evals['Hallucination'].score < 1",onAddFilterConditionSnippet:a},"eval_score"),e(sa,{label:"filter by metadata",initialSnippet:"metadata['topic'] == 'agent'",onAddFilterConditionSnippet:a},"metadata"),e(sa,{label:"filter by substring",initialSnippet:"'agent' in input.value",onAddFilterConditionSnippet:a},"substring")]})})}function sa(n){const{initialSnippet:a,onAddFilterConditionSnippet:t}=n,[l,i]=u.useState(a),{theme:r}=Mn(),o=r==="light"?aa:ta;return e(Yn,{label:n.label,children:s(h,{direction:"row",width:"100%",gap:"size-100",children:[e("div",{css:K(fc,K`
              flex: 1 1 auto;
            `),children:e(la,{value:l,basicSetup:{lineNumbers:!1,foldGutter:!1,bracketMatching:!0,syntaxHighlighting:!0,highlightActiveLine:!1,highlightActiveLineGutter:!1},extensions:[at()],editable:!0,onChange:i,theme:o,css:yc})}),e(A,{"aria-label":"Add to filter condition",variant:"default",onPress:()=>t(l),leadingVisual:e(L,{svg:e(kn,{})})})]})})}const kc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"traceIds"}],a=[{alias:null,args:[{kind:"Variable",name:"traceIds",variableName:"traceIds"}],concreteType:"Query",kind:"LinkedField",name:"deleteTraces",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanSelectionToolbarDeleteTracesMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanSelectionToolbarDeleteTracesMutation",selections:a},params:{cacheID:"eb52eb7c9b255069f86fde333d3c1c75",id:null,metadata:{},name:"SpanSelectionToolbarDeleteTracesMutation",operationKind:"mutation",text:`mutation SpanSelectionToolbarDeleteTracesMutation(
  $traceIds: [GlobalID!]!
) {
  deleteTraces(traceIds: $traceIds) {
    __typename
  }
}
`}}}();kc.hash="5283cfa8a6e985223f13d95395852b17";const bc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"addSpansToDataset",plural:!1,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"dataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanSelectionToolbarAddSpansToDatasetMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanSelectionToolbarAddSpansToDatasetMutation",selections:a},params:{cacheID:"1c694540190478b8fba8ef3c0cacf30c",id:null,metadata:{},name:"SpanSelectionToolbarAddSpansToDatasetMutation",operationKind:"mutation",text:`mutation SpanSelectionToolbarAddSpansToDatasetMutation(
  $input: AddSpansToDatasetInput!
) {
  addSpansToDataset(input: $input) {
    dataset {
      id
    }
  }
}
`}}}();bc.hash="5e3aef907285081a06c0e0360045e865";const Sc={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DatasetSelectorPopoverContentDatasetsQuery",selections:[{args:null,kind:"FragmentSpread",name:"DatasetSelectorPopoverContent_datasets"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"DatasetSelectorPopoverContentDatasetsQuery",selections:[{alias:null,args:null,concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"dataset",args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"6d459b61a36b99979f025742892941f9",id:null,metadata:{},name:"DatasetSelectorPopoverContentDatasetsQuery",operationKind:"query",text:`query DatasetSelectorPopoverContentDatasetsQuery {
  ...DatasetSelectorPopoverContent_datasets
}

fragment DatasetSelectorPopoverContent_datasets on Query {
  datasets {
    edges {
      dataset: node {
        id
        name
      }
    }
  }
}
`}};Sc.hash="40d5267ad0ec2335a73ff2a4d05bbed1";const vc={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:[],operation:Sc}},name:"DatasetSelectorPopoverContent_datasets",selections:[{alias:null,args:null,concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"dataset",args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};vc.hash="40d5267ad0ec2335a73ff2a4d05bbed1";const Cc={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DatasetSelectorPopoverContentQuery",selections:[{args:null,kind:"FragmentSpread",name:"DatasetSelectorPopoverContent_datasets"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"DatasetSelectorPopoverContentQuery",selections:[{alias:null,args:null,concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"dataset",args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"5fb28a402f330dd235295da21efea58b",id:null,metadata:{},name:"DatasetSelectorPopoverContentQuery",operationKind:"query",text:`query DatasetSelectorPopoverContentQuery {
  ...DatasetSelectorPopoverContent_datasets
}

fragment DatasetSelectorPopoverContent_datasets on Query {
  datasets {
    edges {
      dataset: node {
        id
        name
      }
    }
  }
}
`}};Cc.hash="7cd8a13144d97d2b5294f2a09c9e1351";function Qb(n){const{onCreateNewDataset:a,onDatasetSelected:t}=n,[l,i]=u.useState(""),r=I.useLazyLoadQuery(Cc,{},{fetchPolicy:"network-only"});return s(Q,{title:"Add to Dataset",variant:"compact",backgroundColor:"light",borderColor:"light",bodyStyle:{padding:0},extra:e(A,{variant:"default",size:"S",onPress:a,children:"New Dataset"}),children:[e(C,{padding:"size-100",children:e(mg,{onChange:o=>{i(o)},children:e(ne,{placeholder:"Search datasets"})})}),e(C,{borderTopWidth:"thin",borderColor:"light",children:e("div",{css:K`
            height: 400px;
            overflow-y: auto;
            min-width: 300px;
          `,children:e(jb,{query:r,search:l,onDatasetSelected:t})})})]})}function jb(n){const{search:a,onDatasetSelected:t}=n,[l]=I.useRefetchableFragment(vc,n.query),i=u.useMemo(()=>{let o=l.datasets.edges.map(d=>d.dataset);return a&&(o=o.filter(d=>d.name.toLowerCase().includes(a.toLowerCase()))),o},[a,l]);return i.length===0?e(C,{padding:"size-200",children:e(h,{direction:"column",justifyContent:"center",alignItems:"center",flex:"1 1 auto",children:e(v,{children:"No datasets found"})})}):e(vt,{selectionMode:"single",onSelectionChange:o=>{if(typeof o=="object"){const d=Array.from(o);t(d[0])}},children:i.map(o=>e(re,{children:o.name},o.id))})}function Fc(n){const a=le(),[t,l]=u.useState(null),i=ke(),r=Fe(),[o,d]=u.useState(!1),{selectedSpans:c,onClearSelection:p}=n,[y,m]=I.useMutation(bc),[g,f]=I.useMutation(kc),k=c.length!==1,b=u.useCallback(P=>{y({variables:{input:{datasetId:P,spanIds:c.map(D=>D.id)}},onCompleted:()=>{i({title:"Examples added to dataset",message:`${c.length} example${k?"s have":" has"} been added to the dataset.`,action:{text:"View dataset",onClick:()=>{a(`/datasets/${P}/examples`)}}}),p()},onError:D=>{const w=Ce(D);r({title:"An error occurred",message:`Failed to add spans to dataset: ${(w==null?void 0:w[0])??D.message}`})}})},[y,c,i,k,p,a,r]),S=u.useCallback(()=>{const P=[...new Set(c.map(D=>D.traceId))];g({variables:{traceIds:P},onCompleted:()=>{i({title:"Traces deleted",message:`${P.length} trace${P.length!==1?"s have":" has"} been deleted.`}),p()},onError:D=>{const w=Ce(D);r({title:"An error occurred",message:`Failed to delete traces: ${(w==null?void 0:w[0])??D.message}`})}})},[g,c,i,p,r]),F=u.useCallback(()=>{l(s(Z,{size:"S",title:"Delete Traces",isDismissable:!0,onDismiss:()=>l(null),children:[e(C,{padding:"size-200",children:e(v,{color:"danger",children:"Are you sure you want to delete the selected spans and their traces?"})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",children:e(A,{variant:"danger",onPress:()=>{S(),l(null)},children:"Delete Traces"})})})]}))},[S]);return s("div",{css:K`
        position: absolute;
        bottom: var(--ac-global-dimension-size-600);
        left: 50%;
        transform: translateX(-50%);
        z-index: 1000;
        box-shadow: 8px 8px 20px 0 rgba(0, 0, 0, 0.4);
        border-radius: var(--ac-global-rounding-medium);
      `,children:[e(C,{backgroundColor:"light",padding:"size-200",borderColor:"light",borderWidth:"thin",borderRadius:"medium",minWidth:"size-6000",children:s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(v,{children:`${c.length} span${k?"s":""} selected`}),s(h,{direction:"row",gap:"size-100",children:[e(A,{variant:"default",size:"S",onPress:p,children:"Cancel"}),s(ga,{placement:"top end",crossOffset:300,isOpen:o,onOpenChange:P=>{d(P)},children:[e(A,{variant:"primary",size:"S",leadingVisual:e(L,{svg:m?e(je,{}):e(Ct,{})}),isDisabled:m,children:m?"Adding...":"Add to Dataset"}),e(u.Suspense,{children:e(Qb,{onDatasetSelected:P=>{b(P),d(!1)},onCreateNewDataset:()=>{d(!1),l(e(Z,{title:"New Dataset",isDismissable:!0,onDismiss:()=>l(null),children:e(jr,{onDatasetCreateError:P=>{const D=Ce(P);r({title:"Dataset creation failed",message:`Failed to create dataset: ${(D==null?void 0:D[0])??P.message}`})},onDatasetCreated:P=>{l(null),i({title:"Dataset created",message:`${P.name} has been successfully created.`}),d(!0)}})}))}})})]}),e(A,{variant:"danger",size:"S",leadingVisual:e(L,{svg:f?e(je,{}):e(We,{})}),isDisabled:f,onPress:F,children:f?"Deleting...":"Delete"})]})]})}),e(X,{onDismiss:()=>{l(null)},children:t})]})}const Xa="annotations",Cn=":",Kc={col:"startTime",dir:"desc"};function Tc(n){let a=null,t=null;if(n.id&&n.id.startsWith(Xa)){const[,l,i]=n.id.split(Cn);t={attr:l,name:i}}else a=n.id;return{col:a,evalResultKey:t,dir:n.desc?"desc":"asc"}}const Ui=50;function qb(n){return n==="root"||n==="all"}function Bb(n){const{fetchKey:a}=ha(),t=!!rr("/projects/:projectId/spans"),l=u.useRef(null),i=u.useRef(!0),[r,o]=u.useState({}),[d,c]=u.useState([]),[p,y]=u.useState(""),[m,g]=u.useState(!0),f=Ln(_=>_.columnVisibility),k=le(),{data:b,loadNext:S,hasNext:F,isLoadingNext:P,refetch:D}=I.usePaginationFragment(sc,n.project),w=Ln(_=>_.annotationColumnVisibility),T=u.useMemo(()=>Object.keys(w).filter(_=>w[_]),[w]),x=u.useMemo(()=>b.spans.edges.map(({span:z})=>z),[b]),M=T.map(_=>({header:_,columns:[{header:"label",accessorKey:`${Xa}${Cn}label${Cn}${_}`,cell:({row:z})=>{const V=z.original.spanAnnotations.find(q=>q.name===_);return V?V.label:null}},{header:"score",accessorKey:`${Xa}${Cn}score${Cn}${_}`,cell:({row:z})=>{const V=z.original.spanAnnotations.find(q=>q.name===_);return V?V.score:null}}]})),R=[{header:()=>s(h,{direction:"row",gap:"size-50",children:[e("span",{children:"feedback"}),s(Da,{children:[e(te,{level:3,weight:"heavy",children:"Feedback"}),e(Xn,{children:"Feedback includes evaluations and human annotations logged via the API or set via the UI."})]})]}),id:"feedback",accessorKey:"spanAnnotations",enableSorting:!1,cell:({row:_})=>s(h,{direction:"row",gap:"size-50",wrap:"wrap",children:[_.original.spanAnnotations.map(z=>e(_a,{annotation:z,layout:"horizontal",width:"500px",extra:e(cc,{annotation:z}),children:e(En,{annotation:z,annotationDisplayPreference:"label"})},z.name)),_.original.documentRetrievalMetrics.map(z=>s(U,{children:[e(Xe,{name:z.evaluationName,metric:"ndcg",score:z.ndcg},"ndcg"),e(Xe,{name:z.evaluationName,metric:"precision",score:z.precision},"precision"),e(Xe,{name:z.evaluationName,metric:"hit",score:z.hit},"hit")]}))]})},...M],O=[{id:"select",maxSize:10,header:({table:_})=>e(Gn,{checked:_.getIsAllRowsSelected(),indeterminate:_.getIsSomeRowsSelected(),onChange:_.getToggleAllRowsSelectedHandler()}),cell:({row:_})=>e(Gn,{checked:_.getIsSelected(),disabled:!_.getCanSelect(),indeterminate:_.getIsSomeSelected(),onChange:_.getToggleSelectedHandler()})},{header:"status",accessorKey:"statusCode",maxSize:30,enableSorting:!1,cell:({getValue:_})=>{const z=_();return e(h,{direction:"row",gap:"size-50",alignItems:"center",children:e(_t,{statusCode:z})})}},{header:"kind",accessorKey:"spanKind",maxSize:100,enableSorting:!1,cell:({getValue:_})=>e(El,{spanKind:_()})},{header:"name",accessorKey:"name",enableSorting:!1,cell:({getValue:_,row:z})=>{const V=z.original,{traceId:q}=V.trace;return e(Oe,{to:`${q}?selectedSpanNodeId=${V.id}`,children:_()})}},{header:"input",accessorKey:"input.value",cell:De,enableSorting:!1},{header:"output",accessorKey:"output.value",cell:De,enableSorting:!1},{header:"metadata",accessorKey:"metadata",cell:({row:_})=>e(dc,{metadata:_.original.metadata}),enableSorting:!1},...R,{header:"start time",accessorKey:"startTime",cell:Me},{header:"latency",accessorKey:"latencyMs",cell:({getValue:_})=>{const z=_();return z===null||typeof z!="number"?null:e(Ve,{latencyMs:z})}},{header:"total tokens",accessorKey:"tokenCountTotal",cell:({row:_,getValue:z})=>{const V=z();return V===null?"--":e(na,{tokenCountTotal:V,tokenCountPrompt:_.original.tokenCountPrompt||0,tokenCountCompletion:_.original.tokenCountCompletion||0})}}];u.useEffect(()=>{if(i.current===!0){i.current=!1;return}t&&u.startTransition(()=>{const _=d[0];D({sort:_?Tc(_):Kc,after:null,first:Ui,filterCondition:p,rootSpansOnly:m},{fetchPolicy:"store-and-network"})})},[d,D,p,a,t,m]);const N=u.useCallback(_=>{if(_){const{scrollHeight:z,scrollTop:V,clientHeight:q}=_;z-V-q<300&&!P&&F&&S(Ui)}},[F,P,S]),j=Te({columns:O,data:x,state:{sorting:d,columnVisibility:f,rowSelection:r},manualSorting:!0,enableRowSelection:!0,onRowSelectionChange:o,onSortingChange:c,getCoreRowModel:Pe(),getSortedRowModel:hn()}),Y=j.getRowModel().rows,se=j.getSelectedRowModel().rows,ye=se.map(_=>({id:_.original.id,traceId:_.original.trace.id})),be=u.useCallback(()=>{o({})},[o]),Sn=Y.length===0,$n=j.getAllColumns().filter(_=>_.columns.length===0);return s("div",{css:ci,children:[e(C,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-200",paddingEnd:"size-200",borderBottomColor:"grey-300",borderBottomWidth:"thin",flex:"none",children:s(h,{direction:"row",gap:"size-100",width:"100%",alignItems:"center",children:[e(hc,{onValidCondition:y}),s(Ol,{"aria-label":"Toggle between root and all spans",selectionMode:"single",selectedKeys:[m?"root":"all"],onSelectionChange:_=>{if(_.size===0)return;const z=_.keys().next().value;if(qb(z))g(z==="root");else throw new Error(`Unknown root span filter selection: ${z}`)},children:[e(da,{"aria-label":"root spans",id:"root",children:"Root Spans"}),e(da,{"aria-label":"all spans",id:"all",children:"All"})]}),e(pc,{columns:$n,query:b})]})}),e("div",{css:K`
          flex: 1 1 auto;
          overflow: auto;
        `,onScroll:_=>N(_.target),ref:l,children:s("table",{css:ea,children:[e("thead",{children:j.getHeaderGroups().map(_=>e("tr",{children:_.headers.map(z=>e("th",{colSpan:z.colSpan,children:z.isPlaceholder?null:s("div",{className:z.column.getCanSort()?"cursor-pointer":"",onClick:z.column.getToggleSortingHandler(),style:{left:z.getStart(),width:z.getSize()},children:[W(z.column.columnDef.header,z.getContext()),z.column.getIsSorted()?e(L,{className:"sort-icon",svg:z.column.getIsSorted()==="asc"?e(sn,{}):e(rn,{})}):null]})},z.id))},_.id))}),Sn?e(uc,{projectName:b.name}):e("tbody",{children:Y.map(_=>e("tr",{onClick:()=>k(`${_.original.trace.traceId}?selectedSpanNodeId=${_.original.id}`),children:_.getVisibleCells().map(z=>e("td",{children:W(z.column.columnDef.cell,z.getContext())},z.id))},_.id))})]})}),se.length?e(Fc,{selectedSpans:ye,onClearSelection:be}):null]})}function Ub({queryReference:n}){const a=I.usePreloadedQuery(Gd,n);return e(Bb,{project:a.project})}const w2=()=>{const{spansQueryReference:n}=di();return n?s(mi,{children:[e(ui,{children:e(u.Suspense,{fallback:e(ge,{}),children:e(Ub,{queryReference:n})})}),e(u.Suspense,{children:e(xe,{})})]}):null},Pc=function(){var n={defaultValue:null,kind:"LocalArgument",name:"after"},a={defaultValue:null,kind:"LocalArgument",name:"filterCondition"},t={defaultValue:50,kind:"LocalArgument",name:"first"},l={defaultValue:null,kind:"LocalArgument",name:"id"},i={defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},r={defaultValue:null,kind:"LocalArgument",name:"timeRange"},o=[{kind:"Variable",name:"id",variableName:"id"}],d={kind:"Variable",name:"after",variableName:"after"},c={kind:"Variable",name:"filterCondition",variableName:"filterCondition"},p={kind:"Variable",name:"first",variableName:"first"},y={kind:"Variable",name:"sort",variableName:"sort"},m={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},k=[d,c,p,{kind:"Literal",name:"rootSpansOnly",value:!0},y,{kind:"Variable",name:"timeRange",variableName:"timeRange"}],b={alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},S={alias:"statusCode",args:null,kind:"ScalarField",name:"propagatedStatusCode",storageKey:null},F={alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},P={alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},D={alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},w=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}],T={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:w,storageKey:null},x={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:w,storageKey:null},M={alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},R={alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},O={alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[g,f,{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},N={alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:[n,a,t,l,i,r],kind:"Fragment",metadata:null,name:"TracesTableQuery",selections:[{alias:null,args:o,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:[d,c,p,y],kind:"FragmentSpread",name:"TracesTable_spans"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,a,t,i,r,l],kind:"Operation",name:"TracesTableQuery",selections:[{alias:null,args:o,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[m,{kind:"TypeDiscriminator",abstractKey:"__isNode"},g,{kind:"InlineFragment",selections:[f,{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:"rootSpans",args:k,concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"rootSpan",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[g,b,f,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},S,F,P,{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountCompletion",storageKey:null},D,T,x,M,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[g,R,{alias:null,args:null,kind:"ScalarField",name:"numSpans",storageKey:null}],storageKey:null},O,N,{alias:null,args:[{kind:"Literal",name:"first",value:50}],concreteType:"SpanConnection",kind:"LinkedField",name:"descendants",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[g,b,f,S,F,P,D,{alias:"cumulativeTokenCountTotal",args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:"cumulativeTokenCountPrompt",args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:"cumulativeTokenCountCompletion",args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},T,x,M,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[g,R],storageKey:null},O,N],storageKey:null}],storageKey:null}],storageKey:"descendants(first:50)"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[m],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:"rootSpans",args:k,filters:["sort","rootSpansOnly","filterCondition","timeRange"],handle:"connection",key:"TracesTable_rootSpans",kind:"LinkedHandle",name:"spans"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"7e9054483242410f5567caddcc8924c0",id:null,metadata:{},name:"TracesTableQuery",operationKind:"query",text:`query TracesTableQuery(
  $after: String = null
  $filterCondition: String = null
  $first: Int = 50
  $sort: SpanSort = {col: startTime, dir: desc}
  $timeRange: TimeRange
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...TracesTable_spans_1XEuU
    __isNode: __typename
    id
  }
}

fragment SpanColumnSelector_annotations on Project {
  spanAnnotationNames
}

fragment TracesTable_spans_1XEuU on Project {
  name
  ...SpanColumnSelector_annotations
  rootSpans: spans(first: $first, after: $after, sort: $sort, rootSpansOnly: true, filterCondition: $filterCondition, timeRange: $timeRange) {
    edges {
      rootSpan: node {
        id
        spanKind
        name
        metadata
        statusCode: propagatedStatusCode
        startTime
        latencyMs
        cumulativeTokenCountTotal
        cumulativeTokenCountPrompt
        cumulativeTokenCountCompletion
        parentId
        input {
          value: truncatedValue
        }
        output {
          value: truncatedValue
        }
        spanId
        trace {
          id
          traceId
          numSpans
        }
        spanAnnotations {
          id
          name
          label
          score
          annotatorKind
        }
        documentRetrievalMetrics {
          evaluationName
          ndcg
          precision
          hit
        }
        descendants(first: 50) {
          edges {
            node {
              id
              spanKind
              name
              statusCode: propagatedStatusCode
              startTime
              latencyMs
              parentId
              cumulativeTokenCountTotal: tokenCountTotal
              cumulativeTokenCountPrompt: tokenCountPrompt
              cumulativeTokenCountCompletion: tokenCountCompletion
              input {
                value: truncatedValue
              }
              output {
                value: truncatedValue
              }
              spanId
              trace {
                id
                traceId
              }
              spanAnnotations {
                id
                name
                label
                score
                annotatorKind
              }
              documentRetrievalMetrics {
                evaluationName
                ndcg
                precision
                hit
              }
            }
          }
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Pc.hash="6757deb68e4b09c39445840106c9a3dd";const Ic=function(){var n=["rootSpans"],a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},i={alias:"statusCode",args:null,kind:"ScalarField",name:"propagatedStatusCode",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},c=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}],p={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:c,storageKey:null},y={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:c,storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},f={alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[t,a,{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},k={alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"filterCondition"},{defaultValue:50,kind:"LocalArgument",name:"first"},{defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},{kind:"RootArgument",name:"timeRange"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:Pc,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"TracesTable_spans",selections:[a,{args:null,kind:"FragmentSpread",name:"SpanColumnSelector_annotations"},{alias:"rootSpans",args:[{kind:"Variable",name:"filterCondition",variableName:"filterCondition"},{kind:"Literal",name:"rootSpansOnly",value:!0},{kind:"Variable",name:"sort",variableName:"sort"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"SpanConnection",kind:"LinkedField",name:"__TracesTable_rootSpans_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"rootSpan",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[t,l,a,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},i,r,o,{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountCompletion",storageKey:null},d,p,y,m,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[t,g,{alias:null,args:null,kind:"ScalarField",name:"numSpans",storageKey:null}],storageKey:null},f,k,{alias:null,args:[{kind:"Literal",name:"first",value:50}],concreteType:"SpanConnection",kind:"LinkedField",name:"descendants",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[t,l,a,i,r,o,d,{alias:"cumulativeTokenCountTotal",args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:"cumulativeTokenCountPrompt",args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:"cumulativeTokenCountCompletion",args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},p,y,m,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[t,g],storageKey:null},f,k],storageKey:null}],storageKey:null}],storageKey:"descendants(first:50)"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},t],type:"Project",abstractKey:null}}();Ic.hash="6757deb68e4b09c39445840106c9a3dd";const Hi=50,Hb=50,Gb=({row:n})=>n.original.__additionalRow?null:e(dc,{metadata:n.original.metadata}),Wb=K`
  &[data-is-additional-row="true"] {
    box-shadow: inset 0 -10px 20px var(--ac-global-color-grey-100);
  }
`;function xc(n){const{children:a}=n,t=[];for(const l of a){const i={...l.span,children:xc({children:l.children})};t.push(i)}return t}function Jb(n){const a=u.useRef(null),t=u.useRef(!0),[l,i]=u.useState({}),[r,o]=u.useState([]),[d,c]=u.useState(""),p=le(),y=!!rr("/projects/:projectId/traces"),{fetchKey:m}=ha(),{data:g,loadNext:f,hasNext:k,isLoadingNext:b,refetch:S}=I.usePaginationFragment(Ic,n.project),F=Ln(_=>_.annotationColumnVisibility),P=u.useMemo(()=>Object.keys(F).filter(_=>F[_]),[F]),D=u.useMemo(()=>g.rootSpans.edges.map(({rootSpan:_})=>{const z=pg([_,..._.descendants.edges.map(({node:ee})=>ee)]),[V]=xc({children:z}),q=_.trace.numSpans-Hb-1;return q>0&&(V.children=[...V.children,{...V,__additionalRow:!0,name:`+ ${q} more span${q>1?"s":""}`,id:`additional-${V.id}`,input:{value:""},output:{value:""},metadata:null,spanAnnotations:[],documentRetrievalMetrics:[],children:[]}]),V}),[g]),w=u.useMemo(()=>P.map(_=>({header:_,columns:[{header:"label",accessorKey:`${Xa}${Cn}label${Cn}${_}`,cell:({row:z})=>{const q=z.original.spanAnnotations.find(ee=>ee.name===_);return q?q.label:null}},{header:"score",accessorKey:`${Xa}${Cn}score${Cn}${_}`,cell:({row:z})=>{const V=z.original.spanAnnotations.find(q=>q.name===_);return V?V.score:null}}]})),[P]),T=u.useMemo(()=>[{header:()=>s(h,{direction:"row",gap:"size-50",children:[e("span",{children:"feedback"}),s(Da,{children:[e(te,{level:3,weight:"heavy",children:"Feedback"}),e(Xn,{children:"Feedback includes evaluations and human annotations logged via the API or set via the UI."})]})]}),id:"feedback",accessorKey:"spanAnnotations",enableSorting:!1,cell:({row:_})=>{if(_.original.__additionalRow)return null;const z=_.original.spanAnnotations.length===0&&_.original.documentRetrievalMetrics.length===0;return s(h,{direction:"row",gap:"size-50",wrap:"wrap",children:[_.original.spanAnnotations.map(V=>e(_a,{annotation:V,layout:"horizontal",width:"500px",extra:e(cc,{annotation:V}),children:e(En,{annotation:V,annotationDisplayPreference:"label"})},V.name)),_.original.documentRetrievalMetrics.map(V=>s(u.Fragment,{children:[e(Xe,{name:V.evaluationName,metric:"ndcg",score:V.ndcg},"ndcg"),e(Xe,{name:V.evaluationName,metric:"precision",score:V.precision},"precision"),e(Xe,{name:V.evaluationName,metric:"hit",score:V.hit},"hit")]},"doc-evals")),z?"--":null]})}},...w],[w]),x=u.useMemo(()=>[{id:"select",maxSize:10,header:({table:_})=>e(Gn,{checked:_.getIsAllRowsSelected(),indeterminate:_.getIsSomeRowsSelected(),onChange:_.getToggleAllRowsSelectedHandler()}),cell:({row:_})=>_.original.__additionalRow?null:e(Gn,{checked:_.getIsSelected(),disabled:!_.getCanSelect(),indeterminate:_.getIsSomeSelected(),onChange:_.getToggleSelectedHandler()})},{header:"status",accessorKey:"statusCode",maxSize:30,enableSorting:!1,cell:({getValue:_,row:z})=>{if(z.original.__additionalRow)return null;const V=_();return e(_t,{statusCode:V})}},{header:({table:_})=>s(h,{gap:"size-50",direction:"row",alignItems:"center",children:[e(Ki,{isExpanded:_.getIsAllRowsExpanded(),onClick:_.getToggleAllRowsExpandedHandler(),"aria-label":"Expand all rows"}),"kind"]}),enableSorting:!1,accessorKey:"spanKind",maxSize:100,cell:_=>_.row.original.__additionalRow?e("div",{css:K`
                  // Since rows are flattened by default,
                  // we can use the row.depth property
                  // and paddingLeft to visually indicate the depth
                  // of the row
                  padding-left: ${_.row.depth*2}rem;
                `,children:e(L,{svg:e(gg,{})})}):e("div",{css:K`
                // Since rows are flattened by default,
                // we can use the row.depth property
                // and paddingLeft to visually indicate the depth
                // of the row
                padding-left: ${_.row.depth*2}rem;
              `,children:s(h,{gap:"size-50",children:[_.row.getCanExpand()?e(Ki,{isExpanded:_.row.getIsExpanded(),onClick:_.row.getToggleExpandedHandler(),"aria-label":"Expand row"}):null,e(El,{spanKind:_.getValue()})]})})},{header:"name",accessorKey:"name",enableSorting:!1,cell:({getValue:_,row:z})=>{const{traceId:V}=z.original.trace,q=z.original.isAdditionalSpansRow?null:z.original.id;return e(Oe,{to:`${V}${q?`?selectedSpanNodeId=${q}`:""}`,children:_()})}},{header:"input",accessorKey:"input.value",enableSorting:!1,cell:De},{header:"output",accessorKey:"output.value",enableSorting:!1,cell:De},{header:"metadata",accessorKey:"metadata",enableSorting:!1,cell:Gb},...T,{header:"start time",accessorKey:"startTime",cell:_=>_.row.original.__additionalRow?null:e(Me,{..._})},{header:"latency",accessorKey:"latencyMs",cell:({getValue:_,row:z})=>{const V=_();return V===null||typeof V!="number"||z.original.__additionalRow?null:e(Ve,{latencyMs:V})}},{header:"total tokens",minSize:80,accessorKey:"cumulativeTokenCountTotal",cell:({row:_,getValue:z})=>{if(_.original.__additionalRow)return null;const V=z();return V===null?"--":e(na,{tokenCountTotal:V,tokenCountPrompt:_.original.cumulativeTokenCountPrompt||0,tokenCountCompletion:_.original.cumulativeTokenCountCompletion||0})}}],[T]);u.useEffect(()=>{if(t.current===!0){t.current=!1;return}if(y){const _=r[0];u.startTransition(()=>{S({sort:_?Tc(_):Kc,after:null,first:Hi,filterCondition:d},{fetchPolicy:"store-and-network"})})}},[r,S,d,m,y]);const M=u.useCallback(_=>{if(_){const{scrollHeight:z,scrollTop:V,clientHeight:q}=_;z-V-q<300&&!b&&k&&f(Hi)}},[k,b,f]),[R,O]=u.useState({}),N=Ln(_=>_.columnVisibility),j=Te({columns:x,data:D,onExpandedChange:O,manualSorting:!0,getSubRows:_=>_.children,state:{sorting:r,expanded:R,columnVisibility:N,rowSelection:l},onRowSelectionChange:i,enableSubRowSelection:!1,onSortingChange:o,getCoreRowModel:Pe(),getSortedRowModel:hn(),getExpandedRowModel:ir(),getRowId:_=>_.id}),Y=j.getRowModel().rows,se=j.getSelectedRowModel().flatRows,ye=se.map(_=>({id:_.original.id,traceId:_.original.trace.id})),be=u.useCallback(()=>{i({})},[i]),Sn=Y.length===0,$n=j.getAllColumns().filter(_=>_.columns.length===0);return s("div",{css:ci,children:[e(C,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-200",paddingEnd:"size-200",borderBottomColor:"grey-300",borderBottomWidth:"thin",flex:"none",children:s(h,{direction:"row",gap:"size-100",width:"100%",alignItems:"center",children:[e(hc,{onValidCondition:c}),e(pc,{columns:$n,query:g})]})}),e("div",{css:K`
          flex: 1 1 auto;
          overflow: auto;
        `,onScroll:_=>M(_.target),ref:a,children:s("table",{css:ea,children:[e("thead",{children:j.getHeaderGroups().map(_=>e("tr",{children:_.headers.map(z=>e("th",{colSpan:z.colSpan,children:z.isPlaceholder?null:s("div",{"data-sortable":z.column.getCanSort(),className:z.column.getCanSort()?"cursor-pointer":"",onClick:z.column.getToggleSortingHandler(),style:{left:z.getStart(),width:z.getSize()},children:[W(z.column.columnDef.header,z.getContext()),z.column.getIsSorted()?e(L,{className:"sort-icon",svg:z.column.getIsSorted()==="asc"?e(sn,{}):e(rn,{})}):null]})},z.id))},_.id))}),Sn?e(uc,{projectName:g.name}):e("tbody",{children:Y.map(_=>e("tr",{onClick:()=>p(`${_.original.trace.traceId}`),"data-is-additional-row":_.original.__additionalRow,css:Wb,children:_.getVisibleCells().map(z=>e("td",{children:W(z.column.columnDef.cell,z.getContext())},z.id))},_.id))})]})}),se.length?e(Fc,{selectedSpans:ye,onClearSelection:be}):null]})}const Zb=({tracesQueryReference:n})=>{const a=I.usePreloadedQuery(Hd,n);return e(Jb,{project:a.project})},E2=()=>{const{tracesQueryReference:n}=di();return n?s(mi,{children:[e(ui,{children:e(u.Suspense,{fallback:e(ge,{}),children:e(Zb,{tracesQueryReference:n})})}),e(u.Suspense,{children:e(xe,{})})]}):null},Dc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],type:"Project",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"projectLoaderQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,l],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"projectLoaderQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,l],storageKey:null}]},params:{cacheID:"04c84b5bc2a01477851d347af75dcc11",id:null,metadata:{},name:"projectLoaderQuery",operationKind:"query",text:`query projectLoaderQuery(
  $id: GlobalID!
) {
  project: node(id: $id) {
    __typename
    id
    ... on Project {
      name
    }
  }
}
`}}}();Dc.hash="3d31e323c06df38ec2eaa6f3adb55e79";async function M2(n){const{projectId:a}=n.params;return await I.fetchQuery(he,Dc,{id:a}).toPromise()}function V2(){const n=hm(),a=u.useMemo(()=>n instanceof Error&&n.message==="Failed to fetch"?e(Xb,{}):e(Yb,{error:n}),[n]);return e("main",{css:K`
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      `,children:e("section",{css:K`
          width: 500px;
          /* Add spacing on the bottom so it gets pushed down */
          margin-top: 200px;
          display: flex;
          flex-direction: column;
        `,children:a})})}function Xb(){return s(U,{children:[s(h,{direction:"column",width:"100%",alignItems:"center",children:[e(bt,{graphicKey:"not found"}),e("h1",{children:"Server disconnected"})]}),e("p",{children:"We are unable to reach the Phoenix server. Please ensure that Phoenix is running and try again."})]})}function Yb({error:n}){return s(U,{children:[s(h,{direction:"column",width:"100%",alignItems:"center",children:[e(bt,{graphicKey:"error"}),e("h1",{children:"Something went wrong"})]}),e("p",{children:"We strive to do our very best but  bugs happen. It would mean a lot to us if you could file a an issue. If you feel comfortable, please include the error details below in your issue. We will get back to you as soon as we can."}),e("p",{css:K`
          display: flex;
          flex-direction: row;
          justify-content: flex-end;
          gap: var(--ac-global-dimension-static-size-100);
        `,children:s("span",{css:K`
            display: inline-flex;
            flex-direction: row;
            align-items: baseline;
            gap: 0.2em;
          `,children:[" the",e(nn,{href:"mailto:phoenix-devs@arize.com",children:"phoenix team"})]})}),s("div",{css:K`
          display: flex;
          flex-direction: row;
          justify-content: flex-end;
          align-items: center;
          gap: var(--ac-global-dimension-static-size-100);
        `,children:[e(nn,{href:"https://github.com/Arize-ai/phoenix/issues/new?assignees=&labels=bug&template=bug_report.md&title=%5BBUG%5D",children:"file an issue with us"}),e(A,{variant:"primary",size:"S",onPress:()=>{window.location.href="/"},children:"Return Home"})]}),s("details",{open:!0,children:[e("summary",{children:"error details"}),e("pre",{css:K`
            white-space: pre-wrap;
            overflow-wrap: break-word;
            overflow: hidden;
            overflow-y: auto;
            max-height: 500px;
          `,children:n instanceof Error?n.message:null})]})]})}const _c=function(){var n=[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null}],a=[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"primaryInferences",plural:!1,selections:n,storageKey:null},{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"referenceInferences",plural:!1,selections:n,storageKey:null},{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"corpusInferences",plural:!1,selections:n,storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ModelRootQuery",selections:a,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"ModelRootQuery",selections:a},params:{cacheID:"c3baccc5527002697b40a06eef432a4d",id:null,metadata:{},name:"ModelRootQuery",operationKind:"query",text:`query ModelRootQuery {
  model {
    primaryInferences {
      name
      startTime
      endTime
    }
    referenceInferences {
      name
      startTime
      endTime
    }
    corpusInferences {
      name
      startTime
      endTime
    }
  }
}
`}}}();_c.hash="b73d8f3f532a0c6f88863f3c6dd5734f";const eS=_c;function R2(){const n=I.useLazyLoadQuery(eS,{}),{model:{primaryInferences:a,referenceInferences:t,corpusInferences:l}}=n;return e(fg,{primaryInferences:a,referenceInferences:t??null,corpusInferences:l??null,children:e(yg,{timeRangeBounds:{start:new Date(a.startTime),end:new Date(a.endTime)},children:e(xe,{})})})}function A2(){return e(hg,{children:e(xe,{})})}const Lc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:50,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],t={kind:"Variable",name:"timeRange",variableName:"timeRange"},l=[t];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectsPageProjectsQuery",selections:[{args:a,kind:"FragmentSpread",name:"ProjectsPageProjectsFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectsPageProjectsQuery",selections:[{alias:null,args:a,concreteType:"ProjectConnection",kind:"LinkedField",name:"projects",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"project",args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientStartColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientEndColor",storageKey:null},{alias:null,args:l,kind:"ScalarField",name:"traceCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:"latencyMsP50",args:[{kind:"Literal",name:"probability",value:.5},t],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:null,args:l,kind:"ScalarField",name:"tokenCountTotal",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:a,filters:null,handle:"connection",key:"ProjectsPage_projects",kind:"LinkedHandle",name:"projects"}]},params:{cacheID:"ead527a5c3ddda0f6c906c99183edf06",id:null,metadata:{},name:"ProjectsPageProjectsQuery",operationKind:"query",text:`query ProjectsPageProjectsQuery(
  $after: String = null
  $first: Int = 50
  $timeRange: TimeRange
) {
  ...ProjectsPageProjectsFragment_2HEEH6
}

fragment ProjectsPageProjectsFragment_2HEEH6 on Query {
  projects(first: $first, after: $after) {
    edges {
      project: node {
        id
        name
        gradientStartColor
        gradientEndColor
        traceCount(timeRange: $timeRange)
        endTime
        latencyMsP50: latencyMsQuantile(probability: 0.5, timeRange: $timeRange)
        tokenCountTotal(timeRange: $timeRange)
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();Lc.hash="56c501357948255461a24411fb6b5847";const wc=function(){var n=["projects"],a={kind:"Variable",name:"timeRange",variableName:"timeRange"},t=[a];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:50,kind:"LocalArgument",name:"first"},{kind:"RootArgument",name:"timeRange"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:[],operation:Lc}},name:"ProjectsPageProjectsFragment",selections:[{alias:"projects",args:null,concreteType:"ProjectConnection",kind:"LinkedField",name:"__ProjectsPage_projects_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"project",args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientStartColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientEndColor",storageKey:null},{alias:null,args:t,kind:"ScalarField",name:"traceCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:"latencyMsP50",args:[{kind:"Literal",name:"probability",value:.5},a],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:null,args:t,kind:"ScalarField",name:"tokenCountTotal",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null}}();wc.hash="56c501357948255461a24411fb6b5847";const Ec=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Literal",name:"first",value:50}],t={kind:"Variable",name:"timeRange",variableName:"timeRange"},l=[t];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectsPageQuery",selections:[{args:null,kind:"FragmentSpread",name:"ProjectsPageProjectsFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectsPageQuery",selections:[{alias:null,args:a,concreteType:"ProjectConnection",kind:"LinkedField",name:"projects",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"project",args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientStartColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientEndColor",storageKey:null},{alias:null,args:l,kind:"ScalarField",name:"traceCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:"latencyMsP50",args:[{kind:"Literal",name:"probability",value:.5},t],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:null,args:l,kind:"ScalarField",name:"tokenCountTotal",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"projects(first:50)"},{alias:null,args:a,filters:null,handle:"connection",key:"ProjectsPage_projects",kind:"LinkedHandle",name:"projects"}]},params:{cacheID:"35a420462b10b0f0158d042fd39bfabb",id:null,metadata:{},name:"ProjectsPageQuery",operationKind:"query",text:`query ProjectsPageQuery(
  $timeRange: TimeRange!
) {
  ...ProjectsPageProjectsFragment
}

fragment ProjectsPageProjectsFragment on Query {
  projects(first: 50) {
    edges {
      project: node {
        id
        name
        gradientStartColor
        gradientEndColor
        traceCount(timeRange: $timeRange)
        endTime
        latencyMsP50: latencyMsQuantile(probability: 0.5, timeRange: $timeRange)
        tokenCountTotal(timeRange: $timeRange)
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();Ec.hash="c28f5ced0b3ec4b3b8277d0aac29de2d";const nS="https://docs.arize.com/phoenix/tracing/how-to-tracing/setup-tracing";function aS(){const[n,a]=u.useState(null);return s("div",{children:[e(A,{leadingVisual:e(L,{svg:e(cr,{})}),size:"S",onPress:()=>{a(e(tS,{}))},children:"New Project"}),e(X,{isDismissable:!0,type:"slideOver",onDismiss:()=>a(null),children:n})]})}function tS(){const[n,a]=u.useState("Python");return e(Z,{title:"Create a New Project",size:"L",children:s(C,{padding:"size-400",overflow:"auto",children:[e(C,{paddingBottom:"size-200",children:e(Pt,{language:n,onChange:a})}),e(C,{paddingBottom:"size-100",children:s(v,{children:["Projects are created when you log your first trace via OpenTelemetry. See the"," ",e(nn,{href:nS,children:"documentation"})," ","for a complete guide."]})}),n==="Python"?e(Or,{}):e(Qr,{})]})})}const Mc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"Query",kind:"LinkedField",name:"clearProject",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectActionMenuClearMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectActionMenuClearMutation",selections:a},params:{cacheID:"63319b4e42b499db2447817f1dc821fb",id:null,metadata:{},name:"ProjectActionMenuClearMutation",operationKind:"mutation",text:`mutation ProjectActionMenuClearMutation(
  $input: ClearProjectInput!
) {
  clearProject(input: $input) {
    __typename
  }
}
`}}}();Mc.hash="c43eec4d6b882468c611dd9ebf3b095e";const Vc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"projectId"}],a=[{alias:null,args:[{kind:"Variable",name:"id",variableName:"projectId"}],concreteType:"Query",kind:"LinkedField",name:"deleteProject",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectActionMenuDeleteMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectActionMenuDeleteMutation",selections:a},params:{cacheID:"8b00ab3aaef4c5fb3de24f7295d38499",id:null,metadata:{},name:"ProjectActionMenuDeleteMutation",operationKind:"mutation",text:`mutation ProjectActionMenuDeleteMutation(
  $projectId: GlobalID!
) {
  deleteProject(id: $projectId) {
    __typename
  }
}
`}}}();Vc.hash="3bf82e90b3f2d3485b4efb954e30b2cf";const Rc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"Query",kind:"LinkedField",name:"clearProject",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"RemoveProjectDataFormMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"RemoveProjectDataFormMutation",selections:a},params:{cacheID:"1b27a3f7535c3f3943b0f2248d1505a6",id:null,metadata:{},name:"RemoveProjectDataFormMutation",operationKind:"mutation",text:`mutation RemoveProjectDataFormMutation(
  $input: ClearProjectInput!
) {
  clearProject(input: $input) {
    __typename
  }
}
`}}}();Rc.hash="212501fe2d6367ec1503bd7a00c1730f";function lS(n){const{projectId:a}=n,t=u.useRef(null),[l,i]=I.useMutation(Rc),{control:r,handleSubmit:o,setError:d,formState:{isValid:c}}=Ae({defaultValues:{endDate:km(new Date(Date.now()-kg).toISOString())}}),p=u.useCallback(y=>{const m=y.endDate.toDate(Sl());if(!bm(m))return d("endDate",{message:"Date is not in a valid format"});l({variables:{input:{id:a,endTime:new Date(m).toISOString()}},onCompleted:()=>{n.onComplete()},onError:g=>{alert("Failed to clear project traces: "+g)}})},[l,a,n,d]);return s("form",{onSubmit:o(p),ref:t,children:[s(C,{padding:"size-200",children:[e(v,{color:"danger",children:" This will remove all data before the following date. This cannot be undone."}),e(H,{name:"endDate",control:r,rules:{required:"field is required"},render:({field:{name:y,onChange:m,onBlur:g,value:f},fieldState:{invalid:k,error:b}})=>s(bg,{isInvalid:k,onChange:m,name:y,onBlur:g,value:f,granularity:"second",hideTimeZone:!0,css:K`
                .react-aria-DateInput {
                  width: 100%;
                }
              `,children:[e(G,{children:"End Date"}),e(Sm,{children:S=>e(vm,{segment:S})}),b?e(ve,{children:b.message}):e(v,{slot:"description",children:"The date up to which you want to remove data"})]})})]}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",children:e(A,{type:"submit",variant:"danger",isDisabled:!c||i,size:"S",leadingVisual:i?e(L,{svg:e(je,{})}):void 0,onPress:()=>{var y;(y=t.current)==null||y.requestSubmit()},children:i?"Removing...":"Remove Data"})})})]})}function iS({projectId:n,projectName:a,onProjectDelete:t,onProjectClear:l,onProjectRemoveData:i}){const[r,o]=u.useState(null),d=a!=="default",[c]=I.useMutation(Vc),[p]=I.useMutation(Mc),y=u.useCallback(()=>{u.startTransition(()=>{c({variables:{projectId:n}}),t()})},[c,n,t]),m=u.useCallback(()=>{u.startTransition(()=>{p({variables:{input:{id:n}},onCompleted:()=>{l()},onError:b=>{alert("Failed to clear project: "+b)}})})},[p,n,l]),g=u.useCallback(()=>{o(s(Z,{size:"S",title:"Delete Project",children:[e(C,{padding:"size-200",children:e(v,{color:"danger",children:`Are you sure you want to delete project ${a}? This cannot be undone.`})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",children:e(A,{variant:"danger",onPress:()=>{y(),o(null)},children:"Delete Project"})})})]}))},[y,a]),f=u.useCallback(()=>{o(s(Z,{size:"S",title:"Clear Project",children:[e(C,{padding:"size-200",children:e(v,{color:"danger",children:`Are you sure you want to clear project ${a}? All traces and evaluations for this project will be deleted. This cannot be undone.`})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",children:e(A,{variant:"danger",onPress:()=>{m(),o(null)},children:"Clear"})})})]}))},[m,a]),k=u.useCallback(()=>{o(e(Z,{size:"S",title:"Remove Data",children:e(lS,{projectId:n,onComplete:()=>{i(),o(null)}})}))},[i,n]);return s("div",{onClick:b=>{b.preventDefault(),b.stopPropagation()},children:[s(wn,{buttonVariant:"quiet",buttonSize:"compact",align:"end",onAction:b=>{switch(b){case"deleteProject":return g();case"clearProject":return f();case"removeProjectData":return k()}},disabledKeys:d?[]:["deleteProject"],children:[e(re,{textValue:"Clear Traces",children:s(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(L,{svg:e(qr,{})}),e(v,{children:"Clear Data"})]})},"clearProject"),e(re,{textValue:"Remove Data",children:s(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(L,{svg:e(At,{})}),e(v,{children:"Remove Data"})]})},"removeProjectData"),d?e(re,{children:s(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(L,{svg:e(We,{})}),e(v,{children:"Delete"})]})},"deleteProject"):null]}),e(X,{type:"modal",isDismissable:!0,onDismiss:()=>o(null),children:r})]})}function rS(){const n=Ge(t=>t.projectsAutoRefreshEnabled),a=Ge(t=>t.setProjectAutoRefreshEnabled);return e(ya,{labelPlacement:"start",isSelected:n,onChange:()=>{a(!n)},children:"Auto-Refresh"})}const sS=1e4,oS=50;function N2(){const{timeRange:n}=Rt();return e(u.Suspense,{fallback:e(ge,{}),children:e(dS,{timeRange:n})})}function dS({timeRange:n}){const a=Ge(F=>F.projectsAutoRefreshEnabled),[t,l]=xm(),i=u.useMemo(()=>{var F,P;return{start:(F=n==null?void 0:n.start)==null?void 0:F.toISOString(),end:(P=n==null?void 0:n.end)==null?void 0:P.toISOString()}},[n]),r=I.useLazyLoadQuery(Ec,{timeRange:i}),{data:o,loadNext:d,hasNext:c,isLoadingNext:p,refetch:y}=I.usePaginationFragment(wc,r),m=o.projects.edges.map(F=>F.project),g=u.useRef(null),f=u.useCallback(F=>{if(F){const{scrollHeight:P,scrollTop:D,clientHeight:w}=F;P-D-w<300&&!p&&c&&d(oS)}},[c,p,d]);Yd(()=>{u.startTransition(()=>{y({},{fetchPolicy:"store-and-network"})})},a?sS:null);const k=u.useCallback(F=>{u.startTransition(()=>{y({},{fetchPolicy:"store-and-network"}),t({variant:"success",title:"Project Deleted",message:`Project ${F} has been deleted.`})})},[t,y]),b=u.useCallback(F=>{u.startTransition(()=>{y({},{fetchPolicy:"store-and-network"}),t({variant:"success",title:"Project Cleared",message:`Project ${F} has been cleared of traces.`})})},[t,y]),S=u.useCallback(F=>{u.startTransition(()=>{y({},{fetchPolicy:"store-and-network"}),t({variant:"success",title:"Project Data Removed",message:`Old data from project ${F} have been removed.`})})},[t,y]);return s("div",{css:K`
        flex: 1 1 auto;
        overflow-y: auto;
        overflow-x: hidden;
        padding-bottom: var(--ac-global-dimension-size-750);
      `,onScroll:F=>f(F.target),ref:g,children:[e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",width:"100%",borderBottomColor:"grey-200",borderBottomWidth:"thin",children:s(h,{direction:"row",justifyContent:"end",alignItems:"center",gap:"size-100",children:[e(rS,{}),e(aS,{}),e(zr,{})]})}),e(C,{padding:"size-200",width:"100%",children:e("ul",{css:K`
            display: flex;
            flex-direction: row;
            gap: var(--ac-global-dimension-size-200);
            flex-wrap: wrap;
          `,children:m.map(F=>e("li",{children:e(Oe,{to:`/projects/${F.id}`,css:K`
                  text-decoration: none;
                `,children:e(uS,{project:F,onProjectDelete:()=>k(F.name),onProjectClear:()=>b(F.name),onProjectRemoveData:()=>S(F.name)})})},F.id))})}),l]})}function cS({gradientStartColor:n,gradientEndColor:a}){return e("div",{css:K`
        border-radius: 50%;
        width: 32px;
        height: 32px;
        background: linear-gradient(
          136.27deg,
          ${n} 14.03%,
          ${a} 84.38%
        );
        flex-shrink: 0;
      `})}function uS({project:n,onProjectDelete:a,onProjectClear:t,onProjectRemoveData:l}){const{endTime:i,traceCount:r,tokenCountTotal:o,latencyMsP50:d,gradientStartColor:c,gradientEndColor:p}=n,y=u.useMemo(()=>i?`Last updated  ${Cm(new Date(i),new Date,{addSuffix:!0})}`:"No traces uploaded yet.",[i]);return s("div",{css:K`
        padding: var(--ac-global-dimension-size-200);
        border: 1px solid var(--ac-global-color-grey-400);
        background-color: var(--ac-global-color-grey-100);
        border-radius: var(--ac-global-rounding-medium);
        width: var(--ac-global-dimension-size-3600);
        transition: border-color 0.2s;
        &:hover {
          border-color: var(--ac-global-color-primary);
        }
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        gap: var(--ac-global-dimension-size-200);
      `,children:[s(h,{direction:"row",justifyContent:"space-between",alignItems:"start",children:[s(h,{direction:"row",gap:"size-100",alignItems:"center",minWidth:0,children:[e(cS,{gradientStartColor:c,gradientEndColor:p}),s(h,{direction:"column",minWidth:0,children:[e(te,{level:2,css:K`
                overflow: hidden;
                white-space: nowrap;
                text-overflow: ellipsis;
              `,children:n.name}),e(v,{color:"text-700",size:"XS",fontStyle:"italic",children:y})]})]}),e(iS,{projectId:n.id,projectName:n.name,onProjectDelete:a,onProjectClear:t,onProjectRemoveData:l})]}),s(h,{direction:"row",justifyContent:"space-between",children:[s(h,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Total Traces"}),e(v,{size:"L",children:ua(r)})]}),s(h,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Total Tokens"}),e(v,{size:"L",children:ua(o)})]}),s(h,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Latency P50"}),d!=null?e(Ve,{latencyMs:d,size:"L"}):e(v,{size:"L",children:"--"})]})]})]})}const Ac=function(){var n=[{kind:"Literal",name:"first",value:100},{kind:"Literal",name:"sort",value:{col:"createdAt",dir:"desc"}}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DatasetsPageQuery",selections:[{args:null,kind:"FragmentSpread",name:"DatasetsTable_datasets"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"DatasetsPageQuery",selections:[{alias:null,args:n,concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"exampleCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:'datasets(first:100,sort:{"col":"createdAt","dir":"desc"})'},{alias:null,args:n,filters:["sort"],handle:"connection",key:"DatasetsTable_datasets",kind:"LinkedHandle",name:"datasets"}]},params:{cacheID:"695b221e981c4795492d79faa7d007e4",id:null,metadata:{},name:"DatasetsPageQuery",operationKind:"query",text:`query DatasetsPageQuery {
  ...DatasetsTable_datasets
}

fragment DatasetsTable_datasets on Query {
  datasets(first: 100, sort: {col: createdAt, dir: desc}) {
    edges {
      node {
        id
        name
        description
        metadata
        createdAt
        exampleCount
        experimentCount
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();Ac.hash="985853a7939f44c0cefdd1a91472c67e";function mS(n){const a=n.split(`
`);return a.length>0?a[0].split(",").map(t=>t.trim()):[]}function pS(n){const{onDatasetCreated:a,onDatasetCreateError:t}=n,[l,i]=u.useState([]),{control:r,handleSubmit:o,resetField:d,formState:{isDirty:c,isValid:p}}=Ae({defaultValues:{name:"Dataset "+new Date().toISOString(),input_keys:[],output_keys:[],metadata_keys:[],description:"",metadata:{}}}),y=u.useCallback(m=>{const g=new FormData;return g.append("file",m.file[0]),g.append("name",m.name),g.append("description",m.description),g.append("metadata",JSON.stringify(m.metadata)),m.input_keys.forEach(f=>{g.append("input_keys[]",f)}),m.output_keys.forEach(f=>{g.append("output_keys[]",f)}),m.metadata_keys.forEach(f=>{g.append("metadata_keys[]",f)}),fetch(mn("/v1/datasets/upload?sync=true"),{method:"POST",body:g}).then(f=>{if(!f.ok)throw t(new Error(f.statusText||"Failed to create dataset"));return f.json()}).then(f=>{a({name:m.name,id:f.data.dataset_id})})},[t,a]);return s(Ye,{onSubmit:o(y),children:[s("div",{css:K`
          padding: var(--ac-global-dimension-size-200);
          .ac-dropdown-button {
            width: 100%;
          }
        `,children:[e(H,{name:"name",control:r,rules:{required:"field is required"},render:({field:{onChange:m,onBlur:g,value:f},fieldState:{invalid:k,error:b}})=>s(J,{isInvalid:k,onChange:m,onBlur:g,value:f.toString(),children:[e(G,{children:"Dataset Name"}),e(ne,{placeholder:"e.x. Golden Dataset"}),b!=null&&b.message?e(ve,{children:b.message}):e(v,{slot:"description",children:"The name of the dataset"})]})}),e(H,{name:"description",control:r,render:({field:{onChange:m,onBlur:g,value:f},fieldState:{invalid:k,error:b}})=>s(J,{isInvalid:k,onChange:m,onBlur:g,value:f.toString(),children:[e(G,{children:"Description"}),e(pa,{placeholder:"e.x. A dataset for structured data extraction"}),b!=null&&b.message?e(ve,{children:b.message}):e(v,{slot:"description",children:"The description of the dataset"})]})}),e(H,{control:r,name:"file",rules:{required:"CSV file is required"},render:({field:{value:m,onChange:g,...f},fieldState:{invalid:k,error:b}})=>e(Yn,{label:"CSV file",validationState:k?"invalid":"valid",errorMessage:b==null?void 0:b.message,children:e("input",{...f,onChange:S=>{var P;g(S.target.files),d("input_keys"),d("output_keys"),d("metadata_keys");const F=(P=S.target.files)==null?void 0:P[0];if(F){const D=new FileReader;D.onload=function(w){if(!w.target)return;const T=w.target.result,x=mS(T);i(x)},D.readAsText(F)}},type:"file",id:"file",accept:".csv"})})}),e(H,{name:"input_keys",control:r,rules:{required:"field is required"},render:({field:{value:m,onChange:g},fieldState:{invalid:f,error:k}})=>e(sl,{label:"input keys",validationState:f?"invalid":"valid",description:"the columns to use as input",columns:l,selectedColumns:m,onChange:g,errorMessage:k==null?void 0:k.message})}),e(H,{name:"output_keys",control:r,render:({field:{value:m,onChange:g},fieldState:{invalid:f,error:k}})=>e(sl,{label:"output keys",validationState:f?"invalid":"valid",description:"the columns to use as output",columns:l,selectedColumns:m,onChange:g,errorMessage:k==null?void 0:k.message})}),e(H,{name:"metadata_keys",control:r,render:({field:{value:m,onChange:g},fieldState:{invalid:f,error:k}})=>e(sl,{label:"metadata keys",validationState:f?"invalid":"valid",description:"the columns to use as metadata",columns:l,selectedColumns:m,onChange:g,errorMessage:k==null?void 0:k.message})})]}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",children:e(A,{type:"submit",isDisabled:!p,variant:c?"primary":"default",size:"S",children:"Create Dataset"})})})]})}function sl(n){const{columns:a,selectedColumns:t,onChange:l,label:i,validationState:r,description:o,errorMessage:d,...c}=n,p=a.length===0,y=u.useMemo(()=>p?"No columns to select":t.length>0?`${t.join(", ")}`:"No columns selected",[t,p]);return e(Yn,{label:i,isDisabled:p,validationState:r,description:o,errorMessage:d,children:e(Tl,{isDisabled:p,...c,menu:e(vt,{selectionMode:"multiple",onSelectionChange:m=>{l(Array.from(m))},selectedKeys:new Set(t),children:a.map(m=>e(re,{children:m},m))}),triggerProps:{placement:"bottom end"},children:y})})}const Nc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:{col:"createdAt",dir:"desc"},kind:"LocalArgument",name:"sort"}],a=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"},{kind:"Variable",name:"sort",variableName:"sort"}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DatasetsTableDatasetsQuery",selections:[{args:a,kind:"FragmentSpread",name:"DatasetsTable_datasets"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DatasetsTableDatasetsQuery",selections:[{alias:null,args:a,concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"exampleCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:a,filters:["sort"],handle:"connection",key:"DatasetsTable_datasets",kind:"LinkedHandle",name:"datasets"}]},params:{cacheID:"5ac1688f54e51f9bb3247c83e23d98fb",id:null,metadata:{},name:"DatasetsTableDatasetsQuery",operationKind:"query",text:`query DatasetsTableDatasetsQuery(
  $after: String = null
  $first: Int = 100
  $sort: DatasetSort = {col: createdAt, dir: desc}
) {
  ...DatasetsTable_datasets_dWkdd
}

fragment DatasetsTable_datasets_dWkdd on Query {
  datasets(first: $first, after: $after, sort: $sort) {
    edges {
      node {
        id
        name
        description
        metadata
        createdAt
        exampleCount
        experimentCount
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();Nc.hash="fa378bc7ec26f5e877e6cf90e5ee553d";const zc=function(){var n=["datasets"];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:{col:"createdAt",dir:"desc"},kind:"LocalArgument",name:"sort"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:[],operation:Nc}},name:"DatasetsTable_datasets",selections:[{alias:"datasets",args:[{kind:"Variable",name:"sort",variableName:"sort"}],concreteType:"DatasetConnection",kind:"LinkedField",name:"__DatasetsTable_datasets_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"exampleCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null}}();zc.hash="fa378bc7ec26f5e877e6cf90e5ee553d";const $c=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"datasetId"}],a=[{alias:null,args:[{fields:[{kind:"Variable",name:"datasetId",variableName:"datasetId"}],kind:"ObjectValue",name:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"deleteDataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DeleteDatasetDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DeleteDatasetDialogMutation",selections:a},params:{cacheID:"3d32b97acd630dd7dbc9c85a632a1d49",id:null,metadata:{},name:"DeleteDatasetDialogMutation",operationKind:"mutation",text:`mutation DeleteDatasetDialogMutation(
  $datasetId: GlobalID!
) {
  deleteDataset(input: {datasetId: $datasetId}) {
    __typename
  }
}
`}}}();$c.hash="7066cca7015a7e344b77862b0bdab21c";function gS({datasetId:n,datasetName:a,onDatasetDelete:t,onDatasetDeleteError:l}){const[i,r]=I.useMutation($c),o=u.useCallback(()=>{u.startTransition(()=>{i({variables:{datasetId:n},onCompleted:()=>{t()},onError:d=>{l(d)}})})},[i,n,t,l]);return s(Z,{size:"S",title:"Delete Dataset",children:[e(C,{padding:"size-200",children:e(v,{color:"danger",children:`Are you sure you want to delete dataset ${a}? This will also delete all associated experiments and traces, and it cannot be undone.`})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",children:e(A,{variant:"danger",onPress:()=>{o()},isDisabled:r,leadingVisual:e(L,{svg:r?e(je,{}):e(We,{})}),children:"Delete Dataset"})})})]})}function yS({datasetName:n,datasetId:a,datasetDescription:t,datasetMetadata:l,onDatasetEdited:i,onDatasetEditError:r}){return e(Z,{title:"Edit Dataset",size:"M",children:e(Sg,{datasetName:n,datasetId:a,datasetDescription:t,datasetMetadata:l,onDatasetEdited:i,onDatasetEditError:r})})}function fS(n){const{datasetId:a,datasetName:t,datasetDescription:l,datasetMetadata:i,onDatasetDelete:r,onDatasetDeleteError:o,onDatasetEdit:d,onDatasetEditError:c}=n,[p,y]=u.useState(null),m=u.useCallback(()=>{y(e(gS,{datasetId:a,datasetName:t,onDatasetDelete:()=>{r(),y(null)},onDatasetDeleteError:o}))},[a,t,r,o]),g=u.useCallback(()=>{y(e(yS,{datasetId:a,datasetName:t,datasetDescription:l,datasetMetadata:i,onDatasetEdited:()=>{d(),y(null)},onDatasetEditError:c}))},[l,a,i,t,d,c]);return s("div",{onClick:f=>{f.preventDefault(),f.stopPropagation()},children:[s(wn,{align:"end",buttonSize:"compact",onAction:f=>{switch(f){case"deleteDataset":m();break;case"editDataset":g();break}},children:[e(re,{children:s(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(L,{svg:e(We,{})}),e(v,{children:"Delete"})]})},"deleteDataset"),e(re,{children:s(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(L,{svg:e(Ll,{})}),e(v,{children:"Edit"})]})},"editDataset")]}),e(X,{type:"modal",isDismissable:!0,onDismiss:()=>y(null),children:p})]})}const Gi=100;function hS(n){const a=n.id;if(a!=="createdAt"&&a!=="name")throw new Error("Invalid sort column");return{col:a,dir:n.desc?"desc":"asc"}}function kS(n){const[a,t]=u.useState([]),l=u.useRef(null),i=le(),r=ke(),o=Fe(),{data:d,loadNext:c,hasNext:p,isLoadingNext:y,refetch:m}=I.usePaginationFragment(zc,n.query),g=u.useMemo(()=>d.datasets.edges.map(F=>F.node),[d]),f=Ke.useCallback(F=>{if(F){const{scrollHeight:P,scrollTop:D,clientHeight:w}=F;P-D-w<300&&!y&&p&&c(Gi)}},[p,y,c]),k=Te({columns:[{header:"name",accessorKey:"name",cell:({row:F})=>{const D=F.original.experimentCount>0?`${F.original.id}/experiments`:`${F.original.id}/examples`;return e(Oe,{to:D,children:F.original.name})}},{header:"description",accessorKey:"description",enableSorting:!1},{header:"created at",accessorKey:"createdAt",cell:Me},{header:"example count",accessorKey:"exampleCount",enableSorting:!1,meta:{textAlign:"right"}},{header:"experiment count",accessorKey:"experimentCount",enableSorting:!1,meta:{textAlign:"right"}},{header:"metadata",accessorKey:"metadata",enableSorting:!1,cell:Ta},{header:"",id:"actions",enableSorting:!1,size:10,cell:({row:F})=>e(fS,{datasetId:F.original.id,datasetName:F.original.name,datasetDescription:F.original.description,datasetMetadata:F.original.metadata,onDatasetEdit:()=>{r({title:"Dataset updated",message:`${F.original.name} has been successfully updated.`}),m({},{fetchPolicy:"store-and-network"})},onDatasetEditError:P=>{const D=Ce(P);o({title:"Dataset update failed",message:(D==null?void 0:D[0])??P.message})},onDatasetDelete:()=>{r({title:"Dataset deleted",message:`${F.original.name} has been successfully deleted.`}),m({},{fetchPolicy:"store-and-network"})},onDatasetDeleteError:P=>{const D=Ce(P);o({title:"Dataset deletion failed",message:(D==null?void 0:D[0])??P.message})}})}],data:g,state:{sorting:a},getCoreRowModel:Pe(),getSortedRowModel:hn(),onSortingChange:t,manualSorting:!0});u.useEffect(()=>{const F=a[0];u.startTransition(()=>{m({sort:F?hS(F):{col:"createdAt",dir:"desc"},after:null,first:Gi},{fetchPolicy:"store-and-network"})})},[a,m]);const b=k.getRowModel().rows,S=b.length===0;return e("div",{css:K`
        flex: 1 1 auto;
        overflow: auto;
      `,onScroll:F=>f(F.target),ref:l,children:s("table",{css:ea,children:[e("thead",{children:k.getHeaderGroups().map(F=>e("tr",{children:F.headers.map(P=>{var D;return e("th",{colSpan:P.colSpan,children:P.isPlaceholder?null:s("div",{className:P.column.getCanSort()?"cursor-pointer":"",onClick:P.column.getToggleSortingHandler(),style:{textAlign:(D=P.column.columnDef.meta)==null?void 0:D.textAlign},children:[W(P.column.columnDef.header,P.getContext()),P.column.getIsSorted()?e(L,{className:"sort-icon",svg:P.column.getIsSorted()==="asc"?e(sn,{}):e(rn,{})}):null]})},P.id)})},F.id))}),S?e(ln,{}):e("tbody",{children:b.map(F=>e("tr",{onClick:()=>{const D=F.original.experimentCount>0?`${F.original.id}/experiments`:`${F.original.id}/examples`;i(D)},children:F.getVisibleCells().map(P=>{var D;return e("td",{align:(D=P.column.columnDef.meta)==null?void 0:D.textAlign,children:W(P.column.columnDef.cell,P.getContext())},P.id)})},F.id))})]})})}function z2(){return e(u.Suspense,{fallback:e(ge,{}),children:e(bS,{})})}function bS(){const[n,a]=u.useState(0),t=I.useLazyLoadQuery(Ac,{},{fetchKey:n,fetchPolicy:"store-and-network"}),l=u.useCallback(()=>{a(i=>i+1)},[a]);return s(h,{direction:"column",height:"100%",children:[e(C,{padding:"size-200",borderBottomWidth:"thin",borderBottomColor:"dark",flex:"none",children:s(h,{direction:"row",justifyContent:"space-between",children:[e(te,{level:1,children:"Datasets"}),e(SS,{onDatasetCreated:l})]})}),e(kS,{query:t})]})}function SS({onDatasetCreated:n}){const a=le(),t=ke(),l=Fe(),[i,r]=u.useState(null),o=()=>{r(e(Z,{size:"S",title:"New Dataset",children:e(jr,{onDatasetCreated:c=>{t({title:"Dataset created",message:`${c.name} has been successfully created.`,action:{text:"Go to Dataset",onClick:()=>{a(`/datasets/${c.id}`)}}}),r(null),n()},onDatasetCreateError:c=>{const p=Ce(c);l({title:"Dataset creation failed",message:(p==null?void 0:p[0])??c.message})}})}))},d=()=>{r(e(Z,{size:"M",title:"New Dataset from CSV",children:e(pS,{onDatasetCreated:c=>{t({title:"Dataset created",message:`${c.name} has been successfully created.`,action:{text:"Go to Dataset",onClick:()=>{a(`/datasets/${c.id}`)}}}),r(null),n()},onDatasetCreateError:c=>{const p=Ce(c);l({title:"Dataset creation failed",message:(p==null?void 0:p[0])??c.message})}})}))};return s(U,{children:[s(wn,{buttonText:"Create Dataset",align:"end",icon:e(L,{svg:e(Ct,{})}),onAction:c=>{switch(c){case"newDataset":o();break;case"datasetFromCSV":d();break}},children:[e(re,{children:"New Dataset"},"newDataset"),e(re,{children:"Dataset from CSV"},"datasetFromCSV")]}),e(X,{type:"modal",isDismissable:!0,onDismiss:()=>r(null),children:i})]})}const Oc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"datasetId"}],a=[{kind:"Variable",name:"id",variableName:"datasetId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={kind:"InlineFragment",selections:[{alias:"latestVersions",args:[{kind:"Literal",name:"first",value:1},{kind:"Literal",name:"sort",value:{col:"createdAt",dir:"desc"}}],concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"versions",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:'versions(first:1,sort:{"col":"createdAt","dir":"desc"})'}],type:"Dataset",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"datasetStore_latestVersionQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,l],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"datasetStore_latestVersionQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,l],storageKey:null}]},params:{cacheID:"d7075240e4dae8871997e57616c05302",id:null,metadata:{},name:"datasetStore_latestVersionQuery",operationKind:"query",text:`query datasetStore_latestVersionQuery(
  $datasetId: GlobalID!
) {
  dataset: node(id: $datasetId) {
    __typename
    id
    ... on Dataset {
      latestVersions: versions(first: 1, sort: {col: createdAt, dir: desc}) {
        edges {
          version: node {
            id
            description
            createdAt
          }
        }
      }
    }
  }
}
`}}}();Oc.hash="a1349b92d8b0c745f5e8039c55b048c7";const vS=n=>{const a=(t,l)=>({...n,isRefreshingLatestVersion:!1,refreshLatestVersion:async()=>{const i=l();t({isRefreshingLatestVersion:!0});const r=await CS({datasetId:i.datasetId});t({latestVersion:r,isRefreshingLatestVersion:!1})}});return ar()(Fm(a))};async function CS({datasetId:n}){var i;const a=await I.fetchQuery(he,Oc,{datasetId:n}).toPromise(),t=(i=a==null?void 0:a.dataset.latestVersions)==null?void 0:i.edges;return t&&t.length&&t[0].version||null}const Qc=u.createContext(null);function FS({children:n,...a}){const[t]=u.useState(()=>vS(a));return e(Qc.Provider,{value:t,children:n})}function ma(n,a){const t=u.useContext(Qc);if(!t)throw new Error("Missing DatasetContext.Provider in the tree");return Ya(t,n,a)}const jc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"addExamplesToDataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"AddDatasetExampleDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"AddDatasetExampleDialogMutation",selections:a},params:{cacheID:"718cf02ccb39b279132822bf503e51e6",id:null,metadata:{},name:"AddDatasetExampleDialogMutation",operationKind:"mutation",text:`mutation AddDatasetExampleDialogMutation(
  $input: AddExamplesToDatasetInput!
) {
  addExamplesToDataset(input: $input) {
    __typename
  }
}
`}}}();jc.hash="8d99470f590cd5d28701fa6e3c0330e6";const ol={backgroundColor:"light",borderColor:"light",collapsible:!0,bodyStyle:{padding:0}};function KS(n){const{datasetId:a,onCompleted:t}=n,[l,i]=u.useState(null),[r,o]=I.useMutation(jc),{control:d,setError:c,handleSubmit:p,formState:{isValid:y}}=Ae({defaultValues:{input:"{}",output:"{}",metadata:"{}"}}),m=u.useCallback(g=>{if(i(null),!Fn(g==null?void 0:g.input))return c("input",{message:"Input must be a valid JSON object"});if(!Fn(g==null?void 0:g.output))return c("output",{message:"Output must be a valid JSON object"});if(!Fn(g==null?void 0:g.metadata))return c("metadata",{message:"Metadata must be a valid JSON object"});r({variables:{input:{datasetId:a,examples:[{input:JSON.parse(g.input),output:JSON.parse(g.output),metadata:JSON.parse(g.metadata)}],datasetVersionDescription:g.description}},onCompleted:()=>{t()},onError:f=>{const k=Ce(f);i((k==null?void 0:k[0])??f.message)}})},[r,a,c,t]);return s(Z,{size:"L",title:"Add Example",children:[e("div",{css:K`
          overflow-y: auto;
          padding: var(--ac-global-dimension-size-400);
        `,children:e(h,{direction:"row",justifyContent:"center",children:e(C,{width:"900px",paddingStart:"auto",paddingEnd:"auto",children:s(h,{direction:"column",gap:"size-200",children:[l?e(pe,{variant:"danger",children:l}):null,e(H,{control:d,name:"input",render:({field:{onChange:g,onBlur:f,value:k},fieldState:{invalid:b,error:S}})=>s(Q,{title:"Input",subTitle:"The input to the LLM, retriever, program, etc.",...ol,children:[b?e(pe,{variant:"danger",banner:!0,children:S==null?void 0:S.message}):null,e(Qe,{value:k,onChange:g,onBlur:f})]})}),e(H,{control:d,name:"output",render:({field:{onChange:g,onBlur:f,value:k},fieldState:{invalid:b,error:S}})=>s(Q,{title:"Output",subTitle:"The output of the LLM or program to be used as an expected output",...ol,backgroundColor:"green-100",borderColor:"green-700",children:[b?e(pe,{variant:"danger",banner:!0,children:S==null?void 0:S.message}):null,e(Qe,{value:k,onChange:g,onBlur:f})]})}),e(H,{control:d,name:"metadata",render:({field:{onChange:g,onBlur:f,value:k},fieldState:{invalid:b,error:S}})=>s(Q,{title:"Metadata",subTitle:"All data from the span to use during experimentation or evaluation",...ol,children:[b?e(pe,{variant:"danger",banner:!0,children:S==null?void 0:S.message}):null,e(Qe,{value:k,onChange:g,onBlur:f})]})}),e(H,{control:d,name:"description",render:({field:{onChange:g,onBlur:f,value:k},fieldState:{invalid:b,error:S}})=>s(J,{value:k,onChange:g,onBlur:f,isInvalid:b,children:[e(G,{children:"Version Description"}),e(pa,{}),S?e(ve,{children:S.message}):e(v,{slot:"description",children:"A description of the changes made. Will be displayed in the version history."})]})})]})})})}),e(C,{padding:"size-200",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",gap:"size-100",children:e(A,{variant:"primary",size:"S",isDisabled:!y||o,leadingVisual:o?e(L,{svg:e(je,{})}):null,onPress:()=>p(m)(),children:o?"Adding Example...":"Add Example"})})})]})}function TS(n){const{datasetId:a,onAddExampleCompleted:t}=n,[l,i]=u.useState(null),r=u.useCallback(()=>{i(e(KS,{datasetId:a,onCompleted:()=>{t(),i(null)}}))},[a,t]);return s(U,{children:[e(A,{leadingVisual:e(L,{svg:e(kn,{})}),size:"S",onPress:r,children:"Add Example"}),e(X,{isDismissable:!0,onDismiss:()=>{i(null)},children:l})]})}function PS(){const n=ma(i=>i.datasetId),a=ma(i=>i.latestVersion);let t=`${pl}/v1/datasets/${n}/examples`;a&&(t+=`?version-id=${a.id}`);const l=u.useMemo(()=>`import phoenix as px
client = px.Client()
# Get the current dataset version
dataset = client.get_dataset(id="${n}"${a?`, version_id="${a.id}"`:""})`,[n,a]);return e("div",{css:K`
        button.ac-dropdown-button {
          min-width: 80px;
          .ac-dropdown-button__text {
            padding-right: 10px;
          }
        }
      `,children:s(ga,{placement:"bottom right",children:[e(vl,{addonBefore:e(L,{svg:e(Ft,{})}),children:"Code"}),e(kt,{children:s("section",{css:K`
              width: 500px;
              .ac-field {
                flex: 1 1 auto;
              }
            `,children:[e(C,{padding:"size-200",children:s(Ye,{children:[s(h,{direction:"row",gap:"size-100",alignItems:"end",width:"100%",children:[s(J,{isReadOnly:!0,value:n,children:[e(G,{children:"Dataset ID"}),e(ne,{})]}),e(ie,{text:n,size:"M"})]}),s(h,{direction:"row",gap:"size-100",alignItems:"end",children:[s(J,{isReadOnly:!0,value:(a==null?void 0:a.id)||"No Versions",isInvalid:!a,children:[e(G,{children:"Version ID"}),e(ne,{})]}),e(ie,{text:(a==null?void 0:a.id)||"No Versions",isDisabled:!a,size:"M"})]})]})}),s(He,{children:[e(ae,{name:"Python",children:e(C,{margin:"size-200",borderColor:"light",borderWidth:"thin",borderRadius:"small",children:e(cn,{value:l})})}),e(ae,{name:"REST",children:e(C,{padding:"size-200",children:e(Ye,{children:s(h,{direction:"row",gap:"size-100",alignItems:"end",children:[s(J,{isReadOnly:!0,value:t,children:[e(G,{children:"URL"}),e(ne,{})]}),e(ie,{text:t,size:"M"})]})})})})]})]})})]})})}const qc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"datasetId"}],a=[{kind:"Variable",name:"id",variableName:"datasetId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i=[{kind:"Literal",name:"first",value:100}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DatasetHistoryDialogQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[t,{args:null,kind:"FragmentSpread",name:"DatasetHistoryTable_versions"}],type:"Dataset",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DatasetHistoryDialogQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"TypeDiscriminator",abstractKey:"__isNode"},t,{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"versions",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},l],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"versions(first:100)"},{alias:null,args:i,filters:null,handle:"connection",key:"DatasetHistoryTable_versions",kind:"LinkedHandle",name:"versions"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"df94b4e72c0187fd0fd1c8416af19354",id:null,metadata:{},name:"DatasetHistoryDialogQuery",operationKind:"query",text:`query DatasetHistoryDialogQuery(
  $datasetId: GlobalID!
) {
  dataset: node(id: $datasetId) {
    __typename
    ... on Dataset {
      id
      ...DatasetHistoryTable_versions
    }
    __isNode: __typename
    id
  }
}

fragment DatasetHistoryTable_versions on Dataset {
  versions(first: 100) {
    edges {
      node {
        id
        description
        createdAt
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();qc.hash="7215c18bda690418c5ecbcb3131a288e";const Bc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DatasetHistoryTableVersionsQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:t,kind:"FragmentSpread",name:"DatasetHistoryTable_versions"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DatasetHistoryTableVersionsQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"TypeDiscriminator",abstractKey:"__isNode"},i,{kind:"InlineFragment",selections:[{alias:null,args:t,concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"versions",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},l],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:t,filters:null,handle:"connection",key:"DatasetHistoryTable_versions",kind:"LinkedHandle",name:"versions"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"e8e3a05b4e86c8eaeea98172405fdc7e",id:null,metadata:{},name:"DatasetHistoryTableVersionsQuery",operationKind:"query",text:`query DatasetHistoryTableVersionsQuery(
  $after: String = null
  $first: Int = 100
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...DatasetHistoryTable_versions_2HEEH6
    __isNode: __typename
    id
  }
}

fragment DatasetHistoryTable_versions_2HEEH6 on Dataset {
  versions(first: $first, after: $after) {
    edges {
      node {
        id
        description
        createdAt
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Bc.hash="37e453bc58759a1e89bc5862c460de6b";const Uc=function(){var n=["versions"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:Bc,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"DatasetHistoryTable_versions",selections:[{alias:"versions",args:null,concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"__DatasetHistoryTable_versions_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"Dataset",abstractKey:null}}();Uc.hash="37e453bc58759a1e89bc5862c460de6b";const IS=100;function xS(n){const a=u.useRef(null),{data:t,loadNext:l,hasNext:i,isLoadingNext:r}=I.usePaginationFragment(Uc,n.dataset),o=u.useMemo(()=>t.versions.edges.map(m=>m.node),[t]),d=Ke.useCallback(m=>{if(m){const{scrollHeight:g,scrollTop:f,clientHeight:k}=m;g-f-k<300&&!r&&i&&l(IS)}},[i,r,l]),c=Te({columns:[{header:"version ID",accessorKey:"id"},{header:"description",accessorKey:"description"},{header:"created at",accessorKey:"createdAt",cell:Me}],data:o,getCoreRowModel:Pe(),getSortedRowModel:hn()}),p=c.getRowModel().rows,y=p.length===0;return e("div",{css:K`
        flex: 1 1 auto;
        overflow: auto;
      `,onScroll:m=>d(m.target),ref:a,children:s("table",{css:tn,children:[e("thead",{children:c.getHeaderGroups().map(m=>e("tr",{children:m.headers.map(g=>e("th",{colSpan:g.colSpan,children:g.isPlaceholder?null:s("div",{className:g.column.getCanSort()?"cursor-pointer":"",onClick:g.column.getToggleSortingHandler(),style:{left:g.getStart(),width:g.getSize()},children:[W(g.column.columnDef.header,g.getContext()),g.column.getIsSorted()?e(L,{className:"sort-icon",svg:g.column.getIsSorted()==="asc"?e(sn,{}):e(rn,{})}):null]})},g.id))},m.id))}),y?e(ln,{}):e("tbody",{children:p.map(m=>e("tr",{children:m.getVisibleCells().map(g=>e("td",{children:W(g.column.columnDef.cell,g.getContext())},g.id))},m.id))})]})})}function DS(n){const{datasetId:a}=n,t=I.useLazyLoadQuery(qc,{datasetId:a});return e(Z,{size:"L",title:"Dataset History",children:e("div",{css:K`
          height: 500px;
        `,children:e(xS,{dataset:t.dataset})})})}function _S(n){const{datasetId:a}=n,[t,l]=u.useState(null);return s(U,{children:[s(me,{children:[e(A,{leadingVisual:e(L,{svg:e(vg,{})}),"aria-label":"Version History",onPress:()=>{l(e(DS,{datasetId:a}))}}),e(Ee,{children:"Dataset Version History"})]}),e(u.Suspense,{fallback:null,children:e(X,{type:"modal",isDismissable:!0,onDismiss:()=>{l(null)},children:t})})]})}const LS=`pip install arize-phoenix>=${window.Config.platformVersion}`;function wS({isAuthEnabled:n}){let a=`import os
# Set the phoenix collector endpoint. Commonly http://localhost:6006 
os.environ["PHOENIX_COLLECTOR_ENDPOINT"] = "<your-phoenix-url>"`;return n&&(a+=`
# Configure access
os.environ["PHOENIX_API_KEY"] = "<your-api-key>"`),a}const ES=`from phoenix.experiments.types import Example
# Define your task
# Typically should be an LLM call or a call to your application
def my_task(example: Example) -> str:
    # This is just an example of how to return a JSON serializable value
    return f"Hello {example.input['person']}"`,MS=`# Define an evaluator. This just an example.
def exact_match(input, output) -> float:
    return 1.0 if output is f"Hello {input}" else 0.0

# Store the evaluators for later use
evaluators = [exact_match]`,VS=`# Run an experiment
from phoenix.experiments import run_experiment

experiment = run_experiment(dataset, my_task, evaluators=evaluators)`;function Hc(){const[n,a]=u.useState(null),t=u.useCallback(()=>{a(e(Z,{title:"Run Experiment",size:"XL",children:e(RS,{})}))},[]);return s(U,{children:[e(A,{size:"S",leadingVisual:e(L,{svg:e(Fr,{})}),onPress:t,children:"Run Experiment"}),e(X,{isDismissable:!0,type:"slideOver",onDismiss:()=>{a(null)},children:n})]})}function RS(){const n=ma(i=>i.datasetName),a=ma(i=>i.latestVersion),t=window.Config.authenticationEnabled,l=u.useMemo(()=>`import phoenix as px
# Initialize a phoenix client
client = px.Client()
# Get the current dataset version. You can omit the version for the latest.
dataset = client.get_dataset(name="${n}"${a?`, version_id="${a.id}"`:""})`,[n,a]);return s(C,{padding:"size-400",overflow:"auto",children:[e(C,{paddingBottom:"size-100",children:e(v,{children:"Install Phoenix"})}),e(Ue,{children:e(cn,{value:LS})}),e(C,{paddingTop:"size-100",paddingBottom:"size-100",children:e(v,{children:"Point to a running instance of Phoenix"})}),e(Ue,{children:e(cn,{value:wS({isAuthEnabled:t})})}),e(Cg,{children:e(C,{paddingBottom:"size-100",paddingTop:"size-100",children:e(Br,{fallback:s(v,{children:["Your personal API keys can be created and managed on your"," ",e(nn,{href:"/profile",children:"Profile"})]}),children:s(v,{children:["System API keys can be created and managed in"," ",e(nn,{href:"/settings",children:"Settings"})]})})})}),e(C,{paddingTop:"size-100",paddingBottom:"size-100",children:e(v,{children:"Pull down this dataset"})}),e(Ue,{children:e(cn,{value:l})}),e(C,{paddingTop:"size-100",paddingBottom:"size-100",children:e(v,{children:"Define your task"})}),e(Ue,{children:e(cn,{value:ES})}),e(C,{paddingTop:"size-100",paddingBottom:"size-100",children:e(v,{children:"Define evaluators"})}),e(Ue,{children:e(cn,{value:MS})}),e(C,{paddingTop:"size-100",paddingBottom:"size-100",children:e(v,{children:"Run an experiment"})}),e(Ue,{children:e(cn,{value:VS})})]})}function $2(){const n=Be(),a=u.useMemo(()=>{const t=n.dataset.latestVersions;return t!=null&&t.edges&&t.edges.length?t.edges[0].version:null},[n]);return e(FS,{datasetId:n.dataset.id,datasetName:n.dataset.name,latestVersion:a,children:e(u.Suspense,{fallback:e(ge,{}),children:e(NS,{dataset:n.dataset})})})}const AS=K`
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  .ac-tabs {
    flex: 1 1 auto;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    div[role="tablist"] {
      flex: none;
    }
    .ac-tabs__pane-container {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      div[role="tabpanel"]:not([hidden]) {
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }
    }
  }
`;function NS({dataset:n}){const a=n.id,t=ma(c=>c.refreshLatestVersion),l=ke(),i=le(),r=u.useCallback(c=>{c===0?i(`/datasets/${a}/experiments`):c===1&&i(`/datasets/${a}/examples`)},[i,a]),d=kl().pathname.includes("examples")?1:0;return s("main",{css:AS,children:[e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-200",paddingBottom:"size-50",flex:"none",children:s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(h,{direction:"column",justifyContent:"space-between",children:e(h,{direction:"row",gap:"size-200",alignItems:"center",children:s(h,{direction:"column",children:[e(v,{elementType:"h1",size:"L",weight:"heavy",children:n.name}),e(v,{color:"text-700",children:n.description||"--"})]})})}),s(h,{direction:"row",gap:"size-100",children:[s(wn,{align:"end",icon:e(L,{svg:e(Et,{})}),onAction:c=>{switch(c){case"csv":window.open(mn(`/v1/datasets/${n.id}/csv`),"_blank");break;case"openai-ft":window.open(mn(`/v1/datasets/${n.id}/jsonl/openai_ft`),"_blank");break;case"openai-evals":window.open(mn(`/v1/datasets/${n.id}/jsonl/openai_evals`),"_blank");break}},children:[e(re,{children:"Download CSV"},"csv"),e(re,{children:"Download OpenAI Fine-Tuning JSONL"},"openai-ft"),e(re,{children:"Download OpenAI Evals JSONL"},"openai-evals")]}),e(_S,{datasetId:n.id}),e(PS,{}),e(Hc,{}),e(A,{leadingVisual:e(L,{svg:e(fa,{})}),onPress:()=>{i(`/playground?datasetId=${n.id}`)},children:"Playground"}),e(TS,{datasetId:n.id,onAddExampleCompleted:()=>{l({title:"Example added",message:"The example has been added successfully and the version has been updated."}),t()}})]})]})}),s(He,{onChange:r,defaultIndex:d,children:[e(ae,{name:"Experiments",extra:e(dn,{children:n.experimentCount}),children:e(u.Suspense,{children:e(xe,{})})}),e(ae,{name:"Examples",extra:e(dn,{children:n.exampleCount}),children:e(u.Suspense,{children:e(xe,{})})})]})]})}const Gc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},i={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},l,{alias:null,args:null,kind:"ScalarField",name:"exampleCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentCount",storageKey:null},{alias:"latestVersions",args:[{kind:"Literal",name:"first",value:1},{kind:"Literal",name:"sort",value:{col:"createdAt",dir:"desc"}}],concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"versions",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[t,l,{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:'versions(first:1,sort:{"col":"createdAt","dir":"desc"})'}],type:"Dataset",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"datasetLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,i],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"datasetLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,i],storageKey:null}]},params:{cacheID:"5b221627cf7e63f41fbec41027cc0951",id:null,metadata:{},name:"datasetLoaderQuery",operationKind:"query",text:`query datasetLoaderQuery(
  $id: GlobalID!
) {
  dataset: node(id: $id) {
    __typename
    id
    ... on Dataset {
      id
      name
      description
      exampleCount
      experimentCount
      latestVersions: versions(first: 1, sort: {col: createdAt, dir: desc}) {
        edges {
          version: node {
            id
            description
            createdAt
          }
        }
      }
    }
  }
}
`}}}();Gc.hash="469da2debdebd608c88a6ef83c2540aa";async function O2(n){const{datasetId:a}=n.params;return await I.fetchQuery(he,Gc,{id:a}).toPromise()}function Q2(){const{exampleId:n,datasetId:a}=qe(),t=le();return e(li,{exampleId:n,onDismiss:()=>{t(`/datasets/${a}/examples`)}})}const Wc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i=[{kind:"Literal",name:"first",value:100}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"examplesLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{args:null,kind:"FragmentSpread",name:"ExamplesTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"examplesLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"examples",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"examples(first:100)"},{alias:null,args:i,filters:["datasetVersionId"],handle:"connection",key:"ExamplesTable_examples",kind:"LinkedHandle",name:"examples"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"7e303fa9a3c09ccd6a3dc1f3dbb2afb3",id:null,metadata:{},name:"examplesLoaderQuery",operationKind:"query",text:`query examplesLoaderQuery(
  $id: GlobalID!
) {
  dataset: node(id: $id) {
    __typename
    id
    ...ExamplesTableFragment
  }
}

fragment ExamplesTableFragment on Dataset {
  examples(first: 100) {
    edges {
      example: node {
        id
        revision {
          input
          output
          metadata
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Wc.hash="6406bbf43a2e850b384ba9573d8e69de";async function j2(n){const{datasetId:a}=n.params;return await I.fetchQuery(he,Wc,{id:a}).toPromise()}const Jc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"datasetVersionId"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"datasetVersionId",variableName:"datasetVersionId"},{kind:"Variable",name:"first",variableName:"first"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExamplesTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:t,kind:"FragmentSpread",name:"ExamplesTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExamplesTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"TypeDiscriminator",abstractKey:"__isNode"},i,{kind:"InlineFragment",selections:[{alias:null,args:t,concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"examples",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:t,filters:["datasetVersionId"],handle:"connection",key:"ExamplesTable_examples",kind:"LinkedHandle",name:"examples"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"ca59c018695d41ca01b5f9d453386886",id:null,metadata:{},name:"ExamplesTableQuery",operationKind:"query",text:`query ExamplesTableQuery(
  $after: String = null
  $datasetVersionId: GlobalID
  $first: Int = 100
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...ExamplesTableFragment_4a6F8Z
    __isNode: __typename
    id
  }
}

fragment ExamplesTableFragment_4a6F8Z on Dataset {
  examples(datasetVersionId: $datasetVersionId, first: $first, after: $after) {
    edges {
      example: node {
        id
        revision {
          input
          output
          metadata
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Jc.hash="e04e697cdb44ab2dd115f4562211f6a4";const Zc=function(){var n=["examples"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"datasetVersionId"},{defaultValue:100,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:Jc,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"ExamplesTableFragment",selections:[{alias:"examples",args:[{kind:"Variable",name:"datasetVersionId",variableName:"datasetVersionId"}],concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"__ExamplesTable_examples_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"Dataset",abstractKey:null}}();Zc.hash="e04e697cdb44ab2dd115f4562211f6a4";const Xc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"deleteDatasetExamples",plural:!1,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"dataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExampleSelectionToolbarDeleteExamplesMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExampleSelectionToolbarDeleteExamplesMutation",selections:a},params:{cacheID:"b63159f3c325b9af3dc469692f9329e5",id:null,metadata:{},name:"ExampleSelectionToolbarDeleteExamplesMutation",operationKind:"mutation",text:`mutation ExampleSelectionToolbarDeleteExamplesMutation(
  $input: DeleteDatasetExamplesInput!
) {
  deleteDatasetExamples(input: $input) {
    dataset {
      id
    }
  }
}
`}}}();Xc.hash="455bf9e5dc4b9cc655095dc829ef7e12";function zS(n){const a=ma(f=>f.refreshLatestVersion),{selectedExamples:t,onExamplesDeleted:l,onClearSelection:i}=n,[r,o]=u.useState(null),d=ke(),c=Fe(),[p,y]=I.useMutation(Xc),m=t.length!==1,g=u.useCallback(()=>{p({variables:{input:{exampleIds:t.map(f=>f.id)}},onCompleted:()=>{d({title:"Examples Deleted",message:`${t.length} example${m?"s":""} have been deleted.`}),l(),i(),a()},onError:f=>{const k=Ce(f);c({title:"An error occurred",message:`Failed to delete examples: ${(k==null?void 0:k[0])??f.message}`})}})},[p,t,d,m,l,i,a,c]);return s("div",{css:K`
        position: absolute;
        bottom: var(--ac-global-dimension-size-400);
        left: 50%;
        transform: translateX(-50%);
      `,children:[e(C,{backgroundColor:"light",padding:"size-200",borderColor:"light",borderWidth:"thin",borderRadius:"medium",minWidth:"size-6000",children:s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(v,{children:`${t.length} example${m?"s":""} selected`}),s(h,{direction:"row",gap:"size-100",children:[e(A,{variant:"default",size:"S",onPress:i,children:"Cancel"}),e(A,{variant:"danger",size:"S",leadingVisual:e(L,{svg:y?e(je,{}):e(We,{})}),isDisabled:y,onPress:g,children:y?"Deleting...":"Delete Example"+(m?"s":"")})]})]})}),e(X,{onDismiss:()=>{o(null)},children:r})]})}const $S=100;function OS({dataset:n}){const a=ma(w=>w.latestVersion),t=u.useRef(null),[l,i]=Ke.useState({}),{data:r,loadNext:o,hasNext:d,isLoadingNext:c,refetch:p}=I.usePaginationFragment(Zc,n);u.useEffect(()=>{u.startTransition(()=>{p({datasetVersionId:(a==null?void 0:a.id)||null},{fetchPolicy:"store-and-network"})})},[a,p]);const y=u.useMemo(()=>r.examples.edges.map(w=>{const T=w.example,x=T.revision;return{id:T.id,input:x.input,output:x.output,metadata:x.metadata}}),[r]),g=Te({columns:[{id:"select",header:({table:w})=>e(Gn,{checked:w.getIsAllRowsSelected(),indeterminate:w.getIsSomeRowsSelected(),onChange:w.getToggleAllRowsSelectedHandler()}),cell:({row:w})=>e(Gn,{checked:w.getIsSelected(),disabled:!w.getCanSelect(),indeterminate:w.getIsSomeSelected(),onChange:w.getToggleSelectedHandler()})},{header:"example id",accessorKey:"id",cell:({getValue:w,row:T})=>{const x=T.original.id;return e(Oe,{to:`${x}`,children:w()})}},{header:"input",accessorKey:"input",cell:Ta},{header:"output",accessorKey:"output",cell:Ta},{header:"metadata",accessorKey:"metadata",cell:Ta}],data:y,state:{rowSelection:l},onRowSelectionChange:i,getCoreRowModel:Pe()}),f=g.getRowModel().rows,k=f.length===0,b=g.getSelectedRowModel().rows,S=b.map(w=>w.original),F=u.useCallback(()=>{i({})},[i]),P=u.useCallback(w=>{if(w){const{scrollHeight:T,scrollTop:x,clientHeight:M}=w;T-x-M<300&&!c&&d&&o($S)}},[d,c,o]),D=le();return s("div",{css:K`
        flex: 1 1 auto;
        overflow: auto;
      `,ref:t,onScroll:w=>P(w.target),children:[s("table",{css:ea,children:[e("thead",{children:g.getHeaderGroups().map(w=>e("tr",{children:w.headers.map(T=>e("th",{children:e("div",{children:W(T.column.columnDef.header,T.getContext())})},T.id))},w.id))}),k?e(ln,{}):e("tbody",{children:f.map(w=>e("tr",{onClick:()=>{D(`${w.original.id}`)},children:w.getVisibleCells().map(T=>e("td",{children:W(T.column.columnDef.cell,T.getContext())},T.id))},w.id))})]}),b.length?e(zS,{selectedExamples:S,onClearSelection:F,onExamplesDeleted:()=>{p({},{fetchPolicy:"store-and-network"})}}):null]})}function q2(){const n=Be();return s(U,{children:[e(OS,{dataset:n.dataset})," ",e(u.Suspense,{children:e(xe,{})})]})}const Yc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"annotationName",storageKey:null},r=[{kind:"Literal",name:"first",value:100}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"experimentsLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"ExperimentsTableFragment"}],type:"Dataset",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"experimentsLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"experimentAnnotationSummaries",plural:!0,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"minScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxScore",storageKey:null}],storageKey:null},{alias:null,args:r,concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorRate",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"runCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averageRunLatencyMs",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t],storageKey:null},{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"annotationSummaries",plural:!0,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"experiments(first:100)"},{alias:null,args:r,filters:null,handle:"connection",key:"ExperimentsTable_experiments",kind:"LinkedHandle",name:"experiments"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"91f92395f5df4858554b124deed3f47a",id:null,metadata:{},name:"experimentsLoaderQuery",operationKind:"query",text:`query experimentsLoaderQuery(
  $id: GlobalID!
) {
  dataset: node(id: $id) {
    __typename
    id
    ... on Dataset {
      ...ExperimentsTableFragment
    }
  }
}

fragment ExperimentsTableFragment on Dataset {
  experimentAnnotationSummaries {
    annotationName
    minScore
    maxScore
  }
  experiments(first: 100) {
    edges {
      experiment: node {
        id
        name
        sequenceNumber
        description
        createdAt
        metadata
        errorRate
        runCount
        averageRunLatencyMs
        project {
          id
        }
        annotationSummaries {
          annotationName
          meanScore
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Yc.hash="1461484d9e1232cbb99e1251edabbec3";async function B2(n){const{datasetId:a}=n.params;return await I.fetchQuery(he,Yc,{id:a}).toPromise()}const eu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"annotationName",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExperimentsTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:t,kind:"FragmentSpread",name:"ExperimentsTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExperimentsTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"TypeDiscriminator",abstractKey:"__isNode"},i,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"experimentAnnotationSummaries",plural:!0,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"minScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxScore",storageKey:null}],storageKey:null},{alias:null,args:t,concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorRate",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"runCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averageRunLatencyMs",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[i],storageKey:null},{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"annotationSummaries",plural:!0,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:t,filters:null,handle:"connection",key:"ExperimentsTable_experiments",kind:"LinkedHandle",name:"experiments"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"1db5ce5523fa9a472c91d093b0e6160e",id:null,metadata:{},name:"ExperimentsTableQuery",operationKind:"query",text:`query ExperimentsTableQuery(
  $after: String = null
  $first: Int = 100
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...ExperimentsTableFragment_2HEEH6
    __isNode: __typename
    id
  }
}

fragment ExperimentsTableFragment_2HEEH6 on Dataset {
  experimentAnnotationSummaries {
    annotationName
    minScore
    maxScore
  }
  experiments(first: $first, after: $after) {
    edges {
      experiment: node {
        id
        name
        sequenceNumber
        description
        createdAt
        metadata
        errorRate
        runCount
        averageRunLatencyMs
        project {
          id
        }
        annotationSummaries {
          annotationName
          meanScore
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();eu.hash="c7c7580fe40888ceb86a1701fe4eedf4";const nu=function(){var n=["experiments"],a={alias:null,args:null,kind:"ScalarField",name:"annotationName",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:eu,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"ExperimentsTableFragment",selections:[{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"experimentAnnotationSummaries",plural:!0,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"minScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxScore",storageKey:null}],storageKey:null},{alias:"experiments",args:null,concreteType:"ExperimentConnection",kind:"LinkedField",name:"__ExperimentsTable_experiments_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorRate",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"runCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averageRunLatencyMs",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t],storageKey:null},{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"annotationSummaries",plural:!0,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},t],type:"Dataset",abstractKey:null}}();nu.hash="c7c7580fe40888ceb86a1701fe4eedf4";function QS({experimentId:n}){return e(wt,{children:e(wn,{buttonSize:"compact",align:"end",icon:e(L,{svg:e(Et,{})}),onAction:a=>{a==="json"&&window.open(mn(`/v1/experiments/${n}/json`),"_blank")},children:e(re,{children:"Download JSON"},"json")})})}function jS({getValue:n}){const a=n(),t=a!==null?a*100:null,l=u.useMemo(()=>{if(t!==null)return t>=80?"red-1100":t>0?"orange-1100":"green-1100"},[t]);return e(v,{color:l,children:pt(t)})}const au=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"ExperimentMutationPayload",kind:"LinkedField",name:"deleteExperiments",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExperimentSelectionToolbarDeleteExperimentsMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExperimentSelectionToolbarDeleteExperimentsMutation",selections:a},params:{cacheID:"3af24cbaf3208c0d5ad1cd9313dd3823",id:null,metadata:{},name:"ExperimentSelectionToolbarDeleteExperimentsMutation",operationKind:"mutation",text:`mutation ExperimentSelectionToolbarDeleteExperimentsMutation(
  $input: DeleteExperimentsInput!
) {
  deleteExperiments(input: $input) {
    __typename
  }
}
`}}}();au.hash="4ab310746eb51c6a3fcb799d2c972762";function qS(n){const a=le(),[t,l]=u.useState(null),[i,r]=I.useMutation(au),{datasetId:o,selectedExperiments:d,onClearSelection:c,onExperimentsDeleted:p}=n,y=d.length!==1,m=ke(),g=Fe(),f=u.useCallback(()=>{i({variables:{input:{experimentIds:d.map(b=>b.id)}},onCompleted:()=>{m({title:"Experiments Deleted",message:`${d.length} experiment${y?"s":""} have been deleted.`}),p(),c()},onError:b=>{const S=Ce(b);g({title:"An error occurred",message:`Failed to delete experiments: ${(S==null?void 0:S[0])??b.message}`})}})},[i,y,g,m,c,p,d]),k=u.useCallback(()=>{l(s(Z,{size:"S",title:"Delete Experiments",children:[e(C,{padding:"size-200",children:e(v,{color:"danger",children:"Are you sure you want to delete these experiments? This will also delete all associated annotations and traces, and it cannot be undone."})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",children:e(A,{variant:"danger",onPress:()=>{f(),l(null)},children:"Delete Experiments"})})})]}))},[f]);return s("div",{css:K`
        position: absolute;
        bottom: var(--ac-global-dimension-size-400);
        left: 50%;
        transform: translateX(-50%);
      `,children:[e(C,{backgroundColor:"light",padding:"size-200",borderColor:"light",borderWidth:"thin",borderRadius:"medium",minWidth:"size-6000",children:s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",gap:"size-100",children:[e(v,{children:`${d.length} experiment${y?"s":""} selected`}),s(h,{direction:"row",gap:"size-100",children:[e(A,{variant:"default",size:"S",onPress:c,children:"Cancel"}),e(A,{variant:"danger",size:"S",leadingVisual:e(L,{svg:r?e(je,{}):e(We,{})}),isDisabled:r,onPress:k,children:r?"Deleting...":"Delete"}),e(A,{variant:"primary",size:"S",onPress:()=>{a(`/datasets/${o}/compare?${d.map(b=>`experimentId=${b.id}`).join("&")}`)},leadingVisual:e(L,{svg:e(Fg,{})}),children:"Compare Experiments"})]})]})}),e(X,{onDismiss:()=>{l(null)},children:t})]})}const BS=100;function US(){return e("tbody",{className:"is-empty",children:e("tr",{children:s("td",{colSpan:100,css:K`
            text-align: center;
            padding: var(--ac-global-dimension-size-400) !important;
            button {
              margin-top: var(--ac-global-dimension-size-200);
              margin-left: auto;
              margin-right: auto;
            }
          `,children:["No experiments for this dataset. To see how to run experiments on a dataset, check out the documentation.",e(Hc,{})]})})})}function HS({dataset:n}){const a=u.useRef(null),[t,l]=u.useState({}),{data:i,loadNext:r,hasNext:o,isLoadingNext:d,refetch:c}=I.usePaginationFragment(nu,n),p=u.useMemo(()=>i.experiments.edges.map(T=>{const x=T.experiment.annotationSummaries.reduce((M,R)=>(M[R.annotationName]=R,M),{});return{...T.experiment,annotationSummaryMap:x}}),[i.experiments.edges]),y=[{id:"select",header:({table:T})=>e(Gn,{checked:T.getIsAllRowsSelected(),indeterminate:T.getIsSomeRowsSelected(),onChange:T.getToggleAllRowsSelectedHandler()}),cell:({row:T})=>e(Gn,{checked:T.getIsSelected(),disabled:!T.getCanSelect(),indeterminate:T.getIsSomeSelected(),onChange:T.getToggleSelectedHandler()})},{header:"name",accessorKey:"name",minSize:200,cell:({getValue:T,row:x})=>{const M=x.original.id,R=x.original.sequenceNumber;return s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Nt,{sequenceNumber:R}),e(Oe,{to:`/datasets/${n.id}/compare?experimentId=${M}`,children:T()})]})}},{header:"description",accessorKey:"description",minSize:300,cell:De},{header:"created at",accessorKey:"createdAt",cell:Me}],m=i.experimentAnnotationSummaries.map(T=>{const{annotationName:x,minScore:M,maxScore:R}=T;return{header:()=>s(h,{direction:"row",gap:"size-100",wrap:!0,alignItems:"center",justifyContent:"end",children:[e(v,{children:x}),e(Kg,{annotationName:x})]}),id:`annotation-${x}`,meta:{textAlign:"right"},cell:({row:O})=>{const N=O.original.annotationSummaryMap[x];return!N||N.meanScore==null?e("span",{css:K`
                  float: right;
                `,children:"--"}):e(GS,{annotationName:x,value:N.meanScore,min:M,max:R})}}}),g=[{header:"run count",accessorKey:"runCount",meta:{textAlign:"right"},cell:$r},{header:"avg latency",accessorKey:"averageRunLatencyMs",meta:{textAlign:"right"},cell:({getValue:T})=>{const x=T();return x===null||typeof x!="number"?"--":e(Ve,{latencyMs:x})}},{header:"error rate",accessorKey:"errorRate",meta:{textAlign:"right"},cell:jS},{header:"metadata",accessorKey:"metadata",minSize:200,cell:Ta},{id:"actions",cell:({row:T})=>{const x=T.original.project,M=T.original.metadata;return s(h,{direction:"row",gap:"size-100",children:[e(QS,{experimentId:T.original.id}),e(Ur,{projectId:(x==null?void 0:x.id)||null,experimentId:T.original.id,metadata:M})]})}}],f=Te({columns:[...y,...m,...g],data:p,getCoreRowModel:Pe(),state:{rowSelection:t},onRowSelectionChange:l}),k=f.getRowModel().rows,b=f.getSelectedRowModel().rows,S=b.map(T=>T.original),F=u.useCallback(()=>{l({})},[l]),P=k.length===0,D=u.useCallback(T=>{if(T){const{scrollHeight:x,scrollTop:M,clientHeight:R}=T;x-M-R<300&&!d&&o&&r(BS)}},[o,d,r]),w=le();return s("div",{css:K`
        flex: 1 1 auto;
        overflow: auto;
        width: table.getTotalSize();
      `,ref:a,onScroll:T=>D(T.target),children:[s("table",{css:ea,children:[e("thead",{children:f.getHeaderGroups().map(T=>e("tr",{children:T.headers.map(x=>{var M,R;return e("th",{align:(R=(M=x.column.columnDef)==null?void 0:M.meta)==null?void 0:R.textAlign,children:e("div",{children:W(x.column.columnDef.header,x.getContext())})},x.id)})},T.id))}),P?e(US,{}):e("tbody",{children:k.map(T=>e("tr",{onClick:()=>{w(`/datasets/${n.id}/compare?experimentId=${T.original.id}`)},children:T.getVisibleCells().map(x=>e("td",{children:W(x.column.columnDef.cell,x.getContext())},x.id))},T.id))})]}),b.length?e(qS,{datasetId:n.id,selectedExperiments:S,onClearSelection:F,onExperimentsDeleted:()=>{c({},{fetchPolicy:"store-and-network"})}}):null]})}function GS({annotationName:n,value:a,min:t,max:l}){const i=Ar(n),r=u.useMemo(()=>{const o=typeof t=="number"?t:0,d=typeof l=="number"?l:1;if(o===d&&d===a)return 100;const c=d-o||1;return(a-o)/c*100},[a,t,l]);return s(me,{children:[e($e,{children:s("div",{css:K`
            float: right;
            --mod-barloader-fill-color: ${i};
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: var(--ac-global-dimension-size-100);
          `,children:[Fa(a),e(Dm,{width:"40px",value:r,"aria-label":"where the mean score lands between overall min max"})]})}),e(Zn,{children:s(C,{width:"size-2400",children:[e(te,{level:3,weight:"heavy",children:n}),s(h,{direction:"column",children:[s(h,{justifyContent:"space-between",children:[e(v,{weight:"heavy",size:"XS",children:"Mean Score"}),e(v,{size:"XS",children:Fa(a)})]}),s(h,{justifyContent:"space-between",children:[e(v,{weight:"heavy",size:"XS",children:"All Experiments Min"}),e(v,{size:"XS",children:Fa(t)})]}),s(h,{justifyContent:"space-between",children:[e(v,{weight:"heavy",size:"XS",children:"All Experiments Max"}),e(v,{size:"XS",children:Fa(l)})]}),s(h,{justifyContent:"space-between",children:[e(v,{weight:"heavy",size:"XS",children:"Mean Score Percentile"}),e(v,{size:"XS",children:Nr(r)})]})]})]})})]})}function U2(){const n=Be();return s(U,{children:[e(HS,{dataset:n.dataset}),e(u.Suspense,{children:e(xe,{})})]})}const tu=function(){var n={defaultValue:null,kind:"LocalArgument",name:"datasetId"},a={defaultValue:null,kind:"LocalArgument",name:"experimentIds"},t={defaultValue:null,kind:"LocalArgument",name:"filterCondition"},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null}],storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},o={alias:"comparisons",args:[{kind:"Variable",name:"experimentIds",variableName:"experimentIds"},{kind:"Variable",name:"filterCondition",variableName:"filterCondition"}],concreteType:"ExperimentComparison",kind:"LinkedField",name:"compareExperiments",plural:!0,selections:[{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"example",plural:!1,selections:[l,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:"referenceOutput",args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"RunComparisonItem",kind:"LinkedField",name:"runComparisonItems",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"experimentId",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"runs",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},i,{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[l,r,{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},i],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},d=[{kind:"Variable",name:"id",variableName:"datasetId"}],c={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[l,r,{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[l],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Dataset",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"ExperimentCompareTableQuery",selections:[o,{alias:"dataset",args:d,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,c],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n,t],kind:"Operation",name:"ExperimentCompareTableQuery",selections:[o,{alias:"dataset",args:d,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,c],storageKey:null}]},params:{cacheID:"2858d6862ebdeb9248578effd1944942",id:null,metadata:{},name:"ExperimentCompareTableQuery",operationKind:"query",text:`query ExperimentCompareTableQuery(
  $experimentIds: [GlobalID!]!
  $datasetId: GlobalID!
  $filterCondition: String
) {
  comparisons: compareExperiments(experimentIds: $experimentIds, filterCondition: $filterCondition) {
    example {
      id
      revision {
        input
        referenceOutput: output
      }
    }
    runComparisonItems {
      experimentId
      runs {
        output
        error
        startTime
        endTime
        trace {
          traceId
          projectId
        }
        annotations {
          edges {
            annotation: node {
              id
              name
              score
              label
              annotatorKind
              explanation
              trace {
                traceId
                projectId
              }
            }
          }
        }
      }
    }
  }
  dataset: node(id: $datasetId) {
    __typename
    id
    ... on Dataset {
      experiments {
        edges {
          experiment: node {
            id
            name
            sequenceNumber
            metadata
            project {
              id
            }
          }
        }
      }
    }
  }
}
`}}}();tu.hash="3a013b01c738ae156d59ed0d0dcced72";const lu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"condition"},{defaultValue:null,kind:"LocalArgument",name:"experimentIds"}],a=[{alias:null,args:[{kind:"Variable",name:"condition",variableName:"condition"},{kind:"Variable",name:"experimentIds",variableName:"experimentIds"}],concreteType:"ValidationResult",kind:"LinkedField",name:"validateExperimentRunFilterCondition",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isValid",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorMessage",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExperimentRunFilterConditionFieldValidationQuery",selections:a,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExperimentRunFilterConditionFieldValidationQuery",selections:a},params:{cacheID:"215d8f5d35b74d08ed0935cc97450385",id:null,metadata:{},name:"ExperimentRunFilterConditionFieldValidationQuery",operationKind:"query",text:`query ExperimentRunFilterConditionFieldValidationQuery(
  $condition: String!
  $experimentIds: [GlobalID!]!
) {
  validateExperimentRunFilterCondition(condition: $condition, experimentIds: $experimentIds) {
    isValid
    errorMessage
  }
}
`}}}();lu.hash="ebd42c04f1fa695bbd658ed88c167854";const iu=u.createContext(null);function WS(){const n=u.useContext(iu);if(n===null)throw new Error("useExperimentRunFilterCondition must be used within a ExperimentRunFilterConditionProvider");return n}function JS(n){const[a,t]=u.useState(""),l=u.useCallback(r=>{u.startTransition(()=>{t(r)})},[]),i=u.useCallback(r=>{u.startTransition(()=>{a.length>0?t(a+" and "+r):t(r)})},[a]);return e(iu.Provider,{value:{filterCondition:a,setFilterCondition:l,appendFilterCondition:i},children:n.children})}const ru=K`
  flex: 1 1 auto;
  .cm-content {
    padding: var(--ac-global-dimension-static-size-100) 0;
  }
  .cm-editor {
    background-color: transparent !important;
  }
  .cm-focused {
    outline: none;
  }
  .cm-selectionLayer .cm-selectionBackground {
    background: var(--ac-global-color-cyan-400) !important;
  }
`,su=K`
  border-width: var(--ac-global-border-size-thin);
  border-style: solid;
  border-color: var(--ac-global-input-field-border-color);
  border-radius: var(--ac-global-rounding-small);
  background-color: var(--ac-global-input-field-background-color);
  transition: all 0.2s ease-in-out;
  overflow-x: hidden;
  &:hover,
  &[data-is-focused="true"] {
    border-color: var(--ac-global-input-field-border-color-active);
    background-color: var(--ac-global-input-field-background-color-active);
  }
  &[data-is-invalid="true"] {
    border-color: var(--ac-global-color-danger);
  }
  box-sizing: border-box;
`;function ZS(n){const a=n.matchBefore(/\w*/);return!a||a.from==a.to&&!n.explicit?null:{from:a.from,options:[{label:"input",type:"variable",info:"The input of the dataset example"},{label:"reference_output",type:"variable",info:"The reference output of the dataset example"},{label:"metadata",type:"variable",info:"The metadata of the dataset example"},{label:"output",type:"variable",info:"The output of the experiment run"},{label:"error",type:"variable",info:"The error message of the experiment run (if exists)"},{label:"latency_ms",type:"variable",info:"The duration of the experiment run in milliseconds"},{label:"evals",type:"variable",info:"The evaluations of the experiment run"},{label:"search input",type:"text",apply:"'' in input",detail:"macro"},{label:"search reference output",type:"text",apply:"'' in reference_output",detail:"macro"},{label:"search output",type:"text",apply:"'' in output",detail:"macro"},{label:"has error",type:"text",apply:"error is not None",detail:"macro"},{label:"Latency >= 10s",type:"text",apply:"latency_ms >= 10_000",detail:"macro"},{label:"Hallucinations",type:"text",apply:"evals['hallucination'].label == 'hallucinated'",detail:"macro"},{label:"Metadata",type:"text",apply:"metadata['category'] == 'hard_examples'",detail:"macro"}]}}async function XS(n,a){if(!n)return{isValid:!0,errorMessage:null};const t=await et.fetchQuery(he,lu,{condition:n,experimentIds:a}).toPromise();if(!t)throw new Error("Filter condition validation is null");return t.validateExperimentRunFilterCondition}const YS=[Ul.of([{key:"Enter",run:n=>!0}]),at(),Xr({override:[ZS]})];function ev(n){const{onValidCondition:a,placeholder:t=`filter condition (e.g., evals["Hallucination"].label == 'hallucinated')`}=n,[l,i]=u.useState(!1),[r,o]=u.useState(""),{filterCondition:d,setFilterCondition:c,appendFilterCondition:p}=WS(),y=u.useDeferredValue(d),{theme:m}=Mn(),g=m==="light"?aa:ta,[f]=fn(),k=f.getAll("experimentId");u.useEffect(()=>{XS(y,k).then(F=>{F!=null&&F.isValid?(o(""),u.startTransition(()=>{a(y)})):o((F==null?void 0:F.errorMessage)??"Invalid filter condition")})},[a,y,k]);const b=r!=="";return s("div",{"data-is-focused":l,"data-is-invalid":b,css:su,children:[s(h,{direction:"row",children:[e(Kl,{children:e(L,{svg:e(ql,{})})}),e(la,{css:ru,indentWithTab:!1,basicSetup:{lineNumbers:!1,foldGutter:!1,bracketMatching:!0,syntaxHighlighting:!0,highlightActiveLine:!1,highlightActiveLineGutter:!1,defaultKeymap:!1},onFocus:()=>i(!0),onBlur:()=>i(!1),value:d,onChange:c,height:"36px",width:"100%",theme:g,placeholder:t,extensions:YS}),e("button",{css:K`
            margin-right: var(--ac-global-dimension-static-size-100);
            color: var(--ac-global-text-color-700);
            visibility: ${d!==""?"visible":"hidden"};
          `,onClick:()=>c(""),className:"button--reset",children:e(L,{svg:e(At,{})})}),s(ga,{placement:"bottom right",children:[e($e,{children:e("button",{css:K`
                color: var(--ac-global-text-color-700);
                background-color: var(--ac-global-color-grey-300);
                padding-left: var(--ac-global-dimension-static-size-100);
                padding-right: var(--ac-global-dimension-static-size-100);
                height: 100%;
              `,className:"button--reset",children:e(L,{svg:e(kn,{})})})}),e(nv,{onAddFilterConditionSnippet:p})]})]}),s(me,{isOpen:b&&l,placement:"bottom",children:[e($e,{children:e("div",{})}),e(Zn,{children:r!=""?e(v,{color:"danger",children:r}):e(v,{color:"success",children:"Valid Expression"})})]})]})}function nv(n){const{onAddFilterConditionSnippet:a}=n;return e(C,{width:"500px",paddingTop:"size-200",paddingStart:"size-200",paddingEnd:"size-200",borderRadius:"medium",borderWidth:"thin",borderColor:"light",backgroundColor:"light",children:s(Ye,{children:[e(On,{label:"filter by substring",initialSnippet:"'search term' in output['key']",onAddFilterConditionSnippet:a},"substring"),e(On,{label:"filter on errors",initialSnippet:"error is not None",onAddFilterConditionSnippet:a},"errors"),e(On,{label:"filter by evaluation label",initialSnippet:"evals['hallucination'].label == 'hallucinated'",onAddFilterConditionSnippet:a},"eval_label"),e(On,{label:"filter by evaluation score",initialSnippet:"evals['hallucination'].score >= 0.5",onAddFilterConditionSnippet:a},"eval_score"),e(On,{label:"filter by evaluation explanation",initialSnippet:"'search term' in evals['hallucination'].explanation",onAddFilterConditionSnippet:a},"eval_explanation"),e(On,{label:"filter for lower scores than first experiment",initialSnippet:"evals['hallucination'].score < experiments[0].evals['hallucination'].score",onAddFilterConditionSnippet:a},"compare_experiments"),e(On,{label:"filter by metadata",initialSnippet:"metadata['category'] == 'hard_examples'",onAddFilterConditionSnippet:a},"metadata"),e(On,{label:"filter by latency",initialSnippet:"latency_ms >= 10_000",onAddFilterConditionSnippet:a},"latency")]})})}function On(n){const{initialSnippet:a,onAddFilterConditionSnippet:t}=n,[l,i]=u.useState(a),{theme:r}=Mn(),o=r==="light"?aa:ta;return e(Yn,{label:n.label,children:s(h,{direction:"row",width:"100%",gap:"size-100",children:[e("div",{css:K(su,K`
              flex: 1 1 auto;
            `),children:e(la,{value:l,basicSetup:{lineNumbers:!1,foldGutter:!1,bracketMatching:!0,syntaxHighlighting:!0,highlightActiveLine:!1,highlightActiveLineGutter:!1},extensions:[at()],editable:!0,onChange:i,theme:o,css:ru})}),e(A,{"aria-label":"Add to filter condition",variant:"default",onPress:()=>t(l),leadingVisual:e(L,{svg:e(kn,{})})})]})})}const dl={backgroundColor:"light",borderColor:"light",variant:"compact",collapsible:!0,bodyStyle:{padding:0}},av=K`
  flex: 1 1 auto;
  overflow: auto;
  // Make sure the table fills up the remaining space
  table {
    min-width: 100%;
    td {
      vertical-align: top;
    }
  }
`,tv=K`
  display: flex;
  flex-direction: row;
  align-items: center;
  color: var(--ac-global-color-primary);
  gap: var(--ac-global-dimension-size-50);
`;function lv(n){const{datasetId:a,experimentIds:t,displayFullText:l}=n,[i,r]=u.useState(""),o=I.useLazyLoadQuery(tu,{experimentIds:t,datasetId:a,filterCondition:i}),d=u.useMemo(()=>{var P,D;return((D=(P=o.dataset)==null?void 0:P.experiments)==null?void 0:D.edges.reduce((w,T)=>{var x,M;return w[T.experiment.id]={...T.experiment,projectId:((M=(x=T.experiment)==null?void 0:x.project)==null?void 0:M.id)||null},w},{}))||{}},[o]),c=u.useMemo(()=>o.comparisons.map(P=>{const D=P.runComparisonItems.reduce((w,T)=>(w[T.experimentId]=T,w),{});return{...P,id:P.example.id,input:P.example.revision.input,referenceOutput:P.example.revision.referenceOutput,runComparisonMap:D}}),[o]),[p,y]=u.useState(null),m=u.useMemo(()=>[{header:"input",accessorKey:"input",minWidth:500,cell:({row:P})=>e(Ti,{controls:s(me,{children:[e(A,{size:"S","aria-label":"View example details",leadingVisual:e(L,{svg:e(Ja,{})}),onPress:()=>{u.startTransition(()=>{y(e(u.Suspense,{children:e(li,{exampleId:P.original.example.id,onDismiss:()=>{y(null)}})}))})}}),e(Ee,{children:"View Example"})]}),children:e(pi,{children:e(nt,{json:P.original.input,disableTitle:!0,space:l?2:0})})})},{header:"reference output",accessorKey:"referenceOutput",minWidth:500,cell:l?ov:Ta}],[l]),g=u.useMemo(()=>t.map(P=>({header:()=>{var M,R,O,N;const D=(M=d[P])==null?void 0:M.name,w=(R=d[P])==null?void 0:R.metadata,T=(O=d[P])==null?void 0:O.projectId,x=((N=d[P])==null?void 0:N.sequenceNumber)||0;return s(h,{direction:"row",gap:"size-100",wrap:!0,alignItems:"center",justifyContent:"space-between",children:[s(h,{direction:"row",gap:"size-100",wrap:!0,alignItems:"center",children:[e(Nt,{sequenceNumber:x}),e(v,{children:D})]}),e(Ur,{experimentId:P,metadata:w,isQuiet:!0,projectId:T})]})},accessorKey:P,minSize:500,cell:({row:D})=>{var j,Y;const w=D.original.runComparisonMap[P],T=(w==null?void 0:w.runs.length)||0;if(T===0)return e(Wi,{});if(T>1)return e(v,{color:"warning",children:`${T} runs`});const x=w==null?void 0:w.runs[0];let M=null;const R=(j=x==null?void 0:x.trace)==null?void 0:j.traceId,O=(Y=x==null?void 0:x.trace)==null?void 0:Y.projectId;return R&&O&&(M=s(me,{children:[e(A,{variant:"default",className:"trace-button",size:"S","aria-label":"View run trace",leadingVisual:e(L,{svg:e(xt,{})}),onPress:()=>{u.startTransition(()=>{y(e(uu,{traceId:R,projectId:O,title:"Experiment Run Trace"}))})}}),e(Ee,{children:"View Trace"})]})),x?e(Ti,{controls:s(U,{children:[s(me,{children:[e(A,{variant:"default",className:"expand-button",size:"S","aria-label":"View example run details",leadingVisual:e(L,{svg:e(Ja,{})}),onPress:()=>{u.startTransition(()=>{y(e(dv,{selectedExample:D.original,datasetId:a,experimentInfoById:d}))})}}),e(Ee,{children:"View run details"})]}),M]}),children:e(sv,{...x,displayFullText:l,setDialog:y})}):e(Wi,{})}})),[t,d,a,l]),f=u.useMemo(()=>[...m,...g],[m,g]),k=Te({columns:f,data:c,getCoreRowModel:Pe(),columnResizeMode:"onChange"}),b=Ke.useMemo(()=>{const P=k.getFlatHeaders(),D={};for(let w=0;w<P.length;w++){const T=P[w];D[`--header-${T.id}-size`]=T.getSize(),D[`--col-${T.column.id}-size`]=T.column.getSize()}return D},[k.getState().columnSizingInfo,k.getState().columnSizing]),F=k.getRowModel().rows.length===0;return s(h,{direction:"column",height:"100%",children:[e(C,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-200",paddingEnd:"size-200",borderBottomColor:"grey-300",borderBottomWidth:"thin",flex:"none",children:e(ev,{onValidCondition:r})}),s("div",{css:av,children:[s("table",{css:K(tn,vr),style:{...b,width:k.getTotalSize(),minWidth:"100%"},children:[e("thead",{children:k.getHeaderGroups().map(P=>e("tr",{children:P.headers.map(D=>s("th",{style:{width:`calc(var(--header-${D==null?void 0:D.id}-size) * 1px)`},children:[e("div",{children:W(D.column.columnDef.header,D.getContext())}),e("div",{onMouseDown:D.getResizeHandler(),onTouchStart:D.getResizeHandler(),className:`resizer ${D.column.getIsResizing()?"isResizing":""}`})]},D.id))},P.id))}),F?e(ln,{}):k.getState().columnSizingInfo.isResizingColumn?e(iv,{table:k}):e(ou,{table:k})]}),e(X,{isDismissable:!0,type:"slideOver",onDismiss:()=>{y(null)},children:p})]})]})}function ou({table:n}){return e("tbody",{children:n.getRowModel().rows.map(a=>e("tr",{children:a.getVisibleCells().map(t=>e("td",{style:{width:`calc(var(--col-${t.column.id}-size) * 1px)`,wordBreak:"break-all"},children:W(t.column.columnDef.cell,t.getContext())},t.id))},a.id))})}const iv=Ke.memo(ou,(n,a)=>n.table.options.data===a.table.options.data);function rv(n){const{datasetId:a,exampleId:t}=n,l=le();return e("div",{onClick:i=>{i.preventDefault(),i.stopPropagation()},children:e(wn,{buttonSize:"compact",align:"end",onAction:i=>{switch(i){case"gotoExample":return l(`/datasets/${a}/examples/${t}`);default:fe()}},children:e(re,{children:s(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(L,{svg:e(Pg,{})}),e(v,{children:"Go to example"})]})},"gotoExample")})})}function sv(n){const{output:a,error:t,startTime:l,endTime:i,annotations:r,displayFullText:o,setDialog:d}=n;if(t)return e(du,{error:t});const c=r!=null&&r.edges.length?r.edges.map(p=>p.annotation):[];return s(h,{direction:"column",gap:"size-100",height:"100%",justifyContent:"space-between",children:[e(pi,{children:e(nt,{json:a,disableTitle:!0,space:o?2:0})}),s("ul",{css:K`
          display: flex;
          flex-direction: row;
          gap: var(--ac-global-dimension-static-size-100);
          align-items: center;
          flex-wrap: wrap;
        `,children:[e("li",{children:e(cu,{startTime:l,endTime:i})},"run-latency"),c.map(p=>e("li",{children:e(_a,{annotation:p,extra:p.trace&&e(C,{paddingTop:"size-100",children:s("div",{css:tv,children:[e(L,{svg:e(xn,{})}),e("span",{children:"Click to view evaluator trace"})]})}),children:e(En,{annotation:p,onClick:()=>{const y=p.trace;y&&u.startTransition(()=>{d(e(uu,{traceId:y.traceId,projectId:y.projectId,title:`Evaluator Trace: ${p.name}`}))})}})})},p.id))]})]})}function du({error:n}){return s(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(L,{svg:e(wl,{}),color:"danger"}),e(v,{color:"danger",children:n})]})}function cu({startTime:n,endTime:a}){const t=u.useMemo(()=>{let l=null;return n&&a&&(l=new Date(a).getTime()-new Date(n).getTime()),l},[n,a]);return t===null?null:e(Ve,{latencyMs:t})}function Wi(){return s(h,{direction:"row",gap:"size-50",children:[e(L,{svg:e(Tg,{}),color:"grey-800"}),e(v,{color:"text-700",children:"not run"})]})}function ov({getValue:n}){const a=n();return e(pi,{children:e(nt,{json:a,space:2})})}function pi({children:n}){return e("div",{css:K`
        max-height: 300px;
        overflow-y: auto;
      `,children:n})}function dv({selectedExample:n,datasetId:a,experimentInfoById:t}){return e(Z,{title:`Comparing Experiments for Example: ${n.id}`,size:"fullscreen",extra:e(rv,{datasetId:a,exampleId:n.id}),children:s(Pn,{direction:"vertical",autoSaveId:"example-compare-panel-group",children:[e(_e,{defaultSize:35,children:e("div",{css:K`
              overflow-y: auto;
              height: 100%;
            `,children:e(C,{overflow:"hidden",padding:"size-200",children:s(h,{direction:"row",gap:"size-200",flex:"1 1 auto",children:[e(C,{width:"50%",children:e(Q,{title:"Input",...dl,bodyStyle:{padding:0,maxHeight:"300px",overflowY:"auto"},extra:e(ie,{text:JSON.stringify(n.input)}),children:e(Ze,{value:JSON.stringify(n.input,null,2)})})}),e(C,{width:"50%",children:e(Q,{title:"Reference Output",...dl,extra:e(ie,{text:JSON.stringify(n.referenceOutput)}),bodyStyle:{padding:0,maxHeight:"300px",overflowY:"auto"},children:e(Ze,{value:JSON.stringify(n.referenceOutput,null,2)})})})]})})})}),e(Tn,{css:La}),e(_e,{defaultSize:65,children:s(h,{direction:"column",height:"100%",children:[e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderBottomColor:"dark",borderBottomWidth:"thin",flex:"none",children:e(te,{level:2,children:"Experiments"})}),e("div",{css:K`
                overflow-y: auto;
                height: 100%;
                padding: var(--ac-global-dimension-static-size-200);
              `,children:e("ul",{css:K`
                  display: flex;
                  flex-direction: column;
                  gap: var(--ac-global-dimension-static-size-200);
                `,children:n.runComparisonItems.map(l=>{const i=t[l.experimentId];return e("li",{children:e(Q,{...dl,title:i==null?void 0:i.name,titleExtra:e(Nt,{sequenceNumber:(i==null?void 0:i.sequenceNumber)||0}),children:e("ul",{children:l.runs.map((r,o)=>{var d;return e("li",{children:s(h,{direction:"row",children:[e(C,{flex:!0,children:r.error?e(C,{padding:"size-200",children:e(du,{error:r.error})}):e(Ze,{value:JSON.stringify(r.output,null,2)})}),s(oa,{width:"size-3000",children:[e(cu,{startTime:r.startTime,endTime:r.endTime}),e("ul",{css:K`
                                      margin-top: var(
                                        --ac-global-dimension-static-size-100
                                      );
                                      display: flex;
                                      flex-direction: column;
                                      justify-content: flex-start;
                                      align-items: flex-end;
                                      gap: var(
                                        --ac-global-dimension-static-size-100
                                      );
                                    `,children:(d=r.annotations)==null?void 0:d.edges.map(c=>e("li",{children:e(En,{annotation:c.annotation})},c.annotation.id))})]})]})},o)})})})},l.experimentId)})})})]})})]})})}function uu({traceId:n,projectId:a,title:t}){const l=le();return e(Z,{title:t,size:"fullscreen",extra:e(A,{onPress:()=>l(`/projects/${a}/traces/${n}`),children:"View Trace in Project"}),children:e(ri,{traceId:n,projectId:a})})}const mu={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ExperimentMultiSelector__experiments",selections:[{alias:null,args:null,concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Dataset",abstractKey:null};mu.hash="1aa376b1e9425f49268ac231dc2c0412";function cv(n){const{dataset:a,selectedExperimentIds:t,onChange:l,label:i,validationState:r,description:o,errorMessage:d,...c}=n,p=I.useFragment(mu,a),y=u.useMemo(()=>p.experiments.edges.map(f=>f.experiment),[p]),m=y.length===0,g=u.useMemo(()=>{if(m)return"No experiments";const f=t.length;return f>0?`${f} experiment${f>1?"s":""}`:"No experiments selected"},[t,m]);return e(Yn,{label:i,isDisabled:m,validationState:r,description:o,errorMessage:d,children:e(Tl,{isDisabled:m,...c,menu:e(vt,{selectionMode:"multiple",onSelectionChange:f=>{l(Array.from(f))},selectedKeys:new Set(t),children:y.map(f=>e(re,{textValue:f.name,children:s(h,{direction:"column",gap:"size-50",children:[s(h,{direction:"row",gap:"size-100",children:[e(Nt,{sequenceNumber:f.sequenceNumber}),e(v,{children:f.name})]}),e(v,{size:"XS",color:"text-700",children:new Date(f.createdAt).toLocaleString()})]})},f.id))}),triggerProps:{placement:"bottom start"},children:g})})}function H2(){const n=Be(),[a,t]=u.useState(!1),[l,i]=fn(),r=l.getAll("experimentId"),o=r.length>0;return s("main",{css:K`
        height: 100%;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      `,children:[e(C,{padding:"size-200",borderBottomColor:"dark",borderBottomWidth:"thin",flex:"none",children:s(h,{direction:"column",gap:"size-100",children:[e(te,{level:1,children:"Compare Experiments"}),s(h,{direction:"row",justifyContent:"space-between",alignItems:"end",children:[e(cv,{dataset:n.dataset,selectedExperimentIds:r,label:"experiments",onChange:d=>{u.startTransition(()=>{l.delete("experimentId"),d.forEach(c=>{l.append("experimentId",c)}),i(l)})}}),e(ya,{onChange:d=>{t(d)},defaultSelected:!1,labelPlacement:"start",children:"Full Text"})]})]})}),o?e(JS,{children:e(u.Suspense,{fallback:e(ge,{}),children:e(lv,{datasetId:n.dataset.id,experimentIds:r,displayFullText:a})})}):e(C,{padding:"size-200",children:e(pe,{variant:"info",title:"No Experiment Selected",children:"Please select one or more experiments."})})]})}const pu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"experimentCompareLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"InlineFragment",selections:[l,{args:null,kind:"FragmentSpread",name:"ExperimentMultiSelector__experiments"}],type:"Dataset",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"experimentCompareLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,{kind:"InlineFragment",selections:[l,{alias:null,args:null,concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[t,l,{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"7e89f99f940098a21985137aae870de7",id:null,metadata:{},name:"experimentCompareLoaderQuery",operationKind:"query",text:`query experimentCompareLoaderQuery(
  $id: GlobalID!
) {
  dataset: node(id: $id) {
    __typename
    id
    ... on Dataset {
      id
      name
      ...ExperimentMultiSelector__experiments
    }
  }
}

fragment ExperimentMultiSelector__experiments on Dataset {
  experiments {
    edges {
      experiment: node {
        id
        name
        sequenceNumber
        createdAt
      }
    }
  }
}
`}}}();pu.hash="fa02088830fd16688f0f2fba9a0009eb";async function G2(n){const{datasetId:a}=n.params;return await I.fetchQuery(he,pu,{id:a}).toPromise()}const gu=function(){var n={defaultValue:null,kind:"LocalArgument",name:"description"},a={defaultValue:null,kind:"LocalArgument",name:"expiresAt"},t={defaultValue:null,kind:"LocalArgument",name:"name"},l=[{fields:[{kind:"Variable",name:"description",variableName:"description"},{kind:"Variable",name:"expiresAt",variableName:"expiresAt"},{kind:"Variable",name:"name",variableName:"name"}],kind:"ObjectValue",name:"input"}],i={alias:null,args:null,kind:"ScalarField",name:"jwt",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},o={alias:null,args:null,concreteType:"SystemApiKey",kind:"LinkedField",name:"apiKey",plural:!1,selections:[r],storageKey:null};return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"APIKeysCardCreateSystemAPIKeyMutation",selections:[{alias:null,args:l,concreteType:"CreateSystemApiKeyMutationPayload",kind:"LinkedField",name:"createSystemApiKey",plural:!1,selections:[i,{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"SystemAPIKeysTableFragment"}],storageKey:null},o],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[t,n,a],kind:"Operation",name:"APIKeysCardCreateSystemAPIKeyMutation",selections:[{alias:null,args:l,concreteType:"CreateSystemApiKeyMutationPayload",kind:"LinkedField",name:"createSystemApiKey",plural:!1,selections:[i,{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:null,concreteType:"SystemApiKey",kind:"LinkedField",name:"systemApiKeys",plural:!0,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null}],storageKey:null},o],storageKey:null}]},params:{cacheID:"799e8f0a627c6ae06e2a87c051d299d0",id:null,metadata:{},name:"APIKeysCardCreateSystemAPIKeyMutation",operationKind:"mutation",text:`mutation APIKeysCardCreateSystemAPIKeyMutation(
  $name: String!
  $description: String = null
  $expiresAt: DateTime = null
) {
  createSystemApiKey(input: {name: $name, description: $description, expiresAt: $expiresAt}) {
    jwt
    query {
      ...SystemAPIKeysTableFragment
    }
    apiKey {
      id
    }
  }
}

fragment SystemAPIKeysTableFragment on Query {
  systemApiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
}
`}}}();gu.hash="a6f84fa9e14f363d2e7317d3d6507590";const yu=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"APIKeysCardQuery",selections:[{args:null,kind:"FragmentSpread",name:"SystemAPIKeysTableFragment"},{args:null,kind:"FragmentSpread",name:"UserAPIKeysTableFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"APIKeysCardQuery",selections:[{alias:null,args:null,concreteType:"SystemApiKey",kind:"LinkedField",name:"systemApiKeys",plural:!0,selections:[n,a,t,l,i],storageKey:null},{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"userApiKeys",plural:!0,selections:[n,a,t,l,i,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"a8cfba9eaaac34bc497efaacbff45c05",id:null,metadata:{},name:"APIKeysCardQuery",operationKind:"query",text:`query APIKeysCardQuery {
  ...SystemAPIKeysTableFragment
  ...UserAPIKeysTableFragment
}

fragment SystemAPIKeysTableFragment on Query {
  systemApiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
}

fragment UserAPIKeysTableFragment on Query {
  userApiKeys {
    id
    name
    description
    createdAt
    expiresAt
    user {
      email
    }
  }
}
`}}}();yu.hash="ad967afd45af0d5976982c70eaadb330";const fu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DeleteApiKeyMutationPayload",kind:"LinkedField",name:"deleteSystemApiKey",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"apiKeyId",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SystemAPIKeysTableDeleteAPIKeyMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SystemAPIKeysTableDeleteAPIKeyMutation",selections:a},params:{cacheID:"a8c45c42b5becca8efa65334285a2f97",id:null,metadata:{},name:"SystemAPIKeysTableDeleteAPIKeyMutation",operationKind:"mutation",text:`mutation SystemAPIKeysTableDeleteAPIKeyMutation(
  $input: DeleteApiKeyInput!
) {
  deleteSystemApiKey(input: $input) {
    __typename
    apiKeyId
  }
}
`}}}();fu.hash="55ab8200b5bfda0aa73594ad5cfce96f";const hu={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SystemAPIKeysTableQuery",selections:[{args:null,kind:"FragmentSpread",name:"SystemAPIKeysTableFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"SystemAPIKeysTableQuery",selections:[{alias:null,args:null,concreteType:"SystemApiKey",kind:"LinkedField",name:"systemApiKeys",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null}]},params:{cacheID:"94e06b8cd5879701a5d73bee083ad614",id:null,metadata:{},name:"SystemAPIKeysTableQuery",operationKind:"query",text:`query SystemAPIKeysTableQuery {
  ...SystemAPIKeysTableFragment
}

fragment SystemAPIKeysTableFragment on Query {
  systemApiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
}
`}};hu.hash="de0fc04de739f0adfcbdeaff28b16265";const ku={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:[],operation:hu}},name:"SystemAPIKeysTableFragment",selections:[{alias:null,args:null,concreteType:"SystemApiKey",kind:"LinkedField",name:"systemApiKeys",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};ku.hash="de0fc04de739f0adfcbdeaff28b16265";function uv({query:n}){const[a,t]=I.useRefetchableFragment(ku,n),l=Fe(),i=ke(),[r]=I.useMutation(fu),o=u.useCallback(g=>{r({variables:{input:{id:g}},onCompleted:()=>{i({title:"System key deleted",message:"The system key has been deleted and is no longer active."}),u.startTransition(()=>{t({},{fetchPolicy:"network-only"})})},onError:f=>{const k=Ce(f);l({title:"Error deleting system key",message:(k==null?void 0:k[0])??f.message})}})},[r,l,i,t]),d=u.useMemo(()=>[...a.systemApiKeys],[a]),c=u.useMemo(()=>[{header:"Name",accessorKey:"name"},{header:"Description",accessorKey:"description",cell:De},{header:"Created At",accessorKey:"createdAt",cell:Me},{header:"Expires At",accessorKey:"expiresAt",cell:Me},{header:"",accessorKey:"id",size:10,cell:({row:f})=>e(h,{direction:"row",justifyContent:"end",width:"100%",children:e(Bl,{handleDelete:()=>{o(f.original.id)}})}),meta:{textAlign:"right"}}],[o]),p=Te({columns:c,data:d,getCoreRowModel:Pe()}),y=p.getRowModel().rows,m=p.getRowModel().rows.length===0;return s("table",{css:tn,children:[e("thead",{children:p.getHeaderGroups().map(g=>e("tr",{children:g.headers.map(f=>e("th",{colSpan:f.colSpan,children:f.isPlaceholder?null:s("div",{className:f.column.getCanSort()?"cursor-pointer":"",onClick:f.column.getToggleSortingHandler(),style:{left:f.getStart(),width:f.getSize()},children:[W(f.column.columnDef.header,f.getContext()),f.column.getIsSorted()?e(L,{className:"sort-icon",svg:f.column.getIsSorted()==="asc"?e(sn,{}):e(rn,{})}):null]})},f.id))},g.id))}),m?e(ln,{message:"No Keys"}):e("tbody",{children:y.map(g=>e("tr",{children:g.getVisibleCells().map(f=>e("td",{children:W(f.column.columnDef.cell,f.getContext())},f.id))},g.id))})]})}const bu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DeleteApiKeyMutationPayload",kind:"LinkedField",name:"deleteUserApiKey",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"apiKeyId",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"UserAPIKeysTableDeleteAPIKeyMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"UserAPIKeysTableDeleteAPIKeyMutation",selections:a},params:{cacheID:"d137498515ff43864f5525b3c1847376",id:null,metadata:{},name:"UserAPIKeysTableDeleteAPIKeyMutation",operationKind:"mutation",text:`mutation UserAPIKeysTableDeleteAPIKeyMutation(
  $input: DeleteApiKeyInput!
) {
  deleteUserApiKey(input: $input) {
    __typename
    apiKeyId
  }
}
`}}}();bu.hash="9b1d898d1d9858016bed85000ce3906e";const Su={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UserAPIKeysTableQuery",selections:[{args:null,kind:"FragmentSpread",name:"UserAPIKeysTableFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"UserAPIKeysTableQuery",selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"userApiKeys",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"e70d413b072841dff8565a332590a549",id:null,metadata:{},name:"UserAPIKeysTableQuery",operationKind:"query",text:`query UserAPIKeysTableQuery {
  ...UserAPIKeysTableFragment
}

fragment UserAPIKeysTableFragment on Query {
  userApiKeys {
    id
    name
    description
    createdAt
    expiresAt
    user {
      email
    }
  }
}
`}};Su.hash="c2b3a579bcb0ba915523ecb35cae3b44";const vu={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:[],operation:Su}},name:"UserAPIKeysTableFragment",selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"userApiKeys",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};vu.hash="c2b3a579bcb0ba915523ecb35cae3b44";const Ji=70;function mv({query:n}){const[a,t]=I.useRefetchableFragment(vu,n),l=Fe(),i=ke(),[r]=I.useMutation(bu),o=u.useCallback(g=>{r({variables:{input:{id:g}},onCompleted:()=>{i({title:"User key deleted",message:"The user key has been deleted and is no longer active."}),u.startTransition(()=>{t({},{fetchPolicy:"network-only"})})},onError:f=>{const k=Ce(f);l({title:"Error deleting user key",message:(k==null?void 0:k[0])??f.message})}})},[r,l,i,t]),d=u.useMemo(()=>[...a.userApiKeys],[a]),c=u.useMemo(()=>[{header:"Name",accessorKey:"name",size:100,cell:De},{header:"Description",accessorKey:"description",cell:De},{header:"Created At",accessorKey:"createdAt",size:Ji,cell:Me},{header:"Expires At",accessorKey:"expiresAt",size:Ji,cell:Me},{header:"User",size:120,accessorKey:"user.email",cell:De},{header:"",accessorKey:"id",size:10,cell:({row:f})=>e(h,{direction:"row",justifyContent:"end",width:"100%",children:e(Bl,{handleDelete:()=>{o(f.original.id)}})}),meta:{textAlign:"right"}}],[o]),p=Te({columns:c,data:d,getCoreRowModel:Pe()}),y=p.getRowModel().rows,m=p.getRowModel().rows.length===0;return s("table",{css:tn,children:[e("thead",{children:p.getHeaderGroups().map(g=>e("tr",{children:g.headers.map(f=>e("th",{colSpan:f.colSpan,children:f.isPlaceholder?null:s("div",{className:f.column.getCanSort()?"cursor-pointer":"",onClick:f.column.getToggleSortingHandler(),style:{left:f.getStart(),width:f.getSize()},children:[W(f.column.columnDef.header,f.getContext()),f.column.getIsSorted()?e(L,{className:"sort-icon",svg:f.column.getIsSorted()==="asc"?e(sn,{}):e(rn,{})}):null]})},f.id))},g.id))}),m?e(ln,{message:"No Keys"}):e("tbody",{children:y.map(g=>e("tr",{children:g.getVisibleCells().map(f=>e("td",{children:W(f.column.columnDef.cell,f.getContext())},f.id))},g.id))})]})}function pv(){const n=I.useLazyLoadQuery(yu,{},{fetchPolicy:"network-only"});return s(He,{children:[e(ae,{title:"System Keys",name:"System Keys",children:e(uv,{query:n})}),e(ae,{title:"User Keys",name:"User Keys",children:e(mv,{query:n})})]})}function gv(){const[n,a]=u.useState(null),t=Fe(),l=c=>{a(e(Hr,{jwt:c}))},[i,r]=I.useMutation(gu),o=u.useCallback(c=>{var p;i({variables:{...c,expiresAt:((p=c.expiresAt)==null?void 0:p.toDate(Sl()).toISOString())||null},onCompleted:y=>{l(y.createSystemApiKey.jwt)},onError:y=>{t({title:"Error creating system key",message:y.message})}})},[i,t]);return s("div",{children:[e(Cl,{title:"API Keys",variant:"compact",extra:e(A,{size:"S",leadingVisual:e(L,{svg:e(kn,{})}),onPress:()=>{a(e(Gr,{onSubmit:o,isCommitting:r,defaultName:"System"}))},children:"System Key"}),children:e(u.Suspense,{fallback:e(C,{padding:"size-100",children:e(ge,{})}),children:e(pv,{})})}),e(X,{onDismiss:()=>{a(null)},children:n})]})}const Cu={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DBUsagePieChart_data",selections:[{alias:null,args:null,concreteType:"DbTableStats",kind:"LinkedField",name:"dbTableStats",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"tableName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numBytes",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dbStorageCapacityBytes",storageKey:null}],type:"Query",abstractKey:null};Cu.hash="922bf6de312a4be0c38025ffbb868d6d";function Fu(n,a){const{si:t=!1,decimalPlaces:l=1}={},i=t?1e3:1024;if(Math.abs(n)<i)return n+" B";const r=t?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"];let o=-1;const d=10**l;do n/=i,++o;while(Math.round(Math.abs(n)*d)/d>=i&&o<r.length-1);return n.toFixed(l)+" "+r[o]}const Zi="remaining";function yv({active:n,payload:a}){return n&&a&&a.length?e(An,{children:e(Re,{shape:"square",color:a[0].payload.fill||"transparent",name:a[0].name||"--",value:Fu(a[0].value||0)})}):null}function fv({query:n}){const a=I.useFragment(Cu,n),t=a.dbTableStats.reduce((r,o)=>r+o.numBytes,0),l=typeof a.dbStorageCapacityBytes=="number"?a.dbStorageCapacityBytes-t:null,i=u.useMemo(()=>{const r=[...a.dbTableStats];return l!==null&&r.push({tableName:Zi,numBytes:l}),r},[a.dbTableStats,l]);return e(Nn,{width:"100%",height:245,children:s(ns,{children:[e(as,{data:i,dataKey:"numBytes",nameKey:"tableName",cx:"50%",cy:"50%",innerRadius:70,outerRadius:110,strokeWidth:0,stroke:"transparent",children:i.map((r,o)=>e(ts,{stroke:"0",fill:r.tableName===Zi?"var(--ac-global-color-grey-200)":`${hi[o%hi.length]}`},`cell-${o}`))}),e(zn,{content:e(yv,{})}),e("text",{x:"50%",y:"50%",textAnchor:"middle",fill:"var(--ac-global-text-color-900",fontSize:"var(--ac-global-font-size-xl)",children:`${typeof a.dbStorageCapacityBytes=="number"?pt(t/a.dbStorageCapacityBytes*100):Fu(t)}`}),e("text",{x:"50%",y:"50%",dy:25,textAnchor:"middle",fill:"var(--ac-global-text-color-900",fontSize:"var(--ac-global-font-size-s)",children:"Used"}),e("g",{children:e("text",{x:"100%",y:"100%",dx:-80,dy:-2,textAnchor:"right",fill:"var(--ac-global-text-color-500)",fontSize:"var(--ac-global-font-size-xs)",children:"* approximate"})})]})})}const Ku={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"GenerativeProvidersCard_data",selections:[{alias:null,args:null,concreteType:"GenerativeProvider",kind:"LinkedField",name:"modelProviders",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependenciesInstalled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependencies",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"apiKeyEnvVar",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"apiKeySet",storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};Ku.hash="0168d590171b96e7a2e41449a41754be";function hv({query:n}){const[a,t]=u.useState(null),l=xa(y=>y),i=xa(y=>y.setCredential),r=I.useFragment(Ku,n),o=u.useMemo(()=>[...r.modelProviders],[r]),d=u.useMemo(()=>[{header:"Name",accessorKey:"name",cell:({row:y})=>s(h,{direction:"row",alignItems:"center",gap:"size-100",children:[e($l,{provider:y.original.key,height:18}),y.original.name]})},{header:"Environment Variable",accessorKey:"apiKeyEnvVar",cell:({row:y})=>e(v,{children:y.original.apiKeyEnvVar})},{header:"configuration",accessorKey:"apiKeySet",cell:({row:y})=>y.original.dependenciesInstalled?l[y.original.key]?e(v,{color:"success",children:"local"}):y.original.apiKeySet?e(v,{color:"success",children:"configured on the server"}):e(v,{color:"text-700",children:"not configured"}):e(v,{color:"warning",children:"missing dependencies"})},{header:"",accessorKey:"id",cell:({row:y})=>e(h,{direction:"row",justifyContent:"end",gap:"size-100",width:"100%",children:e(A,{size:"S",leadingVisual:e(L,{svg:e(It,{})}),onPress:()=>{t(y.original)}})})}],[l]),c=Te({columns:d,data:o,getCoreRowModel:Pe(),getSortedRowModel:hn()}),p=c.getRowModel().rows;return s(Q,{title:"AI Providers",bodyStyle:{padding:0},variant:"compact",children:[s("table",{css:tn,children:[e("thead",{children:c.getHeaderGroups().map(y=>e("tr",{children:y.headers.map(m=>e("th",{colSpan:m.colSpan,children:m.isPlaceholder?null:e("div",{children:W(m.column.columnDef.header,m.getContext())})},m.id))},y.id))}),e("tbody",{children:p.map(y=>e("tr",{children:y.getVisibleCells().map(m=>e("td",{children:W(m.column.columnDef.cell,m.getContext())},m.id))},y.id))})]}),e(X,{type:"modal",isDismissable:!0,onDismiss:()=>t(null),children:a&&s(Z,{title:`Set ${a.name} API Key`,size:"S",children:[s(C,{padding:"size-200",children:[e(C,{paddingBottom:"size-100",children:s(v,{size:"XS",children:["Set the credentials for the ",a.name," API. These credentials will be stored entirely in your browser and will only be sent to the server during API requests."]})}),s(J,{onChange:y=>{i({provider:a.key,value:y})},value:l[a.key],type:"password",children:[e(G,{children:`${a.name} API Key`}),e(ne,{placeholder:`e.g. ${a.apiKeyEnvVar}`}),e(v,{slot:"description",children:"The API key will be stored locally in your browser"})]})]}),e(C,{paddingX:"size-200",paddingY:"size-100",borderTopWidth:"thin",borderColor:"light",children:e(h,{direction:"row",justifyContent:"end",gap:"size-100",children:e(A,{variant:"primary",size:"S",onPress:()=>{t(null)},children:"Set API Key"})})})]})})]})}const Tu={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UsersCardQuery",selections:[{args:null,kind:"FragmentSpread",name:"UsersTable_users"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"UsersCardQuery",selections:[{alias:null,args:null,concreteType:"UserConnection",kind:"LinkedField",name:"users",plural:!1,selections:[{alias:null,args:null,concreteType:"UserEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"user",args:null,concreteType:"User",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"authMethod",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},{alias:null,args:null,concreteType:"UserRole",kind:"LinkedField",name:"role",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"926faf98cad4bc437a919677347e277c",id:null,metadata:{},name:"UsersCardQuery",operationKind:"query",text:`query UsersCardQuery {
  ...UsersTable_users
}

fragment UsersTable_users on Query {
  users {
    edges {
      user: node {
        id
        email
        username
        createdAt
        authMethod
        profilePictureUrl
        role {
          name
        }
      }
    }
  }
}
`}};Tu.hash="2b3e260c950dd1a6a1a6883ff6fb78c4";const Pu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UserMutationPayload",kind:"LinkedField",name:"createUser",plural:!1,selections:[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"NewUserDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"NewUserDialogMutation",selections:a},params:{cacheID:"a9bf3794a5355d9d0e0a3acebe7f3809",id:null,metadata:{},name:"NewUserDialogMutation",operationKind:"mutation",text:`mutation NewUserDialogMutation(
  $input: CreateUserInput!
) {
  createUser(input: $input) {
    user {
      id
      email
    }
  }
}
`}}}();Pu.hash="97d1aefa41e8831e57b6bb0d1a078a7c";function kv({onNewUserCreated:n,onNewUserCreationError:a,onDismiss:t}){const[l,i]=I.useMutation(Pu),r=u.useCallback(o=>{l({variables:{input:{email:o.email,username:o.username,password:o.password,role:o.role}},onCompleted:d=>{n(d.createUser.user.email)},onError:d=>{a(d)}})},[l,n,a]);return e(X,{onDismiss:t,isDismissable:!0,type:"modal",isKeyboardDismissDisabled:!0,children:e(Z,{title:"Add user",children:e(Ig,{onSubmit:r,isSubmitting:i})})})}const Iu={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UsersTableQuery",selections:[{args:null,kind:"FragmentSpread",name:"UsersTable_users"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"UsersTableQuery",selections:[{alias:null,args:null,concreteType:"UserConnection",kind:"LinkedField",name:"users",plural:!1,selections:[{alias:null,args:null,concreteType:"UserEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"user",args:null,concreteType:"User",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"authMethod",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},{alias:null,args:null,concreteType:"UserRole",kind:"LinkedField",name:"role",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"d3f85064b63f026a47a8ef139638b933",id:null,metadata:{},name:"UsersTableQuery",operationKind:"query",text:`query UsersTableQuery {
  ...UsersTable_users
}

fragment UsersTable_users on Query {
  users {
    edges {
      user: node {
        id
        email
        username
        createdAt
        authMethod
        profilePictureUrl
        role {
          name
        }
      }
    }
  }
}
`}};Iu.hash="acd5e44c43deb927fea733697593c97d";const xu={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:[],operation:Iu}},name:"UsersTable_users",selections:[{alias:null,args:null,concreteType:"UserConnection",kind:"LinkedField",name:"users",plural:!1,selections:[{alias:null,args:null,concreteType:"UserEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"user",args:null,concreteType:"User",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"authMethod",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},{alias:null,args:null,concreteType:"UserRole",kind:"LinkedField",name:"role",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};xu.hash="acd5e44c43deb927fea733697593c97d";const Du=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],kind:"ScalarField",name:"deleteUsers",storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DeleteUserDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DeleteUserDialogMutation",selections:a},params:{cacheID:"00d3d0f3855e92e529bc446d0f426123",id:null,metadata:{},name:"DeleteUserDialogMutation",operationKind:"mutation",text:`mutation DeleteUserDialogMutation(
  $input: DeleteUsersInput!
) {
  deleteUsers(input: $input)
}
`}}}();Du.hash="a718ceab0ec0a7d461f6cd5e5b178a1f";function bv({userId:n,onDeleted:a,onClose:t}){const[l,i]=I.useMutation(Du),r=ke(),o=Fe(),d=u.useCallback(()=>{l({variables:{input:{userIds:[n]}},onCompleted:()=>{r({title:"User deleted",message:"User has been deleted."}),a(),t()},onError:c=>{const p=Ce(c);o({title:"Failed to delete user",message:(p==null?void 0:p[0])??c.message})}})},[l,o,r,t,a,n]);return s(Z,{title:"Delete User",isDismissable:!0,onDismiss:t,children:[e(C,{padding:"size-200",children:e(v,{color:"danger",children:"Are you sure you want to delete this user? This action cannot be undone."})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:s(h,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(A,{variant:"default",onPress:t,children:"Cancel"}),e(A,{variant:"danger",onPress:()=>{d()},isDisabled:i,children:"Delete user"})]})})]})}const _u=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UserMutationPayload",kind:"LinkedField",name:"patchUser",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ResetPasswordDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ResetPasswordDialogMutation",selections:a},params:{cacheID:"6ccff8dd53d97eeb41f656bcd2758da1",id:null,metadata:{},name:"ResetPasswordDialogMutation",operationKind:"mutation",text:`mutation ResetPasswordDialogMutation(
  $input: PatchUserInput!
) {
  patchUser(input: $input) {
    __typename
  }
}
`}}}();_u.hash="85b22da61ec094c28e97db2759622b69";const Oa=4;function Sv({userId:n,onClose:a}){const t=Fe(),l=ke(),[i,r]=I.useMutation(_u),{control:o,handleSubmit:d,formState:{isDirty:c}}=Ae({defaultValues:{newPassword:"",confirmPassword:""}}),p=u.useCallback(y=>{i({variables:{input:{userId:n,newPassword:y.newPassword}},onCompleted:()=>{l({title:"Password reset",message:"Users password has been reset."}),a()},onError:m=>{t({title:"Failed to reset password",message:m.message})}})},[i,t,l,a,n]);return e(Z,{title:"Reset Password",isDismissable:!0,onDismiss:a,children:e(Ye,{children:s(C,{padding:"size-200",children:[s(h,{direction:"column",gap:"size-100",children:[e(H,{name:"newPassword",control:o,rules:{required:"Password is required",minLength:{value:Oa,message:`Password must be at least ${Oa} characters`}},render:({field:{name:y,onChange:m,onBlur:g,value:f},fieldState:{invalid:k,error:b}})=>s(J,{isInvalid:k,onChange:m,name:y,onBlur:g,value:f.toString(),type:"password",id:"new-password",autoComplete:"new-password",children:[e(G,{children:"New Password"}),e(ne,{placeholder:"New password"}),b!=null&&b.message?e(ve,{children:b.message}):s(v,{slot:"description",children:["Password must be at least ",Oa," characters"]})]})}),e(H,{name:"confirmPassword",control:o,rules:{required:"Password is required",minLength:{value:Oa,message:`Password must be at least ${Oa} characters`},validate:(y,m)=>y===m.newPassword||"Passwords do not match"},render:({field:{name:y,onChange:m,onBlur:g,value:f},fieldState:{invalid:k,error:b}})=>s(J,{isInvalid:k,onChange:m,name:y,onBlur:g,value:f.toString(),type:"password",children:[e(G,{children:"Confirm Password"}),e(ne,{placeholder:"Repeat new password"}),b!=null&&b.message?e(ve,{children:b.message}):e(v,{slot:"description",children:"Repeat new password to confirm"})]})})]}),e(C,{paddingTop:"size-200",children:e(h,{direction:"row",gap:"size-100",justifyContent:"end",children:e(A,{variant:c?"primary":"default",type:"submit",isDisabled:r,onPress:()=>d(p)(),children:r?"Resetting...":"Reset Password"})})})]})})})}function vv(n){return n==="LOCAL"}function Cv(n){const{userId:a,onUserDeleted:t,authMethod:l}=n,[i,r]=u.useState(null),o=u.useCallback(()=>{r(e(bv,{userId:a,onClose:()=>r(null),onDeleted:()=>{t(),r(null)}}))},[a,t]),d=u.useCallback(()=>{r(e(Sv,{userId:a,onClose:()=>r(null)}))},[a]),c=u.useMemo(()=>{const p=e(re,{children:s(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(L,{svg:e(We,{})}),e(U,{children:"Delete"})]})},"deleteUser"),y=e(re,{children:s(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(L,{svg:e(qr,{})}),e(U,{children:"Reset Password"})]})},"resetPassword"),m=[p];return vv(l)&&m.push(y),m},[l]);return s("div",{onClick:p=>{p.preventDefault(),p.stopPropagation()},children:[e(wn,{align:"end","aria-label":"User Actions",buttonSize:"compact",onAction:p=>{switch(p){case"deleteUser":o();break;case"resetPassword":d();break}},children:c}),e(X,{type:"modal",isDismissable:!0,onDismiss:()=>r(null),children:i})]})}const Lu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UserMutationPayload",kind:"LinkedField",name:"patchUser",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"UserRoleChangeDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"UserRoleChangeDialogMutation",selections:a},params:{cacheID:"44e970c967f83a0b7a6bd1cbafc3a936",id:null,metadata:{},name:"UserRoleChangeDialogMutation",operationKind:"mutation",text:`mutation UserRoleChangeDialogMutation(
  $input: PatchUserInput!
) {
  patchUser(input: $input) {
    __typename
  }
}
`}}}();Lu.hash="468eff05b42e39b55f9aa5b9a7d2c483";function Fv({userId:n,email:a,currentRole:t,newRole:l,onRoleChanged:i,onClose:r}){const[o,d]=I.useMutation(Lu),c=ke(),p=Fe(),y=u.useCallback(()=>{o({variables:{input:{userId:n,newRole:l}},onCompleted:()=>{c({title:"Role Changed",message:"Users role has been changed."}),i(),r()},onError:m=>{p({title:"Failed to delete user",message:m.message})}})},[o,l,p,c,r,i,n]);return s(Z,{title:"Confirm role change",children:[e(C,{padding:"size-200",children:s(v,{children:[`Are you sure you want to change the role for ${a} from `," ",e("b",{children:gl(t)})," to"," ",e("b",{children:gl(l)}),"?"]})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:s(h,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(A,{onPress:r,size:"S",children:"Cancel"}),e(A,{variant:"primary",size:"S",onPress:()=>{y()},isDisabled:d,children:"Change role"})]})})]})}const Kv=55,Tv=K`
  text-decoration: none;
  color: var(--ac-global-color-grey-600);
  font-size: 12px;
  &:hover {
    text-decoration: underline;
  }
`,Pv=K`
  height: ${Kv}px;
`,Xi=n=>n.email==="admin@localhost"||n.username==="admin";function Iv({query:n}){const[a,t]=u.useState(null),[l,i]=I.useRefetchableFragment(xu,n),r=u.useMemo(()=>l.users.edges.map(({user:m})=>({id:m.id,email:m.email,username:m.username,profilePictureUrl:m.profilePictureUrl,createdAt:m.createdAt,role:m.role.name,authMethod:m.authMethod})),[l]),o=u.useCallback(()=>{u.startTransition(()=>{i({},{fetchPolicy:"network-only"})})},[i]),d=u.useMemo(()=>[{header:"user",accessorKey:"username",cell:({row:m})=>s(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(_l,{name:m.original.username,profilePictureUrl:m.original.profilePictureUrl,size:20}),e("span",{children:m.original.username}),e("a",{href:`mailto:${m.original.email}`,css:Tv,children:m.original.email})]})},{header:"method",accessorKey:"authMethod",size:10,cell:({row:m})=>m.original.authMethod.toLowerCase()},{header:"role",accessorKey:"role",cell:({row:m})=>Xi(m.original)?gl(m.original.role):e(Dg,{includeLabel:!1,onChange:g=>{g!==m.original.role&&t(e(Fv,{onClose:()=>t(null),onRoleChanged:o,currentRole:m.original.role,newRole:g,email:m.original.email,userId:m.original.id}))},role:xg(m.original.role)?m.original.role:void 0})},{header:"created at",accessorKey:"createdAt",cell:Me},{header:"",accessorKey:"id",size:10,cell:({row:m})=>Xi(m.original)?null:e(h,{direction:"row",justifyContent:"end",width:"100%",children:e(Cv,{userId:m.original.id,onUserDeleted:o,authMethod:m.original.authMethod})}),meta:{textAlign:"right"}}],[o]),c=Te({columns:d,data:r,getCoreRowModel:Pe(),getSortedRowModel:hn()}),p=c.getRowModel().rows,y=c.getRowModel().rows.length===0;return s("table",{css:tn,children:[e("thead",{children:c.getHeaderGroups().map(m=>e("tr",{children:m.headers.map(g=>e("th",{colSpan:g.colSpan,children:g.isPlaceholder?null:s("div",{className:g.column.getCanSort()?"cursor-pointer":"",onClick:g.column.getToggleSortingHandler(),style:{left:g.getStart(),width:g.getSize()},children:[W(g.column.columnDef.header,g.getContext()),g.column.getIsSorted()?e(L,{className:"sort-icon",svg:g.column.getIsSorted()==="asc"?e(sn,{}):e(rn,{})}):null]})},g.id))},m.id))}),y?e(ln,{}):e("tbody",{children:p.map(m=>e("tr",{css:Pv,children:m.getVisibleCells().map(g=>e("td",{children:W(g.column.columnDef.cell,g.getContext())},g.id))},m.id))}),e(X,{onDismiss:()=>t(null),isDismissable:!0,type:"modal",children:a})]})}function xv(){const[n,a]=u.useState(0),[t,l]=u.useState(null),i=ke(),r=Fe(),o=I.useLazyLoadQuery(Tu,{},{fetchKey:n,fetchPolicy:"store-and-network"});return s(Q,{title:"Users",variant:"compact",bodyStyle:{padding:0,overflowX:"auto"},extra:e(A,{onPress:()=>{l(e(kv,{onDismiss:()=>{l(null)},onNewUserCreated:d=>{l(null),i({title:"User added",message:`User ${d} has been added.`}),a(c=>c+1)},onNewUserCreationError:d=>{const c=Ce(d);r({title:"Error adding user",message:(c==null?void 0:c[0])??d.message})}}))},size:"S",leadingVisual:e(L,{svg:e(kn,{})}),children:"Add User"}),children:[e(u.Suspense,{fallback:e(C,{padding:"size-200",children:e(ge,{})}),children:e(Iv,{query:o})}),e(X,{onDismiss:()=>{l(null)},children:t})]})}const Dv=K`
  overflow-y: auto;
`,_v=K`
  padding: var(--ac-global-dimension-size-400);
  max-width: 1000px;
  min-width: 500px;
  box-sizing: border-box;
  width: 100%;
  margin-left: auto;
  margin-right: auto;
`,Lv=K`
  .ac-field {
    // Hacky solution to make the text fields fill the remaining space
    width: calc(100% - var(--ac-global-dimension-size-600));
  }
`;function W2(){const n=Be();return e("main",{css:Dv,children:e("div",{css:_v,children:s(h,{direction:"column",gap:"size-200",width:"100%",children:[s(h,{direction:"row",gap:"size-200",alignItems:"center",children:[e(C,{flex:"2",children:e(Q,{title:"Platform Settings",variant:"compact",children:s("form",{css:Lv,children:[s(h,{direction:"row",gap:"size-100",alignItems:"end",children:[s(J,{value:pl,isReadOnly:!0,children:[e(G,{children:"Hostname"}),e(ne,{}),e(v,{slot:"description",children:"Connect to Phoenix over HTTP"})]}),e(cl,{text:pl})]}),s(h,{direction:"row",gap:"size-100",alignItems:"end",children:[s(J,{value:ot,isReadOnly:!0,children:[e(G,{children:"Platform Version"}),e(ne,{}),e(v,{slot:"description",children:"The version of the Phoenix server"})]}),e(cl,{text:ot})]}),s(h,{direction:"row",gap:"size-100",alignItems:"end",justifyContent:"center",children:[s(J,{value:`pip install 'arize-phoenix==${ot}'`,isReadOnly:!0,children:[e(G,{children:"Python Version"}),e(ne,{}),e(v,{slot:"description",children:"The version of the Python client library to use to connect to this Phoenix"})]}),e(cl,{text:ot})]})]})})}),e(C,{flex:"1",children:e(Q,{title:"Database Usage",variant:"compact",children:e(fv,{query:n})})})]}),e(Br,{children:s(U,{children:[e(gv,{}),e(xv,{})]})}),e(hv,{query:n})]})})})}function cl(n){return e(C,{paddingBottom:"19px",flex:"none",children:e(ie,{text:n.text,size:"M"})})}const wu={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"settingsPageLoaderQuery",selections:[{args:null,kind:"FragmentSpread",name:"GenerativeProvidersCard_data"},{args:null,kind:"FragmentSpread",name:"DBUsagePieChart_data"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"settingsPageLoaderQuery",selections:[{alias:null,args:null,concreteType:"GenerativeProvider",kind:"LinkedField",name:"modelProviders",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependenciesInstalled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependencies",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"apiKeyEnvVar",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"apiKeySet",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DbTableStats",kind:"LinkedField",name:"dbTableStats",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"tableName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numBytes",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dbStorageCapacityBytes",storageKey:null}]},params:{cacheID:"57e864e0c3d3ad1ca6853bcc545b0b63",id:null,metadata:{},name:"settingsPageLoaderQuery",operationKind:"query",text:`query settingsPageLoaderQuery {
  ...GenerativeProvidersCard_data
  ...DBUsagePieChart_data
}

fragment DBUsagePieChart_data on Query {
  dbTableStats {
    tableName
    numBytes
  }
  dbStorageCapacityBytes
}

fragment GenerativeProvidersCard_data on Query {
  modelProviders {
    name
    key
    dependenciesInstalled
    dependencies
    apiKeyEnvVar
    apiKeySet
  }
}
`}};wu.hash="69a5a0039a171639cb4817f6d966030c";async function J2(){return await I.fetchQuery(he,wu,{}).toPromise()}const Yi=window.Config.basename,er={width:"100%",height:"100%",border:"none",backgroundColor:"white"};function Z2(){return s("div",{css:K`
        display: flex;
        flex-direction: column;
        flex: 1 1 auto;
        height: 100%;
        .ac-tabs {
          flex: 1 1 auto;
        }
        .ac-tabs__pane-container,
        .ac-tabs__pane-container > div {
          flex: 1 1 auto;
          height: 100%;
        }
      `,children:[e(pe,{variant:"info",banner:!0,icon:e(L,{svg:e(_g,{})}),children:"These APIs are under active development and are subject to change."}),s(He,{children:[e(ae,{name:"REST",children:({isSelected:n})=>n&&e("iframe",{src:`${Yi}/docs`,style:er})}),e(ae,{name:"GraphQL",children:({isSelected:n})=>n&&e("iframe",{src:`${Yi}/graphql`,style:er})})]})]})}function Ht({children:n}){return s("main",{css:K`
        padding-top: 200px;
        width: 100%;
        height: 100vh;
        overflow: hidden;
        background: radial-gradient(
          90% 60% at 50% 30%,
          rgba(5, 145, 193, 0.4) 0%,
          transparent 100%
        );
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        box-sizing: border-box;
      `,children:[e(C,{borderColor:"light",borderWidth:"thin",width:"size-5000",padding:"size-400",backgroundColor:"dark",marginStart:"auto",marginEnd:"auto",borderRadius:"medium",overflow:"auto",children:n}),s("footer",{css:K`
          display: flex;
          justify-content: center;
          padding: var(--ac-global-dimension-size-400);
          gap: var(--ac-global-dimension-size-200);
          a {
            color: var(--ac-global-text-color-700);
            transition: color 0.2s ease-in-out;
            text-decoration: none;
            &:hover {
              color: var(--ac-global-text-color-900);
              text-decoration: underline;
            }
          }
        `,children:[e("a",{href:"https://docs.arize.com/phoenix",children:"Documentation"}),"|",e("a",{href:"https://join.slack.com/t/arize-ai/shared_invite/zt-1px8dcmlf-fmThhDFD_V_48oU7ALan4Q",children:"Community"}),"|",e("a",{href:"https://twitter.com/ArizePhoenix",children:"Social"}),"|",e("a",{href:"https://github.com/Arize-ai/phoenix",children:"GitHub"}),"|",e("a",{href:"https://github.com/Arize-ai/phoenix/releases",children:`arize-phoenix v${window.Config.platformVersion}`})]})]})}function wv(n){const a=le(),{initialError:t,onSubmit:l}=n,[i,r]=u.useState(t),[o,d]=u.useState(!1),c=u.useCallback(async m=>{l==null||l(),r(null),d(!0);try{const f=await fetch(mn("/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)});if(!f.ok){const k=f.status===429?"Too many requests. Please try again later.":"Invalid login";r(k);return}}catch{r("Invalid login");return}finally{d(()=>!1)}const g=Lg();a(g)},[a,l,r]),{control:p,handleSubmit:y}=Ae({defaultValues:{email:"",password:""}});return s(U,{children:[i?s(C,{paddingBottom:"size-100",children:[e(pe,{variant:"danger",children:i})," "]}):null,e(Ye,{children:s(h,{direction:"column",gap:"size-100",children:[e(H,{name:"email",control:p,render:({field:{onChange:m,value:g}})=>s(J,{name:"email",isRequired:!0,type:"email",onChange:m,value:g,autoComplete:"email",children:[e(G,{children:"Email"}),e(ne,{placeholder:"your email address"})]})}),s("div",{css:K`
              position: relative;
              a {
                position: absolute;
                float: right;
                right: 0;
                top: var(--ac-global-dimension-size-50);
                font-size: 12px;
              }
            `,children:[e(H,{name:"password",control:p,render:({field:{onChange:m,value:g}})=>s(J,{name:"password",type:"password",isRequired:!0,onChange:m,value:g,onKeyDown:f=>{f.key==="Enter"&&y(c)()},autoComplete:"password",children:[e(G,{children:"Password"}),e(ne,{placeholder:"your password"})]})}),e(Oe,{to:"/forgot-password",children:"Forgot your password?"})]}),e(A,{variant:"primary",isDisabled:o,leadingVisual:o?e(L,{svg:e(je,{})}):void 0,onPress:()=>y(c)(),children:o?"Logging In":"Log In"})]})})]})}const Ev=K`
  button {
    width: 100%;
  }
  i {
    display: block;
    width: 20px;
    height: 20px;
    padding-right: var(--ac-global-dimension-size-50);
  }
  &[data-provider^="aws"],
  &[data-provider^="google"] {
    button {
      background-color: white;
      color: black;
      &:hover {
        background-color: #ececec !important;
      }
    }
  }
`;function Mv({idpName:n,idpDisplayName:a,returnUrl:t}){return e("form",{action:mn(`/oauth2/${n}/login${t?`?returnUrl=${t}`:""}`),method:"post",css:Ev,"data-provider":n,children:s(A,{variant:"default",type:"submit",leadingVisual:e(Vv,{idpName:n}),children:["Login with ",a]})})}function Vv({idpName:n}){return n==="github"||n==="google"||n==="microsoft_entra_id"||n.startsWith("aws")?e("i",{children:e("div",{css:K`
          display: inline-block;
          width: 20px;
          height: 20px;
          position: relative;
          background-size: contain;
          background-repeat: no-repeat;
          background-position: 50%;
          &[data-provider^="github"] {
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg width='20' height='20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 0C4.477 0 0 4.36 0 9.74c0 4.304 2.865 7.955 6.839 9.243.5.09.682-.211.682-.47 0-.23-.008-.843-.013-1.656-2.782.588-3.369-1.306-3.369-1.306-.454-1.125-1.11-1.425-1.11-1.425-.908-.604.069-.592.069-.592 1.003.069 1.531 1.004 1.531 1.004.892 1.488 2.341 1.059 2.91.81.092-.63.35-1.06.636-1.303-2.22-.245-4.555-1.081-4.555-4.814 0-1.063.39-1.933 1.029-2.613-.103-.247-.446-1.238.098-2.578 0 0 .84-.262 2.75.998A9.818 9.818 0 0 1 10 4.71c.85.004 1.705.112 2.504.328 1.909-1.26 2.747-.998 2.747-.998.546 1.34.203 2.331.1 2.578.64.68 1.028 1.55 1.028 2.613 0 3.742-2.339 4.566-4.566 4.807.359.3.678.895.678 1.804 0 1.301-.012 2.352-.012 2.671 0 .261.18.564.688.47C17.137 17.69 20 14.042 20 9.74 20 4.36 15.522 0 10 0z' fill='%23161514' fill-rule='evenodd'/%3E%3C/svg%3E");
          }

          &[data-provider^="google"] {
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 48 48'%3E%3Cdefs%3E%3Cpath id='a' d='M44.5 20H24v8.5h11.8C34.7 33.9 30.1 37 24 37c-7.2 0-13-5.8-13-13s5.8-13 13-13c3.1 0 5.9 1.1 8.1 2.9l6.4-6.4C34.6 4.1 29.6 2 24 2 11.8 2 2 11.8 2 24s9.8 22 22 22c11 0 21-8 21-22 0-1.3-.2-2.7-.5-4z'/%3E%3C/defs%3E%3CclipPath id='b'%3E%3Cuse xlink:href='%23a' overflow='visible'/%3E%3C/clipPath%3E%3Cpath clip-path='url(%23b)' fill='%23FBBC05' d='M0 37V11l17 13z'/%3E%3Cpath clip-path='url(%23b)' fill='%23EA4335' d='M0 11l17 13 7-6.1L48 14V0H0z'/%3E%3Cpath clip-path='url(%23b)' fill='%2334A853' d='M0 37l30-23 7.9 1L48 0v48H0z'/%3E%3Cpath clip-path='url(%23b)' fill='%234285F4' d='M48 48L17 24l-4-3 35-10z'/%3E%3C/svg%3E");
          }
          &[data-provider^="microsoft"] {
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='21' height='21'%3E%3Cpath fill='%23f25022' d='M1 1h9v9H1z'/%3E%3Cpath fill='%2300a4ef' d='M1 11h9v9H1z'/%3E%3Cpath fill='%237fba00' d='M11 1h9v9h-9z'/%3E%3Cpath fill='%23ffb900' d='M11 11h9v9h-9z'/%3E%3C/svg%3E");
          }
          &[data-provider^="aws"] {
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg width='400' height='334' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M236.578 94.824c-9.683.765-20.854 1.502-32.021 3.006-17.12 2.211-34.24 5.219-48.386 11.907-27.544 11.208-46.163 35.053-46.163 70.114 0 44.018 28.298 66.354 64.026 66.354 11.93 0 21.606-1.466 30.522-3.71 14.156-4.481 26.07-12.67 40.209-27.596 8.192 11.205 10.413 16.428 24.575 28.338 3.725 1.502 7.448 1.502 10.413-.742 8.932-7.458 24.561-20.873 32.773-28.33 3.71-3.012 2.955-7.463.739-11.204-8.198-10.435-16.381-19.401-16.381-39.506V96.324c0-28.359 2.214-54.453-18.614-73.822C261.147 6.815 234.34.86 213.5.86h-8.947c-37.965 2.247-78.169 18.635-87.122 65.629-1.462 5.955 3.012 8.198 5.989 8.962l41.677 5.224c4.471-.773 6.691-4.491 7.432-8.233 3.74-16.388 17.136-24.583 32.024-26.087h2.998c8.905 0 18.586 3.743 23.813 11.168 5.932 8.965 5.21 20.904 5.21 31.339v5.961h.004v.001zm0 43.278c0 17.162.723 30.571-8.195 45.461-5.208 10.437-14.141 17.154-23.827 19.4-1.481 0-3.698.766-5.947.766-16.371 0-26.077-12.673-26.077-31.334 0-23.856 14.159-35.056 32.023-40.277 9.687-2.241 20.86-2.982 32.021-2.982v8.966h.002z'/%3E%3Cpath d='M373.71 315.303c18.201-15.398 25.89-43.349 26.29-57.939v-2.44c0-3.255-.803-5.661-1.6-6.88-3.646-4.445-30.369-8.523-53.402-1.627-6.468 2.045-12.146 4.865-17.396 8.507-4.051 2.854-3.238 6.464.802 6.08 4.447-.823 10.126-1.208 16.594-2.048 14.159-1.18 30.742-1.592 34.784 3.662 5.642 6.87-6.468 36.868-11.749 49.838-1.593 4.065 2.03 5.696 5.677 2.847z' fill='%23FE9900'/%3E%3Cpath d='M2.008 257.364c52.17 47.404 120.925 75.775 197.791 75.775 47.725 0 102.727-13.381 145.199-38.899 5.676-3.27 11.316-6.912 16.565-10.952 7.286-5.25.817-13.38-6.463-10.147-3.229 1.215-6.873 2.857-10.103 4.066-46.539 18.248-95.441 26.76-140.762 26.76-72.008 0-141.56-19.87-197.786-52.684-5.259-2.822-8.907 2.428-4.441 6.081z' fill='%23FE9900'/%3E%3C/svg%3E");
          }
        `,"data-provider":n})}):null}function gi(){return s("svg",{width:"253",height:"63",viewBox:"0 0 682 169",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[s("g",{clipPath:"url(#clip0_290_1904)",children:[e("path",{d:"M147.458 105.593C147.022 103.63 146.028 101.824 144.492 100.222C143.901 99.6064 143.244 99.0233 142.529 98.4978C142.184 98.2432 141.815 98.005 141.437 97.7669C140.969 97.4712 140.484 97.192 139.95 96.921C137.995 95.9191 136.328 94.909 134.866 93.825C134.274 93.3897 133.699 92.9299 133.157 92.4535C131.851 91.312 130.972 90.3348 130.315 89.3C130.102 88.9715 129.913 88.6102 129.732 88.2653C129.658 88.1175 129.543 87.9943 129.412 87.8957C129.173 87.7233 128.869 87.6494 128.565 87.6986C128.097 87.789 127.736 88.1667 127.678 88.6431C127.637 89.0126 127.637 89.4068 127.687 89.8092C127.719 90.0474 127.588 90.2773 127.366 90.3758C127.317 90.4005 127.259 90.4087 127.21 90.4169C126.898 90.4498 126.619 90.6222 126.438 90.885C126.257 91.1478 126.208 91.4681 126.282 91.7719C126.348 92.0347 126.438 92.2236 126.512 92.3714L126.578 92.5028C126.627 92.5931 126.676 92.6917 126.726 92.782C126.873 93.0612 127.021 93.3405 127.202 93.6033C127.547 94.1042 127.933 94.6052 128.393 95.1389C128.541 95.3114 128.565 95.5578 128.459 95.7549C128.352 95.952 128.13 96.0669 127.908 96.0341C125.321 95.681 122.996 95.0979 120.836 94.3013C120.59 94.211 120.335 94.1206 120.097 94.0221C118.158 93.2009 121.658 89.7189 123.259 87.247C130.282 76.4479 131.736 64.0802 131.794 51.5647C131.851 39.4681 130.545 27.5357 128.138 15.7593V15.7429C126.569 5.87173 125.239 2.168 124.401 0.796558C124.22 0.435219 124.023 0.205276 123.818 0.0985162C123.588 -0.0575166 123.465 0.0163937 123.465 0.0163937C123.013 0.0328182 122.495 0.435219 121.871 1.08399C119.251 3.83509 119.399 7.11178 120.122 10.5363C123.432 26.0903 125.921 41.7346 124.787 57.7157C124.007 68.7365 121.953 79.3468 114.248 87.9779C113.789 88.4952 113.287 88.9798 112.786 89.4725C112.211 90.0391 111.316 91.1396 110.651 90.6797C109.764 90.0638 110.552 88.7991 110.831 88.1421C115.341 77.5729 116.639 66.5275 115.949 55.1453C115.932 54.8825 115.908 54.6197 115.891 54.3569V54.3405C115.883 54.1269 115.858 53.9298 115.842 53.7245C115.727 52.2217 115.587 50.7189 115.398 49.2242C113.46 31.1655 111.127 29.9911 111.127 29.9911C110.971 29.8515 110.782 29.7448 110.528 29.6955C109.304 29.4409 108.638 30.5167 108.096 31.3297C105.648 34.9924 106.733 38.8932 107.521 42.753C110.289 56.2703 110.33 69.6645 105.583 82.8124C105.147 84.0113 104.63 85.1775 104.08 86.3272C103.496 87.5508 103.119 89.0783 101.131 88.4213C99.2662 87.8054 99.7918 86.3929 100.03 85.1036C100.654 81.8269 101.155 78.542 101.467 75.2489V75.2653C101.509 74.9368 101.525 74.6247 101.55 74.3127C101.599 73.746 101.632 73.1712 101.665 72.6045C101.689 72.1282 101.714 71.6601 101.739 71.2002C101.747 70.9621 101.763 70.7321 101.763 70.494C102.141 60.0562 100.383 55.3095 99.7179 53.9052C99.644 53.7328 99.5619 53.5767 99.4715 53.4371C98.7815 52.4024 97.6398 52.5256 96.6541 53.5028C94.8388 55.2931 93.8367 57.4118 94.2967 60.0808C95.6438 67.8496 94.8552 75.5445 93.4096 83.1983C93.2124 84.2249 92.7524 86.0973 90.5593 85.6127C89.0644 85.2842 88.7194 84.6437 88.6372 83.3461C88.6537 82.3689 88.6372 81.3916 88.6044 80.4144C88.6044 80.3897 88.6044 80.3651 88.6044 80.3405C88.6044 80.2009 88.588 80.0612 88.588 79.9299C88.588 79.8559 88.5797 79.7902 88.5715 79.7245C88.5058 78.3942 88.399 77.0556 88.2347 75.717C88.2183 75.5856 88.1937 75.4624 88.1773 75.331C87.3394 67.7921 86.247 67.0612 86.247 67.0612C85.5488 66.1497 84.4563 66.3057 83.5117 67.2419C81.6964 69.0322 80.7764 71.1427 81.1543 73.8199C81.4336 75.7745 81.3596 75.175 81.5568 76.8831C81.7128 77.7618 81.8771 79.3632 81.8935 79.8724C81.8525 80.324 81.7375 80.7182 81.4582 81.0139C80.53 82.0076 79.0351 80.9892 77.9015 80.5211C55.9209 71.4302 37.1108 58.6683 20.691 42.523C14.2513 35.945 3.25273 22.6329 3.25273 22.6329C2.84203 22.1566 2.33276 21.8856 1.55243 22.2223C0.114982 22.8383 0.156052 24.6778 0.0246278 26.2217C-0.23822 29.3177 1.42101 31.5597 3.21987 33.662C28.0179 62.5856 58.2783 83.3708 94.8059 93.7675L101.377 95.5085C101.451 95.5249 101.533 95.5496 101.607 95.566C101.624 95.566 101.632 95.566 101.64 95.5742L107.299 97.077L107.456 97.1181C107.267 97.1756 107.061 97.2167 106.839 97.2577C100.613 98.4895 88.2923 96.223 78.3944 93.9153C73.4988 92.8888 68.6854 91.6405 63.9788 90.1541C63.7653 90.0884 63.642 90.0556 63.642 90.0556C45.3577 84.2331 28.6093 74.7972 13.9556 60.4093C12.5674 59.0461 11.286 57.5761 10.0211 56.0897C8.86289 54.71 6.47262 51.8275 5.643 50.8338C5.55265 50.7024 5.45408 50.5875 5.35551 50.4807C5.10909 50.2261 4.80517 50.0619 4.36983 50.1604C3.3513 50.3986 3.05559 51.4498 2.86667 52.3367C2.1192 55.9008 3.25273 58.8983 5.65122 61.5755C20.6582 78.3942 39.4929 89.1358 60.6439 96.1819C72.6528 100.181 85.0067 102.612 97.6069 104.164C90.0911 106.595 82.3617 107.334 74.5667 107.137C59.4775 106.759 45.3248 103.138 32.0264 96.6746C27.1226 94.1535 22.5556 91.3449 21.3564 90.5894C20.6664 90.1213 19.9518 89.8338 19.2454 90.3758C17.9229 91.4024 18.8347 93.2009 19.2618 94.6051C20.075 97.307 21.956 99.1712 24.3956 100.46C46.0641 111.917 68.9401 116.499 93.2946 112.434C95.7588 112.023 98.0998 111.572 100.679 110.701C96.6048 114.224 91.89 116.524 86.9369 118.339C71.6835 123.915 56.5287 123.693 41.4314 119.915C36.5851 118.618 30.9668 116.507 30.9668 116.507C30.1536 116.154 29.3486 116.031 28.7243 116.926C27.6237 118.503 28.5847 120.145 29.5375 121.632C31.7882 125.138 36.1416 125.483 39.5832 126.674C40.7578 127.052 37.5544 129.187 36.5276 129.975C31.5335 133.794 26.6462 137.284 21.6767 140.98L18.424 143.378C17.8654 143.764 17.3726 144.199 17.6272 145.004C17.9229 145.915 18.8675 146.08 19.7875 146.268C23.3442 147.008 26.3833 145.825 29.1925 143.723C35.2134 139.214 41.3493 134.837 47.2387 130.156C49.4811 128.374 51.5182 128.522 54.582 129.31C46.9183 135.083 39.7475 140.495 32.5685 145.899C25.2827 151.376 17.9969 156.854 10.711 162.323L5.89764 165.888C5.82371 165.937 5.758 165.986 5.69229 166.044L5.61836 166.093C5.20766 166.421 4.90374 166.791 4.9941 167.267C5.19123 168.351 6.4644 168.622 7.50758 168.803C11.8117 169.542 14.4813 167.924 17.4219 165.715C32.1496 154.661 46.9266 143.682 61.5721 132.521C64.8577 130.016 68.2337 128.604 72.9731 129.138C68.9401 132.152 65.0631 135.051 61.2436 137.908L50.8611 145.587C50.7871 145.636 50.7132 145.694 50.6475 145.751C50.0972 146.186 49.7111 146.695 49.9247 147.451C50.3189 148.822 51.97 148.987 53.3745 149.2C55.9537 149.586 58.1387 148.675 60.1675 147.164C61.3339 146.293 62.5085 145.439 63.6831 144.593L79.5361 132.004C79.5361 132.004 83.2817 129.327 87.6187 126.871C88.0048 126.633 88.3908 126.387 88.7851 126.148C88.9494 126.075 89.3601 125.886 89.9843 125.59C90.4525 125.352 90.9207 125.114 91.3807 124.892C92.0625 124.547 92.851 124.128 93.7381 123.644C96.2927 122.584 103.611 119.168 109.657 112.73C112.532 110.512 116.581 107.613 119.735 106.217H119.752C119.99 106.111 120.228 106.012 120.458 105.93C120.458 105.93 120.475 105.93 120.483 105.922C120.639 105.864 120.787 105.815 120.935 105.766L121.337 105.61C122.479 105.289 124.335 105.166 124.582 107.679C124.623 108.295 124.615 108.927 124.541 109.593C124.491 110.093 124.393 110.627 124.319 111.054C124.245 111.465 124.417 111.876 124.746 112.122C124.795 112.163 124.853 112.196 124.91 112.22C125.346 112.434 125.871 112.335 126.2 111.974C126.323 111.834 126.446 111.703 126.569 111.572C128.122 109.937 129.699 108.804 131.375 108.114C133.822 107.104 136.303 107.096 138.94 108.106C140.197 108.582 141.379 109.239 142.554 110.102C143.055 110.471 143.556 110.882 144.057 111.334C144.353 111.605 144.648 111.9 144.911 112.163L144.952 112.204L145.166 112.418C145.166 112.418 145.248 112.491 145.289 112.524C145.536 112.705 145.856 112.779 146.168 112.713C146.529 112.631 146.825 112.376 146.957 112.032C146.981 111.966 147.006 111.9 147.031 111.834C147.778 109.617 147.934 107.581 147.499 105.593H147.458Z",fill:"url(#paint0_linear_290_1904)"}),e("path",{d:"M120.113 94.0303C120.195 94.0632 120.269 94.096 120.351 94.1207C120.269 94.0878 120.187 94.0632 120.113 94.0303Z",fill:"#FEDBB5"}),e("path",{d:"M111.283 87.1238C111.283 87.1238 111.267 87.1567 111.267 87.1731C111.267 87.1567 111.283 87.1402 111.283 87.1238Z",fill:"#FEDBB5"}),e("path",{d:"M123.383 87.1074C123.383 87.1074 123.358 87.1487 123.341 87.1652C123.358 87.1487 123.366 87.1239 123.383 87.1074Z",fill:"#FEDBB5"}),e("path",{d:"M104.104 86.3354C103.965 86.6229 103.841 86.9267 103.71 87.2142C103.85 86.9267 103.973 86.6229 104.104 86.3354Z",fill:"#FEDBB5"}),e("path",{d:"M89.0233 84.7422C89.0233 84.7422 89.0233 84.7505 89.0316 84.7588C89.0316 84.7588 89.0316 84.7505 89.0233 84.7422Z",fill:"#FEDBB5"}),e("path",{d:"M89.0644 84.7998C89.1876 84.964 89.3437 85.1118 89.5408 85.235C89.3437 85.1118 89.1876 84.9722 89.0644 84.7998ZM89.0644 84.7833C89.0644 84.7833 89.0644 84.7833 89.0644 84.7915C89.0644 84.7915 89.0644 84.7915 89.0644 84.7833ZM89.0562 84.7751C89.0562 84.7751 89.0562 84.7751 89.0562 84.7833C89.0562 84.7833 89.0562 84.7833 89.0562 84.7751ZM88.6947 83.3626C88.6947 83.3626 88.6947 83.3708 88.6947 83.379C88.6947 83.379 88.6947 83.3708 88.6947 83.3626ZM79.1665 81.0878C79.1665 81.0878 79.1829 81.0878 79.1829 81.096C79.6429 81.2931 80.1029 81.4492 80.53 81.4492C80.7107 81.4492 80.8832 81.4245 81.0393 81.3588C80.875 81.4245 80.7025 81.4492 80.53 81.4492C80.0947 81.4492 79.6265 81.2849 79.1665 81.0878ZM88.629 79.6507C88.629 79.6507 88.629 79.6507 88.629 79.6589C88.629 79.6589 88.629 79.6589 88.629 79.6507Z",fill:"#E5B4A6"}),e("path",{d:"M120.36 94.1206C120.36 94.1206 120.434 94.1535 120.475 94.1617C120.475 94.1617 120.401 94.1289 120.36 94.1206ZM110.273 89.8749C110.273 90.187 110.38 90.4662 110.684 90.6797C110.79 90.7536 110.905 90.7865 111.029 90.7865C111.209 90.7865 111.398 90.7126 111.595 90.5894C111.406 90.7126 111.218 90.7865 111.029 90.7865C110.905 90.7865 110.79 90.7536 110.684 90.6797C110.38 90.4744 110.273 90.187 110.273 89.8749ZM110.914 88.0189C110.914 88.0189 110.881 88.1011 110.864 88.1421C110.881 88.1011 110.897 88.06 110.914 88.0189ZM111.226 87.2798C111.127 87.5262 111.02 87.7726 110.914 88.0189C111.02 87.7726 111.119 87.5262 111.226 87.2798ZM111.267 87.1731C111.267 87.1731 111.234 87.2388 111.226 87.2798C111.242 87.247 111.259 87.2141 111.267 87.1731ZM123.341 87.1731C123.341 87.1731 123.341 87.1813 123.333 87.1895C123.333 87.1895 123.333 87.1813 123.341 87.1731ZM123.391 87.0992C123.391 87.0992 123.391 87.1074 123.382 87.1156C123.382 87.1156 123.382 87.1074 123.391 87.0992ZM111.308 87.0992C111.308 87.0992 111.3 87.132 111.291 87.1402C111.291 87.1238 111.3 87.1074 111.308 87.0992ZM99.8001 86.7707C99.8001 87.4769 100.079 88.0928 101.155 88.446C101.484 88.5527 101.771 88.602 102.026 88.602C102.93 88.602 103.365 87.9615 103.71 87.2306C103.357 87.9697 102.921 88.602 102.026 88.602C101.78 88.602 101.492 88.5527 101.155 88.446C100.088 88.0928 99.8001 87.4769 99.8001 86.7707ZM92.7689 84.9886C92.4486 85.4074 91.9722 85.7195 91.2575 85.7195C91.1836 85.7195 91.1097 85.7195 91.0358 85.7113C91.1097 85.7113 91.1836 85.7195 91.2575 85.7195C91.9722 85.7195 92.4486 85.4157 92.7689 84.9886ZM106.651 79.7081C106.651 79.7081 106.651 79.7081 106.642 79.7081C106.322 80.7511 105.985 81.8023 105.616 82.8452C105.993 81.8023 106.338 80.7593 106.659 79.7081M94.1571 79.1251C93.9846 80.2748 93.7875 81.4163 93.5739 82.566C93.7875 81.4245 93.9846 80.2748 94.1571 79.1251ZM122.191 73.6311C120.623 78.7884 118.175 83.65 114.29 88.0025C113.83 88.5199 113.329 89.0044 112.828 89.4972C113.329 89.0126 113.821 88.5199 114.29 88.0025C118.175 83.65 120.623 78.7884 122.2 73.6311",fill:"#E5B4A6"}),e("path",{opacity:"0.4",d:"M2.20136 22.0745C2.00423 22.0745 1.79066 22.1238 1.55246 22.2223C0.53392 22.6658 0.254644 23.7252 0.139648 24.8503C5.61017 32.0196 27.213 58.4548 61.1943 76.5875C61.1943 76.5875 94.4692 94.1453 127.933 96.0423C125.346 95.6892 123.021 95.1061 120.861 94.3095C120.729 94.2602 120.606 94.2192 120.475 94.1699C108.318 91.542 97.9519 88.2571 90.6168 85.6292C90.7565 85.662 90.8961 85.6784 91.0193 85.6949C90.8879 85.6867 90.7401 85.662 90.5922 85.6292C90.1486 85.5306 89.8037 85.4074 89.5408 85.2432C83.7417 83.1244 80.0454 81.4984 79.1583 81.096C78.7312 80.9153 78.3123 80.6936 77.9344 80.5376C55.9538 71.4466 37.1437 58.6848 20.7239 42.5395C14.2513 35.945 3.25275 22.633 3.25275 22.633C2.97348 22.3045 2.6367 22.0745 2.20136 22.0745Z",fill:"url(#paint1_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M4.62448 50.1358C4.55056 50.1358 4.46842 50.144 4.37806 50.1687C3.35953 50.4068 3.06382 51.458 2.8749 52.3449C2.84204 52.5009 2.80919 52.6652 2.78455 52.8212C19.7711 75.832 42.5732 85.235 42.5732 85.235C65.3341 95.952 84.0128 98.12 95.3892 98.12C100.096 98.12 103.554 97.7505 105.533 97.463C104.63 97.5616 103.636 97.6109 102.568 97.6109C95.8984 97.6109 86.362 95.7795 78.4026 93.9235C73.5071 92.897 68.6937 91.6488 63.987 90.1623C63.7735 90.0966 63.6503 90.0638 63.6503 90.0638C45.3659 84.2413 28.6176 74.8054 13.9638 60.4175C12.5756 59.0543 11.2942 57.5843 10.0293 56.0979C8.87112 54.7182 6.48084 51.8357 5.65123 50.8421C5.56088 50.7107 5.46231 50.5957 5.36374 50.4889C5.16661 50.2836 4.9284 50.1358 4.62448 50.1358Z",fill:"url(#paint2_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M20.0669 90.1049C19.7958 90.1049 19.5247 90.187 19.2537 90.4005C18.1037 91.2874 18.6458 92.7738 19.0812 94.0632C27.5991 99.2287 47.132 109.289 70.2626 109.289C79.0023 109.289 88.243 107.86 97.607 104.189C90.8469 106.382 83.9061 107.195 76.9077 107.195C76.1274 107.195 75.3471 107.186 74.5667 107.162C59.4776 106.784 45.3249 103.162 32.0264 96.6993C27.1227 94.1781 22.5557 91.3695 21.3565 90.614C20.9293 90.3266 20.5022 90.1049 20.0669 90.1049Z",fill:"url(#paint3_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M99.1759 111.949C95.4632 114.791 91.2987 116.762 86.937 118.355C78.7559 121.344 70.5994 122.666 62.4675 122.666C55.4363 122.666 48.4298 121.681 41.4315 119.932C36.5852 118.634 30.9668 116.524 30.9668 116.524C30.6136 116.368 30.2604 116.261 29.9237 116.261C29.4883 116.261 29.0776 116.442 28.7326 116.951C28.2234 117.682 28.1577 118.429 28.3219 119.168C33.6939 121.665 45.2181 126.099 59.2723 126.099C71.4536 126.099 85.5406 122.765 99.1759 111.949Z",fill:"url(#paint4_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M62.9356 129.368C49.7358 129.368 39.7557 126.699 38.4908 126.346C38.8604 126.452 39.2218 126.567 39.5833 126.69C40.7579 127.068 37.5544 129.203 36.5276 129.992C32.8396 132.817 29.2008 135.461 25.5537 138.138H36.7576C40.2897 135.527 43.8052 132.907 47.2387 130.172C48.5119 129.154 49.7275 128.768 51.0993 128.768C52.1342 128.768 53.2678 128.99 54.582 129.335C46.9184 135.108 39.7475 140.52 32.5685 145.924C28.3711 149.077 24.1738 152.231 19.9764 155.384H31.246C41.3821 147.804 51.51 140.216 61.5721 132.546C63.8967 130.78 66.2623 129.557 69.1208 129.179C67.0016 129.318 64.9316 129.376 62.9439 129.376L62.9356 129.368Z",fill:"url(#paint5_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M60.5782 138.409H71.47L79.5115 132.02C79.5115 132.02 83.2571 129.343 87.5941 126.888C87.9801 126.649 88.3662 126.403 88.7605 126.165C88.9248 126.091 89.3354 125.902 89.9597 125.606C90.4279 125.368 90.8961 125.13 91.3561 124.908C92.0625 124.547 92.8921 124.112 93.8121 123.603C86.0499 126.855 78.0987 128.44 70.739 129.056C70.8375 129.056 70.9443 129.056 71.0429 129.056C71.6589 129.056 72.2996 129.088 72.965 129.162C68.9319 132.176 65.0549 135.075 61.2354 137.933L60.5782 138.418V138.409Z",fill:"url(#paint6_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M88.6701 83.3544C88.6865 82.3771 88.6701 81.3999 88.6373 80.4226V80.3487C88.6373 80.2091 88.6208 80.0695 88.6208 79.9381L88.6044 79.7328C88.5633 78.9115 88.4976 78.0903 88.4237 77.2609C85.8281 76.1687 83.3803 74.7726 81.1215 73.1301C81.1379 73.3601 81.1461 73.59 81.179 73.8364C81.4582 75.7909 81.3843 75.1914 81.5814 76.8995C81.7375 77.7783 81.9018 79.3797 81.9182 79.8888C81.8771 80.3405 81.7621 80.7347 81.4829 81.0303C81.1954 81.3342 80.8586 81.4491 80.4972 81.4491C80.0619 81.4491 79.5937 81.2849 79.1337 81.0878C79.9961 81.4738 83.7007 83.108 89.5408 85.2432C88.9165 84.8572 88.7194 84.2742 88.6619 83.3626L88.6701 83.3544Z",fill:"url(#paint7_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M131.022 64.885C128.59 68.2685 125.6 71.2331 122.175 73.6146C120.606 78.7719 118.158 83.6336 114.273 87.9861C113.813 88.5035 113.312 88.988 112.811 89.4807C112.326 89.9488 111.628 90.8029 111.02 90.8029C110.897 90.8029 110.782 90.77 110.675 90.6961C109.788 90.0802 110.577 88.8155 110.856 88.1585C112.31 84.7505 113.427 81.2931 114.257 77.7865C111.825 78.698 109.271 79.3386 106.634 79.6999C106.314 80.7429 105.977 81.794 105.607 82.837C105.172 84.036 104.655 85.2021 104.104 86.3518C103.62 87.3702 103.275 88.602 102.018 88.602C101.771 88.602 101.484 88.5527 101.147 88.446C99.2827 87.83 99.8084 86.4175 100.047 85.1282C100.367 83.4201 100.663 81.7119 100.909 79.9956C98.5927 79.9217 96.3256 79.626 94.1325 79.1168C93.9271 80.4883 93.6889 81.8515 93.4261 83.2148C93.2536 84.1263 92.8675 85.7113 91.2412 85.7113C91.044 85.7113 90.8305 85.6867 90.6005 85.6374C97.9356 88.2735 108.293 91.5584 120.458 94.1863C120.335 94.1371 120.22 94.096 120.105 94.0467C118.167 93.2255 121.666 89.7435 123.268 87.2716C127.777 80.3323 129.987 72.7523 131.005 64.8932L131.022 64.885Z",fill:"url(#paint8_linear_290_1904)"}),e("path",{opacity:"0.5",d:"M129.206 102.497C127.687 102.497 126.151 102.645 124.647 102.916C124.36 102.965 124.081 102.99 123.818 102.99C123.391 102.99 122.988 102.924 122.61 102.809C122.668 102.883 122.734 102.957 122.791 103.039C123.448 103.959 123.793 104.961 123.925 106.004C124.089 106.184 124.229 106.406 124.344 106.694C124.344 106.694 124.344 106.694 124.344 106.71C124.344 106.71 124.344 106.71 124.344 106.718C124.344 106.718 124.344 106.718 124.344 106.726C124.344 106.726 124.344 106.726 124.344 106.735C124.344 106.735 124.344 106.735 124.344 106.743C124.344 106.743 124.344 106.743 124.344 106.751C124.344 106.751 124.344 106.751 124.344 106.759C124.344 106.759 124.344 106.759 124.344 106.768V106.784C124.344 106.784 124.344 106.784 124.344 106.792C124.344 106.792 124.344 106.792 124.344 106.8C124.344 106.8 124.344 106.8 124.344 106.809C124.344 106.809 124.344 106.809 124.344 106.817C124.344 106.817 124.344 106.817 124.344 106.825C124.344 106.825 124.344 106.833 124.344 106.841C124.344 106.841 124.344 106.841 124.344 106.858C124.344 106.858 124.344 106.858 124.344 106.866C124.344 106.866 124.344 106.866 124.344 106.874C124.344 106.874 124.344 106.874 124.344 106.882C124.344 106.882 124.344 106.883 124.344 106.891C124.344 106.891 124.344 106.891 124.344 106.899C124.344 106.899 124.344 106.899 124.344 106.907C124.344 106.907 124.344 106.907 124.344 106.915C124.344 106.915 124.344 106.915 124.344 106.924C124.344 106.924 124.344 106.924 124.344 106.932C124.344 106.932 124.344 106.932 124.344 106.94C124.344 106.94 124.344 106.94 124.344 106.948C124.344 106.948 124.344 106.948 124.344 106.965C124.344 106.965 124.344 106.973 124.344 106.981C124.344 106.981 124.344 106.989 124.344 106.997V107.014C124.344 107.014 124.344 107.022 124.344 107.03C124.344 107.03 124.344 107.039 124.344 107.047C124.344 107.047 124.344 107.055 124.344 107.063C124.344 107.063 124.344 107.071 124.344 107.08C124.344 107.08 124.344 107.088 124.344 107.096C124.344 107.096 124.344 107.104 124.344 107.112C124.344 107.112 124.344 107.121 124.344 107.129C124.344 107.145 124.344 107.162 124.344 107.178C124.344 107.178 124.344 107.186 124.344 107.195C124.344 107.195 124.344 107.227 124.344 107.244C124.344 107.244 124.344 107.252 124.344 107.26V107.277C124.344 107.277 124.344 107.301 124.344 107.31C124.344 107.31 124.344 107.318 124.344 107.326V107.342V107.359C124.36 107.597 124.368 107.843 124.368 108.09C124.368 108.476 124.344 108.87 124.302 109.272C124.253 109.773 124.155 110.307 124.081 110.734C124.072 110.8 124.064 110.865 124.064 110.923C124.064 111.268 124.229 111.588 124.508 111.793L124.672 111.892C124.828 111.966 124.992 112.007 125.157 112.007C125.461 112.007 125.748 111.884 125.962 111.654C126.085 111.514 126.208 111.383 126.331 111.251C127.884 109.617 129.461 108.484 131.136 107.794C132.369 107.285 133.601 107.03 134.857 107.03C136.114 107.03 137.387 107.285 138.702 107.786C139.958 108.262 141.141 108.919 142.316 109.781C142.817 110.151 143.318 110.562 143.819 111.013C144.115 111.284 144.41 111.58 144.673 111.843L144.714 111.884L144.928 112.097L145.051 112.204C145.232 112.335 145.453 112.409 145.675 112.418C144.632 110.192 143.318 108.123 141.461 106.513C137.946 103.466 133.51 102.177 129.001 102.177",fill:"url(#paint9_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M128.779 87.6905L128.582 87.7069C128.114 87.7972 127.752 88.175 127.695 88.6513C127.654 89.0208 127.654 89.415 127.703 89.8174C127.72 89.9488 127.687 90.072 127.629 90.1706C129.51 92.9627 133.584 97.9065 139.769 99.7789C139.769 99.7789 149.331 104.78 146.916 112.032L146.99 111.834C147.737 109.617 147.893 107.581 147.458 105.593C147.022 103.63 146.029 101.824 144.492 100.222C143.901 99.6064 143.244 99.0234 142.529 98.4978C142.184 98.2432 141.815 98.0051 141.437 97.7669C140.969 97.4713 140.484 97.192 139.95 96.921C137.995 95.9191 136.328 94.909 134.866 93.825C134.274 93.3898 133.699 92.9299 133.157 92.4536C131.851 91.3121 130.972 90.3348 130.315 89.3001C130.102 88.9716 129.913 88.6102 129.732 88.2653C129.658 88.1175 129.543 87.9943 129.412 87.8958C129.231 87.7562 129.001 87.6823 128.763 87.6823",fill:"url(#paint10_linear_290_1904)"}),e("path",{opacity:"0.5",d:"M116.647 107.893L118.586 106.768L126.734 95.8535C126.734 95.8535 122.274 95.0076 120.122 94.0303C120.122 94.0303 117.887 104.222 109.632 112.738L112.672 110.488C113.887 109.634 114.988 108.903 116.647 107.893Z",fill:"url(#paint11_linear_290_1904)"}),e("path",{d:"M209.416 49.9962H230.197C245.221 49.9962 252.104 57.7157 252.104 73.5818V81.4409C252.104 97.307 245.221 105.027 230.197 105.027H218.123V148.264H209.416V49.9962ZM230.197 97.0196C239.323 97.0196 243.397 92.9463 243.397 81.8598V73.0152C243.397 62.0682 239.323 57.8553 230.197 57.8553H218.123V97.0196H230.197Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M284.114 49.9962H292.821V93.0941H319.64V49.9962H328.346V148.256H319.64V100.953H292.821V148.256H284.114V49.9962Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M362.451 125.656V72.5963C362.451 57.0177 370.312 48.5919 384.497 48.5919C398.683 48.5919 406.544 57.0177 406.544 72.5963V125.656C406.544 141.234 398.683 149.66 384.497 149.66C370.312 149.66 362.451 141.234 362.451 125.656ZM397.829 126.214V72.0297C397.829 61.5016 393.056 56.451 384.489 56.451C375.922 56.451 371.15 61.5016 371.15 72.0297V126.214C371.15 136.742 375.922 141.653 384.489 141.653C393.056 141.653 397.829 136.742 397.829 126.214Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M440.796 49.9962H480.108V57.8553H449.503V93.0859H474.638V100.945H449.503V140.249H480.108V148.248H440.796V49.9962Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M511.56 49.9962H523.076L548.629 125.935V49.9962H556.769V148.256H547.504L519.56 64.458V148.256H511.56V49.9962Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M592.007 49.9962H600.714V148.256H592.007V49.9962Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M651.674 98.1447L632.437 49.9962H641.702L657.144 89.0209L672.726 49.9962H681.154L661.917 98.1447L681.992 148.256H672.726L656.438 106.989L640.01 148.256H631.591L651.666 98.1447H651.674Z",fill:"var(--ac-global-text-color-900)"})]}),s("defs",{children:[s("linearGradient",{id:"paint0_linear_290_1904",x1:"22.0956",y1:"10.3474",x2:"97.4433",y2:"140.879",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#14BAB6"}),e("stop",{offset:"0.5",stopColor:"#00ADEE"}),e("stop",{offset:"1",stopColor:"#0095C4"})]}),s("linearGradient",{id:"paint1_linear_290_1904",x1:"95.422",y1:"114.807",x2:"31.8741",y2:"4.70214",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#FDFDFE",stopOpacity:"0"}),e("stop",{offset:"0.11",stopColor:"#FDFDFE",stopOpacity:"0.17"}),e("stop",{offset:"0.3",stopColor:"#FDFDFE",stopOpacity:"0.42"}),e("stop",{offset:"0.47",stopColor:"#FDFDFE",stopOpacity:"0.63"}),e("stop",{offset:"0.64",stopColor:"#FDFDFE",stopOpacity:"0.79"}),e("stop",{offset:"0.78",stopColor:"#FDFDFE",stopOpacity:"0.9"}),e("stop",{offset:"0.91",stopColor:"#FDFDFE",stopOpacity:"0.97"}),e("stop",{offset:"1",stopColor:"#FDFDFE"})]}),s("linearGradient",{id:"paint2_linear_290_1904",x1:"76.6695",y1:"114.126",x2:"30.8746",y2:"34.7951",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#FDFDFE",stopOpacity:"0"}),e("stop",{offset:"0.11",stopColor:"#FDFDFE",stopOpacity:"0.17"}),e("stop",{offset:"0.3",stopColor:"#FDFDFE",stopOpacity:"0.42"}),e("stop",{offset:"0.47",stopColor:"#FDFDFE",stopOpacity:"0.63"}),e("stop",{offset:"0.64",stopColor:"#FDFDFE",stopOpacity:"0.79"}),e("stop",{offset:"0.78",stopColor:"#FDFDFE",stopOpacity:"0.9"}),e("stop",{offset:"0.91",stopColor:"#FDFDFE",stopOpacity:"0.97"}),e("stop",{offset:"1",stopColor:"#FDFDFE"})]}),s("linearGradient",{id:"paint3_linear_290_1904",x1:"70.3612",y1:"119.915",x2:"44.7991",y2:"75.6384",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#FDFDFE",stopOpacity:"0"}),e("stop",{offset:"0.11",stopColor:"#FDFDFE",stopOpacity:"0.17"}),e("stop",{offset:"0.3",stopColor:"#FDFDFE",stopOpacity:"0.42"}),e("stop",{offset:"0.47",stopColor:"#FDFDFE",stopOpacity:"0.63"}),e("stop",{offset:"0.64",stopColor:"#FDFDFE",stopOpacity:"0.79"}),e("stop",{offset:"0.78",stopColor:"#FDFDFE",stopOpacity:"0.9"}),e("stop",{offset:"0.91",stopColor:"#FDFDFE",stopOpacity:"0.97"}),e("stop",{offset:"1",stopColor:"#FDFDFE"})]}),s("linearGradient",{id:"paint4_linear_290_1904",x1:"71.4208",y1:"128.85",x2:"55.5071",y2:"101.279",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#FDFDFE",stopOpacity:"0"}),e("stop",{offset:"0.11",stopColor:"#FDFDFE",stopOpacity:"0.17"}),e("stop",{offset:"0.3",stopColor:"#FDFDFE",stopOpacity:"0.42"}),e("stop",{offset:"0.47",stopColor:"#FDFDFE",stopOpacity:"0.63"}),e("stop",{offset:"0.64",stopColor:"#FDFDFE",stopOpacity:"0.79"}),e("stop",{offset:"0.78",stopColor:"#FDFDFE",stopOpacity:"0.9"}),e("stop",{offset:"0.91",stopColor:"#FDFDFE",stopOpacity:"0.97"}),e("stop",{offset:"1",stopColor:"#FDFDFE"})]}),s("linearGradient",{id:"paint5_linear_290_1904",x1:"44.5363",y1:"126.346",x2:"44.5363",y2:"155.384",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"0.03",stopColor:"#231F20",stopOpacity:"0.9"}),e("stop",{offset:"0.22",stopColor:"#231F20",stopOpacity:"0.4"}),e("stop",{offset:"0.42",stopColor:"#231F20",stopOpacity:"0.1"}),e("stop",{offset:"0.65",stopColor:"#231F20",stopOpacity:"0"})]}),s("linearGradient",{id:"paint6_linear_290_1904",x1:"77.1952",y1:"123.603",x2:"77.1952",y2:"138.409",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"1",stopColor:"#231F20",stopOpacity:"0"})]}),s("linearGradient",{id:"paint7_linear_290_1904",x1:"84.3413",y1:"85.235",x2:"84.3413",y2:"73.1301",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"0.03",stopColor:"#231F20",stopOpacity:"0.95"}),e("stop",{offset:"0.51",stopColor:"#231F20",stopOpacity:"0.26"}),e("stop",{offset:"0.81",stopColor:"#231F20",stopOpacity:"0"})]}),s("linearGradient",{id:"paint8_linear_290_1904",x1:"110.815",y1:"94.1699",x2:"110.815",y2:"64.885",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"0.18",stopColor:"#231F20",stopOpacity:"0.48"}),e("stop",{offset:"0.38",stopColor:"#231F20",stopOpacity:"0.12"}),e("stop",{offset:"0.58",stopColor:"#231F20",stopOpacity:"0"})]}),s("linearGradient",{id:"paint9_linear_290_1904",x1:"138.077",y1:"117.246",x2:"127.969",y2:"99.7278",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"1",stopColor:"#231F20",stopOpacity:"0"})]}),s("linearGradient",{id:"paint10_linear_290_1904",x1:"146.226",y1:"112.434",x2:"131.084",y2:"86.1931",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#FDFDFE",stopOpacity:"0"}),e("stop",{offset:"0.11",stopColor:"#FDFDFE",stopOpacity:"0.17"}),e("stop",{offset:"0.3",stopColor:"#FDFDFE",stopOpacity:"0.42"}),e("stop",{offset:"0.47",stopColor:"#FDFDFE",stopOpacity:"0.63"}),e("stop",{offset:"0.64",stopColor:"#FDFDFE",stopOpacity:"0.79"}),e("stop",{offset:"0.78",stopColor:"#FDFDFE",stopOpacity:"0.9"}),e("stop",{offset:"0.91",stopColor:"#FDFDFE",stopOpacity:"0.97"}),e("stop",{offset:"1",stopColor:"#FDFDFE"})]}),s("linearGradient",{id:"paint11_linear_290_1904",x1:"106.889",y1:"107.999",x2:"128.941",y2:"95.2581",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"0.31",stopColor:"#231F20",stopOpacity:"0.5"}),e("stop",{offset:"0.67",stopColor:"#231F20",stopOpacity:"0.13"}),e("stop",{offset:"1",stopColor:"#231F20",stopOpacity:"0"})]}),e("clipPath",{id:"clip0_290_1904",children:e("rect",{width:"682",height:"169",fill:"white"})})]})]})}const Rv=K`
  text-align: center;
  margin-top: var(--ac-global-dimension-size-200);
  margin-bottom: var(--ac-global-dimension-size-200);
  color: var(--ac-global-text-color-700);
`,Av=K`
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-size-100);
  flex-wrap: wrap;
  justify-content: center;
`;function X2(){const n=window.Config.oAuth2Idps,a=n.length>0,[t,l]=fn(),i=t.get("returnUrl"),r=t.get("message");return s(Ht,{children:[e(h,{direction:"column",gap:"size-200",alignItems:"center",children:e(C,{paddingBottom:"size-200",children:e(gi,{})})}),r&&e(C,{paddingBottom:"size-100",children:e(pe,{variant:"success",children:r})}),e(wv,{initialError:t.get("error"),onSubmit:()=>{l(o=>{const d=new URLSearchParams(o);return d.delete("message"),d.delete("error"),d})}}),a&&s(U,{children:[e("div",{css:Rv,children:"or"}),e("ul",{css:Av,children:n.map(o=>e("li",{children:e(Mv,{idpName:o.name,idpDisplayName:o.displayName,returnUrl:i},o.name)},o.name))})]})]})}const Eu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UserMutationPayload",kind:"LinkedField",name:"patchViewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ResetPasswordFormMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ResetPasswordFormMutation",selections:a},params:{cacheID:"d09af5e3a2a3d10f117373e25bef11e6",id:null,metadata:{},name:"ResetPasswordFormMutation",operationKind:"mutation",text:`mutation ResetPasswordFormMutation(
  $input: PatchViewerInput!
) {
  patchViewer(input: $input) {
    __typename
  }
}
`}}}();Eu.hash="f8f5c30b0e00c17cdda7557c73c3c2d3";const Mu={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ResetPasswordFormQuery",selections:[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};Mu.hash="1161643b76edb6ef437d8f136038cf21";const Qa=4;function Nv(n){var p;const a=le(),t=Fe(),l=I.useFragment(Mu,n.query),[i,r]=I.useMutation(Eu),{control:o,handleSubmit:d}=Ae({defaultValues:{currentPassword:"",newPassword:"",confirmPassword:""}}),c=u.useCallback(y=>{i({variables:{input:{currentPassword:y.currentPassword,newPassword:y.newPassword}},onCompleted:()=>{const m=Wr({path:"/login",searchParams:{message:"Password has been reset."}});a(m)},onError:m=>{t({title:"Failed to reset password",message:m.message})}})},[i,a,t]);return s(St,{onSubmit:d(c),children:[e(ml,{children:s(J,{name:"email",type:"email",autoComplete:"email",isRequired:!0,isReadOnly:!0,value:(p=l.viewer)==null?void 0:p.email,children:[e(G,{children:"Email"}),e(ne,{})]})}),e(H,{name:"currentPassword",control:o,rules:{required:"the current is required"},render:({field:{name:y,onChange:m,onBlur:g,value:f},fieldState:{invalid:k,error:b}})=>s(J,{type:"password",name:y,isRequired:!0,isInvalid:k,onChange:m,onBlur:g,value:f,id:"current-password",autoComplete:"current-password",children:[e(G,{children:"Old Password"}),e(ne,{}),b?e(ve,{children:b==null?void 0:b.message}):e(v,{slot:"description",children:"The current password"})]})}),e(H,{name:"newPassword",control:o,rules:{required:"Password is required",minLength:{value:Qa,message:`Password must be at least ${Qa} characters`},validate:(y,m)=>y!==m.currentPassword||"New password must be different"},render:({field:{name:y,onChange:m,onBlur:g,value:f},fieldState:{invalid:k,error:b}})=>s(J,{type:"password",isRequired:!0,name:y,isInvalid:k,onChange:m,onBlur:g,defaultValue:f,id:"new-password",autoComplete:"new-password",children:[e(G,{children:"New Password"}),e(ne,{}),b?e(ve,{children:b==null?void 0:b.message}):s(v,{slot:"description",children:["Password must be at least ",Qa," characters"]})]})}),e(H,{name:"confirmPassword",control:o,rules:{required:"Password is required",minLength:{value:Qa,message:`Password must be at least ${Qa} characters`},validate:(y,m)=>y===m.newPassword||"Passwords do not match"},render:({field:{name:y,onChange:m,onBlur:g,value:f},fieldState:{invalid:k,error:b}})=>s(J,{isRequired:!0,type:"password",name:y,isInvalid:k,onChange:m,onBlur:g,defaultValue:f,autoComplete:"new-password",children:[e(G,{children:"Confirm Password"}),e(ne,{}),b?e(ve,{children:b==null?void 0:b.message}):e(v,{slot:"description",children:"Confirm the new password"})]})}),s("div",{css:K`
          display: flex;
          flex-direction: row;
          gap: var(--ac-global-dimension-size-200);
          padding-top: var(--ac-global-dimension-size-100);
          & > * {
            width: 50%;
          }
        `,children:[e(A,{onPress:()=>{a(-1)},children:"Cancel"}),e(A,{variant:"primary",type:"submit",isDisabled:r,children:r?"Resetting...":"Reset Password"})]})]})}function Y2(){const n=Be();return s(Ht,{children:[e(h,{direction:"column",gap:"size-200",alignItems:"center",children:e(C,{paddingBottom:"size-200",children:e(gi,{})})}),e(Nv,{query:n})]})}const ja=4,zv="An error occurred. Please try resetting again.";function $v({resetToken:n}){const a=le(),[t,l]=u.useState(null),[i,r]=u.useState(!1),o=u.useCallback(async({resetToken:y,newPassword:m})=>{l(null),r(!0);try{const g=await fetch(mn("/auth/password-reset"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:y,password:m})});if(!g.ok){const f=await g.text();l(f);return}}catch{l(zv);return}finally{r(()=>!1)}a(`/login?message=${encodeURIComponent("Password has been reset.")}`)},[l,a]),{control:d,handleSubmit:c,formState:{isDirty:p}}=Ae({defaultValues:{resetToken:n,newPassword:"",confirmPassword:""}});return s(U,{children:[t?e(C,{paddingBottom:"size-100",children:e(pe,{variant:"danger",children:t})}):null,s(St,{onSubmit:c(o),children:[e(H,{name:"newPassword",control:d,rules:{required:"Password is required",minLength:{value:ja,message:`Password must be at least ${ja} characters`}},render:({field:{name:y,onChange:m,onBlur:g,value:f},fieldState:{invalid:k,error:b}})=>s(J,{type:"password",isRequired:!0,name:y,isInvalid:k,id:"new-password",autoComplete:"new-password",onChange:m,onBlur:g,defaultValue:f,children:[e(G,{children:"New Password"}),e(ne,{}),b?e(ve,{children:b==null?void 0:b.message}):s(v,{slot:"description",children:["Password must be at least ",ja," characters"]})]})}),e(H,{name:"confirmPassword",control:d,rules:{required:"Password is required",minLength:{value:ja,message:`Password must be at least ${ja} characters`},validate:(y,m)=>y===m.newPassword||"Passwords do not match"},render:({field:{name:y,onChange:m,onBlur:g,value:f},fieldState:{invalid:k,error:b}})=>s(J,{type:"password",isRequired:!0,name:y,isInvalid:k,onChange:m,onBlur:g,defaultValue:f,children:[e(G,{children:"Confirm Password"}),e(ne,{}),b?e(ve,{children:b==null?void 0:b.message}):e(v,{slot:"description",children:"Confirm the new password"})]})}),e("div",{css:K`
            margin-top: var(--ac-global-dimension-size-200);
            margin-bottom: var(--ac-global-dimension-size-50);
            button {
              width: 100%;
            }
          `,children:e(A,{variant:p?"primary":"default",type:"submit",isDisabled:i,children:i?"Resetting...":"Reset Password"})})]})]})}function eC(){const n=le(),[a]=fn(),t=a.get("token");return t?s(Ht,{children:[e(h,{direction:"column",gap:"size-200",alignItems:"center",children:e(C,{paddingBottom:"size-200",children:e(gi,{})})}),e($v,{resetToken:t}),e(C,{paddingTop:"size-200",children:e(h,{direction:"column",alignItems:"center",justifyContent:"center",children:e(Oe,{to:"/login",children:"Back to Login"})})})]}):(n("/login"),null)}const Vu=function(){var n={alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"resetPasswordLoaderQuery",selections:[n,{args:null,kind:"FragmentSpread",name:"ResetPasswordFormQuery"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"resetPasswordLoaderQuery",selections:[n]},params:{cacheID:"558e2fa85c0dc24da6318db9ebbd7958",id:null,metadata:{},name:"resetPasswordLoaderQuery",operationKind:"query",text:`query resetPasswordLoaderQuery {
  viewer {
    id
    email
  }
  ...ResetPasswordFormQuery
}

fragment ResetPasswordFormQuery on Query {
  viewer {
    email
  }
}
`}}}();Vu.hash="17bb397eaa3a44dd33996854e538f2ef";async function nC(){const n=await I.fetchQuery(he,Vu,{}).toPromise();return n!=null&&n.viewer?n:Ga("/login")}function Ov({onResetSent:n}){const[a,t]=u.useState(null),[l,i]=u.useState(!1),r=u.useCallback(async c=>{t(null),i(!0);try{const p=await fetch(mn("/auth/password-reset-email"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!p.ok){const y=await p.text();t(y);return}n()}finally{i(()=>!1)}},[n,t]),{control:o,handleSubmit:d}=Ae({defaultValues:{email:""}});return s(U,{children:[a?e(C,{paddingBottom:"size-100",children:e(pe,{variant:"danger",children:a})}):null,s(Ye,{onSubmit:d(r),children:[e(H,{name:"email",control:o,render:({field:{onChange:c,value:p}})=>s(J,{name:"email",isRequired:!0,type:"email",onChange:c,value:p,children:[e(G,{children:"Email"}),e(ne,{placeholder:"your email address"}),e(v,{slot:"description",children:"Enter the email address associated with your account."})]})}),e("div",{css:K`
            margin-top: var(--ac-global-dimension-size-200);
            margin-bottom: var(--ac-global-dimension-size-50);
            button {
              width: 100%;
            }
          `,children:e(A,{variant:"primary",type:"submit",isDisabled:l,children:l?"Sending...":"Send"})})]})]})}function aC(){const[n,a]=u.useState(!1),t=n?s(h,{direction:"column",alignItems:"center",justifyContent:"center",gap:"size-100",children:[e(te,{level:1,children:"Check your email"}),e("p",{children:"Thanks! If an account with that email address exists, we sent you a link to reset your password."})]}):s(U,{children:[s(h,{direction:"column",alignItems:"center",justifyContent:"center",gap:"size-100",children:[e(te,{level:1,children:"Forgot Password"}),e("p",{children:`Enter the email address associated with your account and we'll send you
        a link to reset your password.`})]}),e(Ov,{onResetSent:()=>a(!0)})]});return e(Ht,{children:s("div",{css:K`
          & a {
            text-align: center;
            width: 100%;
            display: block;
            text-align: center;
            padding-top: var(--ac-global-dimension-size-200);
          }
        `,children:[t,e(h,{direction:"column",alignItems:"center",justifyContent:"center",gap:"size-200",children:e(Oe,{to:"/login",children:"Back to Login"})})]})})}const Ru=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{kind:"Variable",name:"input",variableName:"input"}],t={alias:null,args:null,kind:"ScalarField",name:"jwt",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ViewerAPIKeysCreateUserAPIKeyMutation",selections:[{alias:null,args:a,concreteType:"CreateUserApiKeyMutationPayload",kind:"LinkedField",name:"createUserApiKey",plural:!1,selections:[t,{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKey",plural:!1,selections:[l,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"APIKeysTableFragment"}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ViewerAPIKeysCreateUserAPIKeyMutation",selections:[{alias:null,args:a,concreteType:"CreateUserApiKeyMutationPayload",kind:"LinkedField",name:"createUserApiKey",plural:!1,selections:[t,{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKey",plural:!1,selections:[l,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKeys",plural:!0,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null},l],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"572bf0f64678128defccf833e6a5d4ce",id:null,metadata:{},name:"ViewerAPIKeysCreateUserAPIKeyMutation",operationKind:"mutation",text:`mutation ViewerAPIKeysCreateUserAPIKeyMutation(
  $input: CreateUserApiKeyInput!
) {
  createUserApiKey(input: $input) {
    jwt
    apiKey {
      id
      user {
        ...APIKeysTableFragment
      }
    }
  }
}

fragment APIKeysTableFragment on User {
  apiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
  id
}
`}}}();Ru.hash="28061ae008e197468be6fd5f2775ccb0";const Au=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{kind:"Variable",name:"input",variableName:"input"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"apiKeyId",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"APIKeysTableDeleteAPIKeyMutation",selections:[{alias:null,args:a,concreteType:"DeleteApiKeyMutationPayload",kind:"LinkedField",name:"deleteUserApiKey",plural:!1,selections:[t,l,{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"UserAPIKeysTableFragment"}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"APIKeysTableDeleteAPIKeyMutation",selections:[{alias:null,args:a,concreteType:"DeleteApiKeyMutationPayload",kind:"LinkedField",name:"deleteUserApiKey",plural:!1,selections:[t,l,{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"userApiKeys",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"f28a00e7a6eb2e18b1f8b31c8231c2b7",id:null,metadata:{},name:"APIKeysTableDeleteAPIKeyMutation",operationKind:"mutation",text:`mutation APIKeysTableDeleteAPIKeyMutation(
  $input: DeleteApiKeyInput!
) {
  deleteUserApiKey(input: $input) {
    __typename
    apiKeyId
    query {
      ...UserAPIKeysTableFragment
    }
  }
}

fragment UserAPIKeysTableFragment on Query {
  userApiKeys {
    id
    name
    description
    createdAt
    expiresAt
    user {
      email
    }
  }
}
`}}}();Au.hash="3a505d9d13944798a57fc873ddf0992d";const Nu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"APIKeysTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"APIKeysTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"APIKeysTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKeys",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null}],type:"User",abstractKey:null}],storageKey:null}]},params:{cacheID:"e677b5974fa137ac3a26acde353767d8",id:null,metadata:{},name:"APIKeysTableQuery",operationKind:"query",text:`query APIKeysTableQuery(
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...APIKeysTableFragment
    __isNode: __typename
    id
  }
}

fragment APIKeysTableFragment on User {
  apiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
  id
}
`}}}();Nu.hash="6c32098d55e4cba859dcec73f3ccd28c";const zu=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:Nu,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"APIKeysTableFragment",selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKeys",plural:!0,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null},n],type:"User",abstractKey:null}}();zu.hash="6c32098d55e4cba859dcec73f3ccd28c";const nr=70;function Qv({query:n}){const[a,t]=I.useRefetchableFragment(zu,n),l=ke(),[i]=I.useMutation(Au),r=u.useCallback(m=>{i({variables:{input:{id:m}},onCompleted:()=>{l({title:"API key deleted",message:"The key has been deleted and is no longer active."}),u.startTransition(()=>{t({},{fetchPolicy:"network-only"})})}})},[i,l,t]),o=u.useMemo(()=>[...a.apiKeys],[a]),d=u.useMemo(()=>[{header:"Name",accessorKey:"name",size:100,cell:De},{header:"Description",accessorKey:"description",cell:De},{header:"Created At",accessorKey:"createdAt",size:nr,cell:Me},{header:"Expires At",accessorKey:"expiresAt",size:nr,cell:Me},{header:"",accessorKey:"id",size:10,cell:({row:g})=>e(h,{direction:"row",justifyContent:"end",width:"100%",children:e(Bl,{handleDelete:()=>{r(g.original.id)}})}),meta:{textAlign:"right"}}],[r]),c=Te({columns:d,data:o,getCoreRowModel:Pe()}),p=c.getRowModel().rows,y=c.getRowModel().rows.length===0;return s("table",{css:tn,children:[e("thead",{children:c.getHeaderGroups().map(m=>e("tr",{children:m.headers.map(g=>e("th",{colSpan:g.colSpan,children:g.isPlaceholder?null:s("div",{className:g.column.getCanSort()?"cursor-pointer":"",onClick:g.column.getToggleSortingHandler(),style:{left:g.getStart(),width:g.getSize()},children:[W(g.column.columnDef.header,g.getContext()),g.column.getIsSorted()?e(L,{className:"sort-icon",svg:g.column.getIsSorted()==="asc"?e(sn,{}):e(rn,{})}):null]})},g.id))},m.id))}),y?e(ln,{message:"No Keys"}):e("tbody",{children:p.map(m=>e("tr",{children:m.getVisibleCells().map(g=>e("td",{children:W(g.column.columnDef.cell,g.getContext())},g.id))},m.id))})]})}function jv({viewer:n}){const[a,t]=u.useState(null),l=Fe(),[i,r]=I.useMutation(Ru),o=u.useCallback(d=>{var c;i({variables:{input:{...d,expiresAt:((c=d.expiresAt)==null?void 0:c.toDate(Sl()).toISOString())||null}},onCompleted:p=>{t(e(Hr,{jwt:p.createUserApiKey.jwt}))},onError:p=>{l({title:"Error creating API key",message:p.message})}})},[i,l]);return s(Q,{title:"API Keys",variant:"compact",bodyStyle:{padding:0},extra:e(A,{size:"S",leadingVisual:e(L,{svg:e(kn,{})}),onPress:()=>t(e(Gr,{onSubmit:o,isCommitting:r})),children:"New Key"}),children:[e(Qv,{query:n}),e(X,{onDismiss:()=>{t(null)},children:a})]})}const $u=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UserMutationPayload",kind:"LinkedField",name:"patchViewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ViewerProfileCardMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ViewerProfileCardMutation",selections:a},params:{cacheID:"03f161df42c71b5924a8ee665e01cdce",id:null,metadata:{},name:"ViewerProfileCardMutation",operationKind:"mutation",text:`mutation ViewerProfileCardMutation(
  $input: PatchViewerInput!
) {
  patchViewer(input: $input) {
    __typename
  }
}
`}}}();$u.hash="4a11ca65151d84fe95f636763c91dc68";function qv(){const{viewer:n,refetchViewer:a}=Jr(),t=Fe(),l=ke(),[i,r]=I.useMutation($u),{control:o,handleSubmit:d,formState:{isDirty:c},reset:p}=Ae({defaultValues:{username:(n==null?void 0:n.username)||""}}),y=u.useCallback(m=>{i({variables:{input:{newUsername:m.username}},onCompleted:()=>{l({title:"Profile updated",message:"Your profile has been updated"}),p({username:m.username}),a()},onError:g=>{t({title:"Failed update profile",message:g.message})}})},[i,l,p,a,t]);return n?s(Q,{title:"Profile",variant:"compact",bodyStyle:{padding:0},extra:n.authMethod==="LOCAL"&&e(Dt,{size:"S",to:"/reset-password",children:"Reset Password"}),children:[e(C,{paddingTop:"size-200",paddingStart:"size-200",paddingEnd:"size-200",children:s(h,{direction:"row",gap:"size-200",alignItems:"center",children:[e(_l,{name:n.username||n.email,profilePictureUrl:n.profilePictureUrl}),s(h,{direction:"column",gap:"size-50",children:[e(te,{level:2,weight:"heavy",children:n.username||n.email}),e(v,{children:n.role.name.toLocaleLowerCase()})]})]})}),e(C,{children:s(Ye,{onSubmit:d(y),children:[e(C,{padding:"size-200",children:s(h,{direction:"column",gap:"size-100",children:[s(J,{value:n.email,isReadOnly:!0,size:"S",children:[e(G,{children:"Email"}),e(ne,{})]}),e(H,{name:"username",control:o,rules:{required:"A username is required as it needs to be unique"},render:({field:{name:m,onChange:g,onBlur:f,value:k},fieldState:{invalid:b,error:S}})=>s(J,{isRequired:!0,name:m,isInvalid:b,onChange:g,onBlur:f,defaultValue:k,size:"S",children:[e(G,{children:"Username"}),e(ne,{}),S?e(ve,{children:S.message}):e(v,{slot:"description",children:"A unique username"})]})})]})}),e(C,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-200",paddingEnd:"size-200",borderTopColor:"dark",borderTopWidth:"thin",children:e(h,{direction:"row",gap:"size-100",justifyContent:"end",children:e(A,{variant:c?"primary":"default",size:"S",isDisabled:!c,onPress:()=>{d(y)()},children:r?"Saving...":"Save"})})})]})})]}):null}const Bv=K`
  overflow-y: auto;
`,Uv=K`
  padding: var(--ac-global-dimension-size-400);
  max-width: 800px;
  min-width: 500px;
  box-sizing: border-box;
  width: 100%;
  margin-left: auto;
  margin-right: auto;
`;function tC(){const{viewer:n}=Jr();return n?e("main",{css:Bv,children:e("div",{css:Uv,children:s(h,{direction:"column",gap:"size-200",children:[e(qv,{}),e(jv,{viewer:n})]})})}):null}function lC(){return e(oi,{})}function iC(){const n=Be(),a=u.useMemo(()=>n.span.__typename==="Span"?n.span:null,[n.span]);if(!a)throw new Error("Span not found");const{playgroundInstance:t,parsingErrors:l,playgroundInput:i}=u.useMemo(()=>Fy(a),[a]),r=i!=null?{input:i}:{};return s(h,{direction:"column",height:"100%",children:[e(Hv,{span:a,parsingErrors:l}),e(oi,{instances:[t],...r},a.id)]})}function Hv({span:n,parsingErrors:a}){const t=le(),l=a&&a.length>0,[i,r]=u.useState(!0),[o,d]=u.useState(l);return s(h,{direction:"column",gap:"size-50",children:[i&&e(pe,{variant:"info",title:"LLM Span Replay",banner:!0,dismissable:!0,onDismissClick:()=>{r(!1)},extra:e(A,{leadingVisual:e(L,{svg:e(wg,{})}),onPress:()=>{t(`/projects/${n.project.id}/traces/${n.trace.traceId}?selectedSpanNodeId=${n.id}`)},children:"Back to Trace"}),children:`Replay and iterate on your LLM call from your ${n.project.name} project`}),o&&l&&e(pe,{variant:"warning",banner:!0,dismissable:!0,onDismissClick:()=>{d(!1)},title:"The following errors occurred when parsing span attributes:",children:e("ul",{children:a.map(c=>e("li",{children:c},c))})})]})}const Ou=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"spanId"}],a=[{kind:"Variable",name:"id",variableName:"spanId"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},o={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"attributes",storageKey:null},c=[{alias:null,args:null,kind:"ScalarField",name:"invocationInputField",storageKey:null}],p={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"invocationParameters",plural:!0,selections:[t,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"canonicalName",storageKey:null}],type:"InvocationParameterBase",abstractKey:"__isInvocationParameterBase"},{kind:"InlineFragment",selections:c,type:"BooleanInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:c,type:"StringInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:c,type:"BoundedFloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:c,type:"FloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:c,type:"IntInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:c,type:"JSONInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:c,type:"StringListInvocationParameter",abstractKey:null}],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"spanPlaygroundPageLoaderQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"InlineFragment",selections:[l,i,r,o,d,p],type:"Span",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"spanPlaygroundPageLoaderQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},l,{kind:"InlineFragment",selections:[i,r,o,d,p],type:"Span",abstractKey:null}],storageKey:null}]},params:{cacheID:"a386c63f2da095f3c0f5bbb383ffd74d",id:null,metadata:{},name:"spanPlaygroundPageLoaderQuery",operationKind:"query",text:`query spanPlaygroundPageLoaderQuery(
  $spanId: GlobalID!
) {
  span: node(id: $spanId) {
    __typename
    ... on Span {
      id
      project {
        id
        name
      }
      spanId
      trace {
        id
        traceId
      }
      attributes
      invocationParameters {
        __typename
        ... on InvocationParameterBase {
          __isInvocationParameterBase: __typename
          invocationName
          canonicalName
        }
        ... on BooleanInvocationParameter {
          invocationInputField
        }
        ... on StringInvocationParameter {
          invocationInputField
        }
        ... on BoundedFloatInvocationParameter {
          invocationInputField
        }
        ... on FloatInvocationParameter {
          invocationInputField
        }
        ... on IntInvocationParameter {
          invocationInputField
        }
        ... on JSONInvocationParameter {
          invocationInputField
        }
        ... on StringListInvocationParameter {
          invocationInputField
        }
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();Ou.hash="1b9e7f07a78fcf0f03722fea073f8a32";async function rC(n){const{spanId:a}=n.params;if(!a||typeof a!="string")throw new Error("Invalid spanId");return await I.fetchQuery(he,Ou,{spanId:a}).toPromise()}const Qu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"}],a=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],t={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PromptsTablePromptsQuery",selections:[{args:a,kind:"FragmentSpread",name:"PromptsTable_prompts"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PromptsTablePromptsQuery",selections:[{alias:null,args:a,concreteType:"PromptConnection",kind:"LinkedField",name:"prompts",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},t,{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"version",plural:!1,selections:[t],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:a,filters:null,handle:"connection",key:"PromptsTable_prompts",kind:"LinkedHandle",name:"prompts"}]},params:{cacheID:"78e88c2a2ce510e78c6c6d8e1b8523b2",id:null,metadata:{},name:"PromptsTablePromptsQuery",operationKind:"query",text:`query PromptsTablePromptsQuery(
  $after: String = null
  $first: Int = 100
) {
  ...PromptsTable_prompts_2HEEH6
}

fragment PromptsTable_prompts_2HEEH6 on Query {
  prompts(first: $first, after: $after) {
    edges {
      prompt: node {
        id
        name
        description
        createdAt
        version {
          createdAt
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();Qu.hash="829c7cff273e0ebcfba1c0606c052d8b";const ju=function(){var n=["prompts"],a={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:[],operation:Qu}},name:"PromptsTable_prompts",selections:[{alias:"prompts",args:null,concreteType:"PromptConnection",kind:"LinkedField",name:"__PromptsTable_prompts_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},a,{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"version",plural:!1,selections:[a],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null}}();ju.hash="829c7cff273e0ebcfba1c0606c052d8b";const qu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"promptId"}],a=[{fields:[{kind:"Variable",name:"promptId",variableName:"promptId"}],kind:"ObjectValue",name:"input"}],t=[{kind:"Literal",name:"first",value:100}],l={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DeletePromptDialogMutation",selections:[{alias:null,args:a,concreteType:"DeletePromptMutationPayload",kind:"LinkedField",name:"deletePrompt",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"PromptsTable_prompts"}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DeletePromptDialogMutation",selections:[{alias:null,args:a,concreteType:"DeletePromptMutationPayload",kind:"LinkedField",name:"deletePrompt",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:t,concreteType:"PromptConnection",kind:"LinkedField",name:"prompts",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},l,{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"version",plural:!1,selections:[l],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"prompts(first:100)"},{alias:null,args:t,filters:null,handle:"connection",key:"PromptsTable_prompts",kind:"LinkedHandle",name:"prompts"}],storageKey:null}],storageKey:null}]},params:{cacheID:"3afd45452374727a72b967ee1cce1632",id:null,metadata:{},name:"DeletePromptDialogMutation",operationKind:"mutation",text:`mutation DeletePromptDialogMutation(
  $promptId: GlobalID!
) {
  deletePrompt(input: {promptId: $promptId}) {
    query {
      ...PromptsTable_prompts
    }
  }
}

fragment PromptsTable_prompts on Query {
  prompts(first: 100) {
    edges {
      prompt: node {
        id
        name
        description
        createdAt
        version {
          createdAt
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();qu.hash="209a27a82eef96e2c39abfe579346bcc";function Gv({promptId:n,onDeleted:a,onClose:t}){const[l,i]=I.useMutation(qu),r=ke(),o=Fe(),d=u.useCallback(()=>{l({variables:{promptId:n},onCompleted:()=>{r({title:"Delete Successful",message:"Prompt has been deleted."}),a(),t()},onError:c=>{o({title:"Failed to delete prompt",message:c.message})}})},[l,o,r,t,a,n]);return s(Z,{title:"Delete Prompt",isDismissable:!0,onDismiss:t,children:[e(C,{padding:"size-200",children:e(v,{color:"danger",children:"Are you sure you want to delete this prompt? This action cannot be undone and all services dependent on this prompt will be affected."})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:s(h,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(A,{variant:"default",onPress:t,size:"S",children:"Cancel"}),e(A,{variant:"danger",onPress:()=>{d()},size:"S",isDisabled:i,children:"Delete Prompt"})]})})]})}function Wv({onDeleted:n,promptId:a}){const[t,l]=u.useState(null),i=u.useCallback(()=>{l(e(Gv,{promptId:a,onClose:()=>l(null),onDeleted:()=>{n(),l(null)}}))},[a,n]);return s(wt,{children:[e(wn,{align:"end","aria-label":"User Actions",buttonSize:"compact",onAction:r=>{switch(r){case"DELETE":i();break}},children:e(re,{children:s(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(L,{svg:e(We,{})}),e(U,{children:"Delete"})]})},"DELETE")}),e(X,{type:"modal",isDismissable:!0,onDismiss:()=>l(null),children:t})]})}const Jv=100;function Zv(n){const a=le(),t=u.useRef(null),{data:l,loadNext:i,hasNext:r,isLoadingNext:o,refetch:d}=I.usePaginationFragment(ju,n.query),c=u.useMemo(()=>l.prompts.edges.map(k=>({lastUpdatedAt:k.prompt.version.createdAt,...k.prompt})),[l]),p=Ke.useCallback(k=>{if(k){const{scrollHeight:b,scrollTop:S,clientHeight:F}=k;b-S-F<300&&!o&&r&&i(Jv)}},[r,o,i]),y=u.useMemo(()=>[{header:"name",accessorKey:"name",cell:({row:b})=>e(Oe,{to:`${b.original.id}`,children:b.original.name})},{header:"description",accessorKey:"description",cell:De},{header:"created at",accessorKey:"createdAt",cell:Me},{header:"last updated",accessorKey:"lastUpdatedAt",cell:Me},{id:"actions",header:"",size:5,accessorKey:"id",cell:({row:b})=>s(h,{direction:"row",gap:"size-100",justifyContent:"end",width:"100%",children:[e(wt,{children:e(Dt,{leadingVisual:e(L,{svg:e(fa,{})}),size:"S","aria-label":"Open in playground",to:`${b.original.id}/playground`,children:"Playground"})}),e(Wv,{promptId:b.original.id,onDeleted:()=>{d({},{fetchPolicy:"network-only"})}})]})}],[d]),m=Te({columns:y,data:c,getCoreRowModel:Pe(),getSortedRowModel:hn()}),g=m.getRowModel().rows,f=g.length===0;return e("div",{css:K`
        flex: 1 1 auto;
        overflow: auto;
      `,onScroll:k=>p(k.target),ref:t,children:s("table",{css:ea,children:[e("thead",{children:m.getHeaderGroups().map(k=>e("tr",{children:k.headers.map(b=>{var S;return e("th",{colSpan:b.colSpan,children:b.isPlaceholder?null:s("div",{className:b.column.getCanSort()?"cursor-pointer":"","aria-role":b.column.getCanSort()?"button":null,onClick:b.column.getToggleSortingHandler(),style:{textAlign:(S=b.column.columnDef.meta)==null?void 0:S.textAlign},children:[W(b.column.columnDef.header,b.getContext()),b.column.getIsSorted()?e(L,{className:"sort-icon",svg:b.column.getIsSorted()==="asc"?e(sn,{}):e(rn,{})}):null]})},b.id)})},k.id))}),f?e(ln,{}):e("tbody",{children:g.map(k=>e("tr",{onClick:()=>{a(`${k.original.id}`)},children:k.getVisibleCells().map(b=>{var S;return e("td",{align:(S=b.column.columnDef.meta)==null?void 0:S.textAlign,children:W(b.column.columnDef.cell,b.getContext())},b.id)})},k.id))})]})})}function sC(){const n=Be();return s(h,{direction:"column",height:"100%",children:[e(C,{padding:"size-200",borderBottomWidth:"thin",borderBottomColor:"dark",flex:"none",children:s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(te,{level:1,children:"Prompts"}),e(Dt,{size:"M",leadingVisual:e(L,{svg:e(Dl,{})}),variant:"primary",to:"/playground",children:"Create Prompt"})]})}),e(Zv,{query:n})]})}const Bu=function(){var n=[{kind:"Literal",name:"first",value:100}],a={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"promptsLoaderQuery",selections:[{args:null,kind:"FragmentSpread",name:"PromptsTable_prompts"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"promptsLoaderQuery",selections:[{alias:null,args:n,concreteType:"PromptConnection",kind:"LinkedField",name:"prompts",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},a,{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"version",plural:!1,selections:[a],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"prompts(first:100)"},{alias:null,args:n,filters:null,handle:"connection",key:"PromptsTable_prompts",kind:"LinkedHandle",name:"prompts"}]},params:{cacheID:"191e9b9974109498195fdef708db636b",id:null,metadata:{},name:"promptsLoaderQuery",operationKind:"query",text:`query promptsLoaderQuery {
  ...PromptsTable_prompts
}

fragment PromptsTable_prompts on Query {
  prompts(first: 100) {
    edges {
      prompt: node {
        id
        name
        description
        createdAt
        version {
          createdAt
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();Bu.hash="ed4295f193bd2a6d2402a82966d45a7f";async function oC(n){return await I.fetchQuery(he,Bu,{}).toPromise()}const Uu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"toolCallId",storageKey:null},o=[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],d={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},y={alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null}],storageKey:null},m=[l,i],g={alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:m,storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"promptLoaderQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,l,{kind:"InlineFragment",selections:[i,{args:null,kind:"FragmentSpread",name:"PromptIndexPage__main"},{args:null,kind:"FragmentSpread",name:"PromptVersionsPageContent__main"},{args:null,kind:"FragmentSpread",name:"PromptLayout__main"}],type:"Prompt",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"promptLoaderQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,l,{kind:"InlineFragment",selections:[i,{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationParameters",storageKey:null},{alias:"provider",args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"template",plural:!1,selections:[t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptMessage",kind:"LinkedField",name:"messages",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"content",plural:!0,selections:[t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TextContentValue",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}],type:"TextContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolCallContentValue",kind:"LinkedField",name:"toolCall",plural:!1,selections:[r,{alias:null,args:null,concreteType:"ToolCallFunction",kind:"LinkedField",name:"toolCall",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null},i],storageKey:null}],storageKey:null}],type:"ToolCallContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolResultContentValue",kind:"LinkedField",name:"toolResult",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}],type:"ToolResultContentPart",abstractKey:null}],storageKey:null}],storageKey:null}],type:"PromptChatTemplate",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"template",storageKey:null}],type:"PromptStringTemplate",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateFormat",storageKey:null},l,{alias:null,args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:"ResponseFormat",kind:"LinkedField",name:"responseFormat",plural:!1,selections:o,storageKey:null},{alias:null,args:null,concreteType:"ToolDefinition",kind:"LinkedField",name:"tools",plural:!0,selections:o,storageKey:null},{alias:"model",args:null,kind:"ScalarField",name:"modelName",storageKey:null}],storageKey:null},{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[l,d,c,p,y,g],storageKey:null}],storageKey:null}],storageKey:null},d,{alias:"latestVersions",args:[{kind:"Literal",name:"first",value:5}],concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[l,d,p,c,y,g],storageKey:null}],storageKey:null}],storageKey:"promptVersions(first:5)"},{alias:null,args:null,concreteType:"Prompt",kind:"LinkedField",name:"sourcePrompt",plural:!1,selections:m,storageKey:null}],type:"Prompt",abstractKey:null}],storageKey:null}]},params:{cacheID:"cc1c86124ed137944acd05f33823e920",id:null,metadata:{},name:"promptLoaderQuery",operationKind:"query",text:`query promptLoaderQuery(
  $id: GlobalID!
) {
  prompt: node(id: $id) {
    __typename
    id
    ... on Prompt {
      name
      ...PromptIndexPage__main
      ...PromptVersionsPageContent__main
      ...PromptLayout__main
    }
  }
}

fragment EditPromptButton_data on Prompt {
  id
  description
}

fragment PromptChatMessagesCard__main on PromptVersion {
  provider: modelProvider
  template {
    __typename
    ... on PromptChatTemplate {
      messages {
        role
        content {
          __typename
          ... on TextContentPart {
            text {
              text
            }
          }
          ... on ToolCallContentPart {
            toolCall {
              toolCallId
              toolCall {
                arguments
                name
              }
            }
          }
          ... on ToolResultContentPart {
            toolResult {
              toolCallId
              result
            }
          }
        }
      }
    }
    ... on PromptStringTemplate {
      template
    }
  }
  templateType
  templateFormat
}

fragment PromptCodeExportCard__main on PromptVersion {
  id
  invocationParameters
  modelName
  modelProvider
  responseFormat {
    definition
  }
  tools {
    definition
  }
  template {
    __typename
    ... on PromptChatTemplate {
      messages {
        role
        content {
          __typename
          ... on TextContentPart {
            __typename
            text {
              text
            }
          }
          ... on ToolCallContentPart {
            __typename
            toolCall {
              toolCallId
              toolCall {
                name
                arguments
              }
            }
          }
          ... on ToolResultContentPart {
            __typename
            toolResult {
              toolCallId
              result
            }
          }
        }
      }
    }
    ... on PromptStringTemplate {
      template
    }
  }
  templateFormat
  templateType
}

fragment PromptIndexPage__aside on Prompt {
  description
  ...PromptLatestVersionsListFragment
  ...EditPromptButton_data
}

fragment PromptIndexPage__main on Prompt {
  promptVersions {
    edges {
      node {
        ...PromptInvocationParameters__main
        ...PromptChatMessagesCard__main
        ...PromptCodeExportCard__main
        ...PromptModelConfigurationCard__main
      }
    }
  }
  ...PromptIndexPage__aside
}

fragment PromptInvocationParameters__main on PromptVersion {
  invocationParameters
}

fragment PromptLLM__main on PromptVersion {
  model: modelName
  provider: modelProvider
}

fragment PromptLatestVersionsListFragment on Prompt {
  latestVersions: promptVersions(first: 5) {
    edges {
      version: node {
        id
        description
        createdAt
        sequenceNumber
        ...PromptVersionSummaryFragment
      }
    }
  }
}

fragment PromptLayout__main on Prompt {
  id
  name
  description
  sourcePrompt {
    id
    name
  }
  promptVersions {
    edges {
      node {
        id
      }
    }
  }
}

fragment PromptModelConfigurationCard__main on PromptVersion {
  model: modelName
  provider: modelProvider
  ...PromptLLM__main
  ...PromptInvocationParameters__main
  ...PromptTools__main
  ...PromptResponseFormatFragment
}

fragment PromptResponseFormatFragment on PromptVersion {
  responseFormat {
    definition
  }
}

fragment PromptTools__main on PromptVersion {
  tools {
    definition
  }
}

fragment PromptVersionSummaryFragment on PromptVersion {
  id
  description
  sequenceNumber
  createdAt
  user {
    id
    username
    profilePictureUrl
  }
  ...PromptVersionTagsList_data
}

fragment PromptVersionTagsList_data on PromptVersion {
  tags {
    id
    name
  }
}

fragment PromptVersionsList__main on Prompt {
  promptVersions {
    edges {
      version: node {
        id
        ...PromptVersionSummaryFragment
      }
    }
  }
}

fragment PromptVersionsPageContent__main on Prompt {
  ...PromptVersionsList__main
}
`}}}();Uu.hash="dd012c15d97eec72a33a69900a92dc9a";async function dC(n){const{promptId:a}=n.params;return await I.fetchQuery(he,Uu,{id:a}).toPromise().catch(()=>{throw new Error("Prompt not found")})}const Hu=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptVersionTagsConfigCard_data",selections:[n,{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"versionTags",plural:!0,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"promptVersionId",storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null}}();Hu.hash="3650e60f18eb8d95b707df7bdbce99a9";const Gu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"},{defaultValue:null,kind:"LocalArgument",name:"promptId"}],a=[{kind:"Variable",name:"input",variableName:"input"}],t=[{kind:"Variable",name:"id",variableName:"promptId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DeletePromptVersionTagButtonMutation",selections:[{alias:null,args:a,concreteType:"PromptVersionTagMutationPayload",kind:"LinkedField",name:"deletePromptVersionTag",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"PromptVersionTagsConfigCard_data"}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DeletePromptVersionTagButtonMutation",selections:[{alias:null,args:a,concreteType:"PromptVersionTagMutationPayload",kind:"LinkedField",name:"deletePromptVersionTag",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"versionTags",plural:!0,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"promptVersionId",storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"f33f0c5c35bdfcb0a9fdb1eacff3dec8",id:null,metadata:{},name:"DeletePromptVersionTagButtonMutation",operationKind:"mutation",text:`mutation DeletePromptVersionTagButtonMutation(
  $input: DeletePromptVersionTagInput!
  $promptId: GlobalID!
) {
  deletePromptVersionTag(input: $input) {
    query {
      node(id: $promptId) {
        __typename
        ...PromptVersionTagsConfigCard_data
        __isNode: __typename
        id
      }
    }
  }
}

fragment PromptVersionTagsConfigCard_data on Prompt {
  id
  versionTags {
    id
    name
    description
    promptVersionId
  }
}
`}}}();Gu.hash="9a239d04f2789c811b994f09bd0a814a";function Xv({promptVersionTagId:n,promptId:a}){const t=ke(),[l,i]=I.useMutation(Gu);return s(hl,{children:[e(A,{"aria-label":"Delete tag",size:"S",leadingVisual:e(L,{svg:e(We,{})})}),s(Ir,{placement:"bottom end",children:[e(xr,{}),e(fl,{children:s(C,{padding:"size-200",children:[e(C,{paddingBottom:"size-100",children:e(v,{color:"danger",size:"XS",children:"Are you sure you want to delete this tag? This will make pulling prompts by this tag no longer possible. Make sure this tag is not used before deleting."})}),e(A,{css:K`
                width: 100%;
              `,variant:"danger",size:"S",onPress:()=>l({variables:{input:{promptVersionTagId:n},promptId:a},onCompleted:()=>{t({title:"Tag Deleted",message:"The tag has been deleted"})}}),children:i?"Deleting...":"Delete Tag"})]})})]})]})}function Yv({prompt:n}){const a=I.useFragment(Hu,n),t=u.useMemo(()=>[{header:"Name",accessorKey:"name"},{header:"Description",accessorKey:"description",cell:De},{header:"Version",accessorKey:"promptVersionId",cell:({row:d})=>{const{promptId:c,promptVersionId:p}=d.original;return e(Oe,{to:`/prompts/${c}/versions/${p}`,children:d.original.promptVersionId})}},{id:"actions",header:"",size:5,accessorKey:"id",cell:({row:d})=>e(h,{direction:"row",gap:"size-100",justifyContent:"end",width:"100%",children:e(Xv,{promptVersionTagId:d.original.id,promptId:d.original.promptId},d.original.id)})}],[]),l=u.useMemo(()=>a.versionTags.map(d=>({id:d.id,name:d.name,description:d.description,promptId:a.id,promptVersionId:d.promptVersionId})),[a]),i=Te({columns:t,data:l,getCoreRowModel:Pe(),getSortedRowModel:hn()}),r=i.getRowModel().rows,o=r.length===0;return e(Q,{title:"Tags",variant:"compact",bodyStyle:{padding:0},children:s("table",{css:tn,children:[e("thead",{children:i.getHeaderGroups().map(d=>e("tr",{children:d.headers.map(c=>e("th",{colSpan:c.colSpan,children:c.isPlaceholder?null:s("div",{className:c.column.getCanSort()?"cursor-pointer":"",onClick:c.column.getToggleSortingHandler(),style:{left:c.getStart(),width:c.getSize()},children:[W(c.column.columnDef.header,c.getContext()),c.column.getIsSorted()?e(L,{className:"sort-icon",svg:c.column.getIsSorted()==="asc"?e(sn,{}):e(rn,{})}):null]})},c.id))},d.id))}),o?e(ln,{message:"No Tags"}):e("tbody",{children:r.map(d=>e("tr",{children:d.getVisibleCells().map(c=>e("td",{children:W(c.column.columnDef.cell,c.getContext())},c.id))},d.id))})]})})}function cC(){const n=Be();return e(h,{direction:"row",height:"100%",children:e(C,{height:"100%",overflow:"auto",width:"100%","data-testid":"scroll-container",children:e(C,{padding:"size-200",children:e(h,{direction:"column",gap:"size-200",marginStart:"auto",marginEnd:"auto",maxWidth:900,children:e(Yv,{prompt:n.prompt})})})})})}function uC(){const n=Be();return e(Eg,{query:n,children:e(xe,{})})}const Wu=function(){var n={alias:null,args:null,kind:"ScalarField",name:"passwordNeedsReset",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"authenticatedRootLoaderQuery",selections:[{args:null,kind:"FragmentSpread",name:"ViewerContext_viewer"},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[n],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"authenticatedRootLoaderQuery",selections:[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},{alias:null,args:null,concreteType:"UserRole",kind:"LinkedField",name:"role",plural:!1,selections:[t],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"authMethod",storageKey:null},{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKeys",plural:!0,selections:[a,t,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null},n],storageKey:null}]},params:{cacheID:"d63c6184305079deb38a6f6235ba88e6",id:null,metadata:{},name:"authenticatedRootLoaderQuery",operationKind:"query",text:`query authenticatedRootLoaderQuery {
  ...ViewerContext_viewer
  viewer {
    passwordNeedsReset
  }
}

fragment APIKeysTableFragment on User {
  apiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
  id
}

fragment ViewerContext_viewer on Query {
  viewer {
    id
    username
    email
    profilePictureUrl
    role {
      name
    }
    authMethod
    ...APIKeysTableFragment
  }
}
`}}}();Wu.hash="d30a68846023740517243e9394be73a8";async function mC(){var a;const n=await I.fetchQuery(he,Wu,{}).toPromise();if((a=n==null?void 0:n.viewer)!=null&&a.passwordNeedsReset){const t=Wr({path:"/reset-password"});return Ga(t)}return n}const e2=K`
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
  gap: var(--ac-global-dimension-size-200);
  padding: var(--ac-global-dimension-size-200);
`;function pC(){return e("main",{children:s(h,{direction:"column",width:"100%",children:[e(C,{padding:"size-200",borderBottomColor:"dark",borderBottomWidth:"thin",children:s(h,{direction:"column",gap:"size-50",children:[e(te,{level:1,children:"Support"}),e(v,{color:"text-700",children:"We are here to help. Pick a channel below to get in touch with us."})]})}),s("div",{css:e2,children:[e(qa,{leadingVisual:e(L,{svg:e(Mg,{})}),href:"https://docs.arize.com/phoenix",title:"Documentation",description:"Visit our documentation for tutorials and AI support."}),e(qa,{leadingVisual:e(L,{svg:e(Pi,{})}),href:"https://github.com/Arize-ai/phoenix/issues",title:"GitHub Issues",description:"Create an issue on Github to report bugs or request new features."}),e(qa,{leadingVisual:e(L,{svg:e(Pi,{})}),href:"https://github.com/Arize-ai/phoenix/discussions",title:"GitHub Discussions",description:"Create a discussion on Github to ask questions or share feedback."}),e(qa,{leadingVisual:e(L,{svg:e(Ii,{})}),href:"https://arize-ai.slack.com/join/shared_invite/zt-11t1vbu4x-xkBIHmOREQnYnYDH1GDfCg?__hstc=259489365.a667dfafcfa0169c8aee4178d115dc81.1733501603539.1733501603539.1733501603539.1&__hssc=259489365.1.1733501603539&__hsfp=3822854628&submissionGuid=381a0676-8f38-437b-96f2-fc10875658df#/shared-invite/email",title:"Slack",description:"Join our Slack community to chat with other users and the team."}),e(qa,{leadingVisual:e(L,{svg:e(Ii,{})}),href:"mailto:phoenix-support@arize.com?subject=Slack%20Connect%20Request",title:"Slack Connect",description:"Get a dedicated support channel for you and your team."})]})]})})}const n2=K`
  padding: var(--ac-global-dimension-size-200)
    var(--ac-global-dimension-size-200) var(--ac-global-dimension-size-200);
  border: var(--ac-global-border-size-thin) solid
    var(--ac-global-border-color-dark);
  border-radius: var(--ac-global-dimension-size-100);
  cursor: pointer;
  background-color: var(--ac-global-background-color-dark);
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-size-50);
  color: var(--ac-global-color-text-700);
  transition: border-color 0.2s ease-in-out;
  text-decoration: none;
  &:hover {
    border-color: var(--ac-global-color-primary);
  }
`,qa=({leadingVisual:n,href:a,title:t,description:l})=>s("a",{css:n2,href:a,target:"_blank",rel:"noreferrer",children:[s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[n,e(te,{level:2,children:t})]}),e(v,{color:"text-700",children:l})]});export{u2 as $,U2 as A,j2 as B,Q2 as C,I2 as D,T2 as E,aC as F,q2 as G,$2 as H,G2 as I,H2 as J,lC as K,X2 as L,K2 as M,rC as N,iC as O,tC as P,oC as Q,Dn as R,C2 as S,Un as T,sC as U,dC as V,m2 as W,b2 as X,k2 as Y,h2 as Z,S2 as _,Wn as a,cC as a0,p2 as a1,g2 as a2,f2 as a3,Z2 as a4,pC as a5,J2 as a6,W2 as a7,c2 as a8,uC as a9,V2 as aa,d2 as ab,o2 as ac,Kn as b,Py as c,Y2 as d,eC as e,mC as f,x2 as g,F2 as h,P2 as i,R2 as j,N2 as k,D2 as l,s2 as m,y2 as n,E2 as o,M2 as p,w2 as q,nC as r,v2 as s,L2 as t,N1 as u,_2 as v,A2 as w,z2 as x,O2 as y,B2 as z};
